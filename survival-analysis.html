<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>30&nbsp; Survival analysis – Problems and Solutions in Applied Statistics (2nd ed)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./anova-revisited.html" rel="next">
<link href="./nominal-response.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./survival-analysis.html"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Survival analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Problems and Solutions in Applied Statistics (2nd ed)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_used.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting used to R and R Studio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reading-in.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reading in data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./making-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Drawing graphs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-summaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data exploration</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./working-with-dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Working with dataframes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./one-sample-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">One-sample inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-sample-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Two-sample inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Power and sample size</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The sign test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mood-median.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Mood median test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matched-pairs-sign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Matched pairs t and sign test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Normal quantile plots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis-of-variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Analysis of variance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing reports</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Learning to code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dandruff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Treating dandruff</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidying-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Tidying data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Simple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Multiple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Regression with categorical variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dates-and-times.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Dates and times</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vector-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Vector and matrix algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Bootstrap</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Bayesian Statistics with Stan</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-revisited.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Regression revisited</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ordinal-response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Logistic regression with ordinal response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nominal-response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Logistic regression with nominal response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival-analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Survival analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova-revisited.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Analysis of variance revisited</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Analysis of covariance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Multivariate analysis of variance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Repeated measures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discriminant-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Discriminant analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Hierarchical cluster analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kmeans-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">K-means cluster analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Drawing maps with Leaflet</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Principal Components</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Factor Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loglin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Frequency table analysis</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-worcester-survey" id="toc-the-worcester-survey" class="nav-link active" data-scroll-target="#the-worcester-survey"><span class="header-section-number">30.1</span> The Worcester survey</a></li>
  <li><a href="#drug-treatment-programs" id="toc-drug-treatment-programs" class="nav-link" data-scroll-target="#drug-treatment-programs"><span class="header-section-number">30.2</span> Drug treatment programs</a></li>
  <li><a href="#multiple-myeloma" id="toc-multiple-myeloma" class="nav-link" data-scroll-target="#multiple-myeloma"><span class="header-section-number">30.3</span> Multiple myeloma</a></li>
  <li><a href="#ovarian-cancer" id="toc-ovarian-cancer" class="nav-link" data-scroll-target="#ovarian-cancer"><span class="header-section-number">30.4</span> Ovarian cancer</a></li>
  <li><a href="#the-worcester-survey-1" id="toc-the-worcester-survey-1" class="nav-link" data-scroll-target="#the-worcester-survey-1"><span class="header-section-number">30.5</span> The Worcester survey</a></li>
  <li><a href="#drug-treatment-programs-1" id="toc-drug-treatment-programs-1" class="nav-link" data-scroll-target="#drug-treatment-programs-1"><span class="header-section-number">30.6</span> Drug treatment programs</a></li>
  <li><a href="#multiple-myeloma-1" id="toc-multiple-myeloma-1" class="nav-link" data-scroll-target="#multiple-myeloma-1"><span class="header-section-number">30.7</span> Multiple myeloma</a></li>
  <li><a href="#ovarian-cancer-1" id="toc-ovarian-cancer-1" class="nav-link" data-scroll-target="#ovarian-cancer-1"><span class="header-section-number">30.8</span> Ovarian cancer</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Survival analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-worcester-survey" class="level2" data-number="30.1">
<h2 data-number="30.1" class="anchored" data-anchor-id="the-worcester-survey"><span class="header-section-number">30.1</span> The Worcester survey</h2>
<p>The Worcester survey was a long-term study of all myocardial-infarction<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> victims admitted to hospitals in the Worcester, Massachusetts area.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> The data have been well studied, and can be found in the file <a href="http://ritsokiguess.site/datafiles/whas100.csv">link</a>.</p>
<ol type="a">
<li>Read the data and display the first few rows of the data frame. You might get an extra column, which you can ignore. For your information, the variables are:</li>
</ol>
<ul>
<li><p>patient ID code</p></li>
<li><p>admission date</p></li>
<li><p>date of last followup (this is the date of death if the patient died)</p></li>
<li><p>length of hospital stay (days)</p></li>
<li><p>followup time (days) (time between admission and last followup)</p></li>
<li><p>followup status: 1=dead, 0=alive</p></li>
<li><p>Age in years (at admission)</p></li>
<li><p>gender (0=male, 1=female)</p></li>
<li><p>body mass index (kg/m<span class="math inline">\(^2\)</span>)</p></li>
</ul>
<ol start="2" type="a">
<li><p>Create a suitable response variable for a Cox proportional hazards model for time of survival, using the followup time and followup status.</p></li>
<li><p>Fit a Cox proportional hazards model predicting survival time from age, gender and BMI. Obtain the <code>summary</code> (but you don’t need to comment on it yet).</p></li>
<li><p>Test the overall fit of the model. What does the result mean?</p></li>
<li><p>Can any of your explanatory variables be removed from the model? Explain briefly.</p></li>
<li><p>Remove your most non-significant explanatory variable from the model and fit again. Take a look at the results. Are all your remaining explanatory variables significant? (If all your explanatory variables were previously significant, you can skip this part.)</p></li>
<li><p>Calculate the 1st quartile, median, and 3rd quartiles of age and BMI. (<code>quantile</code>.) Round these off to the nearest whole number. (Do the rounding off yourself, though R has a function <code>round</code> that does this, which you can investigate if you want.) As an alternative, you can get these by passing the whole data frame, or the columns of it you want, into <code>summary</code>.</p></li>
<li><p>Make a data frame out of all the combinations of age and BMI values (that you obtained in the previous part) suitable for predicting with.</p></li>
<li><p>Obtain predicted survival probabilities for each of the values in your new data frame. Use your best model. (You don’t need to look at the results, though you can if you want to.)</p></li>
<li><p>Make a graph depicting the survival curves from <code>survfit</code> with different colours distinguishing the different survival curves.</p></li>
<li><p>What is the effect of age on survival? What is the effect of BMI on survival? Explain briefly. (You will have to disentangle the meaning of the different coloured lines on the plot to do this.)</p></li>
</ol>
</section>
<section id="drug-treatment-programs" class="level2" data-number="30.2">
<h2 data-number="30.2" class="anchored" data-anchor-id="drug-treatment-programs"><span class="header-section-number">30.2</span> Drug treatment programs</h2>
<p>One of the goals of drug treatment programs is to lengthen the time until the patient returns to using drugs. (It is not generally possible to prevent patients from <em>ever</em> using drugs again.) In one study, over 600 former drug users took part. Two different programs, a short program and a long program, were offered at two different sites, labelled A and B. The data can be found in <a href="http://ritsokiguess.site/datafiles/drugusers.txt">link</a>. The variables are these:</p>
<ul>
<li><p><code>ID</code>: patient ID number</p></li>
<li><p><code>age</code>: patient age at enrollment into the study</p></li>
<li><p><code>ndrugtx</code>: number of previous drug treatments</p></li>
<li><p><code>treat</code>: 0 for short treatment program, 1 for long program</p></li>
<li><p><code>site</code>: 0 for site A, 1 for site B</p></li>
<li><p><code>time</code>: time until return to drug use</p></li>
<li><p><code>censor</code>: whether the subject returned to drug use (1) or not (0) during the follow-up period</p></li>
<li><p><code>herco</code>: whether subject used heroine or cocaine in the last 3 months: 1 is both, 2 is one (either heroine or cocaine), 3 is neither.</p></li>
</ul>
<ol type="a">
<li><p>Read in the data and check in one way or another that you have what was promised above.</p></li>
<li><p>There are some missing values in the dataframe. Demonstrate this using <code>summary</code>. Pipe the dataframe into <code>drop_na</code> and show that they have gone. (<code>drop_na</code> removes all rows that have missing values in them.)</p></li>
<li><p>Some of these variables are recorded as numbers but are actually categorical. Which ones? Re-define these variables in your data frame so that they have sensible (text) values.</p></li>
<li><p>Create a suitable reponse variable for a Cox proportional hazards regression that predicts time until return to drug use from the other variables. This requires some care, because you need to be sure about what the censoring variable actually represents and what you need it to represent.</p></li>
<li><p>Look at the first few values of your response variable. Why is the fifth one marked with a <code>+</code>? Explain briefly.</p></li>
<li><p>Fit a Cox proportional hazards model, predicting from all the other variables (except for <code>row</code> and <code>ID</code>) that you haven’t used yet. Display the results.</p></li>
<li><p>Find which explanatory variables can be removed at <span class="math inline">\(\alpha=0.05\)</span> (there should be two of them). Bear in mind that we have categorical variables, so that looking at the output from <code>summary</code> is not enough.</p></li>
<li><p>Remove <em>all</em> the non-significant explanatory variables and re-fit your model. By carrying out a suitable test demonstrate that your smaller model is the better one.</p></li>
<li><p><a name="part:posneg">*</a> Display your better model. Are all of the explanatory variables significant? Do their slope coefficients have sensible signs (plus or minus), based on what you know or can guess about drug treatments? Explain briefly.</p></li>
<li><p>We have three variables left in our model, <code>age</code>, <code>ndrugtx</code> and <code>treat</code>. The quartiles of age are 27 and 37, the quartiles of <code>ndrugtx</code> are 1 and 6, and the two possible values of <code>treat</code> are <code>short</code> and <code>long</code>. Create a data frame with variables of these names and all possible combinations of their values (so there should be 8 rows in the resulting data frame). Display the resulting data frame.</p></li>
<li><p>Obtain predicted survival probabilities for each of the values of <code>age</code>, <code>ndrugtx</code> and <code>treat</code> used in the previous part. You don’t need to display it (we are going to plot it shortly).</p></li>
<li><p>Plot your predicted survival curves.</p></li>
<li><p>Which of your combinations of values is predicted to take the longest to return to drug use? Which is predicted to take the shortest time? Explain briefly.</p></li>
<li><p>Are your survival curve plot and your conclusions from part (<a href="#part:posneg">here</a>) consistent, or not? Explain briefly.</p></li>
</ol>
</section>
<section id="multiple-myeloma" class="level2" data-number="30.3">
<h2 data-number="30.3" class="anchored" data-anchor-id="multiple-myeloma"><span class="header-section-number">30.3</span> Multiple myeloma</h2>
<p>Multiple myeloma is a kind of cancer. It forms in a plasma cell (which is a type of white blood cell). It causes cancer cells to accumulate in the bone marrow, where they crowd out healthy blood cells. Plasma cells make antibodies (to help fight infections), while the cancer cells don’t: they produce abnormal proteins that can cause kidney problems. (This adapted from <a href="http://www.mayoclinic.org/diseases-conditions/multiple-myeloma/basics/definition/con-20026607">link</a>.) The variables are:</p>
<ul>
<li><p><code>time</code>: survival time from diagnosis (months)</p></li>
<li><p><code>vstatus</code>: 0=alive, 1=dead at end of study</p></li>
<li><p><code>logbun</code>: log of BUN test score (BUN test is a test of kidney function, not to be confused with cha siu bao<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>).</p></li>
<li><p><code>hgb</code>: hemoglobin (at diagnosis).</p></li>
<li><p><code>platelet</code>: platelets: 1=normal, 0=abnormal (at diagnosis).</p></li>
<li><p><code>age</code> at diagnosis, in years</p></li>
<li><p><code>logwbc</code>: log of WBC (white blood cell count, at diagnosis)</p></li>
<li><p><code>frac</code>: fractures at diagnosis (0=absent, 1=present)</p></li>
<li><p><code>logpbm</code>: log of percent of plasma cells in bone marrow</p></li>
<li><p><code>protein</code>: proteinuria (protein in urine) at diagnosis. Most people have very little, so a larger than normal amount indicates illness of some kind.</p></li>
<li><p><code>scalc</code>: serum calcium at diagnosis.</p></li>
</ul>
<p>The data, on 65 patients with multiple myeloma, are in <a href="http://ritsokiguess.site/datafiles/myeloma.csv">link</a>. Some of the variables are logs because they could take very large values.</p>
<p>There are a lot of parts here, but each part is supposed to be short.</p>
<ol type="a">
<li><p>Read in the data and display (some of) the values. Confirm that you have the right number of observations and the right variables.</p></li>
<li><p>Create a suitable response variable for a Cox proportional-hazards survival model, bearing in mind that the “event” here is death. Display your response variable, and explain briefly what the <code>+</code> signs attached to some of the values mean, without using a technical term.</p></li>
<li><p>What is the technical term for those patients that have a <code>+</code> by their values for the response variable?</p></li>
<li><p>Fit a Cox proportional-hazards survival model predicting your response variable from all the other variables (except for the ones that you used to make the response variable). Display the <code>summary</code> of your model.</p></li>
<li><p>In your model, which explanatory variables have a P-value less than 0.10? Fit a model containing only those and display the results.</p></li>
<li><p>Do a test to compare the two models that you fit. Why do you prefer the second model? Explain briefly.</p></li>
<li><p>There should be two explanatory variables left in your model. These are both numerical variables. Find their first and third quartiles, any way you like.</p></li>
<li><p>Create a data frame containing all possible combinations of the two quartiles for each of the two variables, and display the result.</p></li>
<li><p>Obtain predicted survival probabilities for each of the combinations of variables you created above. You don’t need to look at the results (they are rather long).</p></li>
<li><p>Obtain a graph of the predicted survival curves for each combination of your variables.</p></li>
<li><p>Is it better to have high or low values for each of the variables in your prediction? Explain briefly.</p></li>
</ol>
</section>
<section id="ovarian-cancer" class="level2" data-number="30.4">
<h2 data-number="30.4" class="anchored" data-anchor-id="ovarian-cancer"><span class="header-section-number">30.4</span> Ovarian cancer</h2>
<p>R’s <code>survival</code> package contains several data sets. One of these is called <code>ovarian</code>; it comes from a study of 26 ovarian cancer patients. The major purpose of this study was to compare the effects of two treatments on survival time.</p>
<ol type="a">
<li><p>Obtain and display (all of) the data set. This is as simple as loading the package and typing the data set’s name.</p></li>
<li><p>The columns of interest to us are:</p></li>
</ol>
<ul>
<li><p><code>futime</code>: the time for which a patient was followed-up: the number of days until either they died or the study ended (or they withdrew from the study for some other reason).</p></li>
<li><p><code>fustat</code>: follow-up status: 1 if the patient died of ovarian cancer, 0 if they were still alive when the study ended.</p></li>
<li><p><code>age</code>: of patient, at diagnosis, in years</p></li>
<li><p><code>rx</code>: treatment, numbered 1 or 2, but really labels for the two treatments.</p></li>
</ul>
<p>Create and display a suitable response variable <code>y</code> for a Cox proportional-hazards model.</p>
<ol start="3" type="a">
<li><p>In the display of your response variable, some values are marked with a <code>+</code>. Why is that? Explain briefly. (If you use a technical term, you should explain what it means.)</p></li>
<li><p>Fit a Cox proportional-hazards model for predicting survival time from age and treatment. Note that the numeric values for treatment make sense only as labels for the two treatments, so in your model formula make treatment into a factor. Display the results.</p></li>
<li><p>Is there a significant difference between the treatments in terms of their effects on survival (from ovarian cancer)?</p></li>
<li><p>Is there a significant effect of age? If there is, describe the effect that age has on survival.</p></li>
<li><p>Make a martingale residual plot for this model. Do you see any problems? Explain briefly.</p></li>
<li><p>Find the quartiles of <code>age</code>, and make a data frame containing all combinations of those two ages and the two treatments. Display what you have. (Feel free to copy the values by hand, rather than trying to save them and use them.)</p></li>
<li><p>Obtain predicted survival probabilities for each of your age-treatment combinations, for each of a variety of survival times. (This is only one thing, despite it sounding like a lot.)</p></li>
<li><p>Draw a plot that compares the survival probabilities at the different times.</p></li>
<li><p>According to your plot, how would you describe the effects of treatment and of age?</p></li>
</ol>
<p>My solutions follow:</p>
</section>
<section id="the-worcester-survey-1" class="level2" data-number="30.5">
<h2 data-number="30.5" class="anchored" data-anchor-id="the-worcester-survey-1"><span class="header-section-number">30.5</span> The Worcester survey</h2>
<p>The Worcester survey was a long-term study of all myocardial-infarction<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> victims admitted to hospitals in the Worcester, Massachusetts area.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> The data have been well studied, and can be found in the file <a href="http://ritsokiguess.site/datafiles/whas100.csv">link</a>.</p>
<ol type="a">
<li>Read the data and display the first few rows of the data frame. You might get an extra column, which you can ignore. For your information, the variables are:</li>
</ol>
<ul>
<li><p>patient ID code</p></li>
<li><p>admission date</p></li>
<li><p>date of last followup (this is the date of death if the patient died)</p></li>
<li><p>length of hospital stay (days)</p></li>
<li><p>followup time (days) (time between admission and last followup)</p></li>
<li><p>followup status: 1=dead, 0=alive</p></li>
<li><p>Age in years (at admission)</p></li>
<li><p>gender (0=male, 1=female)</p></li>
<li><p>body mass index (kg/m<span class="math inline">\(^2\)</span>)</p></li>
</ul>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/whas100.csv"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>whas100 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Missing column names filled in: 'X1' [1]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Parsed with column specification:
cols(
  X1 = col_double(),
  id = col_double(),
  admitdate = col_character(),
  foldate = col_character(),
  los = col_double(),
  lenfol = col_double(),
  fstat = col_double(),
  age = col_double(),
  gender = col_double(),
  bmi = col_double()
)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>whas100</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["X1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["id"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["admitdate"],"name":[3],"type":["chr"],"align":["left"]},{"label":["foldate"],"name":[4],"type":["chr"],"align":["left"]},{"label":["los"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["lenfol"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["fstat"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["gender"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["bmi"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1","3":"3/13/1995","4":"3/19/1995","5":"4","6":"6","7":"1","8":"65","9":"0","10":"31.38134"},{"1":"2","2":"2","3":"1/14/1995","4":"1/23/1996","5":"5","6":"374","7":"1","8":"88","9":"1","10":"22.65790"},{"1":"3","2":"3","3":"2/17/1995","4":"10/4/2001","5":"5","6":"2421","7":"1","8":"77","9":"0","10":"27.87892"},{"1":"4","2":"4","3":"4/7/1995","4":"7/14/1995","5":"9","6":"98","7":"1","8":"81","9":"1","10":"21.47878"},{"1":"5","2":"5","3":"2/9/1995","4":"5/29/1998","5":"4","6":"1205","7":"1","8":"78","9":"0","10":"30.70601"},{"1":"6","2":"6","3":"1/16/1995","4":"9/11/2000","5":"7","6":"2065","7":"1","8":"82","9":"1","10":"26.45294"},{"1":"7","2":"7","3":"1/17/1995","4":"10/15/1997","5":"3","6":"1002","7":"1","8":"66","9":"1","10":"35.71147"},{"1":"8","2":"8","3":"11/15/1994","4":"11/24/2000","5":"56","6":"2201","7":"1","8":"81","9":"1","10":"28.27676"},{"1":"9","2":"9","3":"8/18/1995","4":"2/23/1996","5":"5","6":"189","7":"1","8":"76","9":"0","10":"27.12082"},{"1":"10","2":"10","3":"7/22/1995","4":"12/31/2002","5":"9","6":"2719","7":"0","8":"40","9":"0","10":"21.78971"},{"1":"11","2":"11","3":"10/11/1995","4":"12/31/2002","5":"6","6":"2638","7":"0","8":"73","9":"1","10":"28.43344"},{"1":"12","2":"12","3":"5/26/1995","4":"9/29/1996","5":"11","6":"492","7":"1","8":"83","9":"0","10":"24.66175"},{"1":"13","2":"13","3":"5/21/1995","4":"3/18/1996","5":"6","6":"302","7":"1","8":"64","9":"1","10":"27.46412"},{"1":"14","2":"14","3":"12/14/1995","4":"12/31/2002","5":"10","6":"2574","7":"0","8":"58","9":"0","10":"29.83756"},{"1":"15","2":"15","3":"11/8/1995","4":"12/31/2002","5":"7","6":"2610","7":"0","8":"43","9":"0","10":"22.95776"},{"1":"16","2":"16","3":"10/8/1995","4":"12/31/2002","5":"5","6":"2641","7":"0","8":"39","9":"0","10":"30.10881"},{"1":"17","2":"17","3":"10/17/1995","4":"5/12/2000","5":"6","6":"1669","7":"1","8":"66","9":"0","10":"31.99738"},{"1":"18","2":"18","3":"10/30/1995","4":"1/5/2003","5":"9","6":"2624","7":"1","8":"61","9":"0","10":"30.71420"},{"1":"19","2":"19","3":"12/10/1995","4":"12/31/2002","5":"6","6":"2578","7":"0","8":"49","9":"0","10":"25.69548"},{"1":"20","2":"20","3":"11/23/1995","4":"12/31/2002","5":"5","6":"2595","7":"0","8":"53","9":"1","10":"30.12017"},{"1":"21","2":"21","3":"10/5/1995","4":"2/5/1996","5":"6","6":"123","7":"1","8":"85","9":"0","10":"18.41038"},{"1":"22","2":"22","3":"11/5/1995","4":"12/31/2002","5":"8","6":"2613","7":"0","8":"69","9":"1","10":"37.60097"},{"1":"23","2":"23","3":"9/9/1995","4":"10/22/1997","5":"4","6":"774","7":"1","8":"54","9":"0","10":"28.97529"},{"1":"24","2":"24","3":"9/9/1995","4":"3/13/2001","5":"14","6":"2012","7":"1","8":"82","9":"0","10":"19.90095"},{"1":"25","2":"25","3":"12/15/1995","4":"12/31/2002","5":"4","6":"2573","7":"0","8":"67","9":"1","10":"28.32237"},{"1":"26","2":"26","3":"12/3/1995","4":"1/19/2001","5":"11","6":"1874","7":"1","8":"89","9":"1","10":"23.43605"},{"1":"27","2":"27","3":"10/18/1995","4":"12/31/2002","5":"2","6":"2631","7":"0","8":"68","9":"0","10":"26.44693"},{"1":"28","2":"28","3":"3/16/1995","4":"6/4/2000","5":"7","6":"1907","7":"1","8":"78","9":"0","10":"28.20595"},{"1":"29","2":"29","3":"10/25/1995","4":"4/15/1997","5":"5","6":"538","7":"1","8":"56","9":"0","10":"24.11997"},{"1":"30","2":"30","3":"10/6/1995","4":"1/18/1996","5":"4","6":"104","7":"1","8":"85","9":"1","10":"36.71647"},{"1":"31","2":"31","3":"9/3/1995","4":"9/9/1995","5":"4","6":"6","7":"1","8":"72","9":"0","10":"27.97907"},{"1":"32","2":"32","3":"6/30/1995","4":"5/1/1999","5":"5","6":"1401","7":"1","8":"50","9":"0","10":"20.36300"},{"1":"33","2":"33","3":"7/22/1995","4":"12/22/2002","5":"8","6":"2710","7":"1","8":"81","9":"1","10":"28.64898"},{"1":"34","2":"34","3":"9/17/1995","4":"1/5/1998","5":"4","6":"841","7":"1","8":"85","9":"1","10":"20.17772"},{"1":"35","2":"35","3":"3/21/1997","4":"8/16/1997","5":"6","6":"148","7":"1","8":"84","9":"1","10":"23.61870"},{"1":"36","2":"36","3":"2/23/1997","4":"12/31/2002","5":"12","6":"2137","7":"0","8":"75","9":"0","10":"23.67519"},{"1":"37","2":"37","3":"1/1/1997","4":"12/31/2002","5":"16","6":"2190","7":"0","8":"61","9":"0","10":"23.43140"},{"1":"38","2":"38","3":"1/18/1997","4":"12/31/2002","5":"5","6":"2173","7":"0","8":"48","9":"0","10":"33.45110"},{"1":"39","2":"39","3":"1/19/1997","4":"4/25/1998","5":"8","6":"461","7":"1","8":"83","9":"1","10":"19.57068"},{"1":"40","2":"40","3":"3/18/1997","4":"12/31/2002","5":"10","6":"2114","7":"0","8":"82","9":"0","10":"25.82748"},{"1":"41","2":"41","3":"2/3/1997","4":"12/31/2002","5":"4","6":"2157","7":"0","8":"62","9":"0","10":"30.86625"},{"1":"42","2":"42","3":"5/17/1997","4":"12/31/2002","5":"5","6":"2054","7":"0","8":"39","9":"0","10":"24.21079"},{"1":"43","2":"43","3":"3/8/1997","4":"12/31/2002","5":"5","6":"2124","7":"0","8":"45","9":"0","10":"31.66439"},{"1":"44","2":"44","3":"2/23/1997","4":"12/31/2002","5":"4","6":"2137","7":"0","8":"65","9":"0","10":"26.22085"},{"1":"45","2":"45","3":"6/14/1997","4":"1/5/2003","5":"18","6":"2031","7":"1","8":"76","9":"1","10":"32.41986"},{"1":"46","2":"46","3":"7/7/1997","4":"12/31/2002","5":"9","6":"2003","7":"0","8":"77","9":"1","10":"24.56345"},{"1":"47","2":"47","3":"4/27/1997","4":"12/31/2002","5":"9","6":"2074","7":"0","8":"68","9":"0","10":"21.30550"},{"1":"48","2":"48","3":"5/15/1997","4":"2/13/1998","5":"7","6":"274","7":"1","8":"73","9":"0","10":"26.45678"},{"1":"49","2":"49","3":"7/26/1997","4":"12/31/2002","5":"4","6":"1984","7":"0","8":"64","9":"0","10":"27.97977"},{"1":"50","2":"50","3":"7/17/1997","4":"12/31/2002","5":"6","6":"1993","7":"0","8":"80","9":"0","10":"36.02333"},{"1":"51","2":"51","3":"9/9/1997","4":"12/31/2002","5":"7","6":"1939","7":"0","8":"84","9":"1","10":"22.31424"},{"1":"52","2":"52","3":"6/19/1997","4":"9/3/2000","5":"4","6":"1172","7":"1","8":"43","9":"1","10":"25.33148"},{"1":"53","2":"53","3":"8/20/1997","4":"11/17/1997","5":"3","6":"89","7":"1","8":"87","9":"1","10":"18.77718"},{"1":"54","2":"54","3":"8/28/1997","4":"1/3/1998","5":"7","6":"128","7":"1","8":"70","9":"1","10":"18.60004"},{"1":"55","2":"55","3":"9/9/1997","4":"12/31/2002","5":"17","6":"1939","7":"0","8":"80","9":"0","10":"25.50204"},{"1":"56","2":"56","3":"9/1/1997","4":"9/15/1997","5":"11","6":"14","7":"1","8":"64","9":"1","10":"24.41255"},{"1":"57","2":"57","3":"9/3/1997","4":"6/10/2000","5":"5","6":"1011","7":"1","8":"59","9":"1","10":"29.85998"},{"1":"58","2":"58","3":"9/24/1997","4":"10/30/2001","5":"6","6":"1497","7":"1","8":"92","9":"0","10":"24.36640"},{"1":"59","2":"59","3":"9/19/1997","4":"12/31/2002","5":"3","6":"1929","7":"0","8":"51","9":"0","10":"34.77034"},{"1":"60","2":"60","3":"4/17/1997","4":"12/31/2002","5":"1","6":"2084","7":"0","8":"41","9":"0","10":"27.26234"},{"1":"61","2":"61","3":"10/21/1997","4":"2/5/1998","5":"6","6":"107","7":"1","8":"90","9":"0","10":"24.78423"},{"1":"62","2":"62","3":"10/2/1997","4":"12/27/1998","5":"4","6":"451","7":"1","8":"83","9":"0","10":"21.80987"},{"1":"63","2":"63","3":"1/8/1997","4":"12/31/2002","5":"3","6":"2183","7":"0","8":"61","9":"0","10":"27.36909"},{"1":"64","2":"64","3":"11/11/1997","4":"12/31/2002","5":"7","6":"1876","7":"0","8":"64","9":"0","10":"26.22085"},{"1":"65","2":"65","3":"11/7/1997","4":"5/31/2000","5":"3","6":"936","7":"1","8":"82","9":"0","10":"26.88683"},{"1":"66","2":"66","3":"4/20/1997","4":"4/18/1998","5":"5","6":"363","7":"1","8":"91","9":"1","10":"27.61844"},{"1":"67","2":"67","3":"6/18/1997","4":"5/1/2000","5":"5","6":"1048","7":"1","8":"48","9":"0","10":"31.58373"},{"1":"68","2":"68","3":"10/29/1997","4":"12/31/2002","5":"12","6":"1889","7":"0","8":"63","9":"0","10":"23.33267"},{"1":"69","2":"69","3":"4/29/1997","4":"12/31/2002","5":"5","6":"2072","7":"0","8":"81","9":"0","10":"28.35006"},{"1":"70","2":"70","3":"11/8/1997","4":"12/31/2002","5":"7","6":"1879","7":"0","8":"52","9":"0","10":"32.63621"},{"1":"71","2":"71","3":"11/17/1997","4":"12/31/2002","5":"4","6":"1870","7":"0","8":"65","9":"0","10":"31.95113"},{"1":"72","2":"72","3":"11/28/1997","4":"12/31/2002","5":"5","6":"1859","7":"0","8":"74","9":"0","10":"25.01782"},{"1":"73","2":"73","3":"5/19/1997","4":"12/31/2002","5":"5","6":"2052","7":"0","8":"62","9":"0","10":"30.22827"},{"1":"74","2":"74","3":"12/11/1997","4":"12/31/2002","5":"4","6":"1846","7":"0","8":"60","9":"1","10":"29.28812"},{"1":"75","2":"75","3":"5/10/1997","4":"12/31/2002","5":"7","6":"2061","7":"0","8":"71","9":"0","10":"32.32407"},{"1":"76","2":"76","3":"10/6/1997","4":"12/31/2002","5":"3","6":"1912","7":"0","8":"73","9":"0","10":"31.47445"},{"1":"77","2":"77","3":"12/21/1997","4":"12/31/2002","5":"5","6":"1836","7":"0","8":"43","9":"0","10":"28.59188"},{"1":"78","2":"78","3":"11/22/1997","4":"3/16/1998","5":"7","6":"114","7":"1","8":"80","9":"0","10":"33.36074"},{"1":"79","2":"79","3":"10/31/1997","4":"2/4/2002","5":"7","6":"1557","7":"1","8":"72","9":"0","10":"21.80987"},{"1":"80","2":"80","3":"6/28/1997","4":"12/27/2000","5":"5","6":"1278","7":"1","8":"57","9":"0","10":"23.57087"},{"1":"81","2":"81","3":"12/21/1997","4":"12/31/2002","5":"3","6":"1836","7":"0","8":"80","9":"1","10":"28.35006"},{"1":"82","2":"82","3":"10/2/1997","4":"12/31/2002","5":"6","6":"1916","7":"0","8":"76","9":"0","10":"28.03555"},{"1":"83","2":"83","3":"9/14/1997","4":"12/31/2002","5":"3","6":"1934","7":"0","8":"53","9":"0","10":"24.21079"},{"1":"84","2":"84","3":"9/25/1997","4":"12/31/2002","5":"10","6":"1923","7":"0","8":"44","9":"0","10":"32.60387"},{"1":"85","2":"85","3":"12/2/1997","4":"1/15/1998","5":"3","6":"44","7":"1","8":"71","9":"0","10":"23.05630"},{"1":"86","2":"86","3":"9/26/1997","4":"12/31/2002","5":"6","6":"1922","7":"0","8":"64","9":"0","10":"31.75016"},{"1":"87","2":"87","3":"10/24/1997","4":"7/25/1998","5":"5","6":"274","7":"1","8":"86","9":"0","10":"21.10959"},{"1":"88","2":"88","3":"11/27/1997","4":"12/31/2002","5":"7","6":"1860","7":"0","8":"72","9":"1","10":"25.23266"},{"1":"89","2":"89","3":"4/12/1997","4":"3/23/2002","5":"4","6":"1806","7":"1","8":"73","9":"1","10":"22.86698"},{"1":"90","2":"90","3":"2/15/1997","4":"12/31/2002","5":"6","6":"2145","7":"0","8":"85","9":"1","10":"26.05501"},{"1":"91","2":"91","3":"10/22/1997","4":"4/22/1998","5":"5","6":"182","7":"1","8":"60","9":"0","10":"23.18023"},{"1":"92","2":"92","3":"6/27/1997","4":"12/31/2002","5":"4","6":"2013","7":"0","8":"63","9":"0","10":"35.48949"},{"1":"93","2":"93","3":"1/17/1997","4":"12/31/2002","5":"5","6":"2174","7":"0","8":"80","9":"1","10":"20.59809"},{"1":"94","2":"94","3":"12/12/1997","4":"5/24/2002","5":"4","6":"1624","7":"1","8":"74","9":"0","10":"30.13206"},{"1":"95","2":"95","3":"11/4/1997","4":"5/10/1998","5":"10","6":"187","7":"1","8":"79","9":"1","10":"16.78615"},{"1":"96","2":"96","3":"11/4/1997","4":"12/31/2002","5":"4","6":"1883","7":"0","8":"48","9":"1","10":"32.11709"},{"1":"97","2":"97","3":"12/24/1997","4":"4/19/2002","5":"3","6":"1577","7":"1","8":"32","9":"1","10":"39.93835"},{"1":"98","2":"98","3":"11/26/1997","4":"1/27/1998","5":"8","6":"62","7":"1","8":"86","9":"1","10":"14.91878"},{"1":"99","2":"99","3":"8/10/1997","4":"12/31/2002","5":"16","6":"1969","7":"0","8":"56","9":"0","10":"29.05295"},{"1":"100","2":"100","3":"3/26/1997","4":"2/13/2000","5":"7","6":"1054","7":"1","8":"74","9":"0","10":"32.89087"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>I seem to have an extra column called <code>X1</code>. This is because I saved my version of the data using the old <code>write.csv</code>, which comes with row names, and I forgot to get rid of them. These came back as an extra unnamed variable to which <code>read_delim</code> gave the name <code>X1</code>.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Create a suitable response variable for a Cox proportional hazards model for time of survival, using the followup time and followup status.</li>
</ol>
<p>Solution</p>
<p><code>Surv</code>. The event here is death, so the two parts of the response variable are followup time <code>lenfol</code> and followup status, 1 being “dead”, <code>fstat</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">with</span>(whas100, <span class="fu">Surv</span>(lenfol, fstat <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]    6   374  2421    98  1205  2065  1002  2201   189  2719+ 2638+  492 
 [13]  302  2574+ 2610+ 2641+ 1669  2624  2578+ 2595+  123  2613+  774  2012 
 [25] 2573+ 1874  2631+ 1907   538   104     6  1401  2710   841   148  2137+
 [37] 2190+ 2173+  461  2114+ 2157+ 2054+ 2124+ 2137+ 2031  2003+ 2074+  274 
 [49] 1984+ 1993+ 1939+ 1172    89   128  1939+   14  1011  1497  1929+ 2084+
 [61]  107   451  2183+ 1876+  936   363  1048  1889+ 2072+ 1879+ 1870+ 1859+
 [73] 2052+ 1846+ 2061+ 1912+ 1836+  114  1557  1278  1836+ 1916+ 1934+ 1923+
 [85]   44  1922+  274  1860+ 1806  2145+  182  2013+ 2174+ 1624   187  1883+
 [97] 1577    62  1969+ 1054 </code></pre>
</div>
</div>
<p>Just using <code>fstat</code> alone as the second thing in <code>Surv</code> also works, because anything that gives <code>TRUE</code> or 1 when the event (death) occurs is equally good. (In R, <code>TRUE</code> as a number is 1 and <code>FALSE</code> as a number is 0.)</p>
<p>I listed the values by way of checking. The ones with a <code>+</code> are censored: that is, the patient was still alive the last time the doctor saw them. Most of the censored values are longer times. Usually this happens because the patient was still alive at the end of the study.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>Fit a Cox proportional hazards model predicting survival time from age, gender and BMI. Obtain the <code>summary</code> (but you don’t need to comment on it yet).</li>
</ol>
<p>Solution</p>
<p>This, using the <code>Surv</code> that we just created:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>whas100<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(lenfol, fstat <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span> age <span class="sc">+</span> gender <span class="sc">+</span> bmi, <span class="at">data =</span> whas100)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(whas100<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(lenfol, fstat == 1) ~ age + gender + bmi, 
    data = whas100)

  n= 100, number of events= 51 

           coef exp(coef) se(coef)      z Pr(&gt;|z|)   
age     0.03713   1.03783  0.01272  2.918  0.00352 **
gender  0.14325   1.15402  0.30604  0.468  0.63973   
bmi    -0.07083   0.93162  0.03607 -1.964  0.04956 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

       exp(coef) exp(-coef) lower .95 upper .95
age       1.0378     0.9636    1.0123    1.0640
gender    1.1540     0.8665    0.6334    2.1024
bmi       0.9316     1.0734    0.8680    0.9999

Concordance= 0.683  (se = 0.037 )
Likelihood ratio test= 21.54  on 3 df,   p=8e-05
Wald test            = 19.46  on 3 df,   p=2e-04
Score (logrank) test = 20.82  on 3 df,   p=1e-04</code></pre>
</div>
</div>
<p>Gender is actually categorical, but because there are only two different values (0 and 1) in the dataset, we can get away with treating it as quantitative here. (The coefficient is actually the effect on the log-hazard of being gender 1, female, rather than gender 0, male).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Test the overall fit of the model. What does the result mean?</li>
</ol>
<p>Solution</p>
<p>Look at those three P-values at the bottom. They are all small, so something in the model is helping to predict survival. As to what? Well, that’s the next part.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Can any of your explanatory variables be removed from the model? Explain briefly.</li>
</ol>
<p>Solution</p>
<p><code>gender</code> has a (very) large P-value, so that can be taken out of the model. The other two variables have small P-values (<code>bmi</code> only just under 0.05), so they need to stay. The other way to think about this is <code>step</code>, or <code>drop1</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(whas100<span class="fl">.1</span>, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"402.6565","3":"NA","4":"NA","_rn_":"<none>"},{"1":"1","2":"410.2537","3":"9.5972143","4":"0.001948728","_rn_":"age"},{"1":"1","2":"400.8750","3":"0.2184572","4":"0.640217940","_rn_":"gender"},{"1":"1","2":"404.5954","3":"3.9388912","4":"0.047181867","_rn_":"bmi"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This is here equivalent to<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> the output from <code>summary</code>, but where it scores is if you have a categorical explanatory variable like “treatment” with more than two levels: <code>drop1</code> will tell you about keeping or dropping it as a whole.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<p>If you prefer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(whas100<span class="fl">.1</span>, <span class="at">trace =</span> <span class="dv">0</span>, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(lenfol, fstat == 1) ~ age + bmi, data = whas100)

        coef exp(coef) se(coef)      z        p
age  0.03927   1.04005  0.01187  3.309 0.000938
bmi -0.07116   0.93131  0.03614 -1.969 0.048952

Likelihood ratio test=21.32  on 2 df, p=2.346e-05
n= 100, number of events= 51 </code></pre>
</div>
</div>
<p><code>gender</code> comes out, but the others stay. As usual, put <code>trace=1</code> or <code>trace=2</code> to get more output, which will look like a sequence of <code>drop1</code>’s one after the other.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Remove your most non-significant explanatory variable from the model and fit again. Take a look at the results. Are all your remaining explanatory variables significant? (If all your explanatory variables were previously significant, you can skip this part.)</li>
</ol>
<p>Solution</p>
<p>So, take out <code>gender</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>whas100<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(whas100<span class="fl">.1</span>, . <span class="sc">~</span> . <span class="sc">-</span> gender)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(whas100<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(lenfol, fstat == 1) ~ age + bmi, data = whas100)

  n= 100, number of events= 51 

        coef exp(coef) se(coef)      z Pr(&gt;|z|)    
age  0.03927   1.04005  0.01187  3.309 0.000938 ***
bmi -0.07116   0.93131  0.03614 -1.969 0.048952 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

    exp(coef) exp(-coef) lower .95 upper .95
age    1.0401     0.9615    1.0161    1.0645
bmi    0.9313     1.0738    0.8676    0.9997

Concordance= 0.681  (se = 0.037 )
Likelihood ratio test= 21.32  on 2 df,   p=2e-05
Wald test            = 19  on 2 df,   p=7e-05
Score (logrank) test = 19.99  on 2 df,   p=5e-05</code></pre>
</div>
</div>
<p>Both explanatory variables are significant: <code>age</code> definitely, <code>bmi</code> only just. This is the same model as <code>step</code> gave me.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Calculate the 1st quartile, median, and 3rd quartiles of age and BMI. (<code>quantile</code>.) Round these off to the nearest whole number. (Do the rounding off yourself, though R has a function <code>round</code> that does this, which you can investigate if you want.) As an alternative, you can get these by passing the whole data frame, or the columns of it you want, into <code>summary</code>.</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(whas100<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   0%   25%   50%   75%  100% 
32.00 59.75 71.00 80.25 92.00 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(whas100<span class="sc">$</span>bmi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      0%      25%      50%      75%     100% 
14.91878 23.53717 27.19158 30.34770 39.93835 </code></pre>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>whas100 <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, bmi) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      age             bmi       
 Min.   :32.00   Min.   :14.92  
 1st Qu.:59.75   1st Qu.:23.54  
 Median :71.00   Median :27.19  
 Mean   :68.25   Mean   :27.04  
 3rd Qu.:80.25   3rd Qu.:30.35  
 Max.   :92.00   Max.   :39.94  </code></pre>
</div>
</div>
<p>Or, pure tidyverse: summarize the two columns you want using <code>across</code>. This one is <code>reframe</code> rather than <code>summarize</code> because <code>quantile</code> returns five values (the five-number summary) rather than just one. The challenge with this kind of thing is getting the brackets right: there should be one bracket closed after <code>bmi</code> (the one belonging to <code>c</code>), but the <code>across</code> has to include both the columns to work with <em>and</em> the thing to do with them (work out the 5-number summary of each one), so there are no more close-brackets before the <code>\(x) quantile(x)</code> but several after: the one closing the <code>quantile</code>, the one closing the <code>across</code>, and the one closing the <code>reframe</code>. When you close a bracket, R Studio shows you the corresponding open bracket, and if you close too many, the offending one will get a red squiggly line under it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>whas100 <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="fu">across</span>(<span class="fu">c</span>(age, bmi), \(x) <span class="fu">quantile</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["bmi"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"32.00","2":"14.91878"},{"1":"59.75","2":"23.53717"},{"1":"71.00","2":"27.19158"},{"1":"80.25","2":"30.34770"},{"1":"92.00","2":"39.93835"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Using whichever of this multitude of ways appeals to you:</p>
<p>60, 71 and 80 for age, 24, 27 and 30 for BMI.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" type="a">
<li>Make a data frame out of all the combinations of age and BMI values (that you obtained in the previous part) suitable for predicting with.</li>
</ol>
<p>Solution</p>
<p>The inevitable <code>datagrid</code>. This is probably quickest, with the best model being the second one:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>whas100.new <span class="ot">&lt;-</span> <span class="fu">datagrid</span>(<span class="at">model =</span> whas100<span class="fl">.2</span>, <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">71</span>, <span class="dv">80</span>), <span class="at">bmi =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">27</span>, <span class="dv">30</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>whas100.new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["lenfol"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fstat"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bmi"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rowid"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"1505.4","2":"1","3":"60","4":"24","5":"1"},{"1":"1505.4","2":"1","3":"60","4":"27","5":"2"},{"1":"1505.4","2":"1","3":"60","4":"30","5":"3"},{"1":"1505.4","2":"1","3":"71","4":"24","5":"4"},{"1":"1505.4","2":"1","3":"71","4":"27","5":"5"},{"1":"1505.4","2":"1","3":"71","4":"30","5":"6"},{"1":"1505.4","2":"1","3":"80","4":"24","5":"7"},{"1":"1505.4","2":"1","3":"80","4":"27","5":"8"},{"1":"1505.4","2":"1","3":"80","4":"30","5":"9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Extra: I set it up this way so that you would find the median and quartiles and then type the values into the <code>datagrid</code> (easier conceptually), but there is nothing stopping us doing it all in one step:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datagrid</span>(<span class="at">model =</span> whas100<span class="fl">.2</span>, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">age =</span> <span class="fu">quantile</span>(whas100<span class="sc">$</span>age, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>)),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> <span class="fu">quantile</span>(whas100<span class="sc">$</span>bmi, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), \(x) <span class="fu">round</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["lenfol"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fstat"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["bmi"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rowid"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1505","2":"1","3":"60","4":"24","5":"1"},{"1":"1505","2":"1","3":"60","4":"27","5":"2"},{"1":"1505","2":"1","3":"60","4":"30","5":"3"},{"1":"1505","2":"1","3":"71","4":"24","5":"4"},{"1":"1505","2":"1","3":"71","4":"27","5":"5"},{"1":"1505","2":"1","3":"71","4":"30","5":"6"},{"1":"1505","2":"1","3":"80","4":"24","5":"7"},{"1":"1505","2":"1","3":"80","4":"27","5":"8"},{"1":"1505","2":"1","3":"80","4":"30","5":"9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The last line rounds everything off to the (default) 0 decimal places. The repetitiousness of the preceding two lines makes me wonder whether I should have written a function.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol type="i">
<li>Obtain predicted survival probabilities for each of the values in your new data frame. Use your best model. (You don’t need to look at the results, though you can if you want to.)</li>
</ol>
<p>Solution</p>
<p>This is an edited version of an old problem where the above was all you needed to do, but to use <code>predictions</code> from <code>marginaleffects</code>, you need to add a column of times as well. In this problem, the times are in <code>lenfol</code>, so we’ll use the median and quartiles of those as well, rounded off. It doesn’t really matter what times you use, as long as they show the passage of survival probabilities over time in some reasonable way:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(whas100<span class="sc">$</span>lenfol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    0%    25%    50%    75%   100% 
   6.0  715.0 1877.5 2076.5 2719.0 </code></pre>
</div>
</div>
<p>so say, 700, 1900, and 2100:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>whas100.new <span class="ot">&lt;-</span> <span class="fu">datagrid</span>(<span class="at">model =</span> whas100<span class="fl">.2</span>, <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">71</span>, <span class="dv">80</span>), </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">bmi =</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">27</span>, <span class="dv">30</span>), <span class="at">lenfol =</span> <span class="fu">c</span>(<span class="dv">700</span>, <span class="dv">1900</span>, <span class="dv">2100</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>whas100.new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["fstat"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["bmi"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["lenfol"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rowid"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"60","3":"24","4":"700","5":"1"},{"1":"1","2":"60","3":"24","4":"1900","5":"2"},{"1":"1","2":"60","3":"24","4":"2100","5":"3"},{"1":"1","2":"60","3":"27","4":"700","5":"4"},{"1":"1","2":"60","3":"27","4":"1900","5":"5"},{"1":"1","2":"60","3":"27","4":"2100","5":"6"},{"1":"1","2":"60","3":"30","4":"700","5":"7"},{"1":"1","2":"60","3":"30","4":"1900","5":"8"},{"1":"1","2":"60","3":"30","4":"2100","5":"9"},{"1":"1","2":"71","3":"24","4":"700","5":"10"},{"1":"1","2":"71","3":"24","4":"1900","5":"11"},{"1":"1","2":"71","3":"24","4":"2100","5":"12"},{"1":"1","2":"71","3":"27","4":"700","5":"13"},{"1":"1","2":"71","3":"27","4":"1900","5":"14"},{"1":"1","2":"71","3":"27","4":"2100","5":"15"},{"1":"1","2":"71","3":"30","4":"700","5":"16"},{"1":"1","2":"71","3":"30","4":"1900","5":"17"},{"1":"1","2":"71","3":"30","4":"2100","5":"18"},{"1":"1","2":"80","3":"24","4":"700","5":"19"},{"1":"1","2":"80","3":"24","4":"1900","5":"20"},{"1":"1","2":"80","3":"24","4":"2100","5":"21"},{"1":"1","2":"80","3":"27","4":"700","5":"22"},{"1":"1","2":"80","3":"27","4":"1900","5":"23"},{"1":"1","2":"80","3":"27","4":"2100","5":"24"},{"1":"1","2":"80","3":"30","4":"700","5":"25"},{"1":"1","2":"80","3":"30","4":"1900","5":"26"},{"1":"1","2":"80","3":"30","4":"2100","5":"27"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>and then</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">predictions</span>(whas100<span class="fl">.2</span>, <span class="at">newdata =</span> whas100.new, <span class="at">type =</span> <span class="st">"survival"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, bmi, lenfol, estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["bmi"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["lenfol"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"60","2":"24","3":"700","4":"0.8043183"},{"1":"60","2":"24","3":"1900","4":"0.6328498"},{"1":"60","2":"24","3":"2100","4":"0.5691106"},{"1":"60","2":"27","3":"700","4":"0.8387015"},{"1":"60","2":"27","3":"1900","4":"0.6910292"},{"1":"60","2":"27","3":"2100","4":"0.6342419"},{"1":"60","2":"30","3":"700","4":"0.8675455"},{"1":"60","2":"30","3":"1900","4":"0.7419075"},{"1":"60","2":"30","3":"2100","4":"0.6922567"},{"1":"71","2":"24","3":"700","4":"0.7150404"},{"1":"71","2":"24","3":"1900","4":"0.4942462"},{"1":"71","2":"24","3":"2100","4":"0.4196907"},{"1":"71","2":"27","3":"700","4":"0.7626626"},{"1":"71","2":"27","3":"1900","4":"0.5659476"},{"1":"71","2":"27","3":"2100","4":"0.4959217"},{"1":"71","2":"30","3":"700","4":"0.8034364"},{"1":"71","2":"30","3":"1900","4":"0.6313929"},{"1":"71","2":"30","3":"2100","4":"0.5674969"},{"1":"80","2":"24","3":"700","4":"0.6202600"},{"1":"80","2":"24","3":"1900","4":"0.3665979"},{"1":"80","2":"24","3":"2100","4":"0.2904487"},{"1":"80","2":"27","3":"700","4":"0.6799031"},{"1":"80","2":"27","3":"1900","4":"0.4445956"},{"1":"80","2":"27","3":"2100","4":"0.3683689"},{"1":"80","2":"30","3":"700","4":"0.7322435"},{"1":"80","2":"30","3":"1900","4":"0.5195608"},{"1":"80","2":"30","3":"2100","4":"0.4463297"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This is getting unwieldy to look at, but the hint here is that the effect of increasing <code>bmi</code> is to <em>increase</em> the probability of survival (comparing the same age and the same <code>lenfol</code>, as in the first, fourth, and seventh rows).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="10" type="a">
<li>Make a graph depicting the survival curves from <code>survfit</code> with different colours distinguishing the different survival curves.</li>
</ol>
<p>Solution</p>
<p>Let’s do it all in one go this time:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(whas100<span class="fl">.2</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"lenfol"</span>, <span class="st">"age"</span>, <span class="st">"bmi"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This puts time on the <span class="math inline">\(x\)</span>-axis, age as colours (it selects some values for you), and <code>bmi</code> as facets. Both <code>age</code> and <code>bmi</code> are quantitative, so there is no reason why they should be this way around rather than <code>bmi</code> first and <code>age</code> second, which would be equally good.</p>
<p>If you will find this a bit much to interpret, do two graphs, one for age and one for BMI:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(whas100<span class="fl">.2</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"lenfol"</span>, <span class="st">"age"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(whas100<span class="fl">.2</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"lenfol"</span>, <span class="st">"bmi"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="11" type="a">
<li>What is the effect of age on survival? What is the effect of BMI on survival? Explain briefly. (You will have to disentangle the meaning of the different coloured lines on the plot to do this.)</li>
</ol>
<p>Solution</p>
<p>Bear in mind that up-and-to-the-right is best for a survival curve, since that means that people in the upper-right group have a higher chance of surviving for longer.</p>
<p>The best survival curve of all is the red one in the last facet. This goes with the youngest age (32), but the <em>highest</em> BMI, and therefore it is better to be younger in terms of survival (no surprise) but to have a <em>higher</em> BMI, which you might find surprising given the relationship between high BMI and obesity.</p>
<p>If you prefer to interpret the separate plots for age and BMI, which are respectively for an average BMI, presumably about 27 and an average age, presumably about 70: a younger age is better in terms of survival (the red curve), and a higher BMI is better for survival (the pink curve).</p>
<p>Extra: That’s the end of what I wanted you to do, but:</p>
<p>A higher BMI is usually associated with being obese (and therefore unhealthy), so you’d expect the effect of BMI to be the other way around. According to Wikipedia (<a href="http://en.wikipedia.org/wiki/Body_mass_index">link</a>), the BMI values here are “overweight” or close to it. Maybe being heavier helps the body recover from a heart attack.</p>
<p>Let’s start with the martingale residual plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>whas100<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">augment</span>(whas100) <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/worcester-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There is a suspicion of bendiness here, though the left side of the curve is entirely because of that one positive residual on the left. In any case, this suggests that nonlinearity (evidently in terms of BMI, since that’s the relationship that currently makes no sense) would be worth exploring.</p>
<p>Thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>whas100<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(whas100<span class="fl">.2</span>, . <span class="sc">~</span> . <span class="sc">+</span> <span class="fu">I</span>(bmi<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(whas100<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(lenfol, fstat == 1) ~ age + bmi + I(bmi^2), 
    data = whas100)

  n= 100, number of events= 51 

              coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
age       0.040542  1.041375  0.012035  3.369 0.000755 ***
bmi      -0.848949  0.427864  0.231562 -3.666 0.000246 ***
I(bmi^2)  0.014500  1.014606  0.004227  3.430 0.000603 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

         exp(coef) exp(-coef) lower .95 upper .95
age         1.0414     0.9603    1.0171    1.0662
bmi         0.4279     2.3372    0.2718    0.6736
I(bmi^2)    1.0146     0.9856    1.0062    1.0230

Concordance= 0.693  (se = 0.04 )
Likelihood ratio test= 30.71  on 3 df,   p=1e-06
Wald test            = 32.56  on 3 df,   p=4e-07
Score (logrank) test = 36.57  on 3 df,   p=6e-08</code></pre>
</div>
</div>
<p>Ah, that seems to be it. The significant positive coefficient on <code>bmi</code>-squared means that the “hazard of dying” increases faster with increasing <code>bmi</code>, so there ought to be an optimal BMI beyond which survival chances decrease again. Have we improved the residuals by adding the squared term?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>whas100<span class="fl">.3</span> <span class="sc">%&gt;%</span> <span class="fu">augment</span>(whas100) <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/worcester-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I call those “inconsequential wiggles” now, so I think we are good. Let’s explore the quadratic relationship on a graph. What matters now is how survival depends on BMI, so we can use an average age such as the one that <code>plot_predictions</code> will give us, and hence:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(whas100<span class="fl">.3</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"lenfol"</span>, <span class="st">"bmi"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This time, the blue and green survival curves are best, which go with BMI of about 30 and 27, values that are in the middle of the range. Both the low BMIs (red and yellow curves) and the highest one (pink, about 40) are associated with worse survival. But it’s still true that having a very <em>low</em> BMI is worst, which is why our (linear) model said that having a higher BMI was better.</p>
<p>It would have been better to have you put a squared term in the model, but the question was already long and complicated enough, and I didn’t want to make your lives more of a nightmare than they are already becoming!</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="drug-treatment-programs-1" class="level2" data-number="30.6">
<h2 data-number="30.6" class="anchored" data-anchor-id="drug-treatment-programs-1"><span class="header-section-number">30.6</span> Drug treatment programs</h2>
<p>One of the goals of drug treatment programs is to lengthen the time until the patient returns to using drugs. (It is not generally possible to prevent patients from <em>ever</em> using drugs again.) In one study, over 600 former drug users took part. Two different programs, a short program and a long program, were offered at two different sites, labelled A and B. The data can be found in <a href="http://ritsokiguess.site/datafiles/drugusers.txt">link</a>. The variables are these:</p>
<ul>
<li><p><code>ID</code>: patient ID number</p></li>
<li><p><code>age</code>: patient age at enrollment into the study</p></li>
<li><p><code>ndrugtx</code>: number of previous drug treatments</p></li>
<li><p><code>treat</code>: 0 for short treatment program, 1 for long program</p></li>
<li><p><code>site</code>: 0 for site A, 1 for site B</p></li>
<li><p><code>time</code>: time until return to drug use</p></li>
<li><p><code>censor</code>: whether the subject returned to drug use (1) or not (0) during the follow-up period</p></li>
<li><p><code>herco</code>: whether subject used heroine or cocaine in the last 3 months: 1 is both, 2 is one (either heroine or cocaine), 3 is neither.</p></li>
</ul>
<ol type="a">
<li>Read in the data and check in one way or another that you have what was promised above.</li>
</ol>
<p>Solution</p>
<p>This:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/drugusers.txt"</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>drugusers <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Parsed with column specification:
cols(
  row = col_double(),
  ID = col_double(),
  age = col_double(),
  ndrugtx = col_double(),
  treat = col_double(),
  site = col_double(),
  time = col_double(),
  censor = col_double(),
  herco = col_double()
)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>drugusers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["row"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["ID"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["ndrugtx"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["treat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["site"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["time"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["censor"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["herco"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1","3":"39","4":"1","5":"1","6":"0","7":"188","8":"1","9":"3"},{"1":"2","2":"2","3":"33","4":"8","5":"1","6":"0","7":"26","8":"1","9":"3"},{"1":"3","2":"3","3":"33","4":"3","5":"1","6":"0","7":"207","8":"1","9":"2"},{"1":"4","2":"4","3":"32","4":"1","5":"0","6":"0","7":"144","8":"1","9":"3"},{"1":"5","2":"5","3":"24","4":"5","5":"1","6":"0","7":"551","8":"0","9":"2"},{"1":"6","2":"6","3":"30","4":"1","5":"1","6":"0","7":"32","8":"1","9":"1"},{"1":"7","2":"7","3":"39","4":"34","5":"1","6":"0","7":"459","8":"1","9":"3"},{"1":"8","2":"8","3":"27","4":"2","5":"1","6":"0","7":"22","8":"1","9":"3"},{"1":"9","2":"9","3":"40","4":"3","5":"1","6":"0","7":"210","8":"1","9":"2"},{"1":"10","2":"10","3":"36","4":"7","5":"1","6":"0","7":"184","8":"1","9":"2"},{"1":"11","2":"11","3":"35","4":"12","5":"1","6":"0","7":"5","8":"1","9":"3"},{"1":"12","2":"12","3":"38","4":"8","5":"1","6":"0","7":"212","8":"1","9":"2"},{"1":"13","2":"13","3":"29","4":"1","5":"1","6":"0","7":"87","8":"1","9":"1"},{"1":"14","2":"14","3":"32","4":"2","5":"1","6":"0","7":"598","8":"0","9":"1"},{"1":"15","2":"15","3":"41","4":"8","5":"1","6":"0","7":"260","8":"1","9":"1"},{"1":"16","2":"16","3":"31","4":"1","5":"1","6":"0","7":"210","8":"1","9":"1"},{"1":"17","2":"17","3":"27","4":"3","5":"1","6":"0","7":"84","8":"1","9":"2"},{"1":"18","2":"18","3":"28","4":"6","5":"1","6":"0","7":"196","8":"1","9":"1"},{"1":"19","2":"19","3":"28","4":"1","5":"1","6":"0","7":"19","8":"1","9":"3"},{"1":"20","2":"20","3":"36","4":"15","5":"1","6":"0","7":"441","8":"1","9":"1"},{"1":"21","2":"21","3":"32","4":"5","5":"1","6":"0","7":"449","8":"1","9":"2"},{"1":"22","2":"22","3":"33","4":"1","5":"0","6":"0","7":"659","8":"0","9":"1"},{"1":"23","2":"23","3":"28","4":"8","5":"0","6":"0","7":"21","8":"1","9":"1"},{"1":"24","2":"24","3":"29","4":"0","5":"0","6":"0","7":"53","8":"1","9":"3"},{"1":"25","2":"25","3":"35","4":"9","5":"0","6":"0","7":"225","8":"1","9":"2"},{"1":"26","2":"26","3":"45","4":"6","5":"0","6":"0","7":"161","8":"1","9":"1"},{"1":"27","2":"27","3":"35","4":"5","5":"0","6":"0","7":"87","8":"1","9":"3"},{"1":"28","2":"28","3":"24","4":"3","5":"0","6":"0","7":"89","8":"1","9":"1"},{"1":"29","2":"29","3":"36","4":"7","5":"0","6":"0","7":"44","8":"1","9":"1"},{"1":"30","2":"30","3":"27","4":"30","5":"0","6":"0","7":"37","8":"1","9":"1"},{"1":"31","2":"31","3":"39","4":"9","5":"0","6":"0","7":"523","8":"0","9":"1"},{"1":"32","2":"32","3":"36","4":"10","5":"0","6":"0","7":"226","8":"1","9":"3"},{"1":"33","2":"33","3":"37","4":"1","5":"0","6":"0","7":"259","8":"1","9":"3"},{"1":"34","2":"34","3":"30","4":"1","5":"0","6":"0","7":"289","8":"1","9":"2"},{"1":"35","2":"35","3":"44","4":"5","5":"0","6":"0","7":"103","8":"1","9":"1"},{"1":"36","2":"36","3":"28","4":"6","5":"0","6":"0","7":"624","8":"0","9":"1"},{"1":"37","2":"37","3":"25","4":"3","5":"0","6":"0","7":"68","8":"1","9":"1"},{"1":"38","2":"38","3":"30","4":"7","5":"1","6":"0","7":"57","8":"1","9":"2"},{"1":"39","2":"39","3":"24","4":"1","5":"0","6":"0","7":"65","8":"1","9":"3"},{"1":"40","2":"40","3":"27","4":"1","5":"0","6":"0","7":"79","8":"1","9":"1"},{"1":"41","2":"41","3":"30","4":"2","5":"0","6":"0","7":"559","8":"0","9":"1"},{"1":"42","2":"42","3":"34","4":"0","5":"1","6":"0","7":"79","8":"1","9":"2"},{"1":"43","2":"43","3":"33","4":"2","5":"1","6":"0","7":"87","8":"1","9":"3"},{"1":"44","2":"44","3":"34","4":"6","5":"1","6":"0","7":"91","8":"1","9":"1"},{"1":"45","2":"45","3":"36","4":"1","5":"1","6":"0","7":"297","8":"1","9":"2"},{"1":"46","2":"46","3":"27","4":"0","5":"1","6":"0","7":"45","8":"1","9":"1"},{"1":"47","2":"47","3":"35","4":"1","5":"1","6":"0","7":"246","8":"1","9":"3"},{"1":"48","2":"48","3":"24","4":"0","5":"1","6":"0","7":"37","8":"1","9":"1"},{"1":"49","2":"49","3":"28","4":"2","5":"1","6":"0","7":"37","8":"1","9":"3"},{"1":"50","2":"50","3":"46","4":"8","5":"1","6":"0","7":"538","8":"0","9":"1"},{"1":"51","2":"51","3":"26","4":"1","5":"1","6":"0","7":"541","8":"0","9":"1"},{"1":"52","2":"52","3":"42","4":"25","5":"1","6":"0","7":"184","8":"1","9":"1"},{"1":"53","2":"53","3":"30","4":"0","5":"1","6":"0","7":"122","8":"1","9":"1"},{"1":"54","2":"54","3":"33","4":"2","5":"1","6":"0","7":"5","8":"1","9":"3"},{"1":"55","2":"55","3":"30","4":"3","5":"1","6":"0","7":"156","8":"1","9":"3"},{"1":"56","2":"56","3":"27","4":"2","5":"0","6":"0","7":"121","8":"1","9":"2"},{"1":"57","2":"57","3":"38","4":"6","5":"0","6":"0","7":"231","8":"1","9":"1"},{"1":"58","2":"58","3":"48","4":"10","5":"0","6":"0","7":"111","8":"1","9":"3"},{"1":"59","2":"59","3":"36","4":"10","5":"0","6":"0","7":"38","8":"1","9":"1"},{"1":"60","2":"60","3":"28","4":"7","5":"0","6":"0","7":"15","8":"1","9":"1"},{"1":"61","2":"61","3":"31","4":"5","5":"0","6":"0","7":"54","8":"1","9":"3"},{"1":"62","2":"62","3":"28","4":"5","5":"0","6":"0","7":"127","8":"1","9":"2"},{"1":"63","2":"63","3":"28","4":"1","5":"0","6":"0","7":"105","8":"1","9":"1"},{"1":"64","2":"64","3":"26","4":"2","5":"0","6":"0","7":"11","8":"1","9":"2"},{"1":"65","2":"65","3":"34","4":"6","5":"0","6":"0","7":"153","8":"1","9":"3"},{"1":"66","2":"66","3":"26","4":"5","5":"0","6":"0","7":"11","8":"1","9":"2"},{"1":"67","2":"67","3":"32","4":"6","5":"0","6":"0","7":"79","8":"1","9":"3"},{"1":"68","2":"68","3":"31","4":"5","5":"0","6":"0","7":"46","8":"1","9":"1"},{"1":"69","2":"69","3":"41","4":"0","5":"0","6":"0","7":"655","8":"0","9":"1"},{"1":"70","2":"70","3":"30","4":"0","5":"0","6":"0","7":"166","8":"1","9":"3"},{"1":"71","2":"71","3":"35","4":"1","5":"0","6":"0","7":"6","8":"1","9":"3"},{"1":"72","2":"72","3":"39","4":"5","5":"0","6":"0","7":"95","8":"1","9":"3"},{"1":"73","2":"73","3":"43","4":"12","5":"0","6":"0","7":"83","8":"1","9":"2"},{"1":"74","2":"74","3":"33","4":"12","5":"0","6":"0","7":"151","8":"1","9":"2"},{"1":"75","2":"75","3":"33","4":"6","5":"0","6":"0","7":"220","8":"1","9":"3"},{"1":"76","2":"76","3":"29","4":"0","5":"0","6":"0","7":"227","8":"1","9":"3"},{"1":"77","2":"77","3":"36","4":"5","5":"0","6":"0","7":"343","8":"1","9":"1"},{"1":"78","2":"78","3":"26","4":"3","5":"0","6":"0","7":"119","8":"1","9":"3"},{"1":"79","2":"79","3":"37","4":"13","5":"0","6":"0","7":"43","8":"1","9":"1"},{"1":"80","2":"80","3":"42","4":"8","5":"0","6":"0","7":"545","8":"0","9":"1"},{"1":"81","2":"81","3":"29","4":"8","5":"0","6":"0","7":"47","8":"1","9":"1"},{"1":"82","2":"82","3":"34","4":"3","5":"0","6":"0","7":"15","8":"1","9":"1"},{"1":"83","2":"83","3":"30","4":"0","5":"0","6":"0","7":"805","8":"0","9":"1"},{"1":"84","2":"84","3":"35","4":"2","5":"0","6":"0","7":"321","8":"1","9":"1"},{"1":"85","2":"85","3":"33","4":"1","5":"0","6":"0","7":"167","8":"1","9":"1"},{"1":"86","2":"86","3":"30","4":"4","5":"0","6":"0","7":"107","8":"1","9":"1"},{"1":"87","2":"87","3":"36","4":"1","5":"0","6":"0","7":"491","8":"1","9":"2"},{"1":"88","2":"88","3":"28","4":"2","5":"0","6":"0","7":"35","8":"1","9":"1"},{"1":"89","2":"89","3":"31","4":"12","5":"0","6":"0","7":"123","8":"1","9":"1"},{"1":"90","2":"90","3":"23","4":"2","5":"0","6":"0","7":"597","8":"0","9":"1"},{"1":"91","2":"91","3":"33","4":"1","5":"0","6":"0","7":"762","8":"0","9":"1"},{"1":"92","2":"92","3":"26","4":"5","5":"0","6":"0","7":"13","8":"1","9":"1"},{"1":"93","2":"93","3":"37","4":"4","5":"0","6":"0","7":"31","8":"1","9":"2"},{"1":"94","2":"94","3":"25","4":"1","5":"1","6":"0","7":"228","8":"1","9":"1"},{"1":"95","2":"95","3":"56","4":"9","5":"1","6":"0","7":"553","8":"0","9":"2"},{"1":"96","2":"96","3":"23","4":"1","5":"1","6":"0","7":"190","8":"1","9":"1"},{"1":"97","2":"97","3":"26","4":"1","5":"1","6":"0","7":"307","8":"1","9":"1"},{"1":"98","2":"98","3":"26","4":"1","5":"1","6":"0","7":"73","8":"1","9":"1"},{"1":"99","2":"99","3":"23","4":"1","5":"1","6":"0","7":"208","8":"1","9":"1"},{"1":"100","2":"100","3":"28","4":"2","5":"1","6":"0","7":"267","8":"1","9":"3"},{"1":"101","2":"101","3":"33","4":"6","5":"1","6":"0","7":"2","8":"1","9":"3"},{"1":"102","2":"102","3":"30","4":"15","5":"1","6":"0","7":"169","8":"1","9":"1"},{"1":"103","2":"103","3":"32","4":"2","5":"1","6":"0","7":"125","8":"1","9":"3"},{"1":"104","2":"104","3":"25","4":"5","5":"1","6":"0","7":"655","8":"0","9":"2"},{"1":"105","2":"105","3":"33","4":"5","5":"1","6":"0","7":"70","8":"1","9":"1"},{"1":"106","2":"106","3":"22","4":"3","5":"1","6":"0","7":"398","8":"1","9":"1"},{"1":"107","2":"107","3":"28","4":"1","5":"1","6":"0","7":"59","8":"1","9":"2"},{"1":"108","2":"108","3":"25","4":"8","5":"1","6":"0","7":"122","8":"1","9":"3"},{"1":"109","2":"109","3":"30","4":"1","5":"1","6":"0","7":"29","8":"1","9":"3"},{"1":"110","2":"110","3":"NA","4":"2","5":"1","6":"0","7":"8","8":"1","9":"1"},{"1":"111","2":"111","3":"38","4":"1","5":"0","6":"0","7":"96","8":"1","9":"1"},{"1":"112","2":"112","3":"35","4":"3","5":"1","6":"0","7":"1172","8":"0","9":"2"},{"1":"113","2":"113","3":"35","4":"1","5":"0","6":"0","7":"734","8":"0","9":"1"},{"1":"114","2":"114","3":"25","4":"1","5":"0","6":"0","7":"26","8":"1","9":"1"},{"1":"115","2":"115","3":"33","4":"3","5":"0","6":"0","7":"84","8":"1","9":"1"},{"1":"116","2":"116","3":"30","4":"2","5":"0","6":"0","7":"171","8":"1","9":"1"},{"1":"117","2":"117","3":"45","4":"1","5":"0","6":"0","7":"159","8":"1","9":"2"},{"1":"118","2":"118","3":"29","4":"3","5":"0","6":"0","7":"5","8":"1","9":"3"},{"1":"119","2":"119","3":"42","4":"20","5":"0","6":"0","7":"7","8":"1","9":"2"},{"1":"120","2":"120","3":"29","4":"1","5":"0","6":"0","7":"763","8":"0","9":"3"},{"1":"121","2":"121","3":"24","4":"0","5":"0","6":"0","7":"104","8":"1","9":"1"},{"1":"122","2":"122","3":"33","4":"4","5":"0","6":"0","7":"162","8":"1","9":"2"},{"1":"123","2":"123","3":"32","4":"0","5":"0","6":"0","7":"90","8":"1","9":"1"},{"1":"124","2":"124","3":"26","4":"0","5":"0","6":"0","7":"373","8":"1","9":"1"},{"1":"125","2":"125","3":"28","4":"3","5":"0","6":"0","7":"115","8":"1","9":"1"},{"1":"126","2":"126","3":"36","4":"3","5":"0","6":"0","7":"67","8":"1","9":"3"},{"1":"127","2":"127","3":"37","4":"1","5":"0","6":"0","7":"30","8":"1","9":"2"},{"1":"128","2":"128","3":"23","4":"6","5":"0","6":"0","7":"8","8":"1","9":"3"},{"1":"129","2":"129","3":"40","4":"3","5":"0","6":"0","7":"168","8":"1","9":"2"},{"1":"130","2":"130","3":"36","4":"0","5":"0","6":"0","7":"70","8":"1","9":"1"},{"1":"131","2":"131","3":"23","4":"2","5":"0","6":"0","7":"130","8":"1","9":"1"},{"1":"132","2":"132","3":"35","4":"1","5":"0","6":"0","7":"285","8":"1","9":"3"},{"1":"133","2":"133","3":"25","4":"1","5":"1","6":"0","7":"569","8":"0","9":"2"},{"1":"134","2":"134","3":"35","4":"6","5":"1","6":"0","7":"87","8":"1","9":"2"},{"1":"135","2":"135","3":"46","4":"0","5":"1","6":"0","7":"310","8":"1","9":"3"},{"1":"136","2":"136","3":"32","4":"3","5":"1","6":"0","7":"87","8":"1","9":"3"},{"1":"137","2":"137","3":"35","4":"16","5":"1","6":"0","7":"544","8":"0","9":"1"},{"1":"138","2":"138","3":"34","4":"1","5":"1","6":"0","7":"156","8":"1","9":"1"},{"1":"139","2":"139","3":"43","4":"3","5":"1","6":"0","7":"658","8":"0","9":"1"},{"1":"140","2":"140","3":"39","4":"15","5":"1","6":"0","7":"273","8":"1","9":"3"},{"1":"141","2":"141","3":"27","4":"2","5":"1","6":"0","7":"168","8":"1","9":"3"},{"1":"142","2":"142","3":"38","4":"1","5":"1","6":"0","7":"83","8":"1","9":"1"},{"1":"143","2":"143","3":"37","4":"7","5":"1","6":"0","7":"4","8":"1","9":"2"},{"1":"144","2":"144","3":"44","4":"4","5":"1","6":"0","7":"708","8":"0","9":"1"},{"1":"145","2":"145","3":"25","4":"1","5":"1","6":"0","7":"137","8":"1","9":"3"},{"1":"146","2":"146","3":"34","4":"1","5":"1","6":"0","7":"259","8":"1","9":"1"},{"1":"147","2":"147","3":"34","4":"2","5":"1","6":"0","7":"560","8":"0","9":"1"},{"1":"148","2":"148","3":"38","4":"1","5":"1","6":"0","7":"586","8":"0","9":"1"},{"1":"149","2":"149","3":"24","4":"2","5":"1","6":"0","7":"190","8":"1","9":"2"},{"1":"150","2":"150","3":"31","4":"NA","5":"1","6":"0","7":"720","8":"0","9":"1"},{"1":"151","2":"151","3":"42","4":"3","5":"1","6":"0","7":"544","8":"0","9":"2"},{"1":"152","2":"152","3":"22","4":"3","5":"1","6":"0","7":"3","8":"1","9":"3"},{"1":"153","2":"153","3":"34","4":"1","5":"0","6":"0","7":"494","8":"1","9":"3"},{"1":"154","2":"154","3":"45","4":"8","5":"0","6":"0","7":"541","8":"0","9":"1"},{"1":"155","2":"155","3":"40","4":"4","5":"0","6":"0","7":"94","8":"1","9":"2"},{"1":"156","2":"156","3":"27","4":"3","5":"0","6":"0","7":"567","8":"0","9":"3"},{"1":"157","2":"157","3":"24","4":"3","5":"0","6":"0","7":"55","8":"1","9":"3"},{"1":"158","2":"158","3":"27","4":"3","5":"0","6":"0","7":"93","8":"1","9":"1"},{"1":"159","2":"159","3":"34","4":"4","5":"0","6":"0","7":"276","8":"1","9":"1"},{"1":"160","2":"160","3":"36","4":"6","5":"0","6":"0","7":"46","8":"1","9":"2"},{"1":"161","2":"161","3":"37","4":"6","5":"0","6":"0","7":"4","8":"1","9":"3"},{"1":"162","2":"162","3":"31","4":"1","5":"0","6":"0","7":"250","8":"1","9":"1"},{"1":"163","2":"163","3":"40","4":"2","5":"0","6":"0","7":"106","8":"1","9":"2"},{"1":"164","2":"164","3":"40","4":"4","5":"0","6":"0","7":"552","8":"0","9":"1"},{"1":"165","2":"165","3":"37","4":"5","5":"0","6":"0","7":"90","8":"1","9":"2"},{"1":"166","2":"166","3":"25","4":"6","5":"0","6":"0","7":"203","8":"1","9":"3"},{"1":"167","2":"167","3":"41","4":"3","5":"1","6":"0","7":"67","8":"1","9":"2"},{"1":"168","2":"168","3":"22","4":"1","5":"1","6":"0","7":"559","8":"1","9":"3"},{"1":"169","2":"169","3":"31","4":"8","5":"1","6":"0","7":"106","8":"1","9":"2"},{"1":"170","2":"170","3":"29","4":"1","5":"1","6":"0","7":"374","8":"1","9":"1"},{"1":"171","2":"171","3":"27","4":"2","5":"1","6":"0","7":"630","8":"0","9":"1"},{"1":"172","2":"172","3":"22","4":"3","5":"1","6":"0","7":"61","8":"1","9":"3"},{"1":"173","2":"173","3":"42","4":"6","5":"1","6":"0","7":"560","8":"0","9":"3"},{"1":"174","2":"174","3":"37","4":"5","5":"1","6":"0","7":"547","8":"0","9":"1"},{"1":"175","2":"175","3":"36","4":"2","5":"1","6":"0","7":"568","8":"0","9":"1"},{"1":"176","2":"176","3":"24","4":"1","5":"1","6":"0","7":"490","8":"1","9":"1"},{"1":"177","2":"177","3":"28","4":"0","5":"1","6":"0","7":"222","8":"1","9":"3"},{"1":"178","2":"178","3":"24","4":"1","5":"1","6":"0","7":"56","8":"1","9":"3"},{"1":"179","2":"179","3":"28","4":"2","5":"1","6":"0","7":"282","8":"1","9":"1"},{"1":"180","2":"180","3":"24","4":"20","5":"1","6":"0","7":"35","8":"1","9":"1"},{"1":"181","2":"181","3":"24","4":"0","5":"1","6":"0","7":"603","8":"0","9":"3"},{"1":"182","2":"182","3":"27","4":"NA","5":"1","6":"0","7":"194","8":"1","9":"1"},{"1":"183","2":"183","3":"29","4":"1","5":"1","6":"0","7":"148","8":"1","9":"1"},{"1":"184","2":"184","3":"37","4":"5","5":"1","6":"0","7":"354","8":"1","9":"1"},{"1":"185","2":"185","3":"26","4":"2","5":"1","6":"0","7":"164","8":"1","9":"1"},{"1":"186","2":"186","3":"29","4":"1","5":"1","6":"0","7":"94","8":"1","9":"1"},{"1":"187","2":"187","3":"29","4":"4","5":"1","6":"0","7":"65","8":"1","9":"2"},{"1":"188","2":"188","3":"33","4":"1","5":"1","6":"0","7":"567","8":"0","9":"3"},{"1":"189","2":"189","3":"29","4":"2","5":"1","6":"0","7":"634","8":"0","9":"3"},{"1":"190","2":"190","3":"32","4":"2","5":"1","6":"0","7":"633","8":"0","9":"1"},{"1":"191","2":"191","3":"32","4":"4","5":"1","6":"0","7":"127","8":"1","9":"1"},{"1":"192","2":"192","3":"33","4":"8","5":"1","6":"0","7":"477","8":"1","9":"3"},{"1":"193","2":"193","3":"26","4":"2","5":"1","6":"0","7":"436","8":"1","9":"3"},{"1":"194","2":"194","3":"31","4":"NA","5":"1","6":"0","7":"226","8":"1","9":"3"},{"1":"195","2":"195","3":"24","4":"4","5":"1","6":"0","7":"362","8":"1","9":"2"},{"1":"196","2":"196","3":"46","4":"2","5":"1","6":"0","7":"552","8":"0","9":"2"},{"1":"197","2":"197","3":"23","4":"2","5":"1","6":"0","7":"144","8":"1","9":"3"},{"1":"198","2":"198","3":"40","4":"8","5":"1","6":"0","7":"242","8":"1","9":"3"},{"1":"199","2":"199","3":"48","4":"4","5":"1","6":"0","7":"564","8":"0","9":"1"},{"1":"200","2":"200","3":"33","4":"0","5":"1","6":"0","7":"299","8":"1","9":"1"},{"1":"201","2":"201","3":"21","4":"7","5":"1","6":"0","7":"167","8":"1","9":"3"},{"1":"202","2":"202","3":"38","4":"2","5":"1","6":"0","7":"380","8":"1","9":"1"},{"1":"203","2":"203","3":"28","4":"4","5":"1","6":"0","7":"120","8":"1","9":"3"},{"1":"204","2":"204","3":"30","4":"6","5":"0","6":"0","7":"248","8":"1","9":"2"},{"1":"205","2":"205","3":"39","4":"6","5":"1","6":"0","7":"218","8":"1","9":"1"},{"1":"206","2":"206","3":"37","4":"1","5":"0","6":"0","7":"115","8":"1","9":"1"},{"1":"207","2":"207","3":"32","4":"4","5":"0","6":"0","7":"224","8":"1","9":"1"},{"1":"208","2":"208","3":"39","4":"2","5":"0","6":"0","7":"132","8":"1","9":"1"},{"1":"209","2":"209","3":"28","4":"10","5":"0","6":"0","7":"148","8":"1","9":"1"},{"1":"210","2":"210","3":"26","4":"0","5":"0","6":"0","7":"593","8":"0","9":"1"},{"1":"211","2":"211","3":"31","4":"0","5":"0","6":"0","7":"26","8":"1","9":"1"},{"1":"212","2":"212","3":"40","4":"NA","5":"0","6":"0","7":"113","8":"1","9":"2"},{"1":"213","2":"213","3":"34","4":"8","5":"0","6":"0","7":"32","8":"1","9":"3"},{"1":"214","2":"214","3":"26","4":"2","5":"0","6":"0","7":"292","8":"1","9":"3"},{"1":"215","2":"215","3":"29","4":"3","5":"0","6":"0","7":"89","8":"1","9":"3"},{"1":"216","2":"216","3":"33","4":"7","5":"0","6":"0","7":"21","8":"1","9":"2"},{"1":"217","2":"217","3":"25","4":"8","5":"0","6":"0","7":"364","8":"1","9":"1"},{"1":"218","2":"218","3":"34","4":"3","5":"0","6":"0","7":"142","8":"1","9":"1"},{"1":"219","2":"219","3":"32","4":"2","5":"0","6":"0","7":"188","8":"1","9":"1"},{"1":"220","2":"220","3":"39","4":"0","5":"0","6":"0","7":"4","8":"1","9":"3"},{"1":"221","2":"221","3":"38","4":"0","5":"0","6":"0","7":"92","8":"1","9":"3"},{"1":"222","2":"222","3":"32","4":"8","5":"0","6":"0","7":"56","8":"1","9":"1"},{"1":"223","2":"223","3":"31","4":"7","5":"0","6":"0","7":"110","8":"1","9":"2"},{"1":"224","2":"224","3":"40","4":"3","5":"0","6":"0","7":"555","8":"0","9":"1"},{"1":"225","2":"225","3":"28","4":"5","5":"0","6":"0","7":"220","8":"1","9":"3"},{"1":"226","2":"226","3":"40","4":"3","5":"0","6":"0","7":"23","8":"1","9":"1"},{"1":"227","2":"227","3":"32","4":"3","5":"0","6":"0","7":"285","8":"1","9":"2"},{"1":"228","2":"228","3":"29","4":"5","5":"0","6":"0","7":"90","8":"1","9":"1"},{"1":"229","2":"229","3":"25","4":"4","5":"0","6":"0","7":"59","8":"1","9":"1"},{"1":"230","2":"230","3":"32","4":"2","5":"0","6":"0","7":"156","8":"1","9":"2"},{"1":"231","2":"231","3":"36","4":"2","5":"0","6":"0","7":"194","8":"1","9":"3"},{"1":"232","2":"232","3":"37","4":"2","5":"0","6":"0","7":"142","8":"1","9":"2"},{"1":"233","2":"233","3":"38","4":"8","5":"0","6":"0","7":"57","8":"1","9":"1"},{"1":"234","2":"234","3":"31","4":"9","5":"0","6":"0","7":"279","8":"1","9":"1"},{"1":"235","2":"235","3":"30","4":"3","5":"0","6":"0","7":"118","8":"1","9":"1"},{"1":"236","2":"236","3":"34","4":"4","5":"0","6":"0","7":"567","8":"0","9":"3"},{"1":"237","2":"237","3":"33","4":"4","5":"1","6":"0","7":"562","8":"0","9":"1"},{"1":"238","2":"238","3":"36","4":"10","5":"1","6":"0","7":"239","8":"1","9":"1"},{"1":"239","2":"239","3":"32","4":"0","5":"1","6":"0","7":"578","8":"0","9":"3"},{"1":"240","2":"240","3":"29","4":"2","5":"1","6":"0","7":"551","8":"0","9":"2"},{"1":"241","2":"241","3":"32","4":"4","5":"1","6":"0","7":"313","8":"1","9":"1"},{"1":"242","2":"242","3":"34","4":"7","5":"1","6":"0","7":"560","8":"0","9":"1"},{"1":"243","2":"243","3":"26","4":"31","5":"1","6":"0","7":"54","8":"1","9":"1"},{"1":"244","2":"244","3":"25","4":"5","5":"1","6":"0","7":"198","8":"1","9":"1"},{"1":"245","2":"245","3":"30","4":"2","5":"1","6":"0","7":"164","8":"1","9":"3"},{"1":"246","2":"246","3":"33","4":"6","5":"1","6":"0","7":"325","8":"1","9":"1"},{"1":"247","2":"247","3":"40","4":"6","5":"1","6":"0","7":"62","8":"1","9":"3"},{"1":"248","2":"248","3":"26","4":"12","5":"1","6":"0","7":"45","8":"1","9":"1"},{"1":"249","2":"249","3":"26","4":"5","5":"1","6":"0","7":"53","8":"1","9":"1"},{"1":"250","2":"250","3":"35","4":"4","5":"1","6":"0","7":"253","8":"1","9":"3"},{"1":"251","2":"251","3":"26","4":"11","5":"1","6":"0","7":"51","8":"1","9":"2"},{"1":"252","2":"252","3":"33","4":"3","5":"1","6":"0","7":"540","8":"0","9":"3"},{"1":"253","2":"253","3":"27","4":"4","5":"1","6":"0","7":"317","8":"1","9":"1"},{"1":"254","2":"254","3":"29","4":"3","5":"1","6":"0","7":"437","8":"1","9":"1"},{"1":"255","2":"255","3":"29","4":"9","5":"1","6":"0","7":"136","8":"1","9":"1"},{"1":"256","2":"256","3":"39","4":"7","5":"1","6":"0","7":"115","8":"1","9":"2"},{"1":"257","2":"257","3":"43","4":"2","5":"1","6":"0","7":"175","8":"1","9":"1"},{"1":"258","2":"258","3":"35","4":"3","5":"1","6":"0","7":"442","8":"1","9":"1"},{"1":"259","2":"259","3":"26","4":"2","5":"1","6":"0","7":"122","8":"1","9":"3"},{"1":"260","2":"260","3":"27","4":"3","5":"1","6":"0","7":"181","8":"1","9":"3"},{"1":"261","2":"261","3":"28","4":"2","5":"1","6":"0","7":"180","8":"1","9":"3"},{"1":"262","2":"262","3":"30","4":"4","5":"1","6":"0","7":"51","8":"1","9":"1"},{"1":"263","2":"263","3":"31","4":"1","5":"1","6":"0","7":"541","8":"0","9":"3"},{"1":"264","2":"264","3":"26","4":"16","5":"1","6":"0","7":"121","8":"1","9":"2"},{"1":"265","2":"265","3":"36","4":"4","5":"1","6":"0","7":"328","8":"1","9":"3"},{"1":"266","2":"266","3":"27","4":"NA","5":"1","6":"0","7":"9","8":"1","9":"3"},{"1":"267","2":"267","3":"25","4":"3","5":"1","6":"0","7":"166","8":"1","9":"2"},{"1":"268","2":"268","3":"26","4":"0","5":"1","6":"0","7":"556","8":"0","9":"1"},{"1":"269","2":"269","3":"30","4":"5","5":"0","6":"0","7":"104","8":"1","9":"2"},{"1":"270","2":"270","3":"28","4":"5","5":"0","6":"0","7":"102","8":"1","9":"1"},{"1":"271","2":"271","3":"31","4":"NA","5":"0","6":"0","7":"533","8":"0","9":"3"},{"1":"272","2":"272","3":"34","4":"0","5":"0","6":"0","7":"144","8":"1","9":"1"},{"1":"273","2":"273","3":"31","4":"2","5":"0","6":"0","7":"545","8":"0","9":"1"},{"1":"274","2":"274","3":"30","4":"1","5":"0","6":"0","7":"537","8":"0","9":"3"},{"1":"275","2":"275","3":"35","4":"5","5":"0","6":"0","7":"625","8":"0","9":"1"},{"1":"276","2":"276","3":"30","4":"3","5":"0","6":"0","7":"6","8":"1","9":"3"},{"1":"277","2":"277","3":"37","4":"7","5":"0","6":"0","7":"307","8":"1","9":"1"},{"1":"278","2":"278","3":"29","4":"12","5":"0","6":"0","7":"290","8":"1","9":"3"},{"1":"279","2":"279","3":"23","4":"8","5":"0","6":"0","7":"20","8":"1","9":"3"},{"1":"280","2":"280","3":"23","4":"4","5":"0","6":"0","7":"74","8":"1","9":"1"},{"1":"281","2":"281","3":"44","4":"0","5":"0","6":"0","7":"100","8":"1","9":"3"},{"1":"282","2":"282","3":"43","4":"8","5":"0","6":"0","7":"555","8":"0","9":"3"},{"1":"283","2":"283","3":"38","4":"3","5":"0","6":"0","7":"152","8":"1","9":"2"},{"1":"284","2":"284","3":"33","4":"3","5":"0","6":"0","7":"115","8":"1","9":"1"},{"1":"285","2":"285","3":"36","4":"9","5":"0","6":"0","7":"92","8":"1","9":"1"},{"1":"286","2":"286","3":"26","4":"2","5":"0","6":"0","7":"554","8":"0","9":"1"},{"1":"287","2":"287","3":"30","4":"0","5":"0","6":"0","7":"92","8":"1","9":"3"},{"1":"288","2":"288","3":"34","4":"0","5":"0","6":"0","7":"69","8":"1","9":"3"},{"1":"289","2":"289","3":"32","4":"6","5":"0","6":"0","7":"25","8":"1","9":"2"},{"1":"290","2":"290","3":"30","4":"1","5":"0","6":"0","7":"501","8":"0","9":"1"},{"1":"291","2":"291","3":"37","4":"10","5":"0","6":"0","7":"86","8":"1","9":"2"},{"1":"292","2":"292","3":"35","4":"7","5":"0","6":"0","7":"99","8":"1","9":"2"},{"1":"293","2":"293","3":"30","4":"0","5":"0","6":"0","7":"87","8":"1","9":"1"},{"1":"294","2":"294","3":"34","4":"6","5":"0","6":"0","7":"136","8":"1","9":"3"},{"1":"295","2":"295","3":"40","4":"6","5":"0","6":"0","7":"106","8":"1","9":"1"},{"1":"296","2":"296","3":"28","4":"3","5":"0","6":"0","7":"220","8":"1","9":"3"},{"1":"297","2":"297","3":"32","4":"6","5":"0","6":"0","7":"36","8":"1","9":"1"},{"1":"298","2":"298","3":"45","4":"2","5":"0","6":"0","7":"162","8":"1","9":"1"},{"1":"299","2":"299","3":"24","4":"0","5":"1","6":"0","7":"116","8":"1","9":"2"},{"1":"300","2":"300","3":"43","4":"5","5":"1","6":"0","7":"175","8":"1","9":"1"},{"1":"301","2":"301","3":"38","4":"0","5":"1","6":"0","7":"209","8":"1","9":"1"},{"1":"302","2":"302","3":"33","4":"1","5":"1","6":"0","7":"545","8":"0","9":"2"},{"1":"303","2":"303","3":"26","4":"2","5":"1","6":"0","7":"245","8":"1","9":"3"},{"1":"304","2":"304","3":"40","4":"3","5":"1","6":"0","7":"176","8":"1","9":"3"},{"1":"305","2":"305","3":"27","4":"0","5":"1","6":"0","7":"14","8":"1","9":"3"},{"1":"306","2":"306","3":"39","4":"12","5":"1","6":"0","7":"113","8":"1","9":"2"},{"1":"307","2":"307","3":"29","4":"2","5":"1","6":"0","7":"159","8":"1","9":"3"},{"1":"308","2":"308","3":"29","4":"3","5":"1","6":"0","7":"354","8":"1","9":"3"},{"1":"309","2":"309","3":"28","4":"4","5":"1","6":"0","7":"174","8":"1","9":"3"},{"1":"310","2":"310","3":"37","4":"20","5":"0","6":"0","7":"23","8":"1","9":"1"},{"1":"311","2":"311","3":"37","4":"20","5":"0","6":"0","7":"26","8":"1","9":"2"},{"1":"312","2":"312","3":"40","4":"9","5":"0","6":"0","7":"98","8":"1","9":"3"},{"1":"313","2":"313","3":"25","4":"5","5":"0","6":"0","7":"23","8":"1","9":"1"},{"1":"314","2":"314","3":"40","4":"2","5":"0","6":"0","7":"555","8":"0","9":"1"},{"1":"315","2":"315","3":"40","4":"4","5":"0","6":"0","7":"290","8":"1","9":"1"},{"1":"316","2":"316","3":"34","4":"8","5":"0","6":"0","7":"543","8":"0","9":"2"},{"1":"317","2":"317","3":"41","4":"7","5":"0","6":"0","7":"274","8":"1","9":"2"},{"1":"318","2":"318","3":"35","4":"NA","5":"0","6":"0","7":"536","8":"0","9":"2"},{"1":"319","2":"319","3":"32","4":"5","5":"0","6":"0","7":"3","8":"1","9":"3"},{"1":"320","2":"320","3":"37","4":"0","5":"1","6":"0","7":"5","8":"1","9":"3"},{"1":"321","2":"321","3":"23","4":"1","5":"1","6":"0","7":"119","8":"1","9":"3"},{"1":"322","2":"322","3":"36","4":"3","5":"1","6":"0","7":"164","8":"1","9":"1"},{"1":"323","2":"323","3":"28","4":"2","5":"1","6":"0","7":"548","8":"0","9":"3"},{"1":"324","2":"324","3":"23","4":"3","5":"1","6":"0","7":"175","8":"1","9":"1"},{"1":"325","2":"325","3":"27","4":"3","5":"1","6":"0","7":"539","8":"0","9":"1"},{"1":"326","2":"326","3":"32","4":"0","5":"1","6":"0","7":"155","8":"1","9":"3"},{"1":"327","2":"327","3":"38","4":"15","5":"1","6":"0","7":"14","8":"1","9":"3"},{"1":"328","2":"328","3":"38","4":"6","5":"1","6":"0","7":"187","8":"1","9":"3"},{"1":"329","2":"329","3":"45","4":"8","5":"1","6":"0","7":"65","8":"1","9":"1"},{"1":"330","2":"330","3":"26","4":"1","5":"1","6":"0","7":"159","8":"1","9":"2"},{"1":"331","2":"331","3":"29","4":"35","5":"1","6":"0","7":"96","8":"1","9":"1"},{"1":"332","2":"332","3":"33","4":"3","5":"1","6":"0","7":"243","8":"1","9":"3"},{"1":"333","2":"333","3":"25","4":"0","5":"1","6":"0","7":"85","8":"1","9":"1"},{"1":"334","2":"334","3":"36","4":"2","5":"1","6":"0","7":"4","8":"1","9":"3"},{"1":"335","2":"335","3":"37","4":"4","5":"1","6":"0","7":"121","8":"1","9":"2"},{"1":"336","2":"336","3":"29","4":"0","5":"1","6":"0","7":"659","8":"1","9":"3"},{"1":"337","2":"337","3":"29","4":"3","5":"1","6":"0","7":"260","8":"1","9":"3"},{"1":"338","2":"338","3":"35","4":"1","5":"1","6":"0","7":"621","8":"0","9":"3"},{"1":"339","2":"339","3":"33","4":"1","5":"1","6":"0","7":"199","8":"1","9":"3"},{"1":"340","2":"340","3":"31","4":"2","5":"1","6":"0","7":"565","8":"0","9":"3"},{"1":"341","2":"341","3":"37","4":"5","5":"1","6":"0","7":"183","8":"1","9":"1"},{"1":"342","2":"342","3":"32","4":"4","5":"1","6":"0","7":"122","8":"1","9":"1"},{"1":"343","2":"343","3":"33","4":"13","5":"1","6":"0","7":"170","8":"1","9":"1"},{"1":"344","2":"344","3":"36","4":"14","5":"1","6":"0","7":"15","8":"1","9":"1"},{"1":"345","2":"345","3":"26","4":"5","5":"1","6":"0","7":"268","8":"1","9":"1"},{"1":"346","2":"346","3":"35","4":"0","5":"1","6":"0","7":"79","8":"1","9":"1"},{"1":"347","2":"347","3":"25","4":"6","5":"0","6":"0","7":"23","8":"1","9":"1"},{"1":"348","2":"348","3":"33","4":"30","5":"0","6":"0","7":"100","8":"1","9":"1"},{"1":"349","2":"349","3":"36","4":"8","5":"0","6":"0","7":"98","8":"1","9":"2"},{"1":"350","2":"350","3":"38","4":"6","5":"0","6":"0","7":"81","8":"1","9":"1"},{"1":"351","2":"351","3":"36","4":"3","5":"0","6":"0","7":"546","8":"0","9":"1"},{"1":"352","2":"352","3":"36","4":"10","5":"0","6":"0","7":"58","8":"1","9":"2"},{"1":"353","2":"353","3":"35","4":"6","5":"0","6":"0","7":"569","8":"0","9":"1"},{"1":"354","2":"354","3":"35","4":"3","5":"0","6":"0","7":"575","8":"0","9":"1"},{"1":"355","2":"355","3":"NA","4":"NA","5":"0","6":"0","7":"17","8":"1","9":"3"},{"1":"356","2":"356","3":"39","4":"4","5":"0","6":"0","7":"91","8":"1","9":"2"},{"1":"357","2":"357","3":"37","4":"6","5":"0","6":"0","7":"57","8":"1","9":"3"},{"1":"358","2":"358","3":"30","4":"5","5":"0","6":"0","7":"499","8":"1","9":"2"},{"1":"359","2":"359","3":"26","4":"7","5":"0","6":"0","7":"123","8":"1","9":"1"},{"1":"360","2":"360","3":"39","4":"5","5":"0","6":"0","7":"143","8":"1","9":"3"},{"1":"361","2":"361","3":"33","4":"NA","5":"0","6":"0","7":"130","8":"1","9":"1"},{"1":"362","2":"362","3":"32","4":"4","5":"0","6":"0","7":"471","8":"1","9":"1"},{"1":"363","2":"363","3":"26","4":"4","5":"0","6":"0","7":"74","8":"1","9":"1"},{"1":"364","2":"364","3":"33","4":"6","5":"0","6":"0","7":"85","8":"1","9":"2"},{"1":"365","2":"365","3":"36","4":"5","5":"0","6":"0","7":"95","8":"1","9":"3"},{"1":"366","2":"366","3":"42","4":"3","5":"1","6":"0","7":"36","8":"1","9":"2"},{"1":"367","2":"367","3":"37","4":"22","5":"1","6":"0","7":"19","8":"1","9":"1"},{"1":"368","2":"368","3":"37","4":"1","5":"1","6":"0","7":"38","8":"1","9":"2"},{"1":"369","2":"369","3":"32","4":"4","5":"1","6":"0","7":"539","8":"0","9":"1"},{"1":"370","2":"370","3":"23","4":"3","5":"1","6":"0","7":"567","8":"0","9":"3"},{"1":"371","2":"371","3":"21","4":"10","5":"1","6":"0","7":"186","8":"1","9":"3"},{"1":"372","2":"372","3":"23","4":"1","5":"1","6":"0","7":"546","8":"0","9":"1"},{"1":"373","2":"373","3":"34","4":"1","5":"1","6":"0","7":"24","8":"1","9":"3"},{"1":"374","2":"374","3":"33","4":"3","5":"1","6":"0","7":"540","8":"0","9":"3"},{"1":"375","2":"375","3":"33","4":"4","5":"1","6":"0","7":"157","8":"1","9":"1"},{"1":"376","2":"376","3":"26","4":"0","5":"1","6":"0","7":"86","8":"1","9":"1"},{"1":"377","2":"377","3":"28","4":"2","5":"1","6":"0","7":"231","8":"1","9":"3"},{"1":"378","2":"378","3":"25","4":"NA","5":"1","6":"0","7":"271","8":"1","9":"3"},{"1":"379","2":"379","3":"27","4":"3","5":"0","6":"0","7":"14","8":"1","9":"1"},{"1":"380","2":"380","3":"22","4":"2","5":"0","6":"0","7":"75","8":"1","9":"1"},{"1":"381","2":"381","3":"31","4":"6","5":"0","6":"0","7":"147","8":"1","9":"1"},{"1":"382","2":"382","3":"29","4":"4","5":"0","6":"0","7":"105","8":"1","9":"1"},{"1":"383","2":"383","3":"44","4":"12","5":"0","6":"0","7":"324","8":"1","9":"3"},{"1":"384","2":"384","3":"26","4":"0","5":"0","6":"0","7":"538","8":"0","9":"1"},{"1":"385","2":"385","3":"44","4":"16","5":"0","6":"0","7":"300","8":"1","9":"2"},{"1":"386","2":"386","3":"34","4":"1","5":"0","6":"0","7":"73","8":"1","9":"1"},{"1":"387","2":"387","3":"36","4":"6","5":"0","6":"0","7":"65","8":"1","9":"2"},{"1":"388","2":"388","3":"43","4":"20","5":"0","6":"0","7":"568","8":"1","9":"2"},{"1":"389","2":"389","3":"37","4":"1","5":"0","6":"0","7":"84","8":"1","9":"1"},{"1":"390","2":"390","3":"44","4":"17","5":"1","6":"0","7":"22","8":"1","9":"3"},{"1":"391","2":"391","3":"31","4":"30","5":"1","6":"0","7":"44","8":"1","9":"1"},{"1":"392","2":"392","3":"24","4":"3","5":"1","6":"0","7":"7","8":"1","9":"2"},{"1":"393","2":"393","3":"NA","4":"NA","5":"1","6":"0","7":"540","8":"0","9":"1"},{"1":"394","2":"394","3":"37","4":"4","5":"1","6":"0","7":"21","8":"1","9":"1"},{"1":"395","2":"395","3":"41","4":"12","5":"1","6":"0","7":"537","8":"0","9":"1"},{"1":"396","2":"396","3":"32","4":"3","5":"1","6":"0","7":"186","8":"1","9":"1"},{"1":"397","2":"397","3":"23","4":"2","5":"1","6":"0","7":"40","8":"1","9":"1"},{"1":"398","2":"398","3":"33","4":"3","5":"1","6":"0","7":"287","8":"1","9":"2"},{"1":"399","2":"399","3":"43","4":"9","5":"1","6":"0","7":"538","8":"0","9":"3"},{"1":"400","2":"400","3":"33","4":"8","5":"1","6":"0","7":"30","8":"1","9":"3"},{"1":"401","2":"401","3":"41","4":"3","5":"1","6":"0","7":"516","8":"1","9":"3"},{"1":"402","2":"402","3":"41","4":"2","5":"1","6":"0","7":"268","8":"1","9":"2"},{"1":"403","2":"403","3":"37","4":"3","5":"1","6":"0","7":"568","8":"0","9":"2"},{"1":"404","2":"404","3":"26","4":"3","5":"0","6":"0","7":"131","8":"1","9":"1"},{"1":"405","2":"405","3":"33","4":"6","5":"0","6":"0","7":"399","8":"1","9":"1"},{"1":"406","2":"406","3":"30","4":"2","5":"0","6":"0","7":"78","8":"1","9":"1"},{"1":"407","2":"407","3":"33","4":"6","5":"0","6":"0","7":"80","8":"1","9":"3"},{"1":"408","2":"408","3":"33","4":"3","5":"0","6":"0","7":"102","8":"1","9":"2"},{"1":"409","2":"409","3":"NA","4":"NA","5":"0","6":"0","7":"3","8":"1","9":"1"},{"1":"410","2":"410","3":"37","4":"6","5":"0","6":"0","7":"124","8":"1","9":"1"},{"1":"411","2":"411","3":"44","4":"20","5":"0","6":"0","7":"80","8":"1","9":"2"},{"1":"412","2":"412","3":"20","4":"1","5":"0","6":"0","7":"23","8":"1","9":"3"},{"1":"413","2":"413","3":"33","4":"4","5":"0","6":"0","7":"274","8":"1","9":"1"},{"1":"414","2":"414","3":"NA","4":"NA","5":"0","6":"0","7":"10","8":"1","9":"2"},{"1":"415","2":"415","3":"36","4":"3","5":"0","6":"0","7":"459","8":"1","9":"2"},{"1":"416","2":"416","3":"34","4":"3","5":"0","6":"0","7":"10","8":"1","9":"2"},{"1":"417","2":"417","3":"35","4":"17","5":"1","6":"0","7":"176","8":"1","9":"1"},{"1":"418","2":"418","3":"38","4":"26","5":"1","6":"0","7":"332","8":"1","9":"2"},{"1":"419","2":"419","3":"24","4":"3","5":"1","6":"0","7":"119","8":"1","9":"1"},{"1":"420","2":"420","3":"24","4":"4","5":"1","6":"0","7":"217","8":"1","9":"1"},{"1":"421","2":"421","3":"32","4":"4","5":"1","6":"0","7":"285","8":"1","9":"1"},{"1":"422","2":"422","3":"35","4":"3","5":"1","6":"0","7":"576","8":"0","9":"3"},{"1":"423","2":"423","3":"33","4":"5","5":"1","6":"0","7":"106","8":"1","9":"1"},{"1":"424","2":"424","3":"29","4":"4","5":"1","6":"0","7":"81","8":"1","9":"2"},{"1":"425","2":"425","3":"42","4":"30","5":"1","6":"0","7":"47","8":"1","9":"2"},{"1":"426","2":"426","3":"23","4":"1","5":"1","6":"0","7":"76","8":"1","9":"3"},{"1":"427","2":"427","3":"28","4":"16","5":"1","6":"0","7":"348","8":"1","9":"3"},{"1":"428","2":"428","3":"39","4":"5","5":"1","6":"0","7":"20","8":"1","9":"3"},{"1":"429","2":"429","3":"43","4":"4","5":"1","6":"0","7":"306","8":"1","9":"2"},{"1":"430","2":"430","3":"33","4":"0","5":"0","6":"0","7":"192","8":"1","9":"2"},{"1":"431","2":"431","3":"37","4":"20","5":"0","6":"0","7":"216","8":"1","9":"1"},{"1":"432","2":"432","3":"49","4":"7","5":"0","6":"0","7":"189","8":"1","9":"2"},{"1":"433","2":"433","3":"27","4":"NA","5":"0","6":"0","7":"403","8":"1","9":"3"},{"1":"434","2":"434","3":"36","4":"1","5":"0","6":"0","7":"193","8":"1","9":"1"},{"1":"435","2":"435","3":"27","4":"13","5":"0","6":"0","7":"28","8":"1","9":"1"},{"1":"436","2":"436","3":"35","4":"1","5":"0","6":"0","7":"150","8":"1","9":"1"},{"1":"437","2":"437","3":"25","4":"3","5":"0","6":"0","7":"99","8":"1","9":"1"},{"1":"438","2":"438","3":"33","4":"3","5":"0","6":"0","7":"510","8":"0","9":"1"},{"1":"439","2":"439","3":"34","4":"7","5":"0","6":"0","7":"306","8":"1","9":"1"},{"1":"440","2":"440","3":"38","4":"10","5":"0","6":"0","7":"101","8":"1","9":"1"},{"1":"441","2":"441","3":"36","4":"0","5":"0","6":"0","7":"102","8":"1","9":"2"},{"1":"442","2":"442","3":"27","4":"1","5":"0","6":"0","7":"510","8":"0","9":"1"},{"1":"443","2":"443","3":"31","4":"NA","5":"0","6":"0","7":"69","8":"1","9":"3"},{"1":"444","2":"444","3":"40","4":"0","5":"0","6":"0","7":"503","8":"0","9":"1"},{"1":"445","2":"445","3":"32","4":"3","5":"0","6":"1","7":"52","8":"1","9":"1"},{"1":"446","2":"446","3":"38","4":"1","5":"0","6":"1","7":"547","8":"0","9":"1"},{"1":"447","2":"447","3":"38","4":"6","5":"0","6":"1","7":"168","8":"1","9":"1"},{"1":"448","2":"448","3":"23","4":"0","5":"0","6":"1","7":"461","8":"1","9":"3"},{"1":"449","2":"449","3":"26","4":"2","5":"0","6":"1","7":"538","8":"0","9":"3"},{"1":"450","2":"450","3":"36","4":"7","5":"0","6":"1","7":"349","8":"1","9":"2"},{"1":"451","2":"451","3":"30","4":"5","5":"0","6":"1","7":"44","8":"1","9":"3"},{"1":"452","2":"452","3":"31","4":"3","5":"1","6":"1","7":"548","8":"0","9":"3"},{"1":"453","2":"453","3":"23","4":"1","5":"1","6":"1","7":"12","8":"1","9":"1"},{"1":"454","2":"454","3":"43","4":"0","5":"1","6":"1","7":"6","8":"1","9":"1"},{"1":"455","2":"455","3":"24","4":"1","5":"1","6":"1","7":"575","8":"0","9":"3"},{"1":"456","2":"456","3":"42","4":"1","5":"1","6":"1","7":"589","8":"0","9":"3"},{"1":"457","2":"457","3":"35","4":"1","5":"1","6":"1","7":"408","8":"1","9":"3"},{"1":"458","2":"458","3":"21","4":"0","5":"1","6":"1","7":"232","8":"1","9":"3"},{"1":"459","2":"459","3":"45","4":"0","5":"1","6":"1","7":"143","8":"1","9":"3"},{"1":"460","2":"460","3":"43","4":"6","5":"1","6":"1","7":"582","8":"0","9":"2"},{"1":"461","2":"461","3":"24","4":"0","5":"1","6":"1","7":"134","8":"1","9":"3"},{"1":"462","2":"462","3":"37","4":"1","5":"1","6":"1","7":"7","8":"1","9":"1"},{"1":"463","2":"463","3":"40","4":"0","5":"1","6":"1","7":"548","8":"0","9":"3"},{"1":"464","2":"464","3":"27","4":"2","5":"0","6":"1","7":"81","8":"1","9":"1"},{"1":"465","2":"465","3":"29","4":"1","5":"0","6":"1","7":"170","8":"1","9":"2"},{"1":"466","2":"466","3":"34","4":"6","5":"0","6":"1","7":"29","8":"1","9":"3"},{"1":"467","2":"467","3":"29","4":"20","5":"0","6":"1","7":"78","8":"1","9":"1"},{"1":"468","2":"468","3":"35","4":"5","5":"0","6":"1","7":"81","8":"1","9":"1"},{"1":"469","2":"469","3":"39","4":"4","5":"1","6":"1","7":"369","8":"1","9":"1"},{"1":"470","2":"470","3":"41","4":"0","5":"1","6":"1","7":"69","8":"1","9":"3"},{"1":"471","2":"471","3":"37","4":"6","5":"1","6":"1","7":"115","8":"1","9":"3"},{"1":"472","2":"472","3":"30","4":"7","5":"1","6":"1","7":"361","8":"1","9":"1"},{"1":"473","2":"473","3":"31","4":"0","5":"1","6":"1","7":"245","8":"1","9":"3"},{"1":"474","2":"474","3":"40","4":"8","5":"0","6":"1","7":"233","8":"1","9":"3"},{"1":"475","2":"475","3":"32","4":"0","5":"0","6":"1","7":"227","8":"1","9":"3"},{"1":"476","2":"476","3":"32","4":"3","5":"0","6":"1","7":"97","8":"1","9":"3"},{"1":"477","2":"477","3":"27","4":"0","5":"0","6":"1","7":"547","8":"0","9":"3"},{"1":"478","2":"478","3":"23","4":"0","5":"0","6":"1","7":"224","8":"1","9":"1"},{"1":"479","2":"479","3":"23","4":"2","5":"0","6":"1","7":"211","8":"1","9":"3"},{"1":"480","2":"480","3":"43","4":"12","5":"0","6":"1","7":"220","8":"1","9":"2"},{"1":"481","2":"481","3":"24","4":"0","5":"0","6":"1","7":"54","8":"1","9":"3"},{"1":"482","2":"482","3":"36","4":"2","5":"0","6":"1","7":"192","8":"1","9":"3"},{"1":"483","2":"483","3":"29","4":"1","5":"0","6":"1","7":"138","8":"1","9":"1"},{"1":"484","2":"484","3":"39","4":"1","5":"1","6":"1","7":"107","8":"1","9":"3"},{"1":"485","2":"485","3":"23","4":"0","5":"1","6":"1","7":"597","8":"0","9":"3"},{"1":"486","2":"486","3":"27","4":"4","5":"1","6":"1","7":"226","8":"1","9":"1"},{"1":"487","2":"487","3":"26","4":"5","5":"1","6":"1","7":"434","8":"1","9":"3"},{"1":"488","2":"488","3":"26","4":"1","5":"1","6":"1","7":"106","8":"1","9":"1"},{"1":"489","2":"489","3":"25","4":"0","5":"1","6":"1","7":"180","8":"1","9":"3"},{"1":"490","2":"490","3":"34","4":"0","5":"1","6":"1","7":"557","8":"0","9":"1"},{"1":"491","2":"491","3":"45","4":"2","5":"1","6":"1","7":"556","8":"0","9":"3"},{"1":"492","2":"492","3":"23","4":"1","5":"0","6":"1","7":"619","8":"0","9":"3"},{"1":"493","2":"493","3":"26","4":"0","5":"0","6":"1","7":"546","8":"0","9":"3"},{"1":"494","2":"494","3":"33","4":"2","5":"0","6":"1","7":"85","8":"1","9":"3"},{"1":"495","2":"495","3":"24","4":"2","5":"0","6":"1","7":"233","8":"1","9":"1"},{"1":"496","2":"496","3":"30","4":"2","5":"0","6":"1","7":"102","8":"1","9":"2"},{"1":"497","2":"497","3":"22","4":"0","5":"0","6":"1","7":"548","8":"0","9":"1"},{"1":"498","2":"498","3":"25","4":"1","5":"0","6":"1","7":"99","8":"1","9":"1"},{"1":"499","2":"499","3":"30","4":"40","5":"0","6":"1","7":"36","8":"1","9":"1"},{"1":"500","2":"500","3":"37","4":"8","5":"0","6":"1","7":"32","8":"1","9":"3"},{"1":"501","2":"501","3":"33","4":"0","5":"1","6":"1","7":"78","8":"1","9":"3"},{"1":"502","2":"502","3":"34","4":"8","5":"1","6":"1","7":"502","8":"1","9":"1"},{"1":"503","2":"503","3":"29","4":"2","5":"1","6":"1","7":"71","8":"1","9":"1"},{"1":"504","2":"504","3":"39","4":"6","5":"1","6":"1","7":"59","8":"1","9":"3"},{"1":"505","2":"505","3":"33","4":"1","5":"1","6":"1","7":"115","8":"1","9":"1"},{"1":"506","2":"506","3":"26","4":"4","5":"1","6":"1","7":"533","8":"0","9":"1"},{"1":"507","2":"507","3":"32","4":"6","5":"1","6":"1","7":"10","8":"1","9":"2"},{"1":"508","2":"508","3":"42","4":"2","5":"0","6":"1","7":"274","8":"1","9":"1"},{"1":"509","2":"509","3":"39","4":"8","5":"0","6":"1","7":"255","8":"1","9":"1"},{"1":"510","2":"510","3":"36","4":"0","5":"0","6":"1","7":"503","8":"0","9":"3"},{"1":"511","2":"511","3":"22","4":"1","5":"0","6":"1","7":"256","8":"1","9":"1"},{"1":"512","2":"512","3":"27","4":"1","5":"0","6":"1","7":"9","8":"1","9":"3"},{"1":"513","2":"513","3":"21","4":"3","5":"0","6":"1","7":"550","8":"0","9":"3"},{"1":"514","2":"514","3":"28","4":"0","5":"0","6":"1","7":"386","8":"1","9":"3"},{"1":"515","2":"515","3":"36","4":"1","5":"1","6":"1","7":"547","8":"0","9":"1"},{"1":"516","2":"516","3":"31","4":"3","5":"1","6":"1","7":"45","8":"1","9":"1"},{"1":"517","2":"517","3":"27","4":"4","5":"1","6":"1","7":"58","8":"1","9":"1"},{"1":"518","2":"518","3":"23","4":"1","5":"1","6":"1","7":"124","8":"1","9":"1"},{"1":"519","2":"519","3":"24","4":"20","5":"0","6":"1","7":"540","8":"0","9":"1"},{"1":"520","2":"520","3":"38","4":"1","5":"0","6":"1","7":"243","8":"1","9":"1"},{"1":"521","2":"521","3":"25","4":"1","5":"1","6":"1","7":"549","8":"0","9":"3"},{"1":"522","2":"522","3":"26","4":"0","5":"0","6":"1","7":"12","8":"1","9":"1"},{"1":"523","2":"523","3":"22","4":"2","5":"0","6":"1","7":"51","8":"1","9":"1"},{"1":"524","2":"524","3":"33","4":"2","5":"1","6":"1","7":"562","8":"0","9":"3"},{"1":"525","2":"525","3":"30","4":"7","5":"1","6":"1","7":"94","8":"1","9":"1"},{"1":"526","2":"526","3":"45","4":"3","5":"0","6":"1","7":"204","8":"1","9":"3"},{"1":"527","2":"527","3":"24","4":"0","5":"0","6":"1","7":"238","8":"1","9":"1"},{"1":"528","2":"528","3":"27","4":"0","5":"1","6":"1","7":"140","8":"1","9":"3"},{"1":"529","2":"529","3":"36","4":"10","5":"1","6":"1","7":"120","8":"1","9":"3"},{"1":"530","2":"530","3":"38","4":"2","5":"0","6":"1","7":"154","8":"1","9":"3"},{"1":"531","2":"531","3":"31","4":"2","5":"1","6":"1","7":"177","8":"1","9":"2"},{"1":"532","2":"532","3":"40","4":"7","5":"1","6":"1","7":"119","8":"1","9":"3"},{"1":"533","2":"533","3":"22","4":"0","5":"1","6":"1","7":"83","8":"1","9":"1"},{"1":"534","2":"534","3":"31","4":"0","5":"1","6":"1","7":"130","8":"1","9":"3"},{"1":"535","2":"535","3":"23","4":"20","5":"1","6":"1","7":"11","8":"1","9":"3"},{"1":"536","2":"536","3":"39","4":"3","5":"0","6":"1","7":"159","8":"1","9":"1"},{"1":"537","2":"537","3":"23","4":"1","5":"0","6":"1","7":"211","8":"1","9":"3"},{"1":"538","2":"538","3":"33","4":"1","5":"0","6":"1","7":"33","8":"1","9":"1"},{"1":"539","2":"539","3":"27","4":"2","5":"1","6":"1","7":"72","8":"1","9":"1"},{"1":"540","2":"540","3":"37","4":"2","5":"1","6":"1","7":"161","8":"1","9":"3"},{"1":"541","2":"541","3":"35","4":"25","5":"0","6":"1","7":"191","8":"1","9":"3"},{"1":"542","2":"542","3":"25","4":"5","5":"0","6":"1","7":"181","8":"1","9":"1"},{"1":"543","2":"543","3":"27","4":"1","5":"1","6":"1","7":"546","8":"0","9":"1"},{"1":"544","2":"544","3":"34","4":"0","5":"0","6":"1","7":"540","8":"0","9":"3"},{"1":"545","2":"545","3":"30","4":"3","5":"0","6":"1","7":"76","8":"1","9":"1"},{"1":"546","2":"546","3":"35","4":"7","5":"0","6":"1","7":"7","8":"1","9":"1"},{"1":"547","2":"547","3":"34","4":"0","5":"0","6":"1","7":"44","8":"1","9":"3"},{"1":"548","2":"548","3":"25","4":"5","5":"0","6":"1","7":"103","8":"1","9":"1"},{"1":"549","2":"549","3":"34","4":"1","5":"0","6":"1","7":"79","8":"1","9":"1"},{"1":"550","2":"550","3":"24","4":"3","5":"0","6":"1","7":"339","8":"1","9":"3"},{"1":"551","2":"551","3":"24","4":"2","5":"0","6":"1","7":"90","8":"1","9":"3"},{"1":"552","2":"552","3":"40","4":"3","5":"0","6":"1","7":"542","8":"0","9":"3"},{"1":"553","2":"553","3":"33","4":"1","5":"0","6":"1","7":"384","8":"1","9":"1"},{"1":"554","2":"554","3":"38","4":"1","5":"1","6":"1","7":"255","8":"1","9":"3"},{"1":"555","2":"555","3":"32","4":"0","5":"1","6":"1","7":"431","8":"1","9":"1"},{"1":"556","2":"556","3":"33","4":"1","5":"0","6":"1","7":"587","8":"0","9":"3"},{"1":"557","2":"557","3":"28","4":"2","5":"0","6":"1","7":"198","8":"1","9":"1"},{"1":"558","2":"558","3":"31","4":"2","5":"0","6":"1","7":"551","8":"0","9":"1"},{"1":"559","2":"559","3":"31","4":"4","5":"1","6":"1","7":"110","8":"1","9":"2"},{"1":"560","2":"560","3":"33","4":"0","5":"1","6":"1","7":"541","8":"0","9":"3"},{"1":"561","2":"561","3":"24","4":"11","5":"0","6":"1","7":"242","8":"1","9":"1"},{"1":"562","2":"562","3":"26","4":"3","5":"0","6":"1","7":"537","8":"0","9":"1"},{"1":"563","2":"563","3":"31","4":"7","5":"1","6":"1","7":"56","8":"1","9":"2"},{"1":"564","2":"564","3":"40","4":"4","5":"1","6":"1","7":"34","8":"1","9":"2"},{"1":"565","2":"565","3":"36","4":"NA","5":"1","6":"1","7":"567","8":"0","9":"3"},{"1":"566","2":"566","3":"34","4":"3","5":"1","6":"1","7":"549","8":"0","9":"1"},{"1":"567","2":"567","3":"30","4":"7","5":"0","6":"1","7":"133","8":"1","9":"1"},{"1":"568","2":"568","3":"36","4":"3","5":"0","6":"1","7":"226","8":"1","9":"1"},{"1":"569","2":"569","3":"38","4":"6","5":"1","6":"1","7":"401","8":"1","9":"2"},{"1":"570","2":"570","3":"31","4":"6","5":"1","6":"1","7":"14","8":"1","9":"1"},{"1":"571","2":"571","3":"27","4":"2","5":"0","6":"1","7":"548","8":"0","9":"2"},{"1":"572","2":"572","3":"32","4":"15","5":"1","6":"1","7":"224","8":"1","9":"1"},{"1":"573","2":"573","3":"35","4":"5","5":"0","6":"1","7":"540","8":"0","9":"1"},{"1":"574","2":"574","3":"44","4":"13","5":"0","6":"1","7":"237","8":"1","9":"2"},{"1":"575","2":"575","3":"31","4":"10","5":"1","6":"1","7":"354","8":"1","9":"2"},{"1":"576","2":"576","3":"28","4":"20","5":"0","6":"1","7":"123","8":"1","9":"1"},{"1":"577","2":"577","3":"40","4":"1","5":"0","6":"1","7":"170","8":"1","9":"3"},{"1":"578","2":"578","3":"25","4":"10","5":"1","6":"1","7":"203","8":"1","9":"1"},{"1":"579","2":"579","3":"32","4":"6","5":"1","6":"1","7":"360","8":"1","9":"1"},{"1":"580","2":"580","3":"29","4":"2","5":"0","6":"1","7":"139","8":"1","9":"3"},{"1":"581","2":"581","3":"40","4":"5","5":"1","6":"1","7":"215","8":"1","9":"2"},{"1":"582","2":"582","3":"27","4":"0","5":"1","6":"1","7":"129","8":"1","9":"3"},{"1":"583","2":"583","3":"26","4":"1","5":"1","6":"1","7":"396","8":"1","9":"1"},{"1":"584","2":"584","3":"34","4":"4","5":"1","6":"1","7":"547","8":"0","9":"1"},{"1":"585","2":"585","3":"49","4":"2","5":"0","6":"1","7":"547","8":"0","9":"3"},{"1":"586","2":"586","3":"21","4":"1","5":"1","6":"1","7":"71","8":"1","9":"1"},{"1":"587","2":"587","3":"39","4":"2","5":"1","6":"1","7":"168","8":"1","9":"1"},{"1":"588","2":"588","3":"33","4":"4","5":"1","6":"1","7":"228","8":"1","9":"3"},{"1":"589","2":"589","3":"32","4":"1","5":"1","6":"1","7":"551","8":"0","9":"1"},{"1":"590","2":"590","3":"35","4":"6","5":"0","6":"1","7":"654","8":"0","9":"3"},{"1":"591","2":"591","3":"31","4":"0","5":"1","6":"1","7":"51","8":"1","9":"3"},{"1":"592","2":"592","3":"28","4":"3","5":"0","6":"1","7":"548","8":"0","9":"3"},{"1":"593","2":"593","3":"27","4":"5","5":"1","6":"1","7":"231","8":"1","9":"1"},{"1":"594","2":"594","3":"29","4":"1","5":"1","6":"1","7":"280","8":"1","9":"2"},{"1":"595","2":"595","3":"30","4":"20","5":"0","6":"1","7":"184","8":"1","9":"2"},{"1":"596","2":"596","3":"27","4":"3","5":"0","6":"1","7":"86","8":"1","9":"3"},{"1":"597","2":"597","3":"33","4":"1","5":"0","6":"1","7":"560","8":"0","9":"3"},{"1":"598","2":"598","3":"40","4":"1","5":"1","6":"1","7":"46","8":"1","9":"3"},{"1":"599","2":"599","3":"37","4":"2","5":"1","6":"1","7":"200","8":"1","9":"1"},{"1":"600","2":"600","3":"33","4":"0","5":"0","6":"1","7":"244","8":"1","9":"3"},{"1":"601","2":"601","3":"28","4":"2","5":"0","6":"1","7":"182","8":"1","9":"3"},{"1":"602","2":"602","3":"40","4":"8","5":"1","6":"1","7":"296","8":"1","9":"3"},{"1":"603","2":"603","3":"48","4":"0","5":"0","6":"1","7":"24","8":"1","9":"3"},{"1":"604","2":"604","3":"38","4":"1","5":"0","6":"1","7":"142","8":"1","9":"1"},{"1":"605","2":"605","3":"35","4":"0","5":"0","6":"1","7":"120","8":"1","9":"3"},{"1":"606","2":"606","3":"37","4":"0","5":"0","6":"1","7":"47","8":"1","9":"3"},{"1":"607","2":"607","3":"25","4":"0","5":"1","6":"1","7":"519","8":"1","9":"1"},{"1":"608","2":"608","3":"26","4":"2","5":"1","6":"1","7":"248","8":"1","9":"3"},{"1":"609","2":"609","3":"30","4":"3","5":"0","6":"1","7":"31","8":"1","9":"1"},{"1":"610","2":"610","3":"28","4":"2","5":"0","6":"1","7":"567","8":"0","9":"3"},{"1":"611","2":"611","3":"23","4":"4","5":"0","6":"1","7":"353","8":"1","9":"2"},{"1":"612","2":"612","3":"36","4":"1","5":"1","6":"1","7":"458","8":"1","9":"3"},{"1":"613","2":"613","3":"36","4":"4","5":"1","6":"1","7":"554","8":"0","9":"3"},{"1":"614","2":"614","3":"24","4":"0","5":"0","6":"1","7":"116","8":"1","9":"3"},{"1":"615","2":"615","3":"33","4":"5","5":"0","6":"1","7":"74","8":"1","9":"1"},{"1":"616","2":"616","3":"38","4":"6","5":"0","6":"1","7":"10","8":"1","9":"3"},{"1":"617","2":"617","3":"41","4":"21","5":"1","6":"1","7":"355","8":"1","9":"1"},{"1":"618","2":"618","3":"31","4":"0","5":"1","6":"1","7":"232","8":"1","9":"1"},{"1":"619","2":"619","3":"31","4":"11","5":"1","6":"1","7":"68","8":"1","9":"3"},{"1":"620","2":"620","3":"37","4":"0","5":"1","6":"1","7":"48","8":"1","9":"3"},{"1":"621","2":"621","3":"37","4":"4","5":"0","6":"1","7":"60","8":"1","9":"3"},{"1":"622","2":"622","3":"33","4":"0","5":"0","6":"1","7":"50","8":"1","9":"3"},{"1":"623","2":"623","3":"36","4":"NA","5":"0","6":"1","7":"51","8":"1","9":"3"},{"1":"624","2":"624","3":"53","4":"6","5":"0","6":"1","7":"126","8":"1","9":"3"},{"1":"625","2":"625","3":"37","4":"4","5":"0","6":"1","7":"18","8":"1","9":"2"},{"1":"626","2":"626","3":"28","4":"3","5":"1","6":"1","7":"35","8":"1","9":"3"},{"1":"627","2":"627","3":"35","4":"2","5":"0","6":"1","7":"379","8":"1","9":"1"},{"1":"628","2":"628","3":"46","4":"15","5":"1","6":"1","7":"377","8":"1","9":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This shows that you have over 600 rows and the variables described.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>There are some missing values in the dataframe. Demonstrate this using <code>summary</code>. Pipe the dataframe into <code>drop_na</code> and show that they have gone. (<code>drop_na</code> removes all rows that have missing values in them.)</li>
</ol>
<p>Solution</p>
<p>First off, <code>summary</code> is a quick way to show how many missing values there are:<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(drugusers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      row              ID             age           ndrugtx      
 Min.   :  1.0   Min.   :  1.0   Min.   :20.00   Min.   : 0.000  
 1st Qu.:157.8   1st Qu.:157.8   1st Qu.:27.00   1st Qu.: 1.000  
 Median :314.5   Median :314.5   Median :32.00   Median : 3.000  
 Mean   :314.5   Mean   :314.5   Mean   :32.37   Mean   : 4.574  
 3rd Qu.:471.2   3rd Qu.:471.2   3rd Qu.:37.00   3rd Qu.: 6.000  
 Max.   :628.0   Max.   :628.0   Max.   :56.00   Max.   :40.000  
                                 NA's   :5       NA's   :17      
     treat             site            time            censor      
 Min.   :0.0000   Min.   :0.000   Min.   :   2.0   Min.   :0.0000  
 1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:  79.0   1st Qu.:1.0000  
 Median :0.0000   Median :0.000   Median : 166.0   Median :1.0000  
 Mean   :0.4904   Mean   :0.293   Mean   : 234.7   Mean   :0.8089  
 3rd Qu.:1.0000   3rd Qu.:1.000   3rd Qu.: 365.2   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :1.000   Max.   :1172.0   Max.   :1.0000  
                                                                   
     herco      
 Min.   :1.000  
 1st Qu.:1.000  
 Median :2.000  
 Mean   :1.898  
 3rd Qu.:3.000  
 Max.   :3.000  
                </code></pre>
</div>
</div>
<p>Age has five missing values and “number of previous drug treatments” has seventeen.</p>
<p>Following the instructions, and saving back into the original dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>drugusers <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="ot">-&gt;</span> drugusers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and then</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(drugusers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      row              ID             age           ndrugtx      
 Min.   :  1.0   Min.   :  1.0   Min.   :20.00   Min.   : 0.000  
 1st Qu.:155.2   1st Qu.:155.2   1st Qu.:27.00   1st Qu.: 1.000  
 Median :312.5   Median :312.5   Median :32.00   Median : 3.000  
 Mean   :313.8   Mean   :313.8   Mean   :32.39   Mean   : 4.579  
 3rd Qu.:473.8   3rd Qu.:473.8   3rd Qu.:37.00   3rd Qu.: 6.000  
 Max.   :628.0   Max.   :628.0   Max.   :56.00   Max.   :40.000  
     treat             site             time            censor      
 Min.   :0.0000   Min.   :0.0000   Min.   :   2.0   Min.   :0.0000  
 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:  79.0   1st Qu.:1.0000  
 Median :0.0000   Median :0.0000   Median : 166.0   Median :1.0000  
 Mean   :0.4918   Mean   :0.2984   Mean   : 234.4   Mean   :0.8115  
 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.: 361.8   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :1.0000   Max.   :1172.0   Max.   :1.0000  
     herco     
 Min.   :1.00  
 1st Qu.:1.00  
 Median :2.00  
 Mean   :1.89  
 3rd Qu.:3.00  
 Max.   :3.00  </code></pre>
</div>
</div>
<p>No NA left. Gosh, as they say, that was easy. Extra: how many rows did we lose?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(drugusers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 610</code></pre>
</div>
</div>
<p>There were 628 rows before, so we lost 18. (There were 22 missing values, but some of them were two on one row, so we only lost 18 rows.)</p>
<p>This is a very unsophisticated way of dealing with missing values. Another way is to “impute” them, that is, to guess what they would have been, and then fill in the guessed values and use them as if they were the truth, for example by regressing the columns with missing values on all the others, and using the regression predictions in place of the missing values.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>Some of these variables are recorded as numbers but are actually categorical. Which ones? Re-define these variables in your data frame so that they have sensible (text) values.</li>
</ol>
<p>Solution</p>
<p>These variables are actually categorical rather than quantitative:</p>
<ul>
<li><p><code>treat</code></p></li>
<li><p><code>site</code></p></li>
<li><p><code>censor</code></p></li>
<li><p><code>herco</code></p></li>
</ul>
<p>Most of them have only two levels, so it doesn’t matter whether we make them categorical or leave them as numbers, but for <code>herco</code> it matters. Let’s give them all sensible values, mostly with <code>ifelse</code>,<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>drugusers <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">treat =</span> <span class="fu">ifelse</span>(treat <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"short"</span>, <span class="st">"long"</span>),</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">site =</span> <span class="fu">ifelse</span>(site <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">censor =</span> <span class="fu">ifelse</span>(censor <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"returned"</span>, <span class="st">"no-return"</span>),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">herco =</span> <span class="fu">case_when</span>(</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    herco <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"both"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    herco <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"one"</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    herco <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"neither"</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>) <span class="ot">-&gt;</span> drugusers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I’m living on the edge and overwriting everything:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>drugusers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["row"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["ID"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["ndrugtx"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["treat"],"name":[5],"type":["chr"],"align":["left"]},{"label":["site"],"name":[6],"type":["chr"],"align":["left"]},{"label":["time"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["censor"],"name":[8],"type":["chr"],"align":["left"]},{"label":["herco"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"1","3":"39","4":"1","5":"long","6":"A","7":"188","8":"returned","9":"neither"},{"1":"2","2":"2","3":"33","4":"8","5":"long","6":"A","7":"26","8":"returned","9":"neither"},{"1":"3","2":"3","3":"33","4":"3","5":"long","6":"A","7":"207","8":"returned","9":"one"},{"1":"4","2":"4","3":"32","4":"1","5":"short","6":"A","7":"144","8":"returned","9":"neither"},{"1":"5","2":"5","3":"24","4":"5","5":"long","6":"A","7":"551","8":"no-return","9":"one"},{"1":"6","2":"6","3":"30","4":"1","5":"long","6":"A","7":"32","8":"returned","9":"both"},{"1":"7","2":"7","3":"39","4":"34","5":"long","6":"A","7":"459","8":"returned","9":"neither"},{"1":"8","2":"8","3":"27","4":"2","5":"long","6":"A","7":"22","8":"returned","9":"neither"},{"1":"9","2":"9","3":"40","4":"3","5":"long","6":"A","7":"210","8":"returned","9":"one"},{"1":"10","2":"10","3":"36","4":"7","5":"long","6":"A","7":"184","8":"returned","9":"one"},{"1":"11","2":"11","3":"35","4":"12","5":"long","6":"A","7":"5","8":"returned","9":"neither"},{"1":"12","2":"12","3":"38","4":"8","5":"long","6":"A","7":"212","8":"returned","9":"one"},{"1":"13","2":"13","3":"29","4":"1","5":"long","6":"A","7":"87","8":"returned","9":"both"},{"1":"14","2":"14","3":"32","4":"2","5":"long","6":"A","7":"598","8":"no-return","9":"both"},{"1":"15","2":"15","3":"41","4":"8","5":"long","6":"A","7":"260","8":"returned","9":"both"},{"1":"16","2":"16","3":"31","4":"1","5":"long","6":"A","7":"210","8":"returned","9":"both"},{"1":"17","2":"17","3":"27","4":"3","5":"long","6":"A","7":"84","8":"returned","9":"one"},{"1":"18","2":"18","3":"28","4":"6","5":"long","6":"A","7":"196","8":"returned","9":"both"},{"1":"19","2":"19","3":"28","4":"1","5":"long","6":"A","7":"19","8":"returned","9":"neither"},{"1":"20","2":"20","3":"36","4":"15","5":"long","6":"A","7":"441","8":"returned","9":"both"},{"1":"21","2":"21","3":"32","4":"5","5":"long","6":"A","7":"449","8":"returned","9":"one"},{"1":"22","2":"22","3":"33","4":"1","5":"short","6":"A","7":"659","8":"no-return","9":"both"},{"1":"23","2":"23","3":"28","4":"8","5":"short","6":"A","7":"21","8":"returned","9":"both"},{"1":"24","2":"24","3":"29","4":"0","5":"short","6":"A","7":"53","8":"returned","9":"neither"},{"1":"25","2":"25","3":"35","4":"9","5":"short","6":"A","7":"225","8":"returned","9":"one"},{"1":"26","2":"26","3":"45","4":"6","5":"short","6":"A","7":"161","8":"returned","9":"both"},{"1":"27","2":"27","3":"35","4":"5","5":"short","6":"A","7":"87","8":"returned","9":"neither"},{"1":"28","2":"28","3":"24","4":"3","5":"short","6":"A","7":"89","8":"returned","9":"both"},{"1":"29","2":"29","3":"36","4":"7","5":"short","6":"A","7":"44","8":"returned","9":"both"},{"1":"30","2":"30","3":"27","4":"30","5":"short","6":"A","7":"37","8":"returned","9":"both"},{"1":"31","2":"31","3":"39","4":"9","5":"short","6":"A","7":"523","8":"no-return","9":"both"},{"1":"32","2":"32","3":"36","4":"10","5":"short","6":"A","7":"226","8":"returned","9":"neither"},{"1":"33","2":"33","3":"37","4":"1","5":"short","6":"A","7":"259","8":"returned","9":"neither"},{"1":"34","2":"34","3":"30","4":"1","5":"short","6":"A","7":"289","8":"returned","9":"one"},{"1":"35","2":"35","3":"44","4":"5","5":"short","6":"A","7":"103","8":"returned","9":"both"},{"1":"36","2":"36","3":"28","4":"6","5":"short","6":"A","7":"624","8":"no-return","9":"both"},{"1":"37","2":"37","3":"25","4":"3","5":"short","6":"A","7":"68","8":"returned","9":"both"},{"1":"38","2":"38","3":"30","4":"7","5":"long","6":"A","7":"57","8":"returned","9":"one"},{"1":"39","2":"39","3":"24","4":"1","5":"short","6":"A","7":"65","8":"returned","9":"neither"},{"1":"40","2":"40","3":"27","4":"1","5":"short","6":"A","7":"79","8":"returned","9":"both"},{"1":"41","2":"41","3":"30","4":"2","5":"short","6":"A","7":"559","8":"no-return","9":"both"},{"1":"42","2":"42","3":"34","4":"0","5":"long","6":"A","7":"79","8":"returned","9":"one"},{"1":"43","2":"43","3":"33","4":"2","5":"long","6":"A","7":"87","8":"returned","9":"neither"},{"1":"44","2":"44","3":"34","4":"6","5":"long","6":"A","7":"91","8":"returned","9":"both"},{"1":"45","2":"45","3":"36","4":"1","5":"long","6":"A","7":"297","8":"returned","9":"one"},{"1":"46","2":"46","3":"27","4":"0","5":"long","6":"A","7":"45","8":"returned","9":"both"},{"1":"47","2":"47","3":"35","4":"1","5":"long","6":"A","7":"246","8":"returned","9":"neither"},{"1":"48","2":"48","3":"24","4":"0","5":"long","6":"A","7":"37","8":"returned","9":"both"},{"1":"49","2":"49","3":"28","4":"2","5":"long","6":"A","7":"37","8":"returned","9":"neither"},{"1":"50","2":"50","3":"46","4":"8","5":"long","6":"A","7":"538","8":"no-return","9":"both"},{"1":"51","2":"51","3":"26","4":"1","5":"long","6":"A","7":"541","8":"no-return","9":"both"},{"1":"52","2":"52","3":"42","4":"25","5":"long","6":"A","7":"184","8":"returned","9":"both"},{"1":"53","2":"53","3":"30","4":"0","5":"long","6":"A","7":"122","8":"returned","9":"both"},{"1":"54","2":"54","3":"33","4":"2","5":"long","6":"A","7":"5","8":"returned","9":"neither"},{"1":"55","2":"55","3":"30","4":"3","5":"long","6":"A","7":"156","8":"returned","9":"neither"},{"1":"56","2":"56","3":"27","4":"2","5":"short","6":"A","7":"121","8":"returned","9":"one"},{"1":"57","2":"57","3":"38","4":"6","5":"short","6":"A","7":"231","8":"returned","9":"both"},{"1":"58","2":"58","3":"48","4":"10","5":"short","6":"A","7":"111","8":"returned","9":"neither"},{"1":"59","2":"59","3":"36","4":"10","5":"short","6":"A","7":"38","8":"returned","9":"both"},{"1":"60","2":"60","3":"28","4":"7","5":"short","6":"A","7":"15","8":"returned","9":"both"},{"1":"61","2":"61","3":"31","4":"5","5":"short","6":"A","7":"54","8":"returned","9":"neither"},{"1":"62","2":"62","3":"28","4":"5","5":"short","6":"A","7":"127","8":"returned","9":"one"},{"1":"63","2":"63","3":"28","4":"1","5":"short","6":"A","7":"105","8":"returned","9":"both"},{"1":"64","2":"64","3":"26","4":"2","5":"short","6":"A","7":"11","8":"returned","9":"one"},{"1":"65","2":"65","3":"34","4":"6","5":"short","6":"A","7":"153","8":"returned","9":"neither"},{"1":"66","2":"66","3":"26","4":"5","5":"short","6":"A","7":"11","8":"returned","9":"one"},{"1":"67","2":"67","3":"32","4":"6","5":"short","6":"A","7":"79","8":"returned","9":"neither"},{"1":"68","2":"68","3":"31","4":"5","5":"short","6":"A","7":"46","8":"returned","9":"both"},{"1":"69","2":"69","3":"41","4":"0","5":"short","6":"A","7":"655","8":"no-return","9":"both"},{"1":"70","2":"70","3":"30","4":"0","5":"short","6":"A","7":"166","8":"returned","9":"neither"},{"1":"71","2":"71","3":"35","4":"1","5":"short","6":"A","7":"6","8":"returned","9":"neither"},{"1":"72","2":"72","3":"39","4":"5","5":"short","6":"A","7":"95","8":"returned","9":"neither"},{"1":"73","2":"73","3":"43","4":"12","5":"short","6":"A","7":"83","8":"returned","9":"one"},{"1":"74","2":"74","3":"33","4":"12","5":"short","6":"A","7":"151","8":"returned","9":"one"},{"1":"75","2":"75","3":"33","4":"6","5":"short","6":"A","7":"220","8":"returned","9":"neither"},{"1":"76","2":"76","3":"29","4":"0","5":"short","6":"A","7":"227","8":"returned","9":"neither"},{"1":"77","2":"77","3":"36","4":"5","5":"short","6":"A","7":"343","8":"returned","9":"both"},{"1":"78","2":"78","3":"26","4":"3","5":"short","6":"A","7":"119","8":"returned","9":"neither"},{"1":"79","2":"79","3":"37","4":"13","5":"short","6":"A","7":"43","8":"returned","9":"both"},{"1":"80","2":"80","3":"42","4":"8","5":"short","6":"A","7":"545","8":"no-return","9":"both"},{"1":"81","2":"81","3":"29","4":"8","5":"short","6":"A","7":"47","8":"returned","9":"both"},{"1":"82","2":"82","3":"34","4":"3","5":"short","6":"A","7":"15","8":"returned","9":"both"},{"1":"83","2":"83","3":"30","4":"0","5":"short","6":"A","7":"805","8":"no-return","9":"both"},{"1":"84","2":"84","3":"35","4":"2","5":"short","6":"A","7":"321","8":"returned","9":"both"},{"1":"85","2":"85","3":"33","4":"1","5":"short","6":"A","7":"167","8":"returned","9":"both"},{"1":"86","2":"86","3":"30","4":"4","5":"short","6":"A","7":"107","8":"returned","9":"both"},{"1":"87","2":"87","3":"36","4":"1","5":"short","6":"A","7":"491","8":"returned","9":"one"},{"1":"88","2":"88","3":"28","4":"2","5":"short","6":"A","7":"35","8":"returned","9":"both"},{"1":"89","2":"89","3":"31","4":"12","5":"short","6":"A","7":"123","8":"returned","9":"both"},{"1":"90","2":"90","3":"23","4":"2","5":"short","6":"A","7":"597","8":"no-return","9":"both"},{"1":"91","2":"91","3":"33","4":"1","5":"short","6":"A","7":"762","8":"no-return","9":"both"},{"1":"92","2":"92","3":"26","4":"5","5":"short","6":"A","7":"13","8":"returned","9":"both"},{"1":"93","2":"93","3":"37","4":"4","5":"short","6":"A","7":"31","8":"returned","9":"one"},{"1":"94","2":"94","3":"25","4":"1","5":"long","6":"A","7":"228","8":"returned","9":"both"},{"1":"95","2":"95","3":"56","4":"9","5":"long","6":"A","7":"553","8":"no-return","9":"one"},{"1":"96","2":"96","3":"23","4":"1","5":"long","6":"A","7":"190","8":"returned","9":"both"},{"1":"97","2":"97","3":"26","4":"1","5":"long","6":"A","7":"307","8":"returned","9":"both"},{"1":"98","2":"98","3":"26","4":"1","5":"long","6":"A","7":"73","8":"returned","9":"both"},{"1":"99","2":"99","3":"23","4":"1","5":"long","6":"A","7":"208","8":"returned","9":"both"},{"1":"100","2":"100","3":"28","4":"2","5":"long","6":"A","7":"267","8":"returned","9":"neither"},{"1":"101","2":"101","3":"33","4":"6","5":"long","6":"A","7":"2","8":"returned","9":"neither"},{"1":"102","2":"102","3":"30","4":"15","5":"long","6":"A","7":"169","8":"returned","9":"both"},{"1":"103","2":"103","3":"32","4":"2","5":"long","6":"A","7":"125","8":"returned","9":"neither"},{"1":"104","2":"104","3":"25","4":"5","5":"long","6":"A","7":"655","8":"no-return","9":"one"},{"1":"105","2":"105","3":"33","4":"5","5":"long","6":"A","7":"70","8":"returned","9":"both"},{"1":"106","2":"106","3":"22","4":"3","5":"long","6":"A","7":"398","8":"returned","9":"both"},{"1":"107","2":"107","3":"28","4":"1","5":"long","6":"A","7":"59","8":"returned","9":"one"},{"1":"108","2":"108","3":"25","4":"8","5":"long","6":"A","7":"122","8":"returned","9":"neither"},{"1":"109","2":"109","3":"30","4":"1","5":"long","6":"A","7":"29","8":"returned","9":"neither"},{"1":"111","2":"111","3":"38","4":"1","5":"short","6":"A","7":"96","8":"returned","9":"both"},{"1":"112","2":"112","3":"35","4":"3","5":"long","6":"A","7":"1172","8":"no-return","9":"one"},{"1":"113","2":"113","3":"35","4":"1","5":"short","6":"A","7":"734","8":"no-return","9":"both"},{"1":"114","2":"114","3":"25","4":"1","5":"short","6":"A","7":"26","8":"returned","9":"both"},{"1":"115","2":"115","3":"33","4":"3","5":"short","6":"A","7":"84","8":"returned","9":"both"},{"1":"116","2":"116","3":"30","4":"2","5":"short","6":"A","7":"171","8":"returned","9":"both"},{"1":"117","2":"117","3":"45","4":"1","5":"short","6":"A","7":"159","8":"returned","9":"one"},{"1":"118","2":"118","3":"29","4":"3","5":"short","6":"A","7":"5","8":"returned","9":"neither"},{"1":"119","2":"119","3":"42","4":"20","5":"short","6":"A","7":"7","8":"returned","9":"one"},{"1":"120","2":"120","3":"29","4":"1","5":"short","6":"A","7":"763","8":"no-return","9":"neither"},{"1":"121","2":"121","3":"24","4":"0","5":"short","6":"A","7":"104","8":"returned","9":"both"},{"1":"122","2":"122","3":"33","4":"4","5":"short","6":"A","7":"162","8":"returned","9":"one"},{"1":"123","2":"123","3":"32","4":"0","5":"short","6":"A","7":"90","8":"returned","9":"both"},{"1":"124","2":"124","3":"26","4":"0","5":"short","6":"A","7":"373","8":"returned","9":"both"},{"1":"125","2":"125","3":"28","4":"3","5":"short","6":"A","7":"115","8":"returned","9":"both"},{"1":"126","2":"126","3":"36","4":"3","5":"short","6":"A","7":"67","8":"returned","9":"neither"},{"1":"127","2":"127","3":"37","4":"1","5":"short","6":"A","7":"30","8":"returned","9":"one"},{"1":"128","2":"128","3":"23","4":"6","5":"short","6":"A","7":"8","8":"returned","9":"neither"},{"1":"129","2":"129","3":"40","4":"3","5":"short","6":"A","7":"168","8":"returned","9":"one"},{"1":"130","2":"130","3":"36","4":"0","5":"short","6":"A","7":"70","8":"returned","9":"both"},{"1":"131","2":"131","3":"23","4":"2","5":"short","6":"A","7":"130","8":"returned","9":"both"},{"1":"132","2":"132","3":"35","4":"1","5":"short","6":"A","7":"285","8":"returned","9":"neither"},{"1":"133","2":"133","3":"25","4":"1","5":"long","6":"A","7":"569","8":"no-return","9":"one"},{"1":"134","2":"134","3":"35","4":"6","5":"long","6":"A","7":"87","8":"returned","9":"one"},{"1":"135","2":"135","3":"46","4":"0","5":"long","6":"A","7":"310","8":"returned","9":"neither"},{"1":"136","2":"136","3":"32","4":"3","5":"long","6":"A","7":"87","8":"returned","9":"neither"},{"1":"137","2":"137","3":"35","4":"16","5":"long","6":"A","7":"544","8":"no-return","9":"both"},{"1":"138","2":"138","3":"34","4":"1","5":"long","6":"A","7":"156","8":"returned","9":"both"},{"1":"139","2":"139","3":"43","4":"3","5":"long","6":"A","7":"658","8":"no-return","9":"both"},{"1":"140","2":"140","3":"39","4":"15","5":"long","6":"A","7":"273","8":"returned","9":"neither"},{"1":"141","2":"141","3":"27","4":"2","5":"long","6":"A","7":"168","8":"returned","9":"neither"},{"1":"142","2":"142","3":"38","4":"1","5":"long","6":"A","7":"83","8":"returned","9":"both"},{"1":"143","2":"143","3":"37","4":"7","5":"long","6":"A","7":"4","8":"returned","9":"one"},{"1":"144","2":"144","3":"44","4":"4","5":"long","6":"A","7":"708","8":"no-return","9":"both"},{"1":"145","2":"145","3":"25","4":"1","5":"long","6":"A","7":"137","8":"returned","9":"neither"},{"1":"146","2":"146","3":"34","4":"1","5":"long","6":"A","7":"259","8":"returned","9":"both"},{"1":"147","2":"147","3":"34","4":"2","5":"long","6":"A","7":"560","8":"no-return","9":"both"},{"1":"148","2":"148","3":"38","4":"1","5":"long","6":"A","7":"586","8":"no-return","9":"both"},{"1":"149","2":"149","3":"24","4":"2","5":"long","6":"A","7":"190","8":"returned","9":"one"},{"1":"151","2":"151","3":"42","4":"3","5":"long","6":"A","7":"544","8":"no-return","9":"one"},{"1":"152","2":"152","3":"22","4":"3","5":"long","6":"A","7":"3","8":"returned","9":"neither"},{"1":"153","2":"153","3":"34","4":"1","5":"short","6":"A","7":"494","8":"returned","9":"neither"},{"1":"154","2":"154","3":"45","4":"8","5":"short","6":"A","7":"541","8":"no-return","9":"both"},{"1":"155","2":"155","3":"40","4":"4","5":"short","6":"A","7":"94","8":"returned","9":"one"},{"1":"156","2":"156","3":"27","4":"3","5":"short","6":"A","7":"567","8":"no-return","9":"neither"},{"1":"157","2":"157","3":"24","4":"3","5":"short","6":"A","7":"55","8":"returned","9":"neither"},{"1":"158","2":"158","3":"27","4":"3","5":"short","6":"A","7":"93","8":"returned","9":"both"},{"1":"159","2":"159","3":"34","4":"4","5":"short","6":"A","7":"276","8":"returned","9":"both"},{"1":"160","2":"160","3":"36","4":"6","5":"short","6":"A","7":"46","8":"returned","9":"one"},{"1":"161","2":"161","3":"37","4":"6","5":"short","6":"A","7":"4","8":"returned","9":"neither"},{"1":"162","2":"162","3":"31","4":"1","5":"short","6":"A","7":"250","8":"returned","9":"both"},{"1":"163","2":"163","3":"40","4":"2","5":"short","6":"A","7":"106","8":"returned","9":"one"},{"1":"164","2":"164","3":"40","4":"4","5":"short","6":"A","7":"552","8":"no-return","9":"both"},{"1":"165","2":"165","3":"37","4":"5","5":"short","6":"A","7":"90","8":"returned","9":"one"},{"1":"166","2":"166","3":"25","4":"6","5":"short","6":"A","7":"203","8":"returned","9":"neither"},{"1":"167","2":"167","3":"41","4":"3","5":"long","6":"A","7":"67","8":"returned","9":"one"},{"1":"168","2":"168","3":"22","4":"1","5":"long","6":"A","7":"559","8":"returned","9":"neither"},{"1":"169","2":"169","3":"31","4":"8","5":"long","6":"A","7":"106","8":"returned","9":"one"},{"1":"170","2":"170","3":"29","4":"1","5":"long","6":"A","7":"374","8":"returned","9":"both"},{"1":"171","2":"171","3":"27","4":"2","5":"long","6":"A","7":"630","8":"no-return","9":"both"},{"1":"172","2":"172","3":"22","4":"3","5":"long","6":"A","7":"61","8":"returned","9":"neither"},{"1":"173","2":"173","3":"42","4":"6","5":"long","6":"A","7":"560","8":"no-return","9":"neither"},{"1":"174","2":"174","3":"37","4":"5","5":"long","6":"A","7":"547","8":"no-return","9":"both"},{"1":"175","2":"175","3":"36","4":"2","5":"long","6":"A","7":"568","8":"no-return","9":"both"},{"1":"176","2":"176","3":"24","4":"1","5":"long","6":"A","7":"490","8":"returned","9":"both"},{"1":"177","2":"177","3":"28","4":"0","5":"long","6":"A","7":"222","8":"returned","9":"neither"},{"1":"178","2":"178","3":"24","4":"1","5":"long","6":"A","7":"56","8":"returned","9":"neither"},{"1":"179","2":"179","3":"28","4":"2","5":"long","6":"A","7":"282","8":"returned","9":"both"},{"1":"180","2":"180","3":"24","4":"20","5":"long","6":"A","7":"35","8":"returned","9":"both"},{"1":"181","2":"181","3":"24","4":"0","5":"long","6":"A","7":"603","8":"no-return","9":"neither"},{"1":"183","2":"183","3":"29","4":"1","5":"long","6":"A","7":"148","8":"returned","9":"both"},{"1":"184","2":"184","3":"37","4":"5","5":"long","6":"A","7":"354","8":"returned","9":"both"},{"1":"185","2":"185","3":"26","4":"2","5":"long","6":"A","7":"164","8":"returned","9":"both"},{"1":"186","2":"186","3":"29","4":"1","5":"long","6":"A","7":"94","8":"returned","9":"both"},{"1":"187","2":"187","3":"29","4":"4","5":"long","6":"A","7":"65","8":"returned","9":"one"},{"1":"188","2":"188","3":"33","4":"1","5":"long","6":"A","7":"567","8":"no-return","9":"neither"},{"1":"189","2":"189","3":"29","4":"2","5":"long","6":"A","7":"634","8":"no-return","9":"neither"},{"1":"190","2":"190","3":"32","4":"2","5":"long","6":"A","7":"633","8":"no-return","9":"both"},{"1":"191","2":"191","3":"32","4":"4","5":"long","6":"A","7":"127","8":"returned","9":"both"},{"1":"192","2":"192","3":"33","4":"8","5":"long","6":"A","7":"477","8":"returned","9":"neither"},{"1":"193","2":"193","3":"26","4":"2","5":"long","6":"A","7":"436","8":"returned","9":"neither"},{"1":"195","2":"195","3":"24","4":"4","5":"long","6":"A","7":"362","8":"returned","9":"one"},{"1":"196","2":"196","3":"46","4":"2","5":"long","6":"A","7":"552","8":"no-return","9":"one"},{"1":"197","2":"197","3":"23","4":"2","5":"long","6":"A","7":"144","8":"returned","9":"neither"},{"1":"198","2":"198","3":"40","4":"8","5":"long","6":"A","7":"242","8":"returned","9":"neither"},{"1":"199","2":"199","3":"48","4":"4","5":"long","6":"A","7":"564","8":"no-return","9":"both"},{"1":"200","2":"200","3":"33","4":"0","5":"long","6":"A","7":"299","8":"returned","9":"both"},{"1":"201","2":"201","3":"21","4":"7","5":"long","6":"A","7":"167","8":"returned","9":"neither"},{"1":"202","2":"202","3":"38","4":"2","5":"long","6":"A","7":"380","8":"returned","9":"both"},{"1":"203","2":"203","3":"28","4":"4","5":"long","6":"A","7":"120","8":"returned","9":"neither"},{"1":"204","2":"204","3":"30","4":"6","5":"short","6":"A","7":"248","8":"returned","9":"one"},{"1":"205","2":"205","3":"39","4":"6","5":"long","6":"A","7":"218","8":"returned","9":"both"},{"1":"206","2":"206","3":"37","4":"1","5":"short","6":"A","7":"115","8":"returned","9":"both"},{"1":"207","2":"207","3":"32","4":"4","5":"short","6":"A","7":"224","8":"returned","9":"both"},{"1":"208","2":"208","3":"39","4":"2","5":"short","6":"A","7":"132","8":"returned","9":"both"},{"1":"209","2":"209","3":"28","4":"10","5":"short","6":"A","7":"148","8":"returned","9":"both"},{"1":"210","2":"210","3":"26","4":"0","5":"short","6":"A","7":"593","8":"no-return","9":"both"},{"1":"211","2":"211","3":"31","4":"0","5":"short","6":"A","7":"26","8":"returned","9":"both"},{"1":"213","2":"213","3":"34","4":"8","5":"short","6":"A","7":"32","8":"returned","9":"neither"},{"1":"214","2":"214","3":"26","4":"2","5":"short","6":"A","7":"292","8":"returned","9":"neither"},{"1":"215","2":"215","3":"29","4":"3","5":"short","6":"A","7":"89","8":"returned","9":"neither"},{"1":"216","2":"216","3":"33","4":"7","5":"short","6":"A","7":"21","8":"returned","9":"one"},{"1":"217","2":"217","3":"25","4":"8","5":"short","6":"A","7":"364","8":"returned","9":"both"},{"1":"218","2":"218","3":"34","4":"3","5":"short","6":"A","7":"142","8":"returned","9":"both"},{"1":"219","2":"219","3":"32","4":"2","5":"short","6":"A","7":"188","8":"returned","9":"both"},{"1":"220","2":"220","3":"39","4":"0","5":"short","6":"A","7":"4","8":"returned","9":"neither"},{"1":"221","2":"221","3":"38","4":"0","5":"short","6":"A","7":"92","8":"returned","9":"neither"},{"1":"222","2":"222","3":"32","4":"8","5":"short","6":"A","7":"56","8":"returned","9":"both"},{"1":"223","2":"223","3":"31","4":"7","5":"short","6":"A","7":"110","8":"returned","9":"one"},{"1":"224","2":"224","3":"40","4":"3","5":"short","6":"A","7":"555","8":"no-return","9":"both"},{"1":"225","2":"225","3":"28","4":"5","5":"short","6":"A","7":"220","8":"returned","9":"neither"},{"1":"226","2":"226","3":"40","4":"3","5":"short","6":"A","7":"23","8":"returned","9":"both"},{"1":"227","2":"227","3":"32","4":"3","5":"short","6":"A","7":"285","8":"returned","9":"one"},{"1":"228","2":"228","3":"29","4":"5","5":"short","6":"A","7":"90","8":"returned","9":"both"},{"1":"229","2":"229","3":"25","4":"4","5":"short","6":"A","7":"59","8":"returned","9":"both"},{"1":"230","2":"230","3":"32","4":"2","5":"short","6":"A","7":"156","8":"returned","9":"one"},{"1":"231","2":"231","3":"36","4":"2","5":"short","6":"A","7":"194","8":"returned","9":"neither"},{"1":"232","2":"232","3":"37","4":"2","5":"short","6":"A","7":"142","8":"returned","9":"one"},{"1":"233","2":"233","3":"38","4":"8","5":"short","6":"A","7":"57","8":"returned","9":"both"},{"1":"234","2":"234","3":"31","4":"9","5":"short","6":"A","7":"279","8":"returned","9":"both"},{"1":"235","2":"235","3":"30","4":"3","5":"short","6":"A","7":"118","8":"returned","9":"both"},{"1":"236","2":"236","3":"34","4":"4","5":"short","6":"A","7":"567","8":"no-return","9":"neither"},{"1":"237","2":"237","3":"33","4":"4","5":"long","6":"A","7":"562","8":"no-return","9":"both"},{"1":"238","2":"238","3":"36","4":"10","5":"long","6":"A","7":"239","8":"returned","9":"both"},{"1":"239","2":"239","3":"32","4":"0","5":"long","6":"A","7":"578","8":"no-return","9":"neither"},{"1":"240","2":"240","3":"29","4":"2","5":"long","6":"A","7":"551","8":"no-return","9":"one"},{"1":"241","2":"241","3":"32","4":"4","5":"long","6":"A","7":"313","8":"returned","9":"both"},{"1":"242","2":"242","3":"34","4":"7","5":"long","6":"A","7":"560","8":"no-return","9":"both"},{"1":"243","2":"243","3":"26","4":"31","5":"long","6":"A","7":"54","8":"returned","9":"both"},{"1":"244","2":"244","3":"25","4":"5","5":"long","6":"A","7":"198","8":"returned","9":"both"},{"1":"245","2":"245","3":"30","4":"2","5":"long","6":"A","7":"164","8":"returned","9":"neither"},{"1":"246","2":"246","3":"33","4":"6","5":"long","6":"A","7":"325","8":"returned","9":"both"},{"1":"247","2":"247","3":"40","4":"6","5":"long","6":"A","7":"62","8":"returned","9":"neither"},{"1":"248","2":"248","3":"26","4":"12","5":"long","6":"A","7":"45","8":"returned","9":"both"},{"1":"249","2":"249","3":"26","4":"5","5":"long","6":"A","7":"53","8":"returned","9":"both"},{"1":"250","2":"250","3":"35","4":"4","5":"long","6":"A","7":"253","8":"returned","9":"neither"},{"1":"251","2":"251","3":"26","4":"11","5":"long","6":"A","7":"51","8":"returned","9":"one"},{"1":"252","2":"252","3":"33","4":"3","5":"long","6":"A","7":"540","8":"no-return","9":"neither"},{"1":"253","2":"253","3":"27","4":"4","5":"long","6":"A","7":"317","8":"returned","9":"both"},{"1":"254","2":"254","3":"29","4":"3","5":"long","6":"A","7":"437","8":"returned","9":"both"},{"1":"255","2":"255","3":"29","4":"9","5":"long","6":"A","7":"136","8":"returned","9":"both"},{"1":"256","2":"256","3":"39","4":"7","5":"long","6":"A","7":"115","8":"returned","9":"one"},{"1":"257","2":"257","3":"43","4":"2","5":"long","6":"A","7":"175","8":"returned","9":"both"},{"1":"258","2":"258","3":"35","4":"3","5":"long","6":"A","7":"442","8":"returned","9":"both"},{"1":"259","2":"259","3":"26","4":"2","5":"long","6":"A","7":"122","8":"returned","9":"neither"},{"1":"260","2":"260","3":"27","4":"3","5":"long","6":"A","7":"181","8":"returned","9":"neither"},{"1":"261","2":"261","3":"28","4":"2","5":"long","6":"A","7":"180","8":"returned","9":"neither"},{"1":"262","2":"262","3":"30","4":"4","5":"long","6":"A","7":"51","8":"returned","9":"both"},{"1":"263","2":"263","3":"31","4":"1","5":"long","6":"A","7":"541","8":"no-return","9":"neither"},{"1":"264","2":"264","3":"26","4":"16","5":"long","6":"A","7":"121","8":"returned","9":"one"},{"1":"265","2":"265","3":"36","4":"4","5":"long","6":"A","7":"328","8":"returned","9":"neither"},{"1":"267","2":"267","3":"25","4":"3","5":"long","6":"A","7":"166","8":"returned","9":"one"},{"1":"268","2":"268","3":"26","4":"0","5":"long","6":"A","7":"556","8":"no-return","9":"both"},{"1":"269","2":"269","3":"30","4":"5","5":"short","6":"A","7":"104","8":"returned","9":"one"},{"1":"270","2":"270","3":"28","4":"5","5":"short","6":"A","7":"102","8":"returned","9":"both"},{"1":"272","2":"272","3":"34","4":"0","5":"short","6":"A","7":"144","8":"returned","9":"both"},{"1":"273","2":"273","3":"31","4":"2","5":"short","6":"A","7":"545","8":"no-return","9":"both"},{"1":"274","2":"274","3":"30","4":"1","5":"short","6":"A","7":"537","8":"no-return","9":"neither"},{"1":"275","2":"275","3":"35","4":"5","5":"short","6":"A","7":"625","8":"no-return","9":"both"},{"1":"276","2":"276","3":"30","4":"3","5":"short","6":"A","7":"6","8":"returned","9":"neither"},{"1":"277","2":"277","3":"37","4":"7","5":"short","6":"A","7":"307","8":"returned","9":"both"},{"1":"278","2":"278","3":"29","4":"12","5":"short","6":"A","7":"290","8":"returned","9":"neither"},{"1":"279","2":"279","3":"23","4":"8","5":"short","6":"A","7":"20","8":"returned","9":"neither"},{"1":"280","2":"280","3":"23","4":"4","5":"short","6":"A","7":"74","8":"returned","9":"both"},{"1":"281","2":"281","3":"44","4":"0","5":"short","6":"A","7":"100","8":"returned","9":"neither"},{"1":"282","2":"282","3":"43","4":"8","5":"short","6":"A","7":"555","8":"no-return","9":"neither"},{"1":"283","2":"283","3":"38","4":"3","5":"short","6":"A","7":"152","8":"returned","9":"one"},{"1":"284","2":"284","3":"33","4":"3","5":"short","6":"A","7":"115","8":"returned","9":"both"},{"1":"285","2":"285","3":"36","4":"9","5":"short","6":"A","7":"92","8":"returned","9":"both"},{"1":"286","2":"286","3":"26","4":"2","5":"short","6":"A","7":"554","8":"no-return","9":"both"},{"1":"287","2":"287","3":"30","4":"0","5":"short","6":"A","7":"92","8":"returned","9":"neither"},{"1":"288","2":"288","3":"34","4":"0","5":"short","6":"A","7":"69","8":"returned","9":"neither"},{"1":"289","2":"289","3":"32","4":"6","5":"short","6":"A","7":"25","8":"returned","9":"one"},{"1":"290","2":"290","3":"30","4":"1","5":"short","6":"A","7":"501","8":"no-return","9":"both"},{"1":"291","2":"291","3":"37","4":"10","5":"short","6":"A","7":"86","8":"returned","9":"one"},{"1":"292","2":"292","3":"35","4":"7","5":"short","6":"A","7":"99","8":"returned","9":"one"},{"1":"293","2":"293","3":"30","4":"0","5":"short","6":"A","7":"87","8":"returned","9":"both"},{"1":"294","2":"294","3":"34","4":"6","5":"short","6":"A","7":"136","8":"returned","9":"neither"},{"1":"295","2":"295","3":"40","4":"6","5":"short","6":"A","7":"106","8":"returned","9":"both"},{"1":"296","2":"296","3":"28","4":"3","5":"short","6":"A","7":"220","8":"returned","9":"neither"},{"1":"297","2":"297","3":"32","4":"6","5":"short","6":"A","7":"36","8":"returned","9":"both"},{"1":"298","2":"298","3":"45","4":"2","5":"short","6":"A","7":"162","8":"returned","9":"both"},{"1":"299","2":"299","3":"24","4":"0","5":"long","6":"A","7":"116","8":"returned","9":"one"},{"1":"300","2":"300","3":"43","4":"5","5":"long","6":"A","7":"175","8":"returned","9":"both"},{"1":"301","2":"301","3":"38","4":"0","5":"long","6":"A","7":"209","8":"returned","9":"both"},{"1":"302","2":"302","3":"33","4":"1","5":"long","6":"A","7":"545","8":"no-return","9":"one"},{"1":"303","2":"303","3":"26","4":"2","5":"long","6":"A","7":"245","8":"returned","9":"neither"},{"1":"304","2":"304","3":"40","4":"3","5":"long","6":"A","7":"176","8":"returned","9":"neither"},{"1":"305","2":"305","3":"27","4":"0","5":"long","6":"A","7":"14","8":"returned","9":"neither"},{"1":"306","2":"306","3":"39","4":"12","5":"long","6":"A","7":"113","8":"returned","9":"one"},{"1":"307","2":"307","3":"29","4":"2","5":"long","6":"A","7":"159","8":"returned","9":"neither"},{"1":"308","2":"308","3":"29","4":"3","5":"long","6":"A","7":"354","8":"returned","9":"neither"},{"1":"309","2":"309","3":"28","4":"4","5":"long","6":"A","7":"174","8":"returned","9":"neither"},{"1":"310","2":"310","3":"37","4":"20","5":"short","6":"A","7":"23","8":"returned","9":"both"},{"1":"311","2":"311","3":"37","4":"20","5":"short","6":"A","7":"26","8":"returned","9":"one"},{"1":"312","2":"312","3":"40","4":"9","5":"short","6":"A","7":"98","8":"returned","9":"neither"},{"1":"313","2":"313","3":"25","4":"5","5":"short","6":"A","7":"23","8":"returned","9":"both"},{"1":"314","2":"314","3":"40","4":"2","5":"short","6":"A","7":"555","8":"no-return","9":"both"},{"1":"315","2":"315","3":"40","4":"4","5":"short","6":"A","7":"290","8":"returned","9":"both"},{"1":"316","2":"316","3":"34","4":"8","5":"short","6":"A","7":"543","8":"no-return","9":"one"},{"1":"317","2":"317","3":"41","4":"7","5":"short","6":"A","7":"274","8":"returned","9":"one"},{"1":"319","2":"319","3":"32","4":"5","5":"short","6":"A","7":"3","8":"returned","9":"neither"},{"1":"320","2":"320","3":"37","4":"0","5":"long","6":"A","7":"5","8":"returned","9":"neither"},{"1":"321","2":"321","3":"23","4":"1","5":"long","6":"A","7":"119","8":"returned","9":"neither"},{"1":"322","2":"322","3":"36","4":"3","5":"long","6":"A","7":"164","8":"returned","9":"both"},{"1":"323","2":"323","3":"28","4":"2","5":"long","6":"A","7":"548","8":"no-return","9":"neither"},{"1":"324","2":"324","3":"23","4":"3","5":"long","6":"A","7":"175","8":"returned","9":"both"},{"1":"325","2":"325","3":"27","4":"3","5":"long","6":"A","7":"539","8":"no-return","9":"both"},{"1":"326","2":"326","3":"32","4":"0","5":"long","6":"A","7":"155","8":"returned","9":"neither"},{"1":"327","2":"327","3":"38","4":"15","5":"long","6":"A","7":"14","8":"returned","9":"neither"},{"1":"328","2":"328","3":"38","4":"6","5":"long","6":"A","7":"187","8":"returned","9":"neither"},{"1":"329","2":"329","3":"45","4":"8","5":"long","6":"A","7":"65","8":"returned","9":"both"},{"1":"330","2":"330","3":"26","4":"1","5":"long","6":"A","7":"159","8":"returned","9":"one"},{"1":"331","2":"331","3":"29","4":"35","5":"long","6":"A","7":"96","8":"returned","9":"both"},{"1":"332","2":"332","3":"33","4":"3","5":"long","6":"A","7":"243","8":"returned","9":"neither"},{"1":"333","2":"333","3":"25","4":"0","5":"long","6":"A","7":"85","8":"returned","9":"both"},{"1":"334","2":"334","3":"36","4":"2","5":"long","6":"A","7":"4","8":"returned","9":"neither"},{"1":"335","2":"335","3":"37","4":"4","5":"long","6":"A","7":"121","8":"returned","9":"one"},{"1":"336","2":"336","3":"29","4":"0","5":"long","6":"A","7":"659","8":"returned","9":"neither"},{"1":"337","2":"337","3":"29","4":"3","5":"long","6":"A","7":"260","8":"returned","9":"neither"},{"1":"338","2":"338","3":"35","4":"1","5":"long","6":"A","7":"621","8":"no-return","9":"neither"},{"1":"339","2":"339","3":"33","4":"1","5":"long","6":"A","7":"199","8":"returned","9":"neither"},{"1":"340","2":"340","3":"31","4":"2","5":"long","6":"A","7":"565","8":"no-return","9":"neither"},{"1":"341","2":"341","3":"37","4":"5","5":"long","6":"A","7":"183","8":"returned","9":"both"},{"1":"342","2":"342","3":"32","4":"4","5":"long","6":"A","7":"122","8":"returned","9":"both"},{"1":"343","2":"343","3":"33","4":"13","5":"long","6":"A","7":"170","8":"returned","9":"both"},{"1":"344","2":"344","3":"36","4":"14","5":"long","6":"A","7":"15","8":"returned","9":"both"},{"1":"345","2":"345","3":"26","4":"5","5":"long","6":"A","7":"268","8":"returned","9":"both"},{"1":"346","2":"346","3":"35","4":"0","5":"long","6":"A","7":"79","8":"returned","9":"both"},{"1":"347","2":"347","3":"25","4":"6","5":"short","6":"A","7":"23","8":"returned","9":"both"},{"1":"348","2":"348","3":"33","4":"30","5":"short","6":"A","7":"100","8":"returned","9":"both"},{"1":"349","2":"349","3":"36","4":"8","5":"short","6":"A","7":"98","8":"returned","9":"one"},{"1":"350","2":"350","3":"38","4":"6","5":"short","6":"A","7":"81","8":"returned","9":"both"},{"1":"351","2":"351","3":"36","4":"3","5":"short","6":"A","7":"546","8":"no-return","9":"both"},{"1":"352","2":"352","3":"36","4":"10","5":"short","6":"A","7":"58","8":"returned","9":"one"},{"1":"353","2":"353","3":"35","4":"6","5":"short","6":"A","7":"569","8":"no-return","9":"both"},{"1":"354","2":"354","3":"35","4":"3","5":"short","6":"A","7":"575","8":"no-return","9":"both"},{"1":"356","2":"356","3":"39","4":"4","5":"short","6":"A","7":"91","8":"returned","9":"one"},{"1":"357","2":"357","3":"37","4":"6","5":"short","6":"A","7":"57","8":"returned","9":"neither"},{"1":"358","2":"358","3":"30","4":"5","5":"short","6":"A","7":"499","8":"returned","9":"one"},{"1":"359","2":"359","3":"26","4":"7","5":"short","6":"A","7":"123","8":"returned","9":"both"},{"1":"360","2":"360","3":"39","4":"5","5":"short","6":"A","7":"143","8":"returned","9":"neither"},{"1":"362","2":"362","3":"32","4":"4","5":"short","6":"A","7":"471","8":"returned","9":"both"},{"1":"363","2":"363","3":"26","4":"4","5":"short","6":"A","7":"74","8":"returned","9":"both"},{"1":"364","2":"364","3":"33","4":"6","5":"short","6":"A","7":"85","8":"returned","9":"one"},{"1":"365","2":"365","3":"36","4":"5","5":"short","6":"A","7":"95","8":"returned","9":"neither"},{"1":"366","2":"366","3":"42","4":"3","5":"long","6":"A","7":"36","8":"returned","9":"one"},{"1":"367","2":"367","3":"37","4":"22","5":"long","6":"A","7":"19","8":"returned","9":"both"},{"1":"368","2":"368","3":"37","4":"1","5":"long","6":"A","7":"38","8":"returned","9":"one"},{"1":"369","2":"369","3":"32","4":"4","5":"long","6":"A","7":"539","8":"no-return","9":"both"},{"1":"370","2":"370","3":"23","4":"3","5":"long","6":"A","7":"567","8":"no-return","9":"neither"},{"1":"371","2":"371","3":"21","4":"10","5":"long","6":"A","7":"186","8":"returned","9":"neither"},{"1":"372","2":"372","3":"23","4":"1","5":"long","6":"A","7":"546","8":"no-return","9":"both"},{"1":"373","2":"373","3":"34","4":"1","5":"long","6":"A","7":"24","8":"returned","9":"neither"},{"1":"374","2":"374","3":"33","4":"3","5":"long","6":"A","7":"540","8":"no-return","9":"neither"},{"1":"375","2":"375","3":"33","4":"4","5":"long","6":"A","7":"157","8":"returned","9":"both"},{"1":"376","2":"376","3":"26","4":"0","5":"long","6":"A","7":"86","8":"returned","9":"both"},{"1":"377","2":"377","3":"28","4":"2","5":"long","6":"A","7":"231","8":"returned","9":"neither"},{"1":"379","2":"379","3":"27","4":"3","5":"short","6":"A","7":"14","8":"returned","9":"both"},{"1":"380","2":"380","3":"22","4":"2","5":"short","6":"A","7":"75","8":"returned","9":"both"},{"1":"381","2":"381","3":"31","4":"6","5":"short","6":"A","7":"147","8":"returned","9":"both"},{"1":"382","2":"382","3":"29","4":"4","5":"short","6":"A","7":"105","8":"returned","9":"both"},{"1":"383","2":"383","3":"44","4":"12","5":"short","6":"A","7":"324","8":"returned","9":"neither"},{"1":"384","2":"384","3":"26","4":"0","5":"short","6":"A","7":"538","8":"no-return","9":"both"},{"1":"385","2":"385","3":"44","4":"16","5":"short","6":"A","7":"300","8":"returned","9":"one"},{"1":"386","2":"386","3":"34","4":"1","5":"short","6":"A","7":"73","8":"returned","9":"both"},{"1":"387","2":"387","3":"36","4":"6","5":"short","6":"A","7":"65","8":"returned","9":"one"},{"1":"388","2":"388","3":"43","4":"20","5":"short","6":"A","7":"568","8":"returned","9":"one"},{"1":"389","2":"389","3":"37","4":"1","5":"short","6":"A","7":"84","8":"returned","9":"both"},{"1":"390","2":"390","3":"44","4":"17","5":"long","6":"A","7":"22","8":"returned","9":"neither"},{"1":"391","2":"391","3":"31","4":"30","5":"long","6":"A","7":"44","8":"returned","9":"both"},{"1":"392","2":"392","3":"24","4":"3","5":"long","6":"A","7":"7","8":"returned","9":"one"},{"1":"394","2":"394","3":"37","4":"4","5":"long","6":"A","7":"21","8":"returned","9":"both"},{"1":"395","2":"395","3":"41","4":"12","5":"long","6":"A","7":"537","8":"no-return","9":"both"},{"1":"396","2":"396","3":"32","4":"3","5":"long","6":"A","7":"186","8":"returned","9":"both"},{"1":"397","2":"397","3":"23","4":"2","5":"long","6":"A","7":"40","8":"returned","9":"both"},{"1":"398","2":"398","3":"33","4":"3","5":"long","6":"A","7":"287","8":"returned","9":"one"},{"1":"399","2":"399","3":"43","4":"9","5":"long","6":"A","7":"538","8":"no-return","9":"neither"},{"1":"400","2":"400","3":"33","4":"8","5":"long","6":"A","7":"30","8":"returned","9":"neither"},{"1":"401","2":"401","3":"41","4":"3","5":"long","6":"A","7":"516","8":"returned","9":"neither"},{"1":"402","2":"402","3":"41","4":"2","5":"long","6":"A","7":"268","8":"returned","9":"one"},{"1":"403","2":"403","3":"37","4":"3","5":"long","6":"A","7":"568","8":"no-return","9":"one"},{"1":"404","2":"404","3":"26","4":"3","5":"short","6":"A","7":"131","8":"returned","9":"both"},{"1":"405","2":"405","3":"33","4":"6","5":"short","6":"A","7":"399","8":"returned","9":"both"},{"1":"406","2":"406","3":"30","4":"2","5":"short","6":"A","7":"78","8":"returned","9":"both"},{"1":"407","2":"407","3":"33","4":"6","5":"short","6":"A","7":"80","8":"returned","9":"neither"},{"1":"408","2":"408","3":"33","4":"3","5":"short","6":"A","7":"102","8":"returned","9":"one"},{"1":"410","2":"410","3":"37","4":"6","5":"short","6":"A","7":"124","8":"returned","9":"both"},{"1":"411","2":"411","3":"44","4":"20","5":"short","6":"A","7":"80","8":"returned","9":"one"},{"1":"412","2":"412","3":"20","4":"1","5":"short","6":"A","7":"23","8":"returned","9":"neither"},{"1":"413","2":"413","3":"33","4":"4","5":"short","6":"A","7":"274","8":"returned","9":"both"},{"1":"415","2":"415","3":"36","4":"3","5":"short","6":"A","7":"459","8":"returned","9":"one"},{"1":"416","2":"416","3":"34","4":"3","5":"short","6":"A","7":"10","8":"returned","9":"one"},{"1":"417","2":"417","3":"35","4":"17","5":"long","6":"A","7":"176","8":"returned","9":"both"},{"1":"418","2":"418","3":"38","4":"26","5":"long","6":"A","7":"332","8":"returned","9":"one"},{"1":"419","2":"419","3":"24","4":"3","5":"long","6":"A","7":"119","8":"returned","9":"both"},{"1":"420","2":"420","3":"24","4":"4","5":"long","6":"A","7":"217","8":"returned","9":"both"},{"1":"421","2":"421","3":"32","4":"4","5":"long","6":"A","7":"285","8":"returned","9":"both"},{"1":"422","2":"422","3":"35","4":"3","5":"long","6":"A","7":"576","8":"no-return","9":"neither"},{"1":"423","2":"423","3":"33","4":"5","5":"long","6":"A","7":"106","8":"returned","9":"both"},{"1":"424","2":"424","3":"29","4":"4","5":"long","6":"A","7":"81","8":"returned","9":"one"},{"1":"425","2":"425","3":"42","4":"30","5":"long","6":"A","7":"47","8":"returned","9":"one"},{"1":"426","2":"426","3":"23","4":"1","5":"long","6":"A","7":"76","8":"returned","9":"neither"},{"1":"427","2":"427","3":"28","4":"16","5":"long","6":"A","7":"348","8":"returned","9":"neither"},{"1":"428","2":"428","3":"39","4":"5","5":"long","6":"A","7":"20","8":"returned","9":"neither"},{"1":"429","2":"429","3":"43","4":"4","5":"long","6":"A","7":"306","8":"returned","9":"one"},{"1":"430","2":"430","3":"33","4":"0","5":"short","6":"A","7":"192","8":"returned","9":"one"},{"1":"431","2":"431","3":"37","4":"20","5":"short","6":"A","7":"216","8":"returned","9":"both"},{"1":"432","2":"432","3":"49","4":"7","5":"short","6":"A","7":"189","8":"returned","9":"one"},{"1":"434","2":"434","3":"36","4":"1","5":"short","6":"A","7":"193","8":"returned","9":"both"},{"1":"435","2":"435","3":"27","4":"13","5":"short","6":"A","7":"28","8":"returned","9":"both"},{"1":"436","2":"436","3":"35","4":"1","5":"short","6":"A","7":"150","8":"returned","9":"both"},{"1":"437","2":"437","3":"25","4":"3","5":"short","6":"A","7":"99","8":"returned","9":"both"},{"1":"438","2":"438","3":"33","4":"3","5":"short","6":"A","7":"510","8":"no-return","9":"both"},{"1":"439","2":"439","3":"34","4":"7","5":"short","6":"A","7":"306","8":"returned","9":"both"},{"1":"440","2":"440","3":"38","4":"10","5":"short","6":"A","7":"101","8":"returned","9":"both"},{"1":"441","2":"441","3":"36","4":"0","5":"short","6":"A","7":"102","8":"returned","9":"one"},{"1":"442","2":"442","3":"27","4":"1","5":"short","6":"A","7":"510","8":"no-return","9":"both"},{"1":"444","2":"444","3":"40","4":"0","5":"short","6":"A","7":"503","8":"no-return","9":"both"},{"1":"445","2":"445","3":"32","4":"3","5":"short","6":"B","7":"52","8":"returned","9":"both"},{"1":"446","2":"446","3":"38","4":"1","5":"short","6":"B","7":"547","8":"no-return","9":"both"},{"1":"447","2":"447","3":"38","4":"6","5":"short","6":"B","7":"168","8":"returned","9":"both"},{"1":"448","2":"448","3":"23","4":"0","5":"short","6":"B","7":"461","8":"returned","9":"neither"},{"1":"449","2":"449","3":"26","4":"2","5":"short","6":"B","7":"538","8":"no-return","9":"neither"},{"1":"450","2":"450","3":"36","4":"7","5":"short","6":"B","7":"349","8":"returned","9":"one"},{"1":"451","2":"451","3":"30","4":"5","5":"short","6":"B","7":"44","8":"returned","9":"neither"},{"1":"452","2":"452","3":"31","4":"3","5":"long","6":"B","7":"548","8":"no-return","9":"neither"},{"1":"453","2":"453","3":"23","4":"1","5":"long","6":"B","7":"12","8":"returned","9":"both"},{"1":"454","2":"454","3":"43","4":"0","5":"long","6":"B","7":"6","8":"returned","9":"both"},{"1":"455","2":"455","3":"24","4":"1","5":"long","6":"B","7":"575","8":"no-return","9":"neither"},{"1":"456","2":"456","3":"42","4":"1","5":"long","6":"B","7":"589","8":"no-return","9":"neither"},{"1":"457","2":"457","3":"35","4":"1","5":"long","6":"B","7":"408","8":"returned","9":"neither"},{"1":"458","2":"458","3":"21","4":"0","5":"long","6":"B","7":"232","8":"returned","9":"neither"},{"1":"459","2":"459","3":"45","4":"0","5":"long","6":"B","7":"143","8":"returned","9":"neither"},{"1":"460","2":"460","3":"43","4":"6","5":"long","6":"B","7":"582","8":"no-return","9":"one"},{"1":"461","2":"461","3":"24","4":"0","5":"long","6":"B","7":"134","8":"returned","9":"neither"},{"1":"462","2":"462","3":"37","4":"1","5":"long","6":"B","7":"7","8":"returned","9":"both"},{"1":"463","2":"463","3":"40","4":"0","5":"long","6":"B","7":"548","8":"no-return","9":"neither"},{"1":"464","2":"464","3":"27","4":"2","5":"short","6":"B","7":"81","8":"returned","9":"both"},{"1":"465","2":"465","3":"29","4":"1","5":"short","6":"B","7":"170","8":"returned","9":"one"},{"1":"466","2":"466","3":"34","4":"6","5":"short","6":"B","7":"29","8":"returned","9":"neither"},{"1":"467","2":"467","3":"29","4":"20","5":"short","6":"B","7":"78","8":"returned","9":"both"},{"1":"468","2":"468","3":"35","4":"5","5":"short","6":"B","7":"81","8":"returned","9":"both"},{"1":"469","2":"469","3":"39","4":"4","5":"long","6":"B","7":"369","8":"returned","9":"both"},{"1":"470","2":"470","3":"41","4":"0","5":"long","6":"B","7":"69","8":"returned","9":"neither"},{"1":"471","2":"471","3":"37","4":"6","5":"long","6":"B","7":"115","8":"returned","9":"neither"},{"1":"472","2":"472","3":"30","4":"7","5":"long","6":"B","7":"361","8":"returned","9":"both"},{"1":"473","2":"473","3":"31","4":"0","5":"long","6":"B","7":"245","8":"returned","9":"neither"},{"1":"474","2":"474","3":"40","4":"8","5":"short","6":"B","7":"233","8":"returned","9":"neither"},{"1":"475","2":"475","3":"32","4":"0","5":"short","6":"B","7":"227","8":"returned","9":"neither"},{"1":"476","2":"476","3":"32","4":"3","5":"short","6":"B","7":"97","8":"returned","9":"neither"},{"1":"477","2":"477","3":"27","4":"0","5":"short","6":"B","7":"547","8":"no-return","9":"neither"},{"1":"478","2":"478","3":"23","4":"0","5":"short","6":"B","7":"224","8":"returned","9":"both"},{"1":"479","2":"479","3":"23","4":"2","5":"short","6":"B","7":"211","8":"returned","9":"neither"},{"1":"480","2":"480","3":"43","4":"12","5":"short","6":"B","7":"220","8":"returned","9":"one"},{"1":"481","2":"481","3":"24","4":"0","5":"short","6":"B","7":"54","8":"returned","9":"neither"},{"1":"482","2":"482","3":"36","4":"2","5":"short","6":"B","7":"192","8":"returned","9":"neither"},{"1":"483","2":"483","3":"29","4":"1","5":"short","6":"B","7":"138","8":"returned","9":"both"},{"1":"484","2":"484","3":"39","4":"1","5":"long","6":"B","7":"107","8":"returned","9":"neither"},{"1":"485","2":"485","3":"23","4":"0","5":"long","6":"B","7":"597","8":"no-return","9":"neither"},{"1":"486","2":"486","3":"27","4":"4","5":"long","6":"B","7":"226","8":"returned","9":"both"},{"1":"487","2":"487","3":"26","4":"5","5":"long","6":"B","7":"434","8":"returned","9":"neither"},{"1":"488","2":"488","3":"26","4":"1","5":"long","6":"B","7":"106","8":"returned","9":"both"},{"1":"489","2":"489","3":"25","4":"0","5":"long","6":"B","7":"180","8":"returned","9":"neither"},{"1":"490","2":"490","3":"34","4":"0","5":"long","6":"B","7":"557","8":"no-return","9":"both"},{"1":"491","2":"491","3":"45","4":"2","5":"long","6":"B","7":"556","8":"no-return","9":"neither"},{"1":"492","2":"492","3":"23","4":"1","5":"short","6":"B","7":"619","8":"no-return","9":"neither"},{"1":"493","2":"493","3":"26","4":"0","5":"short","6":"B","7":"546","8":"no-return","9":"neither"},{"1":"494","2":"494","3":"33","4":"2","5":"short","6":"B","7":"85","8":"returned","9":"neither"},{"1":"495","2":"495","3":"24","4":"2","5":"short","6":"B","7":"233","8":"returned","9":"both"},{"1":"496","2":"496","3":"30","4":"2","5":"short","6":"B","7":"102","8":"returned","9":"one"},{"1":"497","2":"497","3":"22","4":"0","5":"short","6":"B","7":"548","8":"no-return","9":"both"},{"1":"498","2":"498","3":"25","4":"1","5":"short","6":"B","7":"99","8":"returned","9":"both"},{"1":"499","2":"499","3":"30","4":"40","5":"short","6":"B","7":"36","8":"returned","9":"both"},{"1":"500","2":"500","3":"37","4":"8","5":"short","6":"B","7":"32","8":"returned","9":"neither"},{"1":"501","2":"501","3":"33","4":"0","5":"long","6":"B","7":"78","8":"returned","9":"neither"},{"1":"502","2":"502","3":"34","4":"8","5":"long","6":"B","7":"502","8":"returned","9":"both"},{"1":"503","2":"503","3":"29","4":"2","5":"long","6":"B","7":"71","8":"returned","9":"both"},{"1":"504","2":"504","3":"39","4":"6","5":"long","6":"B","7":"59","8":"returned","9":"neither"},{"1":"505","2":"505","3":"33","4":"1","5":"long","6":"B","7":"115","8":"returned","9":"both"},{"1":"506","2":"506","3":"26","4":"4","5":"long","6":"B","7":"533","8":"no-return","9":"both"},{"1":"507","2":"507","3":"32","4":"6","5":"long","6":"B","7":"10","8":"returned","9":"one"},{"1":"508","2":"508","3":"42","4":"2","5":"short","6":"B","7":"274","8":"returned","9":"both"},{"1":"509","2":"509","3":"39","4":"8","5":"short","6":"B","7":"255","8":"returned","9":"both"},{"1":"510","2":"510","3":"36","4":"0","5":"short","6":"B","7":"503","8":"no-return","9":"neither"},{"1":"511","2":"511","3":"22","4":"1","5":"short","6":"B","7":"256","8":"returned","9":"both"},{"1":"512","2":"512","3":"27","4":"1","5":"short","6":"B","7":"9","8":"returned","9":"neither"},{"1":"513","2":"513","3":"21","4":"3","5":"short","6":"B","7":"550","8":"no-return","9":"neither"},{"1":"514","2":"514","3":"28","4":"0","5":"short","6":"B","7":"386","8":"returned","9":"neither"},{"1":"515","2":"515","3":"36","4":"1","5":"long","6":"B","7":"547","8":"no-return","9":"both"},{"1":"516","2":"516","3":"31","4":"3","5":"long","6":"B","7":"45","8":"returned","9":"both"},{"1":"517","2":"517","3":"27","4":"4","5":"long","6":"B","7":"58","8":"returned","9":"both"},{"1":"518","2":"518","3":"23","4":"1","5":"long","6":"B","7":"124","8":"returned","9":"both"},{"1":"519","2":"519","3":"24","4":"20","5":"short","6":"B","7":"540","8":"no-return","9":"both"},{"1":"520","2":"520","3":"38","4":"1","5":"short","6":"B","7":"243","8":"returned","9":"both"},{"1":"521","2":"521","3":"25","4":"1","5":"long","6":"B","7":"549","8":"no-return","9":"neither"},{"1":"522","2":"522","3":"26","4":"0","5":"short","6":"B","7":"12","8":"returned","9":"both"},{"1":"523","2":"523","3":"22","4":"2","5":"short","6":"B","7":"51","8":"returned","9":"both"},{"1":"524","2":"524","3":"33","4":"2","5":"long","6":"B","7":"562","8":"no-return","9":"neither"},{"1":"525","2":"525","3":"30","4":"7","5":"long","6":"B","7":"94","8":"returned","9":"both"},{"1":"526","2":"526","3":"45","4":"3","5":"short","6":"B","7":"204","8":"returned","9":"neither"},{"1":"527","2":"527","3":"24","4":"0","5":"short","6":"B","7":"238","8":"returned","9":"both"},{"1":"528","2":"528","3":"27","4":"0","5":"long","6":"B","7":"140","8":"returned","9":"neither"},{"1":"529","2":"529","3":"36","4":"10","5":"long","6":"B","7":"120","8":"returned","9":"neither"},{"1":"530","2":"530","3":"38","4":"2","5":"short","6":"B","7":"154","8":"returned","9":"neither"},{"1":"531","2":"531","3":"31","4":"2","5":"long","6":"B","7":"177","8":"returned","9":"one"},{"1":"532","2":"532","3":"40","4":"7","5":"long","6":"B","7":"119","8":"returned","9":"neither"},{"1":"533","2":"533","3":"22","4":"0","5":"long","6":"B","7":"83","8":"returned","9":"both"},{"1":"534","2":"534","3":"31","4":"0","5":"long","6":"B","7":"130","8":"returned","9":"neither"},{"1":"535","2":"535","3":"23","4":"20","5":"long","6":"B","7":"11","8":"returned","9":"neither"},{"1":"536","2":"536","3":"39","4":"3","5":"short","6":"B","7":"159","8":"returned","9":"both"},{"1":"537","2":"537","3":"23","4":"1","5":"short","6":"B","7":"211","8":"returned","9":"neither"},{"1":"538","2":"538","3":"33","4":"1","5":"short","6":"B","7":"33","8":"returned","9":"both"},{"1":"539","2":"539","3":"27","4":"2","5":"long","6":"B","7":"72","8":"returned","9":"both"},{"1":"540","2":"540","3":"37","4":"2","5":"long","6":"B","7":"161","8":"returned","9":"neither"},{"1":"541","2":"541","3":"35","4":"25","5":"short","6":"B","7":"191","8":"returned","9":"neither"},{"1":"542","2":"542","3":"25","4":"5","5":"short","6":"B","7":"181","8":"returned","9":"both"},{"1":"543","2":"543","3":"27","4":"1","5":"long","6":"B","7":"546","8":"no-return","9":"both"},{"1":"544","2":"544","3":"34","4":"0","5":"short","6":"B","7":"540","8":"no-return","9":"neither"},{"1":"545","2":"545","3":"30","4":"3","5":"short","6":"B","7":"76","8":"returned","9":"both"},{"1":"546","2":"546","3":"35","4":"7","5":"short","6":"B","7":"7","8":"returned","9":"both"},{"1":"547","2":"547","3":"34","4":"0","5":"short","6":"B","7":"44","8":"returned","9":"neither"},{"1":"548","2":"548","3":"25","4":"5","5":"short","6":"B","7":"103","8":"returned","9":"both"},{"1":"549","2":"549","3":"34","4":"1","5":"short","6":"B","7":"79","8":"returned","9":"both"},{"1":"550","2":"550","3":"24","4":"3","5":"short","6":"B","7":"339","8":"returned","9":"neither"},{"1":"551","2":"551","3":"24","4":"2","5":"short","6":"B","7":"90","8":"returned","9":"neither"},{"1":"552","2":"552","3":"40","4":"3","5":"short","6":"B","7":"542","8":"no-return","9":"neither"},{"1":"553","2":"553","3":"33","4":"1","5":"short","6":"B","7":"384","8":"returned","9":"both"},{"1":"554","2":"554","3":"38","4":"1","5":"long","6":"B","7":"255","8":"returned","9":"neither"},{"1":"555","2":"555","3":"32","4":"0","5":"long","6":"B","7":"431","8":"returned","9":"both"},{"1":"556","2":"556","3":"33","4":"1","5":"short","6":"B","7":"587","8":"no-return","9":"neither"},{"1":"557","2":"557","3":"28","4":"2","5":"short","6":"B","7":"198","8":"returned","9":"both"},{"1":"558","2":"558","3":"31","4":"2","5":"short","6":"B","7":"551","8":"no-return","9":"both"},{"1":"559","2":"559","3":"31","4":"4","5":"long","6":"B","7":"110","8":"returned","9":"one"},{"1":"560","2":"560","3":"33","4":"0","5":"long","6":"B","7":"541","8":"no-return","9":"neither"},{"1":"561","2":"561","3":"24","4":"11","5":"short","6":"B","7":"242","8":"returned","9":"both"},{"1":"562","2":"562","3":"26","4":"3","5":"short","6":"B","7":"537","8":"no-return","9":"both"},{"1":"563","2":"563","3":"31","4":"7","5":"long","6":"B","7":"56","8":"returned","9":"one"},{"1":"564","2":"564","3":"40","4":"4","5":"long","6":"B","7":"34","8":"returned","9":"one"},{"1":"566","2":"566","3":"34","4":"3","5":"long","6":"B","7":"549","8":"no-return","9":"both"},{"1":"567","2":"567","3":"30","4":"7","5":"short","6":"B","7":"133","8":"returned","9":"both"},{"1":"568","2":"568","3":"36","4":"3","5":"short","6":"B","7":"226","8":"returned","9":"both"},{"1":"569","2":"569","3":"38","4":"6","5":"long","6":"B","7":"401","8":"returned","9":"one"},{"1":"570","2":"570","3":"31","4":"6","5":"long","6":"B","7":"14","8":"returned","9":"both"},{"1":"571","2":"571","3":"27","4":"2","5":"short","6":"B","7":"548","8":"no-return","9":"one"},{"1":"572","2":"572","3":"32","4":"15","5":"long","6":"B","7":"224","8":"returned","9":"both"},{"1":"573","2":"573","3":"35","4":"5","5":"short","6":"B","7":"540","8":"no-return","9":"both"},{"1":"574","2":"574","3":"44","4":"13","5":"short","6":"B","7":"237","8":"returned","9":"one"},{"1":"575","2":"575","3":"31","4":"10","5":"long","6":"B","7":"354","8":"returned","9":"one"},{"1":"576","2":"576","3":"28","4":"20","5":"short","6":"B","7":"123","8":"returned","9":"both"},{"1":"577","2":"577","3":"40","4":"1","5":"short","6":"B","7":"170","8":"returned","9":"neither"},{"1":"578","2":"578","3":"25","4":"10","5":"long","6":"B","7":"203","8":"returned","9":"both"},{"1":"579","2":"579","3":"32","4":"6","5":"long","6":"B","7":"360","8":"returned","9":"both"},{"1":"580","2":"580","3":"29","4":"2","5":"short","6":"B","7":"139","8":"returned","9":"neither"},{"1":"581","2":"581","3":"40","4":"5","5":"long","6":"B","7":"215","8":"returned","9":"one"},{"1":"582","2":"582","3":"27","4":"0","5":"long","6":"B","7":"129","8":"returned","9":"neither"},{"1":"583","2":"583","3":"26","4":"1","5":"long","6":"B","7":"396","8":"returned","9":"both"},{"1":"584","2":"584","3":"34","4":"4","5":"long","6":"B","7":"547","8":"no-return","9":"both"},{"1":"585","2":"585","3":"49","4":"2","5":"short","6":"B","7":"547","8":"no-return","9":"neither"},{"1":"586","2":"586","3":"21","4":"1","5":"long","6":"B","7":"71","8":"returned","9":"both"},{"1":"587","2":"587","3":"39","4":"2","5":"long","6":"B","7":"168","8":"returned","9":"both"},{"1":"588","2":"588","3":"33","4":"4","5":"long","6":"B","7":"228","8":"returned","9":"neither"},{"1":"589","2":"589","3":"32","4":"1","5":"long","6":"B","7":"551","8":"no-return","9":"both"},{"1":"590","2":"590","3":"35","4":"6","5":"short","6":"B","7":"654","8":"no-return","9":"neither"},{"1":"591","2":"591","3":"31","4":"0","5":"long","6":"B","7":"51","8":"returned","9":"neither"},{"1":"592","2":"592","3":"28","4":"3","5":"short","6":"B","7":"548","8":"no-return","9":"neither"},{"1":"593","2":"593","3":"27","4":"5","5":"long","6":"B","7":"231","8":"returned","9":"both"},{"1":"594","2":"594","3":"29","4":"1","5":"long","6":"B","7":"280","8":"returned","9":"one"},{"1":"595","2":"595","3":"30","4":"20","5":"short","6":"B","7":"184","8":"returned","9":"one"},{"1":"596","2":"596","3":"27","4":"3","5":"short","6":"B","7":"86","8":"returned","9":"neither"},{"1":"597","2":"597","3":"33","4":"1","5":"short","6":"B","7":"560","8":"no-return","9":"neither"},{"1":"598","2":"598","3":"40","4":"1","5":"long","6":"B","7":"46","8":"returned","9":"neither"},{"1":"599","2":"599","3":"37","4":"2","5":"long","6":"B","7":"200","8":"returned","9":"both"},{"1":"600","2":"600","3":"33","4":"0","5":"short","6":"B","7":"244","8":"returned","9":"neither"},{"1":"601","2":"601","3":"28","4":"2","5":"short","6":"B","7":"182","8":"returned","9":"neither"},{"1":"602","2":"602","3":"40","4":"8","5":"long","6":"B","7":"296","8":"returned","9":"neither"},{"1":"603","2":"603","3":"48","4":"0","5":"short","6":"B","7":"24","8":"returned","9":"neither"},{"1":"604","2":"604","3":"38","4":"1","5":"short","6":"B","7":"142","8":"returned","9":"both"},{"1":"605","2":"605","3":"35","4":"0","5":"short","6":"B","7":"120","8":"returned","9":"neither"},{"1":"606","2":"606","3":"37","4":"0","5":"short","6":"B","7":"47","8":"returned","9":"neither"},{"1":"607","2":"607","3":"25","4":"0","5":"long","6":"B","7":"519","8":"returned","9":"both"},{"1":"608","2":"608","3":"26","4":"2","5":"long","6":"B","7":"248","8":"returned","9":"neither"},{"1":"609","2":"609","3":"30","4":"3","5":"short","6":"B","7":"31","8":"returned","9":"both"},{"1":"610","2":"610","3":"28","4":"2","5":"short","6":"B","7":"567","8":"no-return","9":"neither"},{"1":"611","2":"611","3":"23","4":"4","5":"short","6":"B","7":"353","8":"returned","9":"one"},{"1":"612","2":"612","3":"36","4":"1","5":"long","6":"B","7":"458","8":"returned","9":"neither"},{"1":"613","2":"613","3":"36","4":"4","5":"long","6":"B","7":"554","8":"no-return","9":"neither"},{"1":"614","2":"614","3":"24","4":"0","5":"short","6":"B","7":"116","8":"returned","9":"neither"},{"1":"615","2":"615","3":"33","4":"5","5":"short","6":"B","7":"74","8":"returned","9":"both"},{"1":"616","2":"616","3":"38","4":"6","5":"short","6":"B","7":"10","8":"returned","9":"neither"},{"1":"617","2":"617","3":"41","4":"21","5":"long","6":"B","7":"355","8":"returned","9":"both"},{"1":"618","2":"618","3":"31","4":"0","5":"long","6":"B","7":"232","8":"returned","9":"both"},{"1":"619","2":"619","3":"31","4":"11","5":"long","6":"B","7":"68","8":"returned","9":"neither"},{"1":"620","2":"620","3":"37","4":"0","5":"long","6":"B","7":"48","8":"returned","9":"neither"},{"1":"621","2":"621","3":"37","4":"4","5":"short","6":"B","7":"60","8":"returned","9":"neither"},{"1":"622","2":"622","3":"33","4":"0","5":"short","6":"B","7":"50","8":"returned","9":"neither"},{"1":"624","2":"624","3":"53","4":"6","5":"short","6":"B","7":"126","8":"returned","9":"neither"},{"1":"625","2":"625","3":"37","4":"4","5":"short","6":"B","7":"18","8":"returned","9":"one"},{"1":"626","2":"626","3":"28","4":"3","5":"long","6":"B","7":"35","8":"returned","9":"neither"},{"1":"627","2":"627","3":"35","4":"2","5":"short","6":"B","7":"379","8":"returned","9":"both"},{"1":"628","2":"628","3":"46","4":"15","5":"long","6":"B","7":"377","8":"returned","9":"both"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Create a suitable reponse variable for a Cox proportional hazards regression that predicts time until return to drug use from the other variables. This requires some care, because you need to be sure about what the censoring variable actually represents and what you need it to represent.</li>
</ol>
<p>Solution</p>
<p>This is <code>Surv</code> in package <code>survival</code>. The response variable needs to encode two things: the time until the event of interest (return to drug use) and whether or not that event happened for each patient.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> In this case, that is <code>censor="returned"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">with</span>(drugusers, <span class="fu">Surv</span>(time, censor <span class="sc">==</span> <span class="st">"returned"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since we are doing this to test whether it is the right thing, we can save it in something outside of the dataframe, and then look at it (which we do in a moment).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Look at the first few values of your response variable. Why is the fifth one marked with a <code>+</code>? Explain briefly.</li>
</ol>
<p>Solution</p>
<p><code>head</code> works as well with a vector (displaying the first six values) as it does with a data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 188   26  207  144  551+  32 </code></pre>
</div>
</div>
<p>The fifth value is marked with a <code>+</code> because it is a censored value: this is a patient who was never observed to go back to drug use. You can tell this by looking at the <code>head</code> of the entire data frame:<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(drugusers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["row"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["ID"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["ndrugtx"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["treat"],"name":[5],"type":["chr"],"align":["left"]},{"label":["site"],"name":[6],"type":["chr"],"align":["left"]},{"label":["time"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["censor"],"name":[8],"type":["chr"],"align":["left"]},{"label":["herco"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"1","3":"39","4":"1","5":"long","6":"A","7":"188","8":"returned","9":"neither"},{"1":"2","2":"2","3":"33","4":"8","5":"long","6":"A","7":"26","8":"returned","9":"neither"},{"1":"3","2":"3","3":"33","4":"3","5":"long","6":"A","7":"207","8":"returned","9":"one"},{"1":"4","2":"4","3":"32","4":"1","5":"short","6":"A","7":"144","8":"returned","9":"neither"},{"1":"5","2":"5","3":"24","4":"5","5":"long","6":"A","7":"551","8":"no-return","9":"one"},{"1":"6","2":"6","3":"30","4":"1","5":"long","6":"A","7":"32","8":"returned","9":"both"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>since this patient has <code>censor="no-return"</code>. The other ones have <code>censor="returned"</code>; these are all “uncensored” in the jargon.</p>
<p>Typically, censored values will be bigger than uncensored ones, because (in most cases) the individual will be observed until the study ends, and studies of this kind carry on for years:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(drugusers, <span class="fu">aes</span>(<span class="at">x =</span> censor, <span class="at">y =</span> time)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/drug-treatment-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Yep. The smallest time for a censored observation would be an upper outlier if it were observed for an uncensored observation.</p>
<p>One nice side-effect of turning <code>censor</code> into a categorical variable is that it can now distinguish groups as a boxplot requires.</p>
<p>I discovered something rather amusing when I originally wrote this (a year ago). Suppose you want to compare times for the two treatment groups, and you <em>also</em> want to distinguish censored from non-censored observations. Then, this works:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(drugusers, <span class="fu">aes</span>(<span class="at">x =</span> treat, <span class="at">y =</span> time, <span class="at">colour =</span> censor)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/drug-treatment-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For each treatment, you get side-by-side boxplots of the times for censored (red) and uncensored (blue) observations, and so you see for both treatments (short and long) the censored times are typically longer than the uncensored ones.</p>
<p>(This you may recognize as a “grouped boxplot”, for when we have two categorical variables and one quantitative one.)</p>
<p>I borrow this idea for two-way ANOVA (coming up later).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Fit a Cox proportional hazards model, predicting from all the other variables (except for <code>row</code> and <code>ID</code>) that you haven’t used yet. Display the results.</li>
</ol>
<p>Solution</p>
<p>For the thing to go on the left of the squiggle, copy the <code>Surv()</code> thing you made before and paste it in (once you have it working):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>drugusers<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, censor <span class="sc">==</span> <span class="st">"returned"</span>) <span class="sc">~</span> age <span class="sc">+</span> ndrugtx <span class="sc">+</span> treat <span class="sc">+</span> site <span class="sc">+</span> herco, <span class="at">data =</span> drugusers)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(drugusers<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time, censor == "returned") ~ age + ndrugtx + 
    treat + site + herco, data = drugusers)

  n= 610, number of events= 495 

                  coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
age          -0.023798  0.976483  0.007561 -3.148  0.00165 ** 
ndrugtx       0.034815  1.035429  0.007755  4.490 7.14e-06 ***
treatshort    0.254606  1.289953  0.091006  2.798  0.00515 ** 
siteB        -0.173021  0.841120  0.102105 -1.695  0.09016 .  
herconeither  0.125779  1.134032  0.103075  1.220  0.22236    
hercoone      0.247318  1.280586  0.122759  2.015  0.04394 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

             exp(coef) exp(-coef) lower .95 upper .95
age             0.9765     1.0241    0.9621    0.9911
ndrugtx         1.0354     0.9658    1.0198    1.0513
treatshort      1.2900     0.7752    1.0792    1.5418
siteB           0.8411     1.1889    0.6886    1.0275
herconeither    1.1340     0.8818    0.9266    1.3879
hercoone        1.2806     0.7809    1.0067    1.6289

Concordance= 0.581  (se = 0.014 )
Likelihood ratio test= 35.08  on 6 df,   p=4e-06
Wald test            = 36.96  on 6 df,   p=2e-06
Score (logrank) test = 37.36  on 6 df,   p=1e-06</code></pre>
</div>
</div>
<p>Another way to handle “all the other <span class="math inline">\(x\)</span>’s except <code>row</code>, <code>ID</code>, <code>time</code> and <code>censor</code>” is this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>drugusers<span class="fl">.1</span>a <span class="ot">&lt;-</span> <span class="fu">coxph</span>(y <span class="sc">~</span> . <span class="sc">-</span> row <span class="sc">-</span> ID <span class="sc">-</span> time <span class="sc">-</span> censor, <span class="at">data =</span> drugusers)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(drugusers<span class="fl">.1</span>a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"age","2":"-0.02379823","3":"0.007560504","4":"-3.147704","5":"1.645581e-03"},{"1":"ndrugtx","2":"0.03481539","3":"0.007754846","4":"4.489501","5":"7.139018e-06"},{"1":"treatshort","2":"0.25460584","3":"0.091006112","4":"2.797678","5":"5.147133e-03"},{"1":"siteB","2":"-0.17302084","3":"0.102104740","4":"-1.694543","5":"9.016221e-02"},{"1":"herconeither","2":"0.12577946","3":"0.103075485","4":"1.220266","5":"2.223642e-01"},{"1":"hercoone","2":"0.24731795","3":"0.122759028","4":"2.014662","5":"4.394007e-02"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Same. I used <code>tidy</code> from <code>broom</code> to shorten the output a bit.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Find which explanatory variables can be removed at <span class="math inline">\(\alpha=0.05\)</span> (there should be two of them). Bear in mind that we have categorical variables, so that looking at the output from <code>summary</code> is not enough.</li>
</ol>
<p>Solution</p>
<p>The hint is meant to suggest to you that looking at <code>drop1</code> is the right way to go:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(drugusers<span class="fl">.1</span>, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"5712.194","3":"NA","4":"NA","_rn_":"<none>"},{"1":"1","2":"5720.291","3":"10.097214","4":"1.484937e-03","_rn_":"age"},{"1":"1","2":"5727.338","3":"17.144604","4":"3.463921e-05","_rn_":"ndrugtx"},{"1":"1","2":"5718.029","3":"7.835162","4":"5.123956e-03","_rn_":"treat"},{"1":"1","2":"5713.127","3":"2.933479","4":"8.676037e-02","_rn_":"site"},{"1":"2","2":"5712.512","3":"4.318227","4":"1.154274e-01","_rn_":"herco"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Note that <code>herco</code>, a categorical variable with three levels, has 2 degrees of freedom here, since a test of “no effect of <code>herco</code>” is testing that survival is the same at <em>all three</em> levels of <code>herco</code>.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" type="a">
<li>Remove <em>all</em> the non-significant explanatory variables and re-fit your model. By carrying out a suitable test demonstrate that your smaller model is the better one.</li>
</ol>
<p>Solution</p>
<p><code>site</code> and <code>herco</code> are the two variables to come out.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> I like <code>update</code>, but there is no problem about copying-pasting your <code>coxph</code> and taking out what you no longer need.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>drugusers<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(drugusers<span class="fl">.1</span>, . <span class="sc">~</span> . <span class="sc">-</span> site <span class="sc">-</span> herco)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Having fit two models, we can use <code>anova</code> to compare them. The right test gets done, so no need for <code>test=</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(drugusers<span class="fl">.2</span>, drugusers<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["loglik"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["int"],"align":["right"]},{"label":["Pr(>|Chi|)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"-2853.703","2":"NA","3":"NA","4":"NA","_rn_":"1"},{"1":"-2850.097","2":"7.211703","3":"3","4":"0.06544761","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>There is no significant difference between these two models,<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> so we can go with the smaller, simpler one (with just <code>age</code>, <code>ndrugtx</code> and <code>treat</code>).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol type="i">
<li><a name="part:posneg">*</a> Display your better model. Are all of the explanatory variables significant? Do their slope coefficients have sensible signs (plus or minus), based on what you know or can guess about drug treatments? Explain briefly.</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(drugusers<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time, censor == "returned") ~ age + ndrugtx + 
    treat, data = drugusers)

  n= 610, number of events= 495 

                coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
age        -0.020801  0.979414  0.007419 -2.804  0.00505 ** 
ndrugtx     0.035567  1.036207  0.007621  4.667 3.05e-06 ***
treatshort  0.231055  1.259929  0.090175  2.562  0.01040 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

           exp(coef) exp(-coef) lower .95 upper .95
age           0.9794     1.0210    0.9653    0.9938
ndrugtx       1.0362     0.9651    1.0208    1.0518
treatshort    1.2599     0.7937    1.0558    1.5035

Concordance= 0.572  (se = 0.014 )
Likelihood ratio test= 27.87  on 3 df,   p=4e-06
Wald test            = 30.5  on 3 df,   p=1e-06
Score (logrank) test = 30.62  on 3 df,   p=1e-06</code></pre>
</div>
</div>
<p>The three remaining explanatory variables are all clearly significant: the patient’s age, the number of previous drug treatments, and whether the treatment was short or long. This is legit (we don’t need to run <code>drop1</code> again) because the remaining explanatory variables are all quantitative or have only two levels, so that the single-df tests in <code>summary</code> are what we need.</p>
<p>Do their slope coefficients have sensible signs? Well, this requires careful thought. A positive coefficient means that increasing that variable <em>increases the hazard of the event</em>: ie., it makes the event likelier to happen sooner. Here, the “event” is “return to drug use”:</p>
<ul>
<li><p>Age has a negative coefficient, so an older person is likely to take <em>longer</em> to return to drug use, other things being equal. This makes some kind of sense, if you imagine drug use as being related to maturity, or an older drug user as being more strongly committed to “turning their life around”, so that a drug treatment of any kind is going to be more effective on an older patient.</p></li>
<li><p>The number of previous treatments has a positive coefficient, so that a patient who has had a lot of previous treatments is likely to go back to drugs sooner. Such a person might be an “addict” for whom treatments really do not work, or might not be committed to giving up drugs.</p></li>
<li><p><code>treatshort</code> has a positive coefficient. This says that if you give a patient a short treatment, they are more likely (other things being equal) to go back to drugs sooner, as compared to the baseline long treatment. That is, a longer treatment is more effective than a shorter one. Given a significant effect of treatment length, this is the way around you would expect it to be.</p></li>
</ul>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="10" type="a">
<li>We have three variables left in our model, <code>age</code>, <code>ndrugtx</code> and <code>treat</code>. The quartiles of age are 27 and 37, the quartiles of <code>ndrugtx</code> are 1 and 6, and the two possible values of <code>treat</code> are <code>short</code> and <code>long</code>. The quartiles and median of the times to return are about 80, 160, and 360. Create a data frame with variables of these names and all possible combinations of their values (so there should be 24 rows in the resulting data frame). Display the resulting data frame.</li>
</ol>
<p>Solution</p>
<p>This data frame is going to be used for prediction, so I will call it <code>new</code> and construct it in pieces as I did before (thus meaning that I don’t have to think too hard about what I’m doing):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">27</span>, <span class="dv">37</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>ndrugtxs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>treats <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"short"</span>, <span class="st">"long"</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">160</span>, <span class="dv">360</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">datagrid</span>(<span class="at">model =</span> drugusers<span class="fl">.2</span>, <span class="at">age =</span> ages, <span class="at">ndrugtx =</span> ndrugtxs, <span class="at">treat =</span> treats, <span class="at">time =</span> times)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["censor"],"name":[1],"type":["chr"],"align":["left"]},{"label":["age"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["ndrugtx"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["treat"],"name":[4],"type":["chr"],"align":["left"]},{"label":["time"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["rowid"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"returned","2":"27","3":"1","4":"short","5":"80","6":"1"},{"1":"returned","2":"27","3":"1","4":"short","5":"160","6":"2"},{"1":"returned","2":"27","3":"1","4":"short","5":"360","6":"3"},{"1":"returned","2":"27","3":"1","4":"long","5":"80","6":"4"},{"1":"returned","2":"27","3":"1","4":"long","5":"160","6":"5"},{"1":"returned","2":"27","3":"1","4":"long","5":"360","6":"6"},{"1":"returned","2":"27","3":"6","4":"short","5":"80","6":"7"},{"1":"returned","2":"27","3":"6","4":"short","5":"160","6":"8"},{"1":"returned","2":"27","3":"6","4":"short","5":"360","6":"9"},{"1":"returned","2":"27","3":"6","4":"long","5":"80","6":"10"},{"1":"returned","2":"27","3":"6","4":"long","5":"160","6":"11"},{"1":"returned","2":"27","3":"6","4":"long","5":"360","6":"12"},{"1":"returned","2":"37","3":"1","4":"short","5":"80","6":"13"},{"1":"returned","2":"37","3":"1","4":"short","5":"160","6":"14"},{"1":"returned","2":"37","3":"1","4":"short","5":"360","6":"15"},{"1":"returned","2":"37","3":"1","4":"long","5":"80","6":"16"},{"1":"returned","2":"37","3":"1","4":"long","5":"160","6":"17"},{"1":"returned","2":"37","3":"1","4":"long","5":"360","6":"18"},{"1":"returned","2":"37","3":"6","4":"short","5":"80","6":"19"},{"1":"returned","2":"37","3":"6","4":"short","5":"160","6":"20"},{"1":"returned","2":"37","3":"6","4":"short","5":"360","6":"21"},{"1":"returned","2":"37","3":"6","4":"long","5":"80","6":"22"},{"1":"returned","2":"37","3":"6","4":"long","5":"160","6":"23"},{"1":"returned","2":"37","3":"6","4":"long","5":"360","6":"24"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>24 rows as promised. Note that the predicted probabilities of returning to drug use (or not having done so yet) will depend on the timescale you are looking at: the longer you wait, the more likely the previous drug user will have gone back to using.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="11" type="a">
<li>Obtain predicted survival probabilities for each of the values of <code>age</code>, <code>ndrugtx</code>,<code>treat</code>, and <code>time</code> used in the previous part. Display at least some of it.</li>
</ol>
<p>Solution</p>
<p>This is the usual <code>marginaleffects</code> stuff. I like to limit the display to the columns of interest so that it’s not too wide. Don’t forget the <code>type</code> here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">predictions</span>(drugusers<span class="fl">.2</span>, <span class="at">newdata =</span> new, <span class="at">type =</span> <span class="st">"survival"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, ndrugtx, treat, time, estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["ndrugtx"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["treat"],"name":[3],"type":["chr"],"align":["left"]},{"label":["time"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"27","2":"1","3":"short","4":"80","5":"0.7262638"},{"1":"27","2":"1","3":"short","4":"160","5":"0.4803012"},{"1":"27","2":"1","3":"short","4":"360","5":"0.2154553"},{"1":"27","2":"1","3":"long","4":"80","5":"0.7758026"},{"1":"27","2":"1","3":"long","4":"160","5":"0.5587516"},{"1":"27","2":"1","3":"long","4":"360","5":"0.2957254"},{"1":"27","2":"6","3":"short","4":"80","5":"0.6824318"},{"1":"27","2":"6","3":"short","4":"160","5":"0.4164154"},{"1":"27","2":"6","3":"short","4":"360","5":"0.1598118"},{"1":"27","2":"6","3":"long","4":"80","5":"0.7384032"},{"1":"27","2":"6","3":"long","4":"160","5":"0.4989076"},{"1":"27","2":"6","3":"long","4":"360","5":"0.2332963"},{"1":"37","2":"1","3":"short","4":"80","5":"0.7712253"},{"1":"37","2":"1","3":"short","4":"160","5":"0.5512218"},{"1":"37","2":"1","3":"short","4":"360","5":"0.2874450"},{"1":"37","2":"1","3":"long","4":"80","5":"0.8136850"},{"1":"37","2":"1","3":"long","4":"160","5":"0.6232925"},{"1":"37","2":"1","3":"long","4":"360","5":"0.3717555"},{"1":"37","2":"6","3":"short","4":"80","5":"0.7332017"},{"1":"37","2":"6","3":"short","4":"160","5":"0.4908862"},{"1":"37","2":"6","3":"short","4":"360","5":"0.2255140"},{"1":"37","2":"6","3":"long","4":"80","5":"0.7816790"},{"1":"37","2":"6","3":"long","4":"160","5":"0.5685032"},{"1":"37","2":"6","3":"long","4":"360","5":"0.3066315"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Make sure that you use your best model, ie. the second one.</p>
<p>This gives you a vague picture of the effects of things. The probability of survival (not having gone back to using drugs) decreases over time, and you can get an idea of the effect of the explanatory variables in the model. For example, if you use the first six rows, you can see that the effect of a short treatment vs a long one is to decrease the probability of survival somewhat (that is to say, to make it a little <em>more</em> likely that the user will have gone back to using drugs), comparing the same values for age, number of previous treatments, and time.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="12" type="a">
<li>Plot your predicted survival curves to show the effect of each explanatory variable over time. This is most easily done with three separate plots.</li>
</ol>
<p>Solution</p>
<p>This is <code>plot_predictions</code>, remembering to put time first in the <code>condition</code> and to have a <code>type</code> also.</p>
<p>Effect of age first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(drugusers<span class="fl">.2</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"age"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Five different ages were chosen for us. The best survival, at the top of the traces on the graph, is the purple and blue curves, which go with the oldest ages, so these are the least likely to go back to using drugs, all else equal.</p>
<p>Number of drug treatments:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(drugusers<span class="fl">.2</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"ndrugtx"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Likewise, the graph shows some representative numbers of previous treatments, and the more of them there were, the worse the survival is. This is consistent with my comments on the <code>ndrugtx</code> coefficient on the <code>summary</code> output.</p>
<p>Treatment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(drugusers<span class="fl">.2</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"treat"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A long treatment is a bit better than a short one. (I don’t know why the warning happened on this one.)</p>
<p>You might be curious about what happens if you glue all <em>three</em> explanatory variables onto <code>condition</code>. If you are, try it and see:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(drugusers<span class="fl">.2</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"age"</span>, <span class="st">"ndrugtx"</span>, <span class="st">"treat"</span>), </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What has happened here is that <code>plot_predictions</code> has used facets to accommodate the other explanatory variables, specifically <code>facet_grid</code> (rather than <code>facet_wrap</code>) because there are two additional explanatory variables, one of which is horizontal facets and the other one is vertical facets.</p>
<p>To assess the effect of each explanatory variable, hold the others constant. Thus:</p>
<ul>
<li>To assess age, pick one of the ten facets and see that the highest age is best (no matter which facet you pick)</li>
<li>To assess number of previous drug treatments, pick a row and see what happens as you go to the right (the survival is worse as <code>ndrugtx</code> increases)</li>
<li>To assess short vs.&nbsp;long treatment, pick a column and compare the top facet with the bottom one. This is not easy to see, but survival in the top facet is better (so that the longer treatment is better).</li>
</ul>
<p>My take is that the individual plots make it easier to assess the individual effects, but if you are willing to put in the work to assess the effects, you can make just the one graph and interpret that.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="13" type="a">
<li>Which of your combinations of values is predicted to take the longest to return to drug use? Which is predicted to take the shortest time? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>Remember that “up and to the right” is the best survival curve: that is, the people on this survival curve are predicted to take the longest to return to drug use.</p>
<p>This is easiest to see from my combined plot: the best survival curve of all is the top left one: age 56, no previous drug treatments, long treatment. The worst one is the bottom right one: age 20, 40 previous drug treatments, short treatment. (It’s hard to see which age is worst in this graph, but you infer that the age effect is the same as on all the other facets.)</p>
<p>From the individual graphs, name the best and worst values on each one, and the best and worst survival overall will come from the combinations of those. This gives the same answer as above.</p>
<p>“Returning to drug use” is like “death” in that you want it to be a long time before it happens, so “best” is top right on the plot of survival curves. In other circumstances, you might want the event to happen <em>sooner</em>, in which case the lower-left survival curve would be the “best” one.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="14" type="a">
<li>Are your survival curve plot and your conclusions from part (<a href="#part:posneg">here</a>) consistent, or not? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The survival curves say that being older, having fewer previous treatments and being on the long treatment are better in terms of taking longer to return to drug use. Our analysis of whether the slope coefficients in <code>drugusers.2</code> were positive or negative came to exactly the same conclusion. So the survival curves and part (<a href="#part:posneg">here</a>) are entirely consistent.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="multiple-myeloma-1" class="level2" data-number="30.7">
<h2 data-number="30.7" class="anchored" data-anchor-id="multiple-myeloma-1"><span class="header-section-number">30.7</span> Multiple myeloma</h2>
<p>Multiple myeloma is a kind of cancer. It forms in a plasma cell (which is a type of white blood cell). It causes cancer cells to accumulate in the bone marrow, where they crowd out healthy blood cells. Plasma cells make antibodies (to help fight infections), while the cancer cells don’t: they produce abnormal proteins that can cause kidney problems. (This adapted from <a href="http://www.mayoclinic.org/diseases-conditions/multiple-myeloma/basics/definition/con-20026607">link</a>.) The variables are:</p>
<ul>
<li><p><code>time</code>: survival time from diagnosis (months)</p></li>
<li><p><code>vstatus</code>: 0=alive, 1=dead at end of study</p></li>
<li><p><code>logbun</code>: log of BUN test score (BUN test is a test of kidney function, not to be confused with cha siu bao<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>).</p></li>
<li><p><code>hgb</code>: hemoglobin (at diagnosis).</p></li>
<li><p><code>platelet</code>: platelets: 1=normal, 0=abnormal (at diagnosis).</p></li>
<li><p><code>age</code> at diagnosis, in years</p></li>
<li><p><code>logwbc</code>: log of WBC (white blood cell count, at diagnosis)</p></li>
<li><p><code>frac</code>: fractures at diagnosis (0=absent, 1=present)</p></li>
<li><p><code>logpbm</code>: log of percent of plasma cells in bone marrow</p></li>
<li><p><code>protein</code>: proteinuria (protein in urine) at diagnosis. Most people have very little, so a larger than normal amount indicates illness of some kind.</p></li>
<li><p><code>scalc</code>: serum calcium at diagnosis.</p></li>
</ul>
<p>The data, on 65 patients with multiple myeloma, are in <a href="http://ritsokiguess.site/datafiles/myeloma.csv">link</a>. Some of the variables are logs because they could take very large values.</p>
<p>There are a lot of parts here, but each part is supposed to be short.</p>
<ol type="a">
<li>Read in the data and display (some of) the values. Confirm that you have the right number of observations and the right variables.</li>
</ol>
<p>Solution</p>
<p>The usual:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/myeloma.csv"</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>myeloma <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Parsed with column specification:
cols(
  time = col_double(),
  vstatus = col_double(),
  logbun = col_double(),
  hgb = col_double(),
  platelet = col_double(),
  age = col_double(),
  logwbc = col_double(),
  frac = col_double(),
  logpbm = col_double(),
  protein = col_double(),
  scalc = col_double()
)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>myeloma</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["time"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["vstatus"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["logbun"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hgb"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["platelet"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logwbc"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["frac"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["logpbm"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["protein"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["scalc"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.25","2":"1","3":"2.2175","4":"9.4","5":"1","6":"67","7":"3.6628","8":"1","9":"1.9542","10":"12","11":"10"},{"1":"1.25","2":"1","3":"1.9395","4":"12.0","5":"1","6":"38","7":"3.9868","8":"1","9":"1.9542","10":"20","11":"18"},{"1":"2.00","2":"1","3":"1.5185","4":"9.8","5":"1","6":"81","7":"3.8751","8":"1","9":"2.0000","10":"2","11":"15"},{"1":"2.00","2":"1","3":"1.7482","4":"11.3","5":"0","6":"75","7":"3.8062","8":"1","9":"1.2553","10":"0","11":"12"},{"1":"2.00","2":"1","3":"1.3010","4":"5.1","5":"0","6":"57","7":"3.7243","8":"1","9":"2.0000","10":"3","11":"9"},{"1":"3.00","2":"1","3":"1.5441","4":"6.7","5":"1","6":"46","7":"4.4757","8":"0","9":"1.9345","10":"12","11":"10"},{"1":"5.00","2":"1","3":"2.2355","4":"10.1","5":"1","6":"50","7":"4.9542","8":"1","9":"1.6628","10":"4","11":"9"},{"1":"5.00","2":"1","3":"1.6812","4":"6.5","5":"1","6":"74","7":"3.7324","8":"0","9":"1.7324","10":"5","11":"9"},{"1":"6.00","2":"1","3":"1.3617","4":"9.0","5":"1","6":"77","7":"3.5441","8":"0","9":"1.4624","10":"1","11":"8"},{"1":"6.00","2":"1","3":"2.1139","4":"10.2","5":"0","6":"70","7":"3.5441","8":"1","9":"1.3617","10":"1","11":"8"},{"1":"6.00","2":"1","3":"1.1139","4":"9.7","5":"1","6":"60","7":"3.5185","8":"1","9":"1.3979","10":"0","11":"10"},{"1":"6.00","2":"1","3":"1.4150","4":"10.4","5":"1","6":"67","7":"3.9294","8":"1","9":"1.6902","10":"0","11":"8"},{"1":"7.00","2":"1","3":"1.9777","4":"9.5","5":"1","6":"48","7":"3.3617","8":"1","9":"1.5682","10":"5","11":"10"},{"1":"7.00","2":"1","3":"1.0414","4":"5.1","5":"0","6":"61","7":"3.7324","8":"1","9":"2.0000","10":"1","11":"10"},{"1":"7.00","2":"1","3":"1.1761","4":"11.4","5":"1","6":"53","7":"3.7243","8":"1","9":"1.5185","10":"1","11":"13"},{"1":"9.00","2":"1","3":"1.7243","4":"8.2","5":"1","6":"55","7":"3.7993","8":"1","9":"1.7404","10":"0","11":"12"},{"1":"11.00","2":"1","3":"1.1139","4":"14.0","5":"1","6":"61","7":"3.8808","8":"1","9":"1.2788","10":"0","11":"10"},{"1":"11.00","2":"1","3":"1.2304","4":"12.0","5":"1","6":"43","7":"3.7709","8":"1","9":"1.1761","10":"1","11":"9"},{"1":"11.00","2":"1","3":"1.3010","4":"13.2","5":"1","6":"65","7":"3.7993","8":"1","9":"1.8195","10":"1","11":"10"},{"1":"11.00","2":"1","3":"1.5682","4":"7.5","5":"1","6":"70","7":"3.8865","8":"0","9":"1.6721","10":"0","11":"12"},{"1":"11.00","2":"1","3":"1.0792","4":"9.6","5":"1","6":"51","7":"3.5051","8":"1","9":"1.9031","10":"0","11":"9"},{"1":"13.00","2":"1","3":"0.7782","4":"5.5","5":"0","6":"60","7":"3.5798","8":"1","9":"1.3979","10":"2","11":"10"},{"1":"14.00","2":"1","3":"1.3979","4":"14.6","5":"1","6":"66","7":"3.7243","8":"1","9":"1.2553","10":"2","11":"10"},{"1":"15.00","2":"1","3":"1.6021","4":"10.6","5":"1","6":"70","7":"3.6902","8":"1","9":"1.4314","10":"0","11":"11"},{"1":"16.00","2":"1","3":"1.3424","4":"9.0","5":"1","6":"48","7":"3.9345","8":"1","9":"2.0000","10":"0","11":"10"},{"1":"16.00","2":"1","3":"1.3222","4":"8.8","5":"1","6":"62","7":"3.6990","8":"1","9":"0.6990","10":"17","11":"10"},{"1":"17.00","2":"1","3":"1.2304","4":"10.0","5":"1","6":"53","7":"3.8808","8":"1","9":"1.4472","10":"4","11":"9"},{"1":"17.00","2":"1","3":"1.5911","4":"11.2","5":"1","6":"68","7":"3.4314","8":"0","9":"1.6128","10":"1","11":"10"},{"1":"18.00","2":"1","3":"1.4472","4":"7.5","5":"1","6":"65","7":"3.5682","8":"0","9":"0.9031","10":"7","11":"8"},{"1":"19.00","2":"1","3":"1.0792","4":"14.4","5":"1","6":"51","7":"3.9191","8":"1","9":"2.0000","10":"6","11":"15"},{"1":"19.00","2":"1","3":"1.2553","4":"7.5","5":"0","6":"60","7":"3.7924","8":"1","9":"1.9294","10":"5","11":"9"},{"1":"24.00","2":"1","3":"1.3010","4":"14.6","5":"1","6":"56","7":"4.0899","8":"1","9":"0.4771","10":"0","11":"9"},{"1":"25.00","2":"1","3":"1.0000","4":"12.4","5":"1","6":"67","7":"3.8195","8":"1","9":"1.6435","10":"0","11":"10"},{"1":"26.00","2":"1","3":"1.2304","4":"11.2","5":"1","6":"49","7":"3.6021","8":"1","9":"2.0000","10":"27","11":"11"},{"1":"32.00","2":"1","3":"1.3222","4":"10.6","5":"1","6":"46","7":"3.6990","8":"1","9":"1.6335","10":"1","11":"9"},{"1":"35.00","2":"1","3":"1.1139","4":"7.0","5":"0","6":"48","7":"3.6532","8":"1","9":"1.1761","10":"4","11":"10"},{"1":"37.00","2":"1","3":"1.6021","4":"11.0","5":"1","6":"63","7":"3.9542","8":"0","9":"1.2041","10":"7","11":"9"},{"1":"41.00","2":"1","3":"1.0000","4":"10.2","5":"1","6":"69","7":"3.4771","8":"1","9":"1.4771","10":"6","11":"10"},{"1":"41.00","2":"1","3":"1.1461","4":"5.0","5":"1","6":"70","7":"3.5185","8":"1","9":"1.3424","10":"0","11":"9"},{"1":"51.00","2":"1","3":"1.5682","4":"7.7","5":"0","6":"74","7":"3.4150","8":"1","9":"1.0414","10":"4","11":"13"},{"1":"52.00","2":"1","3":"1.0000","4":"10.1","5":"1","6":"60","7":"3.8573","8":"1","9":"1.6532","10":"4","11":"10"},{"1":"54.00","2":"1","3":"1.2553","4":"9.0","5":"1","6":"49","7":"3.7243","8":"1","9":"1.6990","10":"2","11":"10"},{"1":"58.00","2":"1","3":"1.2041","4":"12.1","5":"1","6":"42","7":"3.6990","8":"1","9":"1.5798","10":"22","11":"10"},{"1":"66.00","2":"1","3":"1.4472","4":"6.6","5":"1","6":"59","7":"3.7853","8":"1","9":"1.8195","10":"0","11":"9"},{"1":"67.00","2":"1","3":"1.3222","4":"12.8","5":"1","6":"52","7":"3.6435","8":"1","9":"1.0414","10":"1","11":"10"},{"1":"88.00","2":"1","3":"1.1761","4":"10.6","5":"1","6":"47","7":"3.5563","8":"0","9":"1.7559","10":"21","11":"9"},{"1":"89.00","2":"1","3":"1.3222","4":"14.0","5":"1","6":"63","7":"3.6532","8":"1","9":"1.6232","10":"1","11":"9"},{"1":"92.00","2":"1","3":"1.4314","4":"11.0","5":"1","6":"58","7":"4.0755","8":"1","9":"1.4150","10":"4","11":"11"},{"1":"4.00","2":"0","3":"1.9542","4":"10.2","5":"1","6":"59","7":"4.0453","8":"0","9":"0.7782","10":"12","11":"10"},{"1":"4.00","2":"0","3":"1.9243","4":"10.0","5":"1","6":"49","7":"3.9590","8":"0","9":"1.6232","10":"0","11":"13"},{"1":"7.00","2":"0","3":"1.1139","4":"12.4","5":"1","6":"48","7":"3.7993","8":"1","9":"1.8573","10":"0","11":"10"},{"1":"7.00","2":"0","3":"1.5315","4":"10.2","5":"1","6":"81","7":"3.5911","8":"0","9":"1.8808","10":"0","11":"11"},{"1":"8.00","2":"0","3":"1.0792","4":"9.9","5":"1","6":"57","7":"3.8325","8":"1","9":"1.6532","10":"0","11":"8"},{"1":"12.00","2":"0","3":"1.1461","4":"11.6","5":"1","6":"46","7":"3.6435","8":"0","9":"1.1461","10":"0","11":"7"},{"1":"11.00","2":"0","3":"1.6128","4":"14.0","5":"1","6":"60","7":"3.7324","8":"1","9":"1.8451","10":"3","11":"9"},{"1":"12.00","2":"0","3":"1.3979","4":"8.8","5":"1","6":"66","7":"3.8388","8":"1","9":"1.3617","10":"0","11":"9"},{"1":"13.00","2":"0","3":"1.6628","4":"4.9","5":"0","6":"71","7":"3.6435","8":"0","9":"1.7924","10":"0","11":"9"},{"1":"16.00","2":"0","3":"1.1461","4":"13.0","5":"1","6":"55","7":"3.8573","8":"0","9":"0.9031","10":"0","11":"9"},{"1":"19.00","2":"0","3":"1.3222","4":"13.0","5":"1","6":"59","7":"3.7709","8":"1","9":"2.0000","10":"1","11":"10"},{"1":"19.00","2":"0","3":"1.3222","4":"10.8","5":"1","6":"69","7":"3.8808","8":"1","9":"1.5185","10":"0","11":"10"},{"1":"28.00","2":"0","3":"1.2304","4":"7.3","5":"1","6":"82","7":"3.7482","8":"1","9":"1.6721","10":"0","11":"9"},{"1":"41.00","2":"0","3":"1.7559","4":"12.8","5":"1","6":"72","7":"3.7243","8":"1","9":"1.4472","10":"1","11":"9"},{"1":"53.00","2":"0","3":"1.1139","4":"12.0","5":"1","6":"66","7":"3.6128","8":"1","9":"2.0000","10":"1","11":"11"},{"1":"57.00","2":"0","3":"1.2553","4":"12.5","5":"1","6":"66","7":"3.9685","8":"0","9":"1.9542","10":"0","11":"11"},{"1":"77.00","2":"0","3":"1.0792","4":"14.0","5":"1","6":"60","7":"3.6812","8":"0","9":"0.9542","10":"0","11":"12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>65 observations, and all the variables listed. If you want to go further (not necessary here), you can check that the variables <code>vstatus</code>, <code>platelet</code> and <code>frac</code> that should be zero and one actually <em>are</em> zero and one, at least for the values shown (they are), and the ages look like ages (they do).</p>
<p>The tidyverse also offers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(myeloma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 65
Columns: 11
$ time     &lt;dbl&gt; 1.25, 1.25, 2.00, 2.00, 2.00, 3.00, 5.00, 5.00, 6.00, 6.00, 6…
$ vstatus  &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
$ logbun   &lt;dbl&gt; 2.2175, 1.9395, 1.5185, 1.7482, 1.3010, 1.5441, 2.2355, 1.681…
$ hgb      &lt;dbl&gt; 9.4, 12.0, 9.8, 11.3, 5.1, 6.7, 10.1, 6.5, 9.0, 10.2, 9.7, 10…
$ platelet &lt;dbl&gt; 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1…
$ age      &lt;dbl&gt; 67, 38, 81, 75, 57, 46, 50, 74, 77, 70, 60, 67, 48, 61, 53, 5…
$ logwbc   &lt;dbl&gt; 3.6628, 3.9868, 3.8751, 3.8062, 3.7243, 4.4757, 4.9542, 3.732…
$ frac     &lt;dbl&gt; 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1…
$ logpbm   &lt;dbl&gt; 1.9542, 1.9542, 2.0000, 1.2553, 2.0000, 1.9345, 1.6628, 1.732…
$ protein  &lt;dbl&gt; 12, 20, 2, 0, 3, 12, 4, 5, 1, 1, 0, 0, 5, 1, 1, 0, 0, 1, 1, 0…
$ scalc    &lt;dbl&gt; 10, 18, 15, 12, 9, 10, 9, 9, 8, 8, 10, 8, 10, 10, 13, 12, 10,…</code></pre>
</div>
</div>
<p>which gives a bit more of a picture of the values.<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a> Or if you were serious about checking, you could do</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myeloma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      time          vstatus           logbun            hgb      
 Min.   : 1.25   Min.   :0.0000   Min.   :0.7782   Min.   : 4.9  
 1st Qu.: 7.00   1st Qu.:0.0000   1st Qu.:1.1461   1st Qu.: 8.8  
 Median :15.00   Median :1.0000   Median :1.3222   Median :10.2  
 Mean   :24.01   Mean   :0.7385   Mean   :1.3929   Mean   :10.2  
 3rd Qu.:35.00   3rd Qu.:1.0000   3rd Qu.:1.5682   3rd Qu.:12.0  
 Max.   :92.00   Max.   :1.0000   Max.   :2.2355   Max.   :14.6  
    platelet           age            logwbc           frac       
 Min.   :0.0000   Min.   :38.00   Min.   :3.362   Min.   :0.0000  
 1st Qu.:1.0000   1st Qu.:51.00   1st Qu.:3.643   1st Qu.:1.0000  
 Median :1.0000   Median :60.00   Median :3.732   Median :1.0000  
 Mean   :0.8615   Mean   :60.15   Mean   :3.769   Mean   :0.7538  
 3rd Qu.:1.0000   3rd Qu.:67.00   3rd Qu.:3.875   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :82.00   Max.   :4.954   Max.   :1.0000  
     logpbm          protein           scalc      
 Min.   :0.4771   Min.   : 0.000   Min.   : 7.00  
 1st Qu.:1.3617   1st Qu.: 0.000   1st Qu.: 9.00  
 Median :1.6232   Median : 1.000   Median :10.00  
 Mean   :1.5497   Mean   : 3.615   Mean   :10.12  
 3rd Qu.:1.8451   3rd Qu.: 4.000   3rd Qu.:10.00  
 Max.   :2.0000   Max.   :27.000   Max.   :18.00  </code></pre>
</div>
</div>
<p>which gives means and five-number summaries for each of the variables (the numeric ones, but they all are here, even the ones coded as 0 or 1 that are really categorical).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Create a suitable response variable for a Cox proportional-hazards survival model, bearing in mind that the “event” here is death. Display your response variable, and explain briefly what the <code>+</code> signs attached to some of the values mean, without using a technical term.</li>
</ol>
<p>Solution</p>
<p>This is really practice for the <code>Surv</code> that you are about to use in fitting a model, so it doesn’t matter whether you save the results anywhere.</p>
<p>Two things to consider: the survival times, here <code>time</code>, and the indicator of the event (death), here <code>vstatus</code> being 1. Sometimes, though not here, the column that is <code>vstatus</code> here is used to capture various types of outcome such as “lost to follow-up” (meaning, we don’t know what happened to this patient) or “died of something else”, and it is then important to make sure that you know which of these outcomes is the one of interest to you.</p>
<p>I’ve changed my mind on this over the years: putting the <code>Surv</code> right in the <code>coxph</code> (next part) is what I do now, because that plays best with <code>marginaleffects</code> (later), so for me this part is just practice at getting the <code>Surv</code> right:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(myeloma, <span class="fu">Surv</span>(time, vstatus <span class="sc">==</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1.25   1.25   2.00   2.00   2.00   3.00   5.00   5.00   6.00   6.00 
[11]  6.00   6.00   7.00   7.00   7.00   9.00  11.00  11.00  11.00  11.00 
[21] 11.00  13.00  14.00  15.00  16.00  16.00  17.00  17.00  18.00  19.00 
[31] 19.00  24.00  25.00  26.00  32.00  35.00  37.00  41.00  41.00  51.00 
[41] 52.00  54.00  58.00  66.00  67.00  88.00  89.00  92.00   4.00+  4.00+
[51]  7.00+  7.00+  8.00+ 12.00+ 11.00+ 12.00+ 13.00+ 16.00+ 19.00+ 19.00+
[61] 28.00+ 41.00+ 53.00+ 57.00+ 77.00+</code></pre>
</div>
</div>
<p>The values of that have a <code>+</code> by them go with patients who were never observed to die (or were still alive at the end of the study). There were 17 of these, listed at the end of the data frame. Usually, these values of the response will be higher than the others, but they weren’t here. (Maybe some of these patients were withdrawn from the study, or they joined it late.)</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>What is the technical term for those patients that have a <code>+</code> by their values for the response variable?</li>
</ol>
<p>Solution</p>
<p>Censored. A quick one. I was trying to dissuade you from using the word “censored” in the previous part, since I wanted you to demonstrate that you understood what it <em>meant</em>. But you should know the technical term as well, which is why I asked you for it here.</p>
<p>Grading note, for when this was on an assignment: if this part and the previous one contain, somewhere, the word “censored” <em>and</em> a clear explanation of what “censored” means, then I don’t mind what is where.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Fit a Cox proportional-hazards survival model predicting your response variable from all the other variables (except for the ones that you used to make the response variable). Display the <code>summary</code> of your model.</li>
</ol>
<p>Solution</p>
<p>The obvious way to do this is to list all the other variables on the right side of the squiggle, but a faster way is this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>myeloma<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, vstatus <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span> ., <span class="at">data =</span> myeloma)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myeloma<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time, vstatus == 1) ~ ., data = myeloma)

  n= 65, number of events= 48 

             coef exp(coef) se(coef)      z Pr(&gt;|z|)   
logbun    1.85557   6.39536  0.65628  2.827  0.00469 **
hgb      -0.12629   0.88136  0.07212 -1.751  0.07994 . 
platelet -0.25488   0.77501  0.51194 -0.498  0.61858   
age      -0.01306   0.98702  0.01957 -0.668  0.50439   
logwbc    0.35389   1.42460  0.71576  0.494  0.62101   
frac      0.34232   1.40821  0.40725  0.841  0.40059   
logpbm    0.38165   1.46470  0.48743  0.783  0.43364   
protein   0.01302   1.01311  0.02612  0.498  0.61817   
scalc     0.12976   1.13856  0.10502  1.236  0.21659   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

         exp(coef) exp(-coef) lower .95 upper .95
logbun      6.3954     0.1564    1.7670    23.147
hgb         0.8814     1.1346    0.7652     1.015
platelet    0.7750     1.2903    0.2841     2.114
age         0.9870     1.0131    0.9499     1.026
logwbc      1.4246     0.7020    0.3503     5.794
frac        1.4082     0.7101    0.6339     3.128
logpbm      1.4647     0.6827    0.5634     3.808
protein     1.0131     0.9871    0.9625     1.066
scalc       1.1386     0.8783    0.9268     1.399

Concordance= 0.675  (se = 0.051 )
Likelihood ratio test= 17.62  on 9 df,   p=0.04
Wald test            = 17.93  on 9 df,   p=0.04
Score (logrank) test = 18.97  on 9 df,   p=0.03</code></pre>
</div>
</div>
<p>The <code>.</code> in this model formula means “all the columns in the data frame” (except for those used in the response variable). I used <code>time</code> and <code>vstatus</code> to make the response, so I had no need to exclude them explicitly.</p>
<p>There is of course nothing wrong with typing out all the variable names, except that the first time you type them out, you will likely make a typo (unless you are more careful than I usually am).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>In your model, which explanatory variables have a P-value less than 0.10? Fit a model containing only those and display the results.</li>
</ol>
<p>Solution</p>
<p>Only <code>logbun</code> and <code>hgb</code>; the other P-values are larger, usually much larger. Because there are so many variables to remove, I am frightened away from <code>update</code> here (which I would normally try to use in this situation). I’m going to copy-and-paste my code for <code>myeloma.1</code> and edit it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>myeloma<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, vstatus <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">~</span> logbun <span class="sc">+</span> hgb, <span class="at">data =</span> myeloma)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myeloma<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time, vstatus == 1) ~ logbun + hgb, data = myeloma)

  n= 65, number of events= 48 

           coef exp(coef) se(coef)      z Pr(&gt;|z|)   
logbun  1.71597   5.56209  0.61855  2.774  0.00553 **
hgb    -0.11966   0.88722  0.05742 -2.084  0.03717 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

       exp(coef) exp(-coef) lower .95 upper .95
logbun    5.5621     0.1798    1.6547   18.6961
hgb       0.8872     1.1271    0.7928    0.9929

Concordance= 0.675  (se = 0.043 )
Likelihood ratio test= 12.27  on 2 df,   p=0.002
Wald test            = 12.51  on 2 df,   p=0.002
Score (logrank) test = 13.07  on 2 df,   p=0.001</code></pre>
</div>
</div>
<p>That’s all I wanted, but you can note that <code>hgb</code> has become significant at <span class="math inline">\(\alpha=0.05\)</span>. I suspect it was somewhat correlated with a variable that we removed, so that its value to the regression has become clearer.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Do a test to compare the two models that you fit. Why do you prefer the second model? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>Comparing two models is <code>anova</code>, which also works here. The right <code>test</code> is <code>Chisq</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(myeloma<span class="fl">.2</span>, myeloma<span class="fl">.1</span>, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["loglik"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["int"],"align":["right"]},{"label":["Pr(>|Chi|)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"-148.0607","2":"NA","3":"NA","4":"NA","_rn_":"1"},{"1":"-145.3872","2":"5.346968","3":"7","4":"0.6177007","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The usual logic here: this is far from significant, so the null hypothesis (that the two models are equally good) is not rejected, so we prefer the smaller model <code>myeloma.2</code> because it is simpler.</p>
<p>In case you are curious, <code>step</code> also works on models like these:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>myeloma<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">step</span>(myeloma<span class="fl">.1</span>, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">trace =</span> <span class="dv">0</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myeloma<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time, vstatus == 1) ~ logbun + hgb, data = myeloma)

  n= 65, number of events= 48 

           coef exp(coef) se(coef)      z Pr(&gt;|z|)   
logbun  1.71597   5.56209  0.61855  2.774  0.00553 **
hgb    -0.11966   0.88722  0.05742 -2.084  0.03717 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

       exp(coef) exp(-coef) lower .95 upper .95
logbun    5.5621     0.1798    1.6547   18.6961
hgb       0.8872     1.1271    0.7928    0.9929

Concordance= 0.675  (se = 0.043 )
Likelihood ratio test= 12.27  on 2 df,   p=0.002
Wald test            = 12.51  on 2 df,   p=0.002
Score (logrank) test = 13.07  on 2 df,   p=0.001</code></pre>
</div>
</div>
<p>The same model as the one we found by brute force. You can change the value of <code>trace</code> to see the progress, but in this case it’s not very illuminating, since <code>&lt;none&gt;</code> and the variables we end up keeping are always at the bottom of the list to remove.</p>
<p><code>step</code> is built on <code>add1</code> and <code>drop1</code>. In this case, <code>drop1</code> is run repeatedly and the variable with lowest AIC is removed. We had all numeric variables in this one, but if our model had something categorical like <code>treatment</code> with, let’s say, 4 levels, <code>drop1</code> would contemplate dropping all four of these in one shot, the same way it works with a categorical variable in a regression of any other kind.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>There should be two explanatory variables left in your model. These are both numerical variables. Find their first and third quartiles, any way you like.</li>
</ol>
<p>Solution</p>
<p>The most concise way is probably this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(myeloma<span class="sc">$</span>logbun)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    0%    25%    50%    75%   100% 
0.7782 1.1461 1.3222 1.5682 2.2355 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(myeloma<span class="sc">$</span>hgb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0%  25%  50%  75% 100% 
 4.9  8.8 10.2 12.0 14.6 </code></pre>
</div>
</div>
<p>So the quartiles are 1.15 and 1.57 for <code>logbun</code>, and 8.8 and 12.0 for <code>hgb</code>.</p>
<p>There are (at least) three other ways to do it. This is the easiest:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myeloma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      time          vstatus           logbun            hgb      
 Min.   : 1.25   Min.   :0.0000   Min.   :0.7782   Min.   : 4.9  
 1st Qu.: 7.00   1st Qu.:0.0000   1st Qu.:1.1461   1st Qu.: 8.8  
 Median :15.00   Median :1.0000   Median :1.3222   Median :10.2  
 Mean   :24.01   Mean   :0.7385   Mean   :1.3929   Mean   :10.2  
 3rd Qu.:35.00   3rd Qu.:1.0000   3rd Qu.:1.5682   3rd Qu.:12.0  
 Max.   :92.00   Max.   :1.0000   Max.   :2.2355   Max.   :14.6  
    platelet           age            logwbc           frac       
 Min.   :0.0000   Min.   :38.00   Min.   :3.362   Min.   :0.0000  
 1st Qu.:1.0000   1st Qu.:51.00   1st Qu.:3.643   1st Qu.:1.0000  
 Median :1.0000   Median :60.00   Median :3.732   Median :1.0000  
 Mean   :0.8615   Mean   :60.15   Mean   :3.769   Mean   :0.7538  
 3rd Qu.:1.0000   3rd Qu.:67.00   3rd Qu.:3.875   3rd Qu.:1.0000  
 Max.   :1.0000   Max.   :82.00   Max.   :4.954   Max.   :1.0000  
     logpbm          protein           scalc      
 Min.   :0.4771   Min.   : 0.000   Min.   : 7.00  
 1st Qu.:1.3617   1st Qu.: 0.000   1st Qu.: 9.00  
 Median :1.6232   Median : 1.000   Median :10.00  
 Mean   :1.5497   Mean   : 3.615   Mean   :10.12  
 3rd Qu.:1.8451   3rd Qu.: 4.000   3rd Qu.:10.00  
 Max.   :2.0000   Max.   :27.000   Max.   :18.00  </code></pre>
</div>
</div>
<p>from which you pick out the ones you need. Or, you <code>select</code> the ones you need first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>myeloma <span class="sc">%&gt;%</span> <span class="fu">select</span>(logbun, hgb) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     logbun            hgb      
 Min.   :0.7782   Min.   : 4.9  
 1st Qu.:1.1461   1st Qu.: 8.8  
 Median :1.3222   Median :10.2  
 Mean   :1.3929   Mean   :10.2  
 3rd Qu.:1.5682   3rd Qu.:12.0  
 Max.   :2.2355   Max.   :14.6  </code></pre>
</div>
</div>
<p>The obvious <code>tidyverse</code> way is actually a bit inelegant, because you have to calculate two things for two variables:<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>myeloma <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">logbun.q1 =</span> <span class="fu">quantile</span>(logbun, <span class="fl">0.25</span>),</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">logbun.q3 =</span> <span class="fu">quantile</span>(logbun, <span class="fl">0.75</span>),</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">hgb.q1 =</span> <span class="fu">quantile</span>(hgb, <span class="fl">0.25</span>),</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">hgb.q3 =</span> <span class="fu">quantile</span>(hgb, <span class="fl">0.75</span>)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["logbun.q1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["logbun.q3"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["hgb.q1"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hgb.q3"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.1461","2":"1.5682","3":"8.8","4":"12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Next is the tidyverse-approved way to get both quartiles for both variables at once. Use <code>across</code> to select the variables to use, and then something with a squiggle and a dot to say “do this on each of the columns selected in the <code>across</code>”. If you have a cleverer way to select those two columns without naming them, go for it. Read this in English as “for each of the columns <code>logbun</code> and <code>hgb</code>, work out the first and third quantiles of it”, where the dot is read as “it”. This works but is not the best way:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>myeloma <span class="sc">%&gt;%</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">c</span>(logbun, hgb), </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>                   \(x) <span class="fu">quantile</span>(x, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in
dplyr 1.1.0.
ℹ Please use `reframe()` instead.
ℹ When switching from `summarise()` to `reframe()`, remember that `reframe()`
  always returns an ungrouped data frame and adjust accordingly.</code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["logbun"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["hgb"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.1461","2":"8.8"},{"1":"1.5682","2":"12.0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The warning says that <code>summarize</code> is designed for situations where the summary is a <em>single</em> number. (The people behind <code>summarize</code> have changed their mind on this; it used to work, indeed it still does work, but “deprecated” means “one day it will stop working and our advice is to work out what to do now rather than later”.) Reading the warning carefully is the right way to figure out what to do. The <code>tidyverse</code> people have put a good deal of effort into making their messages readable and helpful, so the least we can do is to repay their hard work.</p>
<p>The message says to use <code>reframe</code> rather than <code>summarize</code>, so let’s try that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>myeloma <span class="sc">%&gt;%</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="fu">across</span>(<span class="fu">c</span>(logbun, hgb), </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                   \(x) <span class="fu">quantile</span>(x, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["logbun"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["hgb"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.1461","2":"8.8"},{"1":"1.5682","2":"12.0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This works without warnings. We have lost which quartile is which, but of course the lower one must be Q1 and the higher one Q3 for each variable.<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a></p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" type="a">
<li>Create a data frame containing all possible combinations of the two quartiles for each of the two variables, and display the result.</li>
</ol>
<p>Solution</p>
<p>This is <code>datagrid</code>. My best model is the one I called <code>y.2</code> (I had to scroll back a ways to find it), so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">datagrid</span>(<span class="at">model =</span> myeloma<span class="fl">.2</span>, <span class="at">logbun =</span> <span class="fu">c</span>(<span class="fl">1.14561</span>, <span class="fl">1.5682</span>), <span class="at">hgb =</span> <span class="fu">c</span>(<span class="fl">8.8</span>, <span class="fl">12.0</span>))</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["time"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["vstatus"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["logbun"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hgb"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rowid"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"24.00769","2":"1","3":"1.14561","4":"8.8","5":"1"},{"1":"24.00769","2":"1","3":"1.14561","4":"12.0","5":"2"},{"1":"24.00769","2":"1","3":"1.56820","4":"8.8","5":"3"},{"1":"24.00769","2":"1","3":"1.56820","4":"12.0","5":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Or anything equivalent to that.</p>
<p>The place you have to get to in the end is a data frame with columns called <code>logbun</code> and <code>hgb</code>, and the right four combinations of values. If you want to round the <code>logbun</code> values off more, for example to two decimals, that’s fine; it won’t affect the graph that’s coming up.</p>
<p>In fact, for predictions, you also need some times to predict for. We’ll use 10, 20, and 35, gluing those onto the end of the <code>datagrid</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">datagrid</span>(<span class="at">model =</span> myeloma<span class="fl">.2</span>, <span class="at">logbun =</span> <span class="fu">c</span>(<span class="fl">1.14561</span>, <span class="fl">1.5682</span>), </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">hgb =</span> <span class="fu">c</span>(<span class="fl">8.8</span>, <span class="fl">12.0</span>), <span class="at">time =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">35</span>))</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["vstatus"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["logbun"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["hgb"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["time"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rowid"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"1","2":"1.14561","3":"8.8","4":"10","5":"1"},{"1":"1","2":"1.14561","3":"8.8","4":"20","5":"2"},{"1":"1","2":"1.14561","3":"8.8","4":"35","5":"3"},{"1":"1","2":"1.14561","3":"12.0","4":"10","5":"4"},{"1":"1","2":"1.14561","3":"12.0","4":"20","5":"5"},{"1":"1","2":"1.14561","3":"12.0","4":"35","5":"6"},{"1":"1","2":"1.56820","3":"8.8","4":"10","5":"7"},{"1":"1","2":"1.56820","3":"8.8","4":"20","5":"8"},{"1":"1","2":"1.56820","3":"8.8","4":"35","5":"9"},{"1":"1","2":"1.56820","3":"12.0","4":"10","5":"10"},{"1":"1","2":"1.56820","3":"12.0","4":"20","5":"11"},{"1":"1","2":"1.56820","3":"12.0","4":"35","5":"12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol type="i">
<li>Obtain predicted survival probabilities for each of the combinations of variables you created above.</li>
</ol>
<p>Solution</p>
<p>This is <code>predictions</code> from <code>marginaleffects</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">predictions</span>(myeloma<span class="fl">.2</span>, <span class="at">newdata =</span> new, <span class="at">type =</span> <span class="st">"survival"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(logbun, hgb, time, estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["logbun"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["hgb"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["time"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.14561","2":"8.8","3":"10","4":"0.8072949"},{"1":"1.14561","2":"8.8","3":"20","4":"0.5389476"},{"1":"1.14561","2":"8.8","3":"35","4":"0.4292788"},{"1":"1.14561","2":"12.0","3":"10","4":"0.8641883"},{"1":"1.14561","2":"12.0","3":"20","4":"0.6560706"},{"1":"1.14561","2":"12.0","3":"35","4":"0.5617943"},{"1":"1.56820","2":"8.8","3":"10","4":"0.6427128"},{"1":"1.56820","2":"8.8","3":"20","4":"0.2790169"},{"1":"1.56820","2":"8.8","3":"35","4":"0.1744171"},{"1":"1.56820","2":"12.0","3":"10","4":"0.7397640"},{"1":"1.56820","2":"12.0","3":"20","4":"0.4187878"},{"1":"1.56820","2":"12.0","3":"35","4":"0.3039940"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Despite what it says in the original question, this is not too long to look at (the old way was). For example, increasing <code>hgb</code> increases survival probability somewhat, if you compare the same <code>logbun</code> at the same time, and increasing <code>logbun</code> for the some <code>hgb</code> decreases survival probability by a bit more.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="10" type="a">
<li>Obtain a graph of the predicted survival curves for each combination of your variables.</li>
</ol>
<p>Solution</p>
<p>You can do this in one shot or two, but it’s <code>plot_predictions</code> either way.</p>
<p>The one-shot version is to put both <code>logbun</code> and <code>hgb</code> in at once (with <code>time</code> first, since the predictions depend on time which goes on the <span class="math inline">\(x\)</span>-axis):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(myeloma<span class="fl">.2</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"logbun"</span>, <span class="st">"hgb"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The first thing in <code>condition</code> goes on the <span class="math inline">\(x\)</span>-axis (time), the second thing is colour (the selected values of <code>logbun</code>), and the third thing is facets (the selected values of <code>hgb</code>).</p>
<p>If you don’t like that, or don’t fancy your chances of interpreting it (in a moment), do the two explanatory variables one at a time. First this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(myeloma<span class="fl">.2</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"logbun"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>and then this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(myeloma<span class="fl">.2</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"time"</span>, <span class="st">"hgb"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Keep the time first, to make sure it appears on the plot where it should. These two graphs leave you only one thing to compare (the colours, each time).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="11" type="a">
<li>Is it better to have high or low values for each of the variables in your prediction? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The best survival curve is the top-right one in each case.</p>
<p>On the graph of <code>logbun</code>, this is the red curve, that goes with the <em>lowest</em> value of <code>logbun</code>. So the lowest value on this variable is the best, and as <code>logbun</code> increases, the survival gets progressively worse. With <code>hgb</code>, it is the other way around: the lowest value is worst, and the highest value (pink curve) is the best.</p>
<p>If you prefer the one-shot graph with both explanatory variables on it:</p>
<ul>
<li>to assess <code>logbun</code>, pick a facet, and see which curve is best: the red one, which goes with the <em>lowest</em> <code>logbun</code> value.</li>
<li>to assess <code>hgb</code>, cast your eye across the facets (along the first row and then the second) and see what is happening to the survival curves as you move from one facet to the next. These ones are moving up in their facet, so survival is improving as <code>hgb</code> increases (those numbers on the top of the facets are values of <code>hgb</code>).</li>
</ul>
<p>Another way to think about this is to mentally compare all of those survival curves and ask which is the best out of all of them: the one for <code>logbun</code> 0.7782 (the smallest value), and <code>hgb</code> 14.6 (the largest value).</p>
<p>Extra 1: the conclusions from the graphs are the same as those from the <code>summary</code> table (as they should be). The coefficient of <code>logbun</code> is 1.72, positive, so that a higher value is associated with a higher hazard of death (and thus a smaller value is better). On the other hand, the coefficient of <code>hgb</code>, -0.12, is negative, so that a higher value <em>decreases</em> the hazard of death, and is thus better. You might find it confusing that things are this way around; the story is that you have to get used to it, and one way to do that is to phrase it in terms of hazard of death (or whatever the event is), and then decide whether that is good or bad.</p>
<p>Extra 2: for <code>ggplot</code> enthusiasts among you: when you have three variables in a <code>plot_predictions</code>, the plot uses <code>facet_wrap</code>. When you have <em>four</em> of them (as one of the plots in one of the other problems does), it uses <code>facet_grid</code>, which is the way to handle <em>two</em> extra categorical or made-categorical variables. In this case, the quantitative variables <code>hgb</code> and <code>logbun</code> have been broken up into five distinct values, although they could take any of the values in between; they have been made categorical to enable us to draw a graph.</p>
<p>Extra 3: the model we fitted here assumes that each variable has a one-directional effect: that is, survival is better the higher the variable’s value gets (<code>hgb</code>) or the lower it gets (<code>logbun</code>), but it can’t change direction. You might imagine an explanatory variable that has a “best” value: survival improves as the value increases, until it reaches the best value, and then, as it increases further, survival gets worse again. To model something like that, you might add a squared term in the variable and see whether that is significant; if it is, the relationship is curved rather than linear. An example of a variable for which that might be true is blood pressure; it is dangerous to have a blood pressure that is too high (“hypertension”) or one that is too low (“hypotension”).</p>
<p>Extra 4: Things that are tests, like <code>logbun</code>, are often set up so that a high value is the abnormal one (so that an abnormal one will be easy to spot). Things that are measurements, like <code>hgb</code>, might have an ideal range, but the better value could be high or low, depending on what is being measured.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="ovarian-cancer-1" class="level2" data-number="30.8">
<h2 data-number="30.8" class="anchored" data-anchor-id="ovarian-cancer-1"><span class="header-section-number">30.8</span> Ovarian cancer</h2>
<p>R’s <code>survival</code> package contains several data sets. One of these is called <code>ovarian</code>; it comes from a study of 26 ovarian cancer patients. The major purpose of this study was to compare the effects of two treatments on survival time.</p>
<ol type="a">
<li>Obtain and display (all of) the data set. This is as simple as loading the package and typing the data set’s name.</li>
</ol>
<p>Solution</p>
<p>Thus. You may need to start with <code>library(survival)</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>ovarian</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["futime"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fustat"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["resid.ds"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rx"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["ecog.ps"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"59","2":"1","3":"72.3315","4":"2","5":"1","6":"1","_rn_":"1"},{"1":"115","2":"1","3":"74.4932","4":"2","5":"1","6":"1","_rn_":"2"},{"1":"156","2":"1","3":"66.4658","4":"2","5":"1","6":"2","_rn_":"3"},{"1":"421","2":"0","3":"53.3644","4":"2","5":"2","6":"1","_rn_":"4"},{"1":"431","2":"1","3":"50.3397","4":"2","5":"1","6":"1","_rn_":"5"},{"1":"448","2":"0","3":"56.4301","4":"1","5":"1","6":"2","_rn_":"6"},{"1":"464","2":"1","3":"56.9370","4":"2","5":"2","6":"2","_rn_":"7"},{"1":"475","2":"1","3":"59.8548","4":"2","5":"2","6":"2","_rn_":"8"},{"1":"477","2":"0","3":"64.1753","4":"2","5":"1","6":"1","_rn_":"9"},{"1":"563","2":"1","3":"55.1781","4":"1","5":"2","6":"2","_rn_":"10"},{"1":"638","2":"1","3":"56.7562","4":"1","5":"1","6":"2","_rn_":"11"},{"1":"744","2":"0","3":"50.1096","4":"1","5":"2","6":"1","_rn_":"12"},{"1":"769","2":"0","3":"59.6301","4":"2","5":"2","6":"2","_rn_":"13"},{"1":"770","2":"0","3":"57.0521","4":"2","5":"2","6":"1","_rn_":"14"},{"1":"803","2":"0","3":"39.2712","4":"1","5":"1","6":"1","_rn_":"15"},{"1":"855","2":"0","3":"43.1233","4":"1","5":"1","6":"2","_rn_":"16"},{"1":"1040","2":"0","3":"38.8932","4":"2","5":"1","6":"2","_rn_":"17"},{"1":"1106","2":"0","3":"44.6000","4":"1","5":"1","6":"1","_rn_":"18"},{"1":"1129","2":"0","3":"53.9068","4":"1","5":"2","6":"1","_rn_":"19"},{"1":"1206","2":"0","3":"44.2055","4":"2","5":"2","6":"1","_rn_":"20"},{"1":"1227","2":"0","3":"59.5890","4":"1","5":"2","6":"2","_rn_":"21"},{"1":"268","2":"1","3":"74.5041","4":"2","5":"1","6":"2","_rn_":"22"},{"1":"329","2":"1","3":"43.1370","4":"2","5":"1","6":"1","_rn_":"23"},{"1":"353","2":"1","3":"63.2192","4":"1","5":"2","6":"2","_rn_":"24"},{"1":"365","2":"1","3":"64.4247","4":"2","5":"2","6":"1","_rn_":"25"},{"1":"377","2":"0","3":"58.3096","4":"1","5":"2","6":"1","_rn_":"26"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>There are indeed 26 rows. This is a <code>data.frame</code> rather than a <code>tibble</code>, so you might see the whole thing, in case you were expecting something like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>ovarian <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["futime"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fustat"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["resid.ds"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rx"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["ecog.ps"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"59","2":"1","3":"72.3315","4":"2","5":"1","6":"1"},{"1":"115","2":"1","3":"74.4932","4":"2","5":"1","6":"1"},{"1":"156","2":"1","3":"66.4658","4":"2","5":"1","6":"2"},{"1":"421","2":"0","3":"53.3644","4":"2","5":"2","6":"1"},{"1":"431","2":"1","3":"50.3397","4":"2","5":"1","6":"1"},{"1":"448","2":"0","3":"56.4301","4":"1","5":"1","6":"2"},{"1":"464","2":"1","3":"56.9370","4":"2","5":"2","6":"2"},{"1":"475","2":"1","3":"59.8548","4":"2","5":"2","6":"2"},{"1":"477","2":"0","3":"64.1753","4":"2","5":"1","6":"1"},{"1":"563","2":"1","3":"55.1781","4":"1","5":"2","6":"2"},{"1":"638","2":"1","3":"56.7562","4":"1","5":"1","6":"2"},{"1":"744","2":"0","3":"50.1096","4":"1","5":"2","6":"1"},{"1":"769","2":"0","3":"59.6301","4":"2","5":"2","6":"2"},{"1":"770","2":"0","3":"57.0521","4":"2","5":"2","6":"1"},{"1":"803","2":"0","3":"39.2712","4":"1","5":"1","6":"1"},{"1":"855","2":"0","3":"43.1233","4":"1","5":"1","6":"2"},{"1":"1040","2":"0","3":"38.8932","4":"2","5":"1","6":"2"},{"1":"1106","2":"0","3":"44.6000","4":"1","5":"1","6":"1"},{"1":"1129","2":"0","3":"53.9068","4":"1","5":"2","6":"1"},{"1":"1206","2":"0","3":"44.2055","4":"2","5":"2","6":"1"},{"1":"1227","2":"0","3":"59.5890","4":"1","5":"2","6":"2"},{"1":"268","2":"1","3":"74.5041","4":"2","5":"1","6":"2"},{"1":"329","2":"1","3":"43.1370","4":"2","5":"1","6":"1"},{"1":"353","2":"1","3":"63.2192","4":"1","5":"2","6":"2"},{"1":"365","2":"1","3":"64.4247","4":"2","5":"2","6":"1"},{"1":"377","2":"0","3":"58.3096","4":"1","5":"2","6":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>which doesn’t change anything in <code>ovarian</code>, but changes what kind of thing it is (and thus how it displays). Usually when you read something in from a file, you use something like <code>read_delim</code> that makes a <code>tibble</code>, but this one wasn’t read in from a file. It was stored in the package as an old-fashioned <code>data.frame</code>, and so that’s how it stays.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>The columns of interest to us are:</li>
</ol>
<ul>
<li><p><code>futime</code>: the time for which a patient was followed-up: the number of days until either they died or the study ended (or they withdrew from the study for some other reason).</p></li>
<li><p><code>fustat</code>: follow-up status: 1 if the patient died of ovarian cancer, 0 if they were still alive when the study ended.</p></li>
<li><p><code>age</code>: of patient, at diagnosis, in years</p></li>
<li><p><code>rx</code>: treatment, numbered 1 or 2, but really labels for the two treatments.</p></li>
</ul>
<p>Create and display a suitable response variable <code>y</code> for a Cox proportional-hazards model.</p>
<p>Solution</p>
<p>You’ll notice that <code>rx</code> (treatment) is a number, but it really should be categorical, so let’s first replace it with the categorical version of itself so that we don’t get in trouble later:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>ovarian <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rx =</span> <span class="fu">factor</span>(rx)) <span class="ot">-&gt;</span> ovarian</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>ovarian</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["futime"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fustat"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["resid.ds"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rx"],"name":[5],"type":["fct"],"align":["left"]},{"label":["ecog.ps"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"59","2":"1","3":"72.3315","4":"2","5":"1","6":"1","_rn_":"1"},{"1":"115","2":"1","3":"74.4932","4":"2","5":"1","6":"1","_rn_":"2"},{"1":"156","2":"1","3":"66.4658","4":"2","5":"1","6":"2","_rn_":"3"},{"1":"421","2":"0","3":"53.3644","4":"2","5":"2","6":"1","_rn_":"4"},{"1":"431","2":"1","3":"50.3397","4":"2","5":"1","6":"1","_rn_":"5"},{"1":"448","2":"0","3":"56.4301","4":"1","5":"1","6":"2","_rn_":"6"},{"1":"464","2":"1","3":"56.9370","4":"2","5":"2","6":"2","_rn_":"7"},{"1":"475","2":"1","3":"59.8548","4":"2","5":"2","6":"2","_rn_":"8"},{"1":"477","2":"0","3":"64.1753","4":"2","5":"1","6":"1","_rn_":"9"},{"1":"563","2":"1","3":"55.1781","4":"1","5":"2","6":"2","_rn_":"10"},{"1":"638","2":"1","3":"56.7562","4":"1","5":"1","6":"2","_rn_":"11"},{"1":"744","2":"0","3":"50.1096","4":"1","5":"2","6":"1","_rn_":"12"},{"1":"769","2":"0","3":"59.6301","4":"2","5":"2","6":"2","_rn_":"13"},{"1":"770","2":"0","3":"57.0521","4":"2","5":"2","6":"1","_rn_":"14"},{"1":"803","2":"0","3":"39.2712","4":"1","5":"1","6":"1","_rn_":"15"},{"1":"855","2":"0","3":"43.1233","4":"1","5":"1","6":"2","_rn_":"16"},{"1":"1040","2":"0","3":"38.8932","4":"2","5":"1","6":"2","_rn_":"17"},{"1":"1106","2":"0","3":"44.6000","4":"1","5":"1","6":"1","_rn_":"18"},{"1":"1129","2":"0","3":"53.9068","4":"1","5":"2","6":"1","_rn_":"19"},{"1":"1206","2":"0","3":"44.2055","4":"2","5":"2","6":"1","_rn_":"20"},{"1":"1227","2":"0","3":"59.5890","4":"1","5":"2","6":"2","_rn_":"21"},{"1":"268","2":"1","3":"74.5041","4":"2","5":"1","6":"2","_rn_":"22"},{"1":"329","2":"1","3":"43.1370","4":"2","5":"1","6":"1","_rn_":"23"},{"1":"353","2":"1","3":"63.2192","4":"1","5":"2","6":"2","_rn_":"24"},{"1":"365","2":"1","3":"64.4247","4":"2","5":"2","6":"1","_rn_":"25"},{"1":"377","2":"0","3":"58.3096","4":"1","5":"2","6":"1","_rn_":"26"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now, the idea is to use the appropriate one(s) of these columns in <code>Surv</code>. Remember that the response variable in a survival model encodes two things: the survival time, and whether or not the event (here death) actually happened to that patient or not. I always forget whether the second thing in <code>Surv</code> has to be 1 or 0 if the event happened. The help says that it needs to be 1 or <code>TRUE</code> if the event (death) happened, which is what <code>fustat</code> is, so we can use it as it is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">with</span>(ovarian, <span class="fu">Surv</span>(futime, fustat))</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]   59   115   156   421+  431   448+  464   475   477+  563   638   744+
[13]  769+  770+  803+  855+ 1040+ 1106+ 1129+ 1206+ 1227+  268   329   353 
[25]  365   377+</code></pre>
</div>
</div>
<p>This creates a separate variable <code>y</code> outside of any data frame. This is fine, because when we actually fit the model, we repeat the <code>Surv</code> rather than using the <code>y</code> we just made, which was only for practice.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>In the display of your response variable, some values are marked with a <code>+</code>. Why is that? Explain briefly. (If you use a technical term, you should explain what it means.)</li>
</ol>
<p>Solution</p>
<p>These are the censored observations. You can say this, but you also need to say what that means (this is the “technical term” referred to in the question). The observations with a <code>+</code> are individuals who were never observed to die, or who were still alive at the end of the study.</p>
<p>I want you to demonstrate that you know what censored <em>means</em>, not just that you know when you have a censored observation.</p>
<p>Extra: in a study like this, patients are typically “recruited” into the study at various different times. Patients who happened to be in the study near the beginning and who survived can have a large (censored) value of <code>y</code> (like those values over 1000 days). But a patient might join the study later on; if they survive, they might produce a censored observation with a small survival time, like the last value 377. I’m sure the doctor would have liked to follow them for longer, but the funding ran out, and the doctor had a paper to write. (There is <em>some</em> information in these small censored values, but not much, because most of the patients, even the ones who eventually died, survived for longer than 377 days.)</p>
<p>The other thing that might have happened is that a patient with the 377-censored value died <em>from something else</em> unrelated to ovarian cancer. The study is only concerned with deaths from ovarian cancer, so such a patient is treated as censored at their death time. After this point we cannot assess how long this patient survived <em>ovarian cancer</em>.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Fit a Cox proportional-hazards model for predicting survival time from age and treatment. Note that the numeric values for treatment make sense only as labels for the two treatments, so in your model formula make treatment into a factor. Display the results.</li>
</ol>
<p>Solution</p>
<p>The hint suggests something like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>time<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(futime, fustat) <span class="sc">~</span> age <span class="sc">+</span> rx, <span class="at">data =</span> ovarian)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(time<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(futime, fustat) ~ age + rx, data = ovarian)

  n= 26, number of events= 12 

        coef exp(coef) se(coef)      z Pr(&gt;|z|)   
age  0.14733   1.15873  0.04615  3.193  0.00141 **
rx2 -0.80397   0.44755  0.63205 -1.272  0.20337   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

    exp(coef) exp(-coef) lower .95 upper .95
age    1.1587      0.863    1.0585     1.268
rx2    0.4475      2.234    0.1297     1.545

Concordance= 0.798  (se = 0.076 )
Likelihood ratio test= 15.89  on 2 df,   p=4e-04
Wald test            = 13.47  on 2 df,   p=0.001
Score (logrank) test = 18.56  on 2 df,   p=9e-05</code></pre>
</div>
</div>
<p>Because I made <code>rx</code> categorical earlier, I have nothing extra to do here. If you didn’t, you might need <code>factor(rx)</code> here and below.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Is there a significant difference between the treatments in terms of their effects on survival (from ovarian cancer)?</li>
</ol>
<p>Solution</p>
<p>Look at the P-value for my <code>rx2</code>, 0.203. This is not small, so there is no evidence of a difference between treatments.</p>
<p>I got away with something here, which is that treatment is actually categorical, so I should have tested it with <code>drop1</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(time<span class="fl">.1</span>, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"58.08380","3":"NA","4":"NA","_rn_":"<none>"},{"1":"1","2":"70.91843","3":"14.834630","4":"0.0001173606","_rn_":"age"},{"1":"1","2":"57.67629","3":"1.592497","4":"0.2069697652","_rn_":"rx"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The reason it didn’t matter here is that there were only two treatments, and therefore that testing the coefficient was equivalent to testing the whole categorical variable (a one degree of freedom test either way). If there had been three or more treatments, then the <code>summary</code> table would have compared each one with the baseline treatment, which is not the same as testing for <em>any</em> differences among treatments.</p>
<p>The P-values are very close but not identical because <code>drop1</code> is using a so-called likelihood ratio test, and <code>summary</code> is using a Wald test, and they are different. In a regular regression, these two tests are identical, but once you get away from regression, they are only “asymptotically equivalent”, meaning that they would be identical if you had an infinitely large sample size, but for actual real sample sizes, they can be a bit different. Usually though, as here, they are not different enough to change your conclusion about significance.</p>
<p>Extra: the reason for the odd label is that we have turned treatment into a categorical variable; treatment 1 is used as the baseline, and the negative slope says that the “hazard of death” is lower for treatment 2 than for treatment 1: that is, people survive longer on treatment 2, but the difference is not big enough to be significant (we also have a smallish sample size).</p>
<p>Since there are only two treatments, it would in fact have been OK to leave them as numbers (with two numbers one unit apart, the slope would have been the same size as here), but I think it’s a good idea to treat categorical variables as categorical. My own habit is to use letters or something non-numerical to distinguish categories. I might have used <code>t1</code> and <code>t2</code> in this case, or the names of the different treatments.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Is there a significant effect of age? If there is, describe the effect that age has on survival.</li>
</ol>
<p>Solution</p>
<p>The P-value for age is 0.0014, small, so age definitely has a significant effect on survival. As to what kind of effect, look at the slope coefficient, 0.15, positive, which means that increased age-at-diagnosis goes with an <em>increased</em> hazard of death, or that older patients do not survive as long.</p>
<p>I would like you to get to the plain-English words at the end. Part of your job as a statistician is explaining what you got to people who are doctors, managers, etc., who won’t understand the terminology.</p>
<p>Thus, when this was on an assignment, one mark for assessing significance via P-value, one for looking at the slope coefficient and noting that it is positive, and one for getting to “older patients do not survive as long”, or “older patients have a larger chance of dying sooner”. (Strictly, this is also “all else equal” as usual, since survival time might also have depended on treatment, but the point of this question is for you to get to “older patients do not survive as long”.)</p>
<p>(The interpretation of the slope may seem backwards: a positive slope means a <em>shorter</em> survival time for a larger age. This is why I talk about “hazard of death”, since that guides us to the correct interpretation.)</p>
<p>Extra: I was curious about what would happen if I just included <code>rx</code> in the model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>time<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(time<span class="fl">.1</span>, . <span class="sc">~</span> . <span class="sc">-</span> age)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(time<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(futime, fustat) ~ rx, data = ovarian)

  n= 26, number of events= 12 

       coef exp(coef) se(coef)      z Pr(&gt;|z|)
rx2 -0.5964    0.5508   0.5870 -1.016     0.31

    exp(coef) exp(-coef) lower .95 upper .95
rx2    0.5508      1.816    0.1743      1.74

Concordance= 0.608  (se = 0.07 )
Likelihood ratio test= 1.05  on 1 df,   p=0.3
Wald test            = 1.03  on 1 df,   p=0.3
Score (logrank) test = 1.06  on 1 df,   p=0.3</code></pre>
</div>
</div>
<p>Still not significant, but this model is a <em>lot worse</em> because I took out the significant <code>age</code>. What this is doing is mixing up all the people of different ages (and we know that age has an effect on survival) and trying (and failing) to discern an effect of treatment.</p>
<p>We could have been badly misled by this model if one of the treatments had predominantly older patients. We know that older patients have worse survival, so the treatment with older patients would have looked worse, even if it actually wasn’t. The model <code>time.1</code> which contained <code>age</code> properly adjusted for the effect of age, so that was the best way to see whether there was a difference between treatments.</p>
<p>What you often see early on in a paper on this kind of stuff is a graph showing that the treatment groups are similar in terms of important things like <code>age</code>. Here, that could be a boxplot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ovarian, <span class="fu">aes</span>(<span class="at">x =</span> rx, <span class="at">y =</span> age)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/ovarian-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>0.14733</p>
<p>You might need to do <code>factor(rx)</code> because <code>geom_boxplot</code> needs a genuine categorical variable, not just a numerical variable masquerading as one. If you just leave it as the numerical <code>rx</code>, as I discovered, you get <em>one</em> boxplot of all the ages together regardless of treatment. The key, for you as user of software, is not (necessarily) to get it right the first time, but to know what to do to fix up the errors you will inevitably get. If you have worked through the boxplot examples in C32 and D29, you will have enough experience to remember that a boxplot has to have a categorical <code>x</code> (text will do, but definitely not numbers). This is why I give you so many things to work through: so that you gain the experience to know how to fix up problems.</p>
<p>Treatment 1 has a larger spread of ages and treatment 2 has a low outlier age, but the median ages are very similar.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Make a martingale residual plot for this model. Do you see any problems? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The plot is just the same idea as the one in the notes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>time<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">augment</span>(ovarian) <span class="sc">%&gt;%</span> </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/ovarian-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Make a call about whether you think the smooth trend deviates too much from the red dotted line going across at zero. Martingale residuals can get very negative (and that is OK), so that residual of <span class="math inline">\(-2\)</span> is not a problem, and this is pulling the smooth trend down a bit (it’s the reason for the dip on the right side of the smooth trend). So I’d call this OK, but you can make whatever call you like as long as it’s supported by what you see here.</p>
<p>I observe that the obvious fixable thing is where you have a curve here, one that looks like a parabola (at which point you add squared terms to your explanatory variables and see if that helps, as for <code>bmi</code> in one of the other problems). This one is too wiggly to be a parabola (it bends <em>twice</em>), and so is more like a cubic than anything.</p>
<p>The other thing you can note is that the grey envelope is “not significantly different from zero”, since 0 is clearly within the grey envelope all the way across.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" type="a">
<li>Find the quartiles of <code>age</code>, and make a data frame containing all combinations of those two ages and the two treatments. Display what you have. (Feel free to copy the values by hand, rather than trying to save them and use them.)</li>
</ol>
<p>Solution</p>
<p>I imagine you can guess what we are going to be doing with these: predictions, so we’ll call the data frame <code>new</code> when we get there.</p>
<p>Quartiles first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(ovarian<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      0%      25%      50%      75%     100% 
38.89320 50.16712 56.84660 62.37810 74.50410 </code></pre>
</div>
</div>
<p>or, if you prefer,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>ovarian <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">q1 =</span> <span class="fu">quantile</span>(age, <span class="fl">0.25</span>),</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">q3 =</span> <span class="fu">quantile</span>(age, <span class="fl">0.75</span>)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["q1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["q3"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"50.16712","2":"62.3781"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The quartiles are 50.17 and 62.38 (rounding slightly).</p>
<p>Either way is good.</p>
<p>Then follow my standard procedure (or one of your own devising), remembering that “treatment” is called <code>rx</code> here:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">50.17</span>, <span class="fl">62.38</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>rxs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">datagrid</span>(<span class="at">model =</span> time<span class="fl">.1</span>, <span class="at">age =</span> ages, <span class="at">rx =</span> rxs)</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["futime"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fustat"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["rx"],"name":[4],"type":["fct"],"align":["left"]},{"label":["rowid"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"599.5385","2":"0","3":"50.17","4":"1","5":"1"},{"1":"599.5385","2":"0","3":"50.17","4":"2","5":"2"},{"1":"599.5385","2":"0","3":"62.38","4":"1","5":"3"},{"1":"599.5385","2":"0","3":"62.38","4":"2","5":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The values 1 and 2 for <code>rx</code> should be in quotes (they are levels of a categorical variable), but it seems to work all right if they are not (this might be <code>datagrid</code> being clever on our behalf).</p>
<p>Extra: recall that actual predictions of survival probabilities also depend on time, which is in <code>futime</code> here. Let’s pick about three times:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(ovarian<span class="sc">$</span>futime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     0%     25%     50%     75%    100% 
  59.00  368.00  476.00  794.75 1227.00 </code></pre>
</div>
</div>
<p>so, say, 350, 500, and 800 (rounded-off median and quartiles):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">50.17</span>, <span class="fl">62.38</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>rxs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>futimes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">350</span>, <span class="dv">500</span>, <span class="dv">800</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">datagrid</span>(<span class="at">model =</span> time<span class="fl">.1</span>, <span class="at">age =</span> ages, <span class="at">rx =</span> rxs, <span class="at">futime =</span> futimes)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["fustat"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["rx"],"name":[3],"type":["fct"],"align":["left"]},{"label":["futime"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["rowid"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"0","2":"50.17","3":"1","4":"350","5":"1"},{"1":"0","2":"50.17","3":"1","4":"500","5":"2"},{"1":"0","2":"50.17","3":"1","4":"800","5":"3"},{"1":"0","2":"50.17","3":"2","4":"350","5":"4"},{"1":"0","2":"50.17","3":"2","4":"500","5":"5"},{"1":"0","2":"50.17","3":"2","4":"800","5":"6"},{"1":"0","2":"62.38","3":"1","4":"350","5":"7"},{"1":"0","2":"62.38","3":"1","4":"500","5":"8"},{"1":"0","2":"62.38","3":"1","4":"800","5":"9"},{"1":"0","2":"62.38","3":"2","4":"350","5":"10"},{"1":"0","2":"62.38","3":"2","4":"500","5":"11"},{"1":"0","2":"62.38","3":"2","4":"800","5":"12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol type="i">
<li>Obtain predicted survival probabilities for each of your age-treatment combinations, for each of a variety of survival times. (This is only one thing, despite it sounding like a lot.)</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">predictions</span>(time<span class="fl">.1</span>, <span class="at">newdata =</span> new, <span class="at">type =</span> <span class="st">"survival"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, rx, futime, estimate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["rx"],"name":[2],"type":["fct"],"align":["left"]},{"label":["futime"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"50.17","2":"1","3":"350","4":"0.93188906"},{"1":"50.17","2":"1","3":"500","4":"0.76754283"},{"1":"50.17","2":"1","3":"800","4":"0.63449640"},{"1":"50.17","2":"2","3":"350","4":"0.96892249"},{"1":"50.17","2":"2","3":"500","4":"0.88833748"},{"1":"50.17","2":"2","3":"800","4":"0.81578873"},{"1":"62.38","2":"1","3":"350","4":"0.65294390"},{"1":"62.38","2":"1","3":"500","4":"0.20216448"},{"1":"62.38","2":"1","3":"800","4":"0.06399272"},{"1":"62.38","2":"2","3":"350","4":"0.82631986"},{"1":"62.38","2":"2","3":"500","4":"0.48895633"},{"1":"62.38","2":"2","3":"800","4":"0.29220453"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>To eyeball these: the effect of treatment seems to be smallish (compare rows 1 and 4, or 2 and 5, of what you see here), but the effect of age is more substantial (compare rows 1 and 7, with the same treatment but different ages, or rows 2 and 8). This matches up to what we found out about significance earlier.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="10" type="a">
<li>Draw a plot that compares the survival probabilities at the different times.</li>
</ol>
<p>Solution</p>
<p>One plot per explanatory variable might be easier to interpret:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(time<span class="fl">.1</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"futime"</span>, <span class="st">"age"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>and</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(time<span class="fl">.1</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"futime"</span>, <span class="st">"rx"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
-Inf</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Or you could put both age and treatment on one plot. Treatment is categorical, so this might fit better on facets (ie. as the last thing in <code>condition</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(time<span class="fl">.1</span>, <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">"futime"</span>, <span class="st">"age"</span>, <span class="st">"rx"</span>), <span class="at">type =</span> <span class="st">"survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="survival-analysis_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="11" type="a">
<li>According to your plot(s), how would you describe the effects of treatment and of age?</li>
</ol>
<p>Solution</p>
<p>The best survival curve is up and to the right (if we are trying to avoid an unfavourable event such as death, here).</p>
<ul>
<li>On the plot for age, the best age is the youngest one (38.9 years old on the graph: it picked some ages for us). The envelopes for ages seem to be distinct, for the most part, so that the effect of age appears to be a real one.</li>
<li>On the plot for treatment, treatment 2 appears to be better than treatment 1, but the envelopes are indistinguishable, which is consistent with the treatment difference not being significant.</li>
<li>On the two-facet plot with both explanatory variables, the age effect is clear, with the youngest age at the top and the oldest at the bottom (so being younger is associated with better survival) in each facet. To assess the treatment effect, compare the patterns in the left and right facet: the story is very much the same, so treatment doesn’t make much difference to survival.</li>
</ul>
<p>Extra: recall the output from the Cox model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(time<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(futime, fustat) ~ age + rx, data = ovarian)

  n= 26, number of events= 12 

        coef exp(coef) se(coef)      z Pr(&gt;|z|)   
age  0.14733   1.15873  0.04615  3.193  0.00141 **
rx2 -0.80397   0.44755  0.63205 -1.272  0.20337   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

    exp(coef) exp(-coef) lower .95 upper .95
age    1.1587      0.863    1.0585     1.268
rx2    0.4475      2.234    0.1297     1.545

Concordance= 0.798  (se = 0.076 )
Likelihood ratio test= 15.89  on 2 df,   p=4e-04
Wald test            = 13.47  on 2 df,   p=0.001
Score (logrank) test = 18.56  on 2 df,   p=9e-05</code></pre>
</div>
</div>
<p>The slope coefficient for treatment 2 (as compared to the baseline treatment 1) was <span class="math inline">\(-0.83097\)</span>, <em>negative</em>, which meant that patients on treatment 2 had a <em>lower</em> hazard of death than patients on treatment 1: that is, that treatment 2 was better for survival than treatment 1. That is what the plot said also (and the relatively small difference is consistent with that difference not being significant).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Heart attack.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Worcester is pronounced, by locals, <em>Woo-stuh</em>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Barbecued pork in a bun. A staple of Chinese dim sum and Chinese bakeries, such as Ding Dong bakery on Spadina.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Heart attack.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Worcester is pronounced, by locals, <em>Woo-stuh</em>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Not exactly the same as that output, because it is doing a test that would be the same if you had an infinitely large sample, but is slightly different with an ordinary finite number of observations.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Our categorical variable <em>gender</em> has only two levels.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>It doesn’t work with text columns, but it <em>does</em> work if you temporarily turn the text columns into factors, eg. by using <code>mutate</code> with <code>where</code>. However, we don’t have any text columns here, so what we do here is good for this data set.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p><code>case_when</code> is much clearer than using nested <code>if-else</code>s when you have three or more categories, as for <code>herco</code>.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>I now define the response variable right inside the <code>coxph</code>, in the same way as putting something like <code>log(y)</code> as a response in an <code>lm</code>, but I think, especially while you’re getting used to the process, it’s better to create the response variable first and look at it to make sure it’s the right thing.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>Or, <code>slice</code> off the first few rows.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>The researchers were probably relieved that there was not quite a significant effect of <code>site</code>.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>Not at the 0.05 level, anyway.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>Barbecued pork in a bun. A staple of Chinese dim sum and Chinese bakeries, such as Ding Dong bakery on Spadina.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>Don’t confuse this with <code>glance</code> from <code>broom</code>, which gives a one-line summary of a <em>model</em>, containing things like R-squared and a test for the overall model significance.<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>Because <em>summarize</em> will only allow you to have a single-number answer.<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>The way, as we have seen elsewhere, is to use <code>tidy(quantile)</code> or <code>enframe(quantile)</code>, which produce a two-column data frame with the percentiles shown.<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./nominal-response.html" class="pagination-link" aria-label="Logistic regression with nominal response">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Logistic regression with nominal response</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./anova-revisited.html" class="pagination-link" aria-label="Analysis of variance revisited">
        <span class="nav-page-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Analysis of variance revisited</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>