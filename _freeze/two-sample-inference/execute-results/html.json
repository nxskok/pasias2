{
  "hash": "54a8cdec2bb4753d2884bea517392d9a",
  "result": {
<<<<<<< HEAD
    "engine": "knitr",
    "markdown": "# Two-sample inference\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n##  Children and electronic devices\n\n\n Do children (aged 8--17) spend more time on electronic\ndevices now than they did 10 years ago? Samples of 15 children aged\n8--17 were taken in each of two years, 1999 and 2009, and the children (with\ntheir parents' help) were\nasked to keep a diary of the number of hours they spent using\nelectronic devices on a certain day. The data are in the file\n[http://ritsokiguess.site/datafiles/pluggedin.txt](http://ritsokiguess.site/datafiles/pluggedin.txt).\n\n\n\n(a) Read in the data and  verify that you have 30 rows of data from two\ndifferent years.\n\n\n\n(b) Draw side-by-side boxplots of the number of hours for each\nyear. `year` is a numeric variable that we want to treat as a\nfactor, so we need to *make* it into a factor.\n\n\n\n\n(c) Test whether the mean number of hours has *increased* since 1999. Which test did R do?\n\n\n\n\n(d) Obtain a 99\\% confidence interval for the difference in means.\n\n\n\n\n\n\n\n\n\n\n##  Parking close to the curb\n\n\n In 2009, the Toronto Star commissioned a survey to address\nthe issue of who is better at parking a car: men or women. The\nresearchers recorded 93 drivers who were parallel-parking their car in\ndowntown Toronto, and for each driver, recorded the distance between\nthe car and the curb, in inches, when the driver was finished parking\ntheir car. The data are in an Excel spreadsheet,\n[link](http://ritsokiguess.site/datafiles/parking.xlsx).  Click on the link. The data\nwill probably download automatically. Check the folder on your\ncomputer where things get downloaded.^[Mine is rather  prosaically called `Downloads`.] \nIf the spreadsheet is just\ndisplayed and not downloaded, save it somewhere on your computer.\n\n\n\n(a) There are two sheets in this spreadsheet workbook. They are\nof the same data in two different formats. Take a look at Sheet 1\nand Sheet 2. Describe the format of the data in each case. Which will be the most suitable data layout, bearing in\nmind that one of the first things we do is to make side-by-side\nboxplots of parking distances for males and females? Explain briefly.\n\n\n\n(b) Read your preferred sheet directly into R, *without*\nusing a `.csv` file. (There is a clue in the lecture notes,\nin the section about reading in files.) If you get stuck, make a\n`.csv` file and read that in.\n\n\n\n(c) Obtain side-by-side boxplots of parking distances for\nmales and females. Does one\ngender seem to be better at parking than the other? Explain briefly.\n\n\n\n(d) Explain briefly why this is two independent samples\nrather than matched pairs.\n\n\n\n(e) Run a suitable $t$-test for comparing parking distances\nfor males and females. What do you conclude, in the context of the data?\n\n\n\n(f) Why might you have some doubts about the $t$-test that\nyou just did? Explain briefly.\n\n\n\n(g) The Toronto Star in its report said that females are\nmore accurate at parking their cars. Why do you think they\nconcluded that, and do you think they were right to do so?\nExplain briefly.\n\n\n\n\n\n\n\n\n##  Bell peppers and too much water\n\n\n A pathogen called *Phytophthora capsici* causes bell\npeppers to wilt and die. It is thought that too much water aids in the\nspread of the pathogen. Two fields are under study, labelled\n`a` and `b`. The first step in the research project is\nto compare the mean soil  water content of the two fields.  There is\na suspicion that field `a` will have a higher water content\nthan field `b`. The data\nare in the\nfile\n[link](http://ritsokiguess.site/datafiles/bellpepper.csv).\n\n\n(a) Read the file in using `read_csv`, and\nlist the resulting data frame.\n \n\n(b) Make side-by-side boxplots of the water content values for\nthe two fields. How do the fields seem to compare?\n \n\n(c) Do a two-sample $t$-test to test whether there is evidence\nthat the mean water\ncontent in field `a` is higher than that of field\n`b`. What do you conclude? Explain briefly. (You'll need to\nfigure out a way of doing a one-sided test, or how to adapt the\nresults from a two-sided test.)\n \n\n(d) Is the result of your test consistent with the boxplot, or\nnot? Explain briefly.\n \n\n\n\n\n##  Exercise and anxiety and bullying mice\n\n\n Does exercise help to reduce anxiety?\nTo assess this, some researchers randomly assigned\nmice to either \nan enriched environment where there was an exercise wheel available,\nor a standard environment with no exercise options. After three weeks\nin the specified environment, for five minutes a day for two weeks,\nthe mice were each exposed to a \"mouse bully\" --- a mouse who was very\nstrong, aggressive, and territorial. One measure of mouse anxiety is\namount of time hiding in a dark compartment, with mice who are more\nanxious spending more time in darkness. The amount of time spent in\ndarkness is recorded for each of the mice. \n\nThe data can be found at\n[link](http://ritsokiguess.site/datafiles/stressedmice.txt). \n\n\n\n(a) Read the data into R, and display your data frame. Count the number of mice in each group. \n\n\n(b) Draw side-by-side boxplots of time spent in darkness for each\ngroup of mice.\n\n\n(c) Do the boxplots support the hypothesis about exercise and\nanxiety? Explain briefly.\n\n\n(d) Carry out a $t$-test for comparing the mean time spent in\ndarkness for the mice in the two groups. Think carefully about the\ndetails of the $t$-test (and what you need evidence in favour of).\n\n\n(e) What do you conclude, in terms of anxiety and exercise (at\nleast for mice)? Explain  briefly.\n\n\n(f) Does anything in the previous parts suggest any problems with\nthe analysis you just did? Explain briefly.\n\n\n\n\n\n##  Diet and growth in boys\n\n\n A dietician is studying the effect of\ndifferent diets on children's growth. In part of the study, the\ndietician is investigating two religious sects, labelled `a`\nand `b` in our data set. Both sects are vegetarian; the\ndifference between them is that people in Sect A only eat vegetables\nfrom below the ground, and Sect B only eats vegetables from above the\nground. The height and weight of the boys^[This was not sexism, but a recognition that boys and girls will be of different heights for reasons unrelated to diet. Doing it this way makes the analysis simpler.] are measured at regular\nintervals. The data in\n[link](http://ritsokiguess.site/datafiles/kids-diet.txt) are the\nheights of the boys at age 12.\n\n\n\n(a) Read in the data and find out how many observations you have\nand which variables.\n\n\n\n(b) Obtain side-by-side boxplots of the heights for boys from\neach sect. Does it look as if the heights of the boys in each sect\nare different? Comment briefly. \n\n\n\n(c) Looking at your boxplots, do you see any problems with\ndoing a two-sample $t$-test? Explain briefly.\n\n\n\n(d) Run a $t$-test to determine whether the mean heights differ\nsignificantly. What do you conclude? Explain briefly. (Run the\n$t$-test even if your previous work suggests that it is not the\nright thing to do.)\n\n\n\n\n\n\n\n\n## Handspans of males and females\n\n Take your right hand, and stretch the fingers out as far as\nyou can. The distance between the tip of your thumb and the tip of\nyour little (pinky) finger is your handspan. The students in a\nStatistics class at Penn State measured their handspans and also\nwhether they identified as male or female. The data are at [http://ritsokiguess.site/datafiles/handspan.txt](http://ritsokiguess.site/datafiles/handspan.txt),\nwith handspans\nmeasured in inches.  Thinking of these as a random sample of all\npossible students, is it true that males have a larger mean handspan\nthan females? This is what we will explore.\n\n\n(a) Read in and display (some of) the data.\n\n\n\n(b) Make a suitable graph of the two columns.\n\n\n\n(c) Run a suitable two-sample $t$-test to address the question\nof interest. What do you conclude, in the context of the data?\n\n\n\n(d) Obtain a 90\\% confidence interval for the difference\nin mean handspan between males and females. Do you need to run\nany more code? Explain briefly.\n\n\n\n(e) Explain briefly why you might have some concerns about the\nvalidity of the $t$-tests you ran in this question. Or, if you don't have any concerns, explain briefly why that is.\n\n\n\n\n\n\n\n## The anchoring effect: Australia vs US\n\n Two groups of students (in a class at a American university) were asked what they thought the population of Canada was. (The correct answer at the time was just over 30 million.)\nSome of the students, before having to answer this, were told that the population of the United States was about 270 million. The other students in the class were told that the population of Australia was\nabout 18 million. The data are in [http://ritsokiguess.site/datafiles/anchoring.csv](http://ritsokiguess.site/datafiles/anchoring.csv). The first column contains the country whose population the student was told, and the second contains the student's guess at the population of Canada.\n\nYou might wonder how being told the population of an unrelated country would have any impact on a student's guess at the population of Canada. Psychology says it does: it's called the *anchoring effect*, and the idea is that the number mentioned first acts as an \"anchor\": a person's guess will be closer to the anchor than it would have been otherwise. In this case, that would mean that the guesses for the students given the\nUS as an anchor will be higher than for the students given Australia as an anchor. We are interested in seeing whether there is evidence for that here.\n\n\n\n\n(a) Read in and display (some of)  the data.\n\n\n\n(b) Draw a suitable graph of these data.\n\n\n\n(c) Explain briefly why a Welch $t$-test would be better than a pooled $t$-test in this case.\n\n\n\n(d) Run a suitable Welch $t$-test and display the output.\n\n\n\n(e) What do you conclude from your test, in the context of the data?\n\n\n\n\n\n\n\n\n\nMy solutions follow:\n\n\n\n\n##  Children and electronic devices\n\n\n Do children (aged 8--17) spend more time on electronic\ndevices now than they did 10 years ago? Samples of 15 children aged\n8--17 were taken in each of two years, 1999 and 2009, and the children (with\ntheir parents' help) were\nasked to keep a diary of the number of hours they spent using\nelectronic devices on a certain day. The data are in the file\n[http://ritsokiguess.site/datafiles/pluggedin.txt](http://ritsokiguess.site/datafiles/pluggedin.txt).\n\n\n\n(a) Read in the data and  verify that you have 30 rows of data from two\ndifferent years.\n\n\nSolution\n\n\nI see this:\n\n::: {.cell}\n\n```{.r .cell-code}\nmyurl <- \"http://ritsokiguess.site/datafiles/pluggedin.txt\"\nplugged <- read_delim(myurl,\" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 30 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \" \"\ndbl (2): year, hours\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nplugged\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"year\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"hours\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1999\",\"2\":\"4\"},{\"1\":\"1999\",\"2\":\"5\"},{\"1\":\"1999\",\"2\":\"7\"},{\"1\":\"1999\",\"2\":\"7\"},{\"1\":\"1999\",\"2\":\"5\"},{\"1\":\"1999\",\"2\":\"7\"},{\"1\":\"1999\",\"2\":\"5\"},{\"1\":\"1999\",\"2\":\"6\"},{\"1\":\"1999\",\"2\":\"5\"},{\"1\":\"1999\",\"2\":\"6\"},{\"1\":\"1999\",\"2\":\"7\"},{\"1\":\"1999\",\"2\":\"8\"},{\"1\":\"1999\",\"2\":\"5\"},{\"1\":\"1999\",\"2\":\"6\"},{\"1\":\"1999\",\"2\":\"6\"},{\"1\":\"2009\",\"2\":\"5\"},{\"1\":\"2009\",\"2\":\"9\"},{\"1\":\"2009\",\"2\":\"5\"},{\"1\":\"2009\",\"2\":\"8\"},{\"1\":\"2009\",\"2\":\"7\"},{\"1\":\"2009\",\"2\":\"6\"},{\"1\":\"2009\",\"2\":\"7\"},{\"1\":\"2009\",\"2\":\"9\"},{\"1\":\"2009\",\"2\":\"7\"},{\"1\":\"2009\",\"2\":\"9\"},{\"1\":\"2009\",\"2\":\"6\"},{\"1\":\"2009\",\"2\":\"9\"},{\"1\":\"2009\",\"2\":\"10\"},{\"1\":\"2009\",\"2\":\"9\"},{\"1\":\"2009\",\"2\":\"8\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nIf you want to check for yourself that there are 30 rows, you can click Next a couple of times to get down to row 30, and then see that the Next button cannot be clicked again, and therefore that 30 rows is how many there are. At the same time, you can see that some of the dataset is from 1999 and some of it is from 2009.\n\nOr, you can summarize the years by counting how many there are\nof each:\n\n::: {.cell}\n\n```{.r .cell-code}\nplugged %>% count(year)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"year\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1999\",\"2\":\"15\"},{\"1\":\"2009\",\"2\":\"15\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nor the more verbose form of the same thing:\n\n::: {.cell}\n\n```{.r .cell-code}\nplugged %>% group_by(year) %>% summarize(rows=n())\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"year\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"rows\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1999\",\"2\":\"15\"},{\"1\":\"2009\",\"2\":\"15\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nAny of those says that it looks good. 30 rows, years 1999 and 2009, 15\nmeasurements for each.\n\n$\\blacksquare$\n\n(b) Draw side-by-side boxplots of the number of hours for each\nyear. `year` is a numeric variable that we want to treat as a\nfactor, so we need to *make* it into a factor.\n\n\n\nSolution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(plugged, aes(x = factor(year), y = hours)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/waehingen-1.png){width=672}\n:::\n:::\n\nThe `fct_inorder` trick will also work, since\nthe years are in the data in the order we want them to be displayed. (An option in case  you have seen this.)\n\nThe median for 2009 is noticeably higher, and there is no skewness or\noutliers worth worrying about.\n\nThe measurements for the two years have a very similar spread, so\nthere would be no problem running the pooled test here.\n\nYou might be bothered by the `factor(year)` on the $x$-axis. To\nget around that, you can define year-as-factor *first*, using\n`mutate`, then feed your new column into the boxplot. That goes\nlike this. There is a wrinkle that I explain afterwards:\n\n::: {.cell}\n\n```{.r .cell-code}\nplugged %>% mutate(the_year = factor(year)) %>%\n  ggplot(aes(x = the_year, y=hours)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/bisslerin-1.png){width=672}\n:::\n:::\n\nYou could even redefine `year` to be the factor version of\nitself (if you don't need the year-as-number anywhere else). The\nwrinkle I mentioned above is that in the `ggplot` you *do\nnot* name the data frame first; the data frame used is the\n(nameless) data frame that came out of the previous step, not\n`plugged` but `plugged` with a new column\n`the_year`.\n\nNote how the $x$-axis now has the name of the new variable.\n\nIf you forget to make `year` into a factor, this happens:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(plugged, aes(x = year, y = hours)) + geom_boxplot()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Continuous x aesthetic\nℹ did you forget `aes(group = ...)`?\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/luotter-1.png){width=672}\n:::\n:::\n\nYou get *one* boxplot, for all the hours, without distinguishing\nby year, and a warning message that tries (and fails) to read our\nmind: yes, we have a continuous, quantitative `x`, but\n`geom_boxplot` doesn't take a `group`. Or maybe it does. Try it and see:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(plugged,aes(x = year, y = hours, group = year)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\nThe $x$-axis treats the year as a number, which looks a little odd, but adding a `group` correctly gets us two boxplots side by side, so this is also a good way to do it. So maybe the error message *did* read our mind after all.\n\n\n$\\blacksquare$\n\n(c) Test whether the mean number of hours has *increased* since 1999. Which test did R do?\n\n\n\nSolution\n\n\nThe hard part to remember is how you specify a one-sided test in\nR; it's `alternative=\"less\"` (rather\nthan \"greater\") because 1999 is \"before\" 2009:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(hours~year,data=plugged,alternative=\"less\")  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  hours by year\nt = -3.3323, df = 24.861, p-value = 0.001348\nalternative hypothesis: true difference in means between group 1999 and group 2009 is less than 0\n95 percent confidence interval:\n       -Inf -0.8121415\nsample estimates:\nmean in group 1999 mean in group 2009 \n          5.933333           7.600000 \n```\n\n\n:::\n:::\n\nThe P-value is 0.0013. R does the Welch-Satterthwaite test by default\n(the unequal-variances one). Since we didn't change that, that's what\nwe got. (The pooled test is below.)\n\nThis is the cleanest way to do it, because this version of\n`t.test`, with a \"model formula\" (the thing with the\nsquiggle) allows a `data=` to say which data frame to get\nthings from. The other ways, using (for example) `with`, also work:\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(plugged,t.test(hours~year,alternative=\"less\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  hours by year\nt = -3.3323, df = 24.861, p-value = 0.001348\nalternative hypothesis: true difference in means between group 1999 and group 2009 is less than 0\n95 percent confidence interval:\n       -Inf -0.8121415\nsample estimates:\nmean in group 1999 mean in group 2009 \n          5.933333           7.600000 \n```\n\n\n:::\n:::\n\nThis also works, but is *ugly*:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(plugged$hours~plugged$year,alternative=\"less\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  plugged$hours by plugged$year\nt = -3.3323, df = 24.861, p-value = 0.001348\nalternative hypothesis: true difference in means between group 1999 and group 2009 is less than 0\n95 percent confidence interval:\n       -Inf -0.8121415\nsample estimates:\nmean in group 1999 mean in group 2009 \n          5.933333           7.600000 \n```\n\n\n:::\n:::\n\nUgly because you've just typed the name of the data frame and the\ndollar sign *twice* for no reason. As a general principle, if you\nas a programmer are repeating yourself, you should stop and ask\nyourself how you can avoid the repeat.\n\nIf you want the pooled test in R, you have to ask for it:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(hours~year, alternative = \"less\", data = plugged, var.equal = TRUE)    \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo Sample t-test\n\ndata:  hours by year\nt = -3.3323, df = 28, p-value = 0.001216\nalternative hypothesis: true difference in means between group 1999 and group 2009 is less than 0\n95 percent confidence interval:\n       -Inf -0.8158312\nsample estimates:\nmean in group 1999 mean in group 2009 \n          5.933333           7.600000 \n```\n\n\n:::\n:::\n\nAs is often the case, the P-values for the pooled and\nWelch-Satterthwaite tests are very similar, so from that point of view\nit doesn't matter much which one you use. If you remember back to the\nboxplots, the number of hours had about the same spread for the two\nyears, so if you used the pooled test instead of the\nWelch-Satterthwaite test, that would have been just fine.\n\nThere is a school of thought that says we should learn the\nWelch-Satterthwaite test and use that always. This is because W-S (i)\nworks when the populations from which the groups are sampled have\ndifferent SDs and (ii) is pretty good even when those SDs are the same.\n\nThe pooled test can go badly wrong if the groups have very different\nSDs.  The story is this: if the larger sample is from the population\nwith the larger SD, the probability of a type I error will be smaller\nthan $\\alpha$, and if the larger sample is from the population with\nthe *smaller* SD, the probability of a type I error will be\nlarger than $\\alpha$. This is why you see S-W in STAB22. You see the\npooled test in STAB57 because the logic of its derivation is so much\nclearer, \nnot because it's really the better test in\npractice. The theory says that if your data are normal in both groups\nwith the same variance, then the pooled test is best, but it says\n*nothing* about the quality of the pooled test if any of that\ngoes wrong.\nThe usual approach to assessing things like this is via simulation,\nas we do for estimating power (later): generate some random data\neg. from normal distributions with the same means, SDs 10 and 20\nand sample sizes 15 and 30, run the pooled $t$-test, see if you\nreject, then repeat lots of times and see whether you reject about\n5\\% of the time. Then do the same thing again with the sample sizes\nswitched around. Or, do the same thing with Welch-Satterthwaite.\n\n\n$\\blacksquare$\n\n(d) Obtain a 99\\% confidence interval for the difference in means.\n\n\n\nSolution\n\n\nTake off the thing that made it one-sided, and\nput in a thing that gets the right CI:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(hours~year,data=plugged,conf.level=0.99)  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  hours by year\nt = -3.3323, df = 24.861, p-value = 0.002696\nalternative hypothesis: true difference in means between group 1999 and group 2009 is not equal to 0\n99 percent confidence interval:\n -3.0614628 -0.2718705\nsample estimates:\nmean in group 1999 mean in group 2009 \n          5.933333           7.600000 \n```\n\n\n:::\n:::\n\n$-3.06$ to $-0.27$. The interval contains only negative values, which\nis consistent with our having rejected a null hypothesis of no\ndifference in means.\n\n$\\blacksquare$\n\n\n\n\n\n\n\n##  Parking close to the curb\n\n\n In 2009, the Toronto Star commissioned a survey to address\nthe issue of who is better at parking a car: men or women. The\nresearchers recorded 93 drivers who were parallel-parking their car in\ndowntown Toronto, and for each driver, recorded the distance between\nthe car and the curb, in inches, when the driver was finished parking\ntheir car. The data are in an Excel spreadsheet,\n[link](http://ritsokiguess.site/datafiles/parking.xlsx).  Click on the link. The data\nwill probably download automatically. Check the folder on your\ncomputer where things get downloaded.^[Mine is rather  prosaically called `Downloads`.] \nIf the spreadsheet is just\ndisplayed and not downloaded, save it somewhere on your computer.\n\n\n\n(a) There are two sheets in this spreadsheet workbook. They are\nof the same data in two different formats. Take a look at Sheet 1\nand Sheet 2. Describe the format of the data in each case. Which will be the most suitable data layout, bearing in\nmind that one of the first things we do is to make side-by-side\nboxplots of parking distances for males and females? Explain briefly.\n\n\nSolution\n\n\nThe data in Sheet 1 has one column of parking distances for\nmales, and another for females. This is often how you see data\nof this sort laid out. Sheet 2 has *one* column of parking\ndistances, all combined together, and a second column indicating\nthe gender of the driver whose distance is in the first column.\nIf you look back at the kind of data we've used to make\nside-by-side boxplots, it's always been in the format of Sheet\n2: one column containing all the values of the variable we're\ninterested in, with a second column indicating which group each\nobservation belongs to (\"group\" here being \n\"gender of driver\"). \nSo we need to use the data in Sheet 2, because the\ndata in Sheet 1 are not easy to handle with R. \nThe layout of Sheet 2 is the way R likes to do most things:\nso-called \"long format\" with a lot of rows and not many\ncolumns. This is true for descriptive stuff: side-by-side\nboxplots or histograms or  means by group, as well as modelling\nsuch as (here) a two-sample $t$-test, or (in other\ncircumstances, as with several groups) a one-way analysis of\nvariance. \nHadley Wickham, the guy behind the `tidyverse`, likes to\ntalk about \"tidy data\" (like Sheet 2), with each column\ncontaining a variable, and \"untidy data\" (like Sheet 1), where\nthe two columns are the same thing (distances), but under\ndifferent circumstances (genders). As we'll see later, it is\npossible to convert from one format to the other. Usually you\nwant to make untidy data tidy (the function for this is called\n`pivot_longer`). \n\n$\\blacksquare$\n\n(b) Read your preferred sheet directly into R, *without*\nusing a `.csv` file. (There is a clue in the lecture notes,\nin the section about reading in files.) If you get stuck, make a\n`.csv` file and read that in.\n\n\nSolution\n\n\nThe direct way is to use the package `readxl`. This has a\n`read_excel` that works the same way as any of the other\n`read_` functions. You'll have to make sure that you\nread in sheet 2, since that's the one you want. \nThere is some setup first. There are a couple of ways you can do that:\n\n\n* Download the spreadsheet to your computer, and upload it\nto your project on `r.datatools` (or, if you are running R\nStudio on your computer, use something like\n`file.choose` to get the file from wherever it got\ndownloaded to).\n\n* Use the function `download.file` to get the file\nfrom the URL and store it in your project folder\ndirectly. This also works on `r.datatools`, and completely\nby-passes the download-upload steps that you would have to do\notherwise. (I am grateful to Rose Gao for this idea.)\nHere is how you can use `download.file` here:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/parking.xlsx\"\nlocal <- \"parking.xlsx\"\ndownload.file(my_url, local, mode = \"wb\")\n```\n:::\n\n         \n\nWhen you've gotten the spreadsheet into your project folder via one of\nthose two ways, you go ahead and do this:    \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nparking <- read_excel(\"parking.xlsx\", sheet = 2)\nparking\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"distance\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"gender\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0.5\",\"2\":\"male\"},{\"1\":\"1.0\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"3.0\",\"2\":\"male\"},{\"1\":\"3.5\",\"2\":\"male\"},{\"1\":\"5.0\",\"2\":\"male\"},{\"1\":\"6.0\",\"2\":\"male\"},{\"1\":\"6.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"8.0\",\"2\":\"male\"},{\"1\":\"8.0\",\"2\":\"male\"},{\"1\":\"8.5\",\"2\":\"male\"},{\"1\":\"8.5\",\"2\":\"male\"},{\"1\":\"9.0\",\"2\":\"male\"},{\"1\":\"9.0\",\"2\":\"male\"},{\"1\":\"9.5\",\"2\":\"male\"},{\"1\":\"10.0\",\"2\":\"male\"},{\"1\":\"10.0\",\"2\":\"male\"},{\"1\":\"11.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"13.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"17.0\",\"2\":\"male\"},{\"1\":\"18.0\",\"2\":\"male\"},{\"1\":\"18.0\",\"2\":\"male\"},{\"1\":\"19.0\",\"2\":\"male\"},{\"1\":\"19.0\",\"2\":\"male\"},{\"1\":\"20.0\",\"2\":\"male\"},{\"1\":\"21.0\",\"2\":\"male\"},{\"1\":\"48.0\",\"2\":\"male\"},{\"1\":\"2.0\",\"2\":\"female\"},{\"1\":\"2.5\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"4.0\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"6.0\",\"2\":\"female\"},{\"1\":\"6.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.5\",\"2\":\"female\"},{\"1\":\"8.0\",\"2\":\"female\"},{\"1\":\"8.5\",\"2\":\"female\"},{\"1\":\"8.5\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"10.0\",\"2\":\"female\"},{\"1\":\"10.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.5\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"15.5\",\"2\":\"female\"},{\"1\":\"16.0\",\"2\":\"female\"},{\"1\":\"18.0\",\"2\":\"female\"},{\"1\":\"20.0\",\"2\":\"female\"},{\"1\":\"21.0\",\"2\":\"female\"},{\"1\":\"25.0\",\"2\":\"female\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n       \n\nYou have to do it this way, using the version of the spreadsheet on\nyour computer, since `read_excel` won't take a\nURL, or if it does, I can't make it work.^[Let me know if you  have more success than I did.] \nI put the spreadsheet in R Studio's\ncurrent folder, so I could read it in by name, or you can do the\n`f <- file.choose()` thing, find it, then read it in.\nThe `sheet=` thing can take either a number (as here: the\nsecond sheet in the workbook), or a name (whatever name the sheet has\non its tab in the workbook). \n\nExtra: Rose actually came up with a better idea, which I will show\nyou and explain:\n\n::: {.cell}\n\n```{.r .cell-code}\ntf <- tempfile()\ndownload.file(my_url, tf, mode = \"wb\")\np <- read_excel(tf, sheet = 2)\n```\n:::\n\n \n\nWhat `tempfile()` does is to create a temporary file to hold the\nspreadsheet that you are about to download. After downloading the\nspreadsheet to the temporary file, you then use `read_excel` to\nread *from the temporary file* into the data frame.\n\nThe advantage of this approach is that the temporary file disappears\nas soon as you close R, and so you don't have a copy of the\nspreadsheet lying around that you don't need (once you have created\nthe dataframe that I called `parking`, anyway).\n\nIf you are wondering about that `mode` thing on\n`download.file`: files are of two different types, \"text\"\n(like the text of an email, that you can open and look at in something\nlike Notepad), and \"binary\" that you can't look at directly, but for\nwhich you need special software like Word or Excel to decode it for\nyou.^[A Word or Excel document has all kinds of formatting  information hidden in the file as well as the text that you see on  the screen.]  \nThe first character in `mode` is either\n`w` for \"write a new file\", which is what we want here, or\n`a` for \"append\", which would mean adding to the end of a\nfile that already exists. Thus `mode=\"wb\"` means \n\"create a new binary file\".\nEnd of Extra.\n\nIf you can't make any of this work, then do it in two steps:\nsave the appropriate sheet as a `.csv` \nfile, and then read the `.csv` file using\n`read_csv`. If you experiment, you'll find that saving a\nspreadsheet workbook as `.csv` only saves the sheet\nyou're looking at, so make sure you are looking at sheet 2\nbefore you Save As `.csv`. I did that, and called my\nsaved `.csv` `parking2.csv` (because it was from\nsheet 2, but you can use any name you like).\nThen I read this into R thus:\n\n::: {.cell}\n\n```{.r .cell-code}\nparking2 <- read_csv(\"parking2.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 93 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): gender\ndbl (1): distance\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nparking2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"distance\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"gender\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0.5\",\"2\":\"male\"},{\"1\":\"1.0\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"3.0\",\"2\":\"male\"},{\"1\":\"3.5\",\"2\":\"male\"},{\"1\":\"5.0\",\"2\":\"male\"},{\"1\":\"6.0\",\"2\":\"male\"},{\"1\":\"6.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"8.0\",\"2\":\"male\"},{\"1\":\"8.0\",\"2\":\"male\"},{\"1\":\"8.5\",\"2\":\"male\"},{\"1\":\"8.5\",\"2\":\"male\"},{\"1\":\"9.0\",\"2\":\"male\"},{\"1\":\"9.0\",\"2\":\"male\"},{\"1\":\"9.5\",\"2\":\"male\"},{\"1\":\"10.0\",\"2\":\"male\"},{\"1\":\"10.0\",\"2\":\"male\"},{\"1\":\"11.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"13.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"17.0\",\"2\":\"male\"},{\"1\":\"18.0\",\"2\":\"male\"},{\"1\":\"18.0\",\"2\":\"male\"},{\"1\":\"19.0\",\"2\":\"male\"},{\"1\":\"19.0\",\"2\":\"male\"},{\"1\":\"20.0\",\"2\":\"male\"},{\"1\":\"21.0\",\"2\":\"male\"},{\"1\":\"48.0\",\"2\":\"male\"},{\"1\":\"2.0\",\"2\":\"female\"},{\"1\":\"2.5\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"4.0\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"6.0\",\"2\":\"female\"},{\"1\":\"6.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.5\",\"2\":\"female\"},{\"1\":\"8.0\",\"2\":\"female\"},{\"1\":\"8.5\",\"2\":\"female\"},{\"1\":\"8.5\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"10.0\",\"2\":\"female\"},{\"1\":\"10.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.5\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"15.5\",\"2\":\"female\"},{\"1\":\"16.0\",\"2\":\"female\"},{\"1\":\"18.0\",\"2\":\"female\"},{\"1\":\"20.0\",\"2\":\"female\"},{\"1\":\"21.0\",\"2\":\"female\"},{\"1\":\"25.0\",\"2\":\"female\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n       \n\nThe read-in data frame `parking` \nhas 93 rows ($47+46=93$ drivers) and two columns: the distance from\nthe curb that the driver ended up at, and the gender of the\ndriver. This is as the spreadsheet Sheet 2 was, and the first few\ndistances match the ones in the spreadsheet.\n\nIf I were grading this, you'd get some credit for the `.csv`\nroute, but I really wanted you to figure out how to read the Excel\nspreadsheet directly, so that's what would be worth full marks.\n\nYou might want to check that you have some males and some females, and\nhow many of each, which you could do this way:\n\n::: {.cell}\n\n```{.r .cell-code}\nparking %>% count(gender)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"gender\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"female\",\"2\":\"47\"},{\"1\":\"male\",\"2\":\"46\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\n$\\blacksquare$\n\n(c) Obtain side-by-side boxplots of parking distances for\nmales and females. Does one\ngender seem to be better at parking than the other? Explain briefly.\n\n\nSolution\n\n\nWith the right data set, this is a piece of cake:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = gender, y = distance)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/parking-6-1.png){width=672}\n:::\n:::\n\n         \n\nThe outcome variable is distance from the curb, so smaller should be\nbetter (more accurate parking). With that in mind, the median for\nfemales is a little smaller than for males (about 8.5 vs.\\ about 10),\nso it seems that on average females are more accurate parkers than\nmales are. The difference is small, however (and so you might be\nwondering at this point whether it's a statistically significant\ndifference --- don't worry, that's coming up).\n\nBefore I leave this one, I want to show you something else:\nabove-and-below histograms, as another way of comparing males and\nfemales (two or more groups, in general). First, we make a histogram of all\nthe distances, without distinguishing by gender:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) + geom_histogram(bins = 8)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/parking-7-1.png){width=672}\n:::\n:::\n\n \n\nThat big outlier is the very inaccurate male driver.\n\nNow, how do we get a *separate* histogram for each\n`gender`? In `ggplot`, separate plots for each\n\"something\" are called **facets**, and the way to get facets\narranged as you want them is called `facet_grid`.^[I wrote this question a long time ago, back when I thought that `facet_grid` was the only way to do facets. Now, I would use `facet_wrap`. See the discussion about `facet_wrap` near the bottom.] Let me show you\nthe code first, and then explain how it works:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) +\n  geom_histogram(bins = 7) +\n  facet_grid(gender ~ .)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/parking-8-1.png){width=672}\n:::\n:::\n\n \n\n`facet_grid` takes a \"model formula\" with a squiggle, with $y$\non the left and $x$ on the right. We want to compare our two\nhistograms, one for males and one for females, and I think the best\nway to compare histograms is to have one on top of the other. Note\nthat the same `distance` scale is used for both histograms, so\nthat it is a fair comparison.  The above-and-below is accomplished by\nhaving `gender` as the $y$ in the arrangement of the facets, so\nit goes before the squiggle. We don't have any $x$ in the arrangement\nof the facets, and we tell `ggplot` this by putting a dot where\nthe $x$ would be.^[You might have a second categorical variable  by which you want to arrange the facets left and right, and that  would go where the dot is.]\n\nYou can also use `facet_wrap` for this, but you have to be\nmore careful since you don't have any control over how the histograms\ncome out (you probably get them side by side, which is not so helpful\nfor comparing distributions). You can make it work by using\n`ncol=1` to arrange *all* the histograms in one column:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) +\n  geom_histogram(bins = 7) +\n  facet_wrap(~gender, ncol = 1)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/parking-9-1.png){width=672}\n:::\n:::\n\n \n\nThe centres of both histograms are somewhere around 10, so it's hard\nto see any real difference between males and females here. Maybe this\nis further evidence that the small difference we saw between the\nboxplots is really not worth getting excited about.\n\nYou might be concerned about how you know what to put with the\nsquiggle-thing in `facet_grid` and `facet_wrap`. The\nanswer is that `facet_wrap` *only* has something to the\nright of the squiggle (which `ggplot` then decides how to\narrange), but `facet_grid` *must* have something on\n*both* sides of the squiggle (how to arrange in the $y$ direction\non the left, how to arrange in the $x$ direction on the right), and if\nyou don't have anything else to put there, you put a dot. Here's my\n`facet_grid` code from above, again:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) +\n  geom_histogram(bins = 7) +\n  facet_grid(gender ~ .)\n```\n:::\n\n \n\nWe wanted gender to go up and down, and we had nothing to go left and\nright, hence the dot. Contrast that with my `facet_wrap`\ncode:^[I took out the `ncol` since that confuses the  explanation here.] \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) +\n  geom_histogram(bins = 7) +\n  facet_wrap(~gender)\n```\n:::\n\n \n\nThis says \"make a separate facet for each gender\", but it doesn't\nsay anything about how to arrange them.\nThe choice of bins for my histogram(s) came from Sturges' rule: with\n$n$ being the number of observations, you use $k$ bins where\n$k=\\log_2(n)+1$, rounded up. If we were to make a histogram of all the\nparking distances combined together, we would have $n=47+48=95$\nobservations, so we should use this many bins:\n\n::: {.cell}\n\n```{.r .cell-code}\nsturges <- log(95, 2) + 1\nsturges\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7.569856\n```\n\n\n:::\n:::\n\n \n\nRound this up to 8. (The second thing in `log` is the base of\nthe logs, if you specify it, otherwise it defaults to $e$ and gives\nyou \"natural\" logs.) I seem to have the powers of 2 in my head, so I\ncan do it mentally by saying \"the next power of 2 is 128, which is $2^7$, so I need $7+1=8$ bins.\"\n\nOr:\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(parking, nclass.Sturges(distance))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 8\n```\n\n\n:::\n:::\n\n \nSturges' rule tends to produce not enough bins if $n$ is small, so be\nprepared to increase it a bit if you don't have much data.\nI think that gives a fairly bare-bones picture of the shape: skewed to\nthe right with outlier.\n\nThe other rule we saw was Freedman-Diaconis:\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(parking, nclass.FD(distance))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 14\n```\n\n\n:::\n:::\n\n \n\nand that leads to this histogram: \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) + geom_histogram(bins = 14)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/parking-15-1.png){width=672}\n:::\n:::\n\n \n\nThat gives rather more detail (a lot more bars: the binwidth in the\nSturges-rule histogram is about 7, or twice what you see here), but in\nthis case the overall story is about the same.\n\nIn the case of faceted histograms, you would want to apply a rule that\nuses the number of observations in *each* histogram. The facets\nmight have quite different numbers of observations, but you can only\nuse one `binwidth` (or `bins`), so you may have to\ncompromise. For example, using Sturges' rule based on 47 observations\n(the number of males; the number of females is one more):\n\n::: {.cell}\n\n```{.r .cell-code}\nlog(47, 2) + 1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.554589\n```\n\n\n:::\n:::\n\n \n\nand so each facet should have that many bins, rounded up. That's where\nI got my 7 for the facetted histogram from. This one doesn't work\nimmediately with `nclass.Sturges`, because we do not have\n*one* column whose length is the number of observations we want:\nwe have one column of distances that are males and females mixed\nup. To do *that*, `filter` one of the genders first:\n\n::: {.cell}\n\n```{.r .cell-code}\nparking %>%\n  filter(gender == \"female\") %>%\n  with(., nclass.Sturges(distance))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 7\n```\n\n\n:::\n:::\n\n \n\nI used the \"dot\" trick again, which you can read as \"it\": \"from `parking`, take only the rows for the females, and with it, give me the number of bins for a histogram by Sturges' rule.\"\n\n$\\blacksquare$\n\n(d) Explain briefly why this is two independent samples\nrather than matched pairs.\n\n\nSolution\n\n\nThere is no way to pair any male with a corresponding female,\nbecause they are unrelated people. You might also notice that\nthere are not even the *same number* of males and females,\nso there can be no way of pairing them up without leaving one\nover. (In general, if the two samples are paired, there must be\nthe same number of observations in each; if there are different\nnumbers in each, as here, they cannot be paired.)\nIf you want that more mathematically, let $n_1$ and $n_2$ be the\ntwo sample sizes; then:\n\n$$\n\\mbox{Paired} \\Longrightarrow n_1=n_2\n$$\n\nfrom which it follows logically (the \"contrapositive\") that\n\n$$\nn_1 \\ne n_2 \\Longrightarrow \\mbox{not paired}\n$$\n\nYou'll note from the logic that if the two sample sizes are the same,\nthat tells you *nothing* about whether it's paired or independent\nsamples: it could be either, and in that case you have to look at the\ndescription of the data to decide between them.\n\nHere, anything that gets at why the males and females cannot be paired\nup is good.\n\n$\\blacksquare$\n\n(e) Run a suitable $t$-test for comparing parking distances\nfor males and females. What do you conclude, in the context of the data?\n\n\nSolution\n\n\n A two-sample $t$-test. I think either the Welch or the pooled one can\n be justified (and I would expect them to give similar answers). You\n can do the Welch one either without comment or by asserting that the\n boxplots show different spreads; if you are going to do the pooled\n one, you need to say that the spreads are \"about equal\", by\n comparing the heights of the boxes on the boxplots:\n \n::: {.cell}\n\n```{.r .cell-code}\nt.test(distance ~ gender, data = parking)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  distance by gender\nt = -1.3238, df = 79.446, p-value = 0.1894\nalternative hypothesis: true difference in means between group female and group male is not equal to 0\n95 percent confidence interval:\n -4.5884103  0.9228228\nsample estimates:\nmean in group female   mean in group male \n            9.308511            11.141304 \n```\n\n\n:::\n:::\n\n  \n\nThis is the Welch-Satterthwaite version of the test, the one that does\nnot assume equal SDs in the two groups. The P-value of 0.1894 is not\nsmall, so there is no evidence of any difference in parking accuracy\nbetween males and females.\n\nOr, this being the pooled one:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(distance ~ gender, data = parking, var.equal = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo Sample t-test\n\ndata:  distance by gender\nt = -1.329, df = 91, p-value = 0.1872\nalternative hypothesis: true difference in means between group female and group male is not equal to 0\n95 percent confidence interval:\n -4.5722381  0.9066506\nsample estimates:\nmean in group female   mean in group male \n            9.308511            11.141304 \n```\n\n\n:::\n:::\n\n \n\nYou might have thought, looking at the boxplots, that the groups had\nabout the same SD (based, for example, on noting that the two boxes\nwere about the same height, so the IQRs were about the same). In that\ncase, you might run a pooled $t$-test, which here gives an almost\nidentical P-value of 0.1872, and the exact same conclusion.\n\n$\\blacksquare$\n\n(f) Why might you have some doubts about the $t$-test that\nyou just did? Explain briefly.\n\n\nSolution\n\n\nThe two-sample $t$-test is based on an assumption of\nnormally-distributed data within each group. If you go back\nand look at the boxplots, you'll see either (depending on\nyour point of view) that both groups are right-skewed, or\nthat both groups have outliers, neither of which fits a\nnormal distribution. The outlier in the male group is\nparticularly egregious.^[Google defines this as            meaning \"outstandingly bad, shocking\".] So I think we\nare entitled to question whether a two-sample $t$-test is\nthe right thing to do.\nHaving said that, we should go back and remember that the\n$t$-tests are \"robust to departures from normality\" (since\nwe are working with the Central Limit Theorem here), and\ntherefore that this test might be quite good even though the\ndata are not normal, because the sample sizes of 40-plus are\nlarge (by the standards of what typically makes the Central\nLimit Theorem work for us). So it may not be as bad as it seems.\nA common competitor for the two-sample $t$-test is the\nMann-Whitney test. This doesn't assume normality, but it\n*does* assume symmetric distributions, which it's not\nclear that we have here. I like a test called Mood's Median\nTest, which is kind of the two-sample equivalent of the sign\ntest (which we will also see later). It goes like this:\nWork out the overall median of all the distances, regardless\nof gender:\n\n::: {.cell}\n\n```{.r .cell-code}\nparking %>% summarize(med = median(distance))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"med\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"9\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nThe overall median is 9.\n\nCount up how many distances of each gender were above or below the\noverall median. (Strictly, I'm supposed to throw away any values that\nare exactly equal to the overall median, but I won't here for clarity\nof exposition.)\n\n::: {.cell}\n\n```{.r .cell-code}\ntab <- with(parking, table(gender, distance < 9))\ntab\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        \ngender   FALSE TRUE\n  female    23   24\n  male      27   19\n```\n\n\n:::\n:::\n\n \n\nFor example, 19 of the male drivers had a distance (strictly) less than 9.\nBoth genders are pretty close to 50--50 above and below the overall\nmedian, which suggests that the males and females have about the same\nmedian. This can be tested (it's a chi-squared test for independence,\nif you know that):\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(tab, correct = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  tab\nX-squared = 0.89075, df = 1, p-value = 0.3453\n```\n\n\n:::\n:::\n\n \n\nThis is even less significant (P-value 0.3453) than the two-sample\n$t$-test, and so is consistent with our conclusion from before that\nthere is actually no difference between males and females in terms of\naverage parking distance. The Mood's median test is believable because\nit is not affected by outliers or distribution shape.\n\n$\\blacksquare$\n\n(g) The Toronto Star in its report said that females are\nmore accurate at parking their cars. Why do you think they\nconcluded that, and do you think they were right to do so?\nExplain briefly.\n\n\nSolution\n\n\nThe conclusion from the boxplots was that the female\nmedian distance was less than the males, slightly, in this\nsample. That is probably what the Star seized on.\nWere they right? Well, that was why we did the test of\nsignificance. We were trying to see whether this observed\ndifference between males and females was \"real\" (would\nhold up if you looked at \"all\" male and female drivers)\nor \"reproducible\" (you would expect to see it again if\nyou did another study like this one). The large,\nnon-significant P-values in all our tests tell us that the\ndifference observed here was nothing more than chance. So\nit was not reasonable to conclude that females generally\nare more accurate at parallel-parking than males are.\n\n$\\blacksquare$\n\n\n\n\n\n\n##  Bell peppers and too much water\n\n\n A pathogen called *Phytophthora capsici* causes bell\npeppers to wilt and die. It is thought that too much water aids in the\nspread of the pathogen. Two fields are under study, labelled\n`a` and `b`. The first step in the research project is\nto compare the mean soil  water content of the two fields.  There is\na suspicion that field `a` will have a higher water content\nthan field `b`. The data\nare in the\nfile\n[link](http://ritsokiguess.site/datafiles/bellpepper.csv).\n\n\n(a) Read the file in using `read_csv`, and\nlist the resulting data frame.\n \nSolution\n\n\nReading directly from the URL is easiest:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/bellpepper.csv\"\npepper <- read_csv(my_url)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 30 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): field\ndbl (1): water\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\npepper\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"field\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"water\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"a\",\"2\":\"10.2\"},{\"1\":\"a\",\"2\":\"10.7\"},{\"1\":\"a\",\"2\":\"15.5\"},{\"1\":\"a\",\"2\":\"10.4\"},{\"1\":\"a\",\"2\":\"9.9\"},{\"1\":\"a\",\"2\":\"10.0\"},{\"1\":\"a\",\"2\":\"16.6\"},{\"1\":\"a\",\"2\":\"15.1\"},{\"1\":\"a\",\"2\":\"15.2\"},{\"1\":\"a\",\"2\":\"13.8\"},{\"1\":\"a\",\"2\":\"14.1\"},{\"1\":\"a\",\"2\":\"11.4\"},{\"1\":\"a\",\"2\":\"11.5\"},{\"1\":\"a\",\"2\":\"11.0\"},{\"1\":\"b\",\"2\":\"8.1\"},{\"1\":\"b\",\"2\":\"8.5\"},{\"1\":\"b\",\"2\":\"8.4\"},{\"1\":\"b\",\"2\":\"7.3\"},{\"1\":\"b\",\"2\":\"8.0\"},{\"1\":\"b\",\"2\":\"7.1\"},{\"1\":\"b\",\"2\":\"13.9\"},{\"1\":\"b\",\"2\":\"12.2\"},{\"1\":\"b\",\"2\":\"13.4\"},{\"1\":\"b\",\"2\":\"11.3\"},{\"1\":\"b\",\"2\":\"12.6\"},{\"1\":\"b\",\"2\":\"12.6\"},{\"1\":\"b\",\"2\":\"12.7\"},{\"1\":\"b\",\"2\":\"12.4\"},{\"1\":\"b\",\"2\":\"11.3\"},{\"1\":\"b\",\"2\":\"12.5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n     \n\nIf you like, find out how many observations you have from each field, thus:\n\n::: {.cell}\n\n```{.r .cell-code}\npepper %>% count(field)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"field\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"a\",\"2\":\"14\"},{\"1\":\"b\",\"2\":\"16\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\nFourteen and sixteen.\n \n$\\blacksquare$\n\n(b) Make side-by-side boxplots of the water content values for\nthe two fields. How do the fields seem to compare?\n \nSolution\n\n\nThis kind of thing:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pepper, aes(x = field, y = water)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/dartmouth-1.png){width=672}\n:::\n:::\n\n     \n\nThis one is rather interesting: the distribution of water contents for\nfield `a` is generally higher than that for field `b`,\nbut the median for `a` is actually *lower*.\n\nThe other reasonable plot is a facetted histogram, something like this:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pepper, aes(x = water)) + geom_histogram(bins = 6) +\n  facet_grid(field ~ .)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/bellpepper-3-1.png){width=672}\n:::\n:::\n\n \n\nThe distribution of water content in field `b` is actually\nbimodal, which is probably the explanation of the funny thing with the\nmedian. What actually seems to be happening (at least for these data)\nis that the water content in field B is either about the same as field\nA, or a lot less (nothing in between).  We can find the five-number summaries for each field. The strategy is to use `reframe` (rather than summarize, because the five-number summary is five numbers rather than one), and pivot wider to make a nice display:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquantile_df <- function(x) { enframe(quantile(x))}\npepper %>% \n  group_by(field) %>% \n  reframe(quantile_df(water)) %>% \n  pivot_wider(names_from=name, values_from=value)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"field\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"0%\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"25%\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"50%\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"75%\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"100%\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"a\",\"2\":\"9.9\",\"3\":\"10.475\",\"4\":\"11.45\",\"5\":\"14.85\",\"6\":\"16.6\"},{\"1\":\"b\",\"2\":\"7.1\",\"3\":\"8.325\",\"4\":\"11.75\",\"5\":\"12.60\",\"6\":\"13.9\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nThis is a weird one: all the quantiles are greater for field A\n*except* for the median.\n \n$\\blacksquare$\n\n(c) Do a two-sample $t$-test to test whether there is evidence\nthat the mean water\ncontent in field `a` is higher than that of field\n`b`. What do you conclude? Explain briefly. (You'll need to\nfigure out a way of doing a one-sided test, or how to adapt the\nresults from a two-sided test.)\n \nSolution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(water ~ field, alternative = \"greater\", data = pepper)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  water by field\nt = 2.0059, df = 27.495, p-value = 0.0274\nalternative hypothesis: true difference in means between group a and group b is greater than 0\n95 percent confidence interval:\n 0.2664399       Inf\nsample estimates:\nmean in group a mean in group b \n       12.52857        10.76875 \n```\n\n\n:::\n:::\n\n     \n\nNote the use of `alternative` to specify that the first group\nmean (that of field `a`) is bigger than the second, field\n`b`, under the alternative hypothesis.\n\nThe P-value, 0.0274, is less than 0.05, so we reject the null (equal\nmeans) in favour of the `a` mean being bigger than the\n`b` mean: field `a` really does have a higher mean water\ncontent. \n\nAnother way to tackle this is to do a two-sided test and adapt the P-value:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(water ~ field, data = pepper)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  water by field\nt = 2.0059, df = 27.495, p-value = 0.0548\nalternative hypothesis: true difference in means between group a and group b is not equal to 0\n95 percent confidence interval:\n -0.03878411  3.55842696\nsample estimates:\nmean in group a mean in group b \n       12.52857        10.76875 \n```\n\n\n:::\n:::\n\n \n\nThis time we do *not* go straight to the P-value. First we check\nthat we are on the correct side, which we are since the sample mean\nfor field `a` *is* bigger than for field `b`. Then we are\nentitled to take the two-sided P-value 0.0548 and *halve* it to\nget the same 0.0274 that we did before.\n \n$\\blacksquare$\n\n(d) Is the result of your test consistent with the boxplot, or\nnot? Explain briefly.\n \nSolution\n\n\nThe test said that field `a` had a greater mean water\ncontent. Looking at the boxplot, this is consistent with where the\nboxes sit (`a`'s box is higher up than\n`b`'s). However, it is not consistent with the medians,\nwhere `b`'s median is actually *bigger*.\nYou have two possible right answers here: comparing the boxes with\nthe test result (they agree) or comparing the medians with the\ntest result (they disagree). Either is good. If you like, you\ncould also take the angle that the two boxes overlap a fair bit,\nso it is surprising that the test came out significant. (The\nresolution of this one is that we have 30 measurements altogether,\n14 and 16 in the two groups, so the sample size is not tiny. With\nsmaller samples, having overlapping boxes would probably lead to a\nnon-significant difference.) \n \n\n$\\blacksquare$\n\n\n\n\n##  Exercise and anxiety and bullying mice\n\n\n Does exercise help to reduce anxiety?\nTo assess this, some researchers randomly assigned\nmice to either \nan enriched environment where there was an exercise wheel available,\nor a standard environment with no exercise options. After three weeks\nin the specified environment, for five minutes a day for two weeks,\nthe mice were each exposed to a \"mouse bully\" --- a mouse who was very\nstrong, aggressive, and territorial. One measure of mouse anxiety is\namount of time hiding in a dark compartment, with mice who are more\nanxious spending more time in darkness. The amount of time spent in\ndarkness is recorded for each of the mice. \n\nThe data can be found at\n[link](http://ritsokiguess.site/datafiles/stressedmice.txt). \n\n\n\n(a) Read the data into R, and display your data frame. Count the number of mice in each group. \n\nSolution\n\n\nThese are aligned columns with spaces in between, so we need `read_table`:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/stressedmice.txt\"\nmice <- read_table(my_url)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n── Column specification ────────────────────────────────────────────────────────\ncols(\n  Time = col_double(),\n  Environment = col_character()\n)\n```\n\n\n:::\n\n```{.r .cell-code}\nmice\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Time\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Environment\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"359\",\"2\":\"Enriched\"},{\"1\":\"280\",\"2\":\"Enriched\"},{\"1\":\"138\",\"2\":\"Enriched\"},{\"1\":\"227\",\"2\":\"Enriched\"},{\"1\":\"203\",\"2\":\"Enriched\"},{\"1\":\"184\",\"2\":\"Enriched\"},{\"1\":\"231\",\"2\":\"Enriched\"},{\"1\":\"394\",\"2\":\"Standard\"},{\"1\":\"477\",\"2\":\"Standard\"},{\"1\":\"439\",\"2\":\"Standard\"},{\"1\":\"428\",\"2\":\"Standard\"},{\"1\":\"391\",\"2\":\"Standard\"},{\"1\":\"488\",\"2\":\"Standard\"},{\"1\":\"454\",\"2\":\"Standard\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n   \n\nYou can call the data frame whatever you like.\n\nIf you must, you can physically count the number of mice in each group, but you ought to get in the habit of coding this kind of thing:\n\n::: {.cell}\n\n```{.r .cell-code}\nmice %>% count(Environment)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Environment\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Enriched\",\"2\":\"7\"},{\"1\":\"Standard\",\"2\":\"7\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\nSeven in each.\n \n\n$\\blacksquare$\n\n(b) Draw side-by-side boxplots of time spent in darkness for each\ngroup of mice.\n\nSolution\n\n\nThis:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mice, aes(x = Environment, y = Time)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/artichoke-1.png){width=672}\n:::\n:::\n\n     \n\nYou did remember to put capital letters on the variable names, didn't you?\n \n\n$\\blacksquare$\n\n(c) Do the boxplots support the hypothesis about exercise and\nanxiety? Explain briefly.\n\nSolution\n\n\nThe hypothesis about exercise and anxiety is that mice who\nexercise more should be less anxious. How does that play out in\nthis study? Well, mice in the enriched environment at least have\nthe opportunity to exercise, which the mice in the standard\nenvironment do not, and anxiety is measured by the amount of time\nspent in darkness (more equals more anxious).\nSo we'd expect the mice in the standard environment to spend more\ntime in darkness, if that hypothesis is correct.\nThat's exactly what the boxplots show, with very little\ndoubt.^[This means that I would expect to reject a null hypothesis of equal means, but I get ahead of myself.]\nYour answer needs to make two points: (i) what you would expect to\nsee, if the hypothesis about anxiety and exercise is true, and\n(ii) whether you actually did see it. You can do this either way\naround: for example, you can say what you see in the boxplot, and\nthen make the case that this *does* support the idea of more\nexercise corresponding with less anxiety.\n \n\n$\\blacksquare$\n\n(d) Carry out a $t$-test for comparing the mean time spent in\ndarkness for the mice in the two groups. Think carefully about the\ndetails of the $t$-test (and what you need evidence in favour of).\n\nSolution\n\n\nWe are trying to prove that exercise goes with *less*\nanxiety, so a one-sided test is called for. The other thing to\nthink about is how R organizes the groups for\n`Environment`: in alphabetical order. Thus\n`Enriched` is first (like on the boxplot). We're trying to\nprove that the mean `Time` is *less* for\n`Enriched` than for `Standard`, so we need `alternative=\"less\"`:\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(mice, t.test(Time ~ Environment, alternative = \"less\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  Time by Environment\nt = -6.7966, df = 9.1146, p-value = 3.734e-05\nalternative hypothesis: true difference in means between group Enriched and group Standard is less than 0\n95 percent confidence interval:\n      -Inf -151.2498\nsample estimates:\nmean in group Enriched mean in group Standard \n              231.7143               438.7143 \n```\n\n\n:::\n:::\n\n     \n\nA common clue that you have the wrong alternative hypothesis is a P-value coming out close to *1*, which is what you would have gotten from something like this:\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(mice, t.test(Time ~ Environment, alternative = \"greater\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  Time by Environment\nt = -6.7966, df = 9.1146, p-value = 1\nalternative hypothesis: true difference in means between group Enriched and group Standard is greater than 0\n95 percent confidence interval:\n -262.7502       Inf\nsample estimates:\nmean in group Enriched mean in group Standard \n              231.7143               438.7143 \n```\n\n\n:::\n:::\n\n     \n\nHere, we looked at the pictures and expected to find a difference, so we expected to find a P-value close to 0 rather than close to 1.\n \n\n$\\blacksquare$\n\n(e) What do you conclude, in terms of anxiety and exercise (at\nleast for mice)? Explain  briefly.\n\nSolution\n\n\nThe P-value (from the previous part) is 0.000037, which is way less\nthan 0.05 (or 0.01 or whatever $\\alpha$ you chose). So the null\nhypothesis (equal means) is resoundingly rejected in favour of the\none-sided alternative that the mean anxiety (as measured by time\nspent in darkness) is less for the mice who (can) exercise.\nYou need to end up by doing a one-sided test. An alternative to\nwhat I did is to do a two-sided test in the previous part. Then\nyou can fix it up by recognizing that the means are the right way\naround for the research hypothesis (the mean time in darkness is\nway less for `Enriched`), and then dividing the two-sided\nP-value by 2. But you need to do the \"correct side\" thing: just\nhalving the two-sided P-value is not enough, because the sample\nmean for `Enriched` might have been *more* than for\n`Standard`. \n \n\n$\\blacksquare$\n\n(f) Does anything in the previous parts suggest any problems with\nthe analysis you just did? Explain briefly.\n\nSolution\n\n\nLook at the side-by-side boxplots. The strict assumptions hiding\nbehind the $t$-tests are that the data in each group come from\nnormal distributions (equal standard deviations are not\nrequired). Are the data symmetric? Are there any outliers? Well, I\nsee a high outlier in the `Enriched` group, so I have some\ndoubts about the normality. On the other hand, I only have seven\nobservations in each group, so there is no guarantee even if the\npopulations from which they come are normal that the samples will\nbe. So maybe things are not so bad.\nThis is one of those situations where you make a case and defend it. I\ndon't mind so much which case you make, as long as you can defend\nit. Thus, something like either of these two is good:\n\n\n* I see an outlier in the `Enriched` group. The data\nwithin each group are supposed to be normally distributed, and\nthe `Enriched` group is not. So I see a problem.\n\n* I see an outlier in the `Enriched` group. But the\nsample sizes are small, and an apparent outlier could arise by\nchance. So I do not see a problem.\n\nExtra: another way to think about this is normal quantile plots to assess\nnormality within each group. This uses the facetting trick to get a separate normal quantile plot for each `Environment`:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mice, aes(sample = Time)) + stat_qq() + stat_qq_line() +\n  facet_wrap(~Environment, scales = \"free\")\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/mousebully-5-1.png){width=672}\n:::\n:::\n\n     \n\nFor the `Enriched` group, the upper-end outlier shows up. In a\nway this plot is no more illuminating than the boxplot, because you\nstill have to make a call about whether this is \"too big\". Bear in\nmind also that these facetted normal quantile plots, with two groups,\ncome out tall and skinny, so vertical deviations from the line are\nexaggerated. On this plot, the lowest value also looks too low.\n\nFor the `Standard` group, there are no problems with normality\nat all.\n\nWhat happens if we change the shape of the plots?\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mice, aes(sample = Time)) + stat_qq() + stat_qq_line() +\n  facet_wrap(~Environment, scales = \"free\", ncol = 1)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/mousebully-6-1.png){width=672}\n:::\n:::\n\n     \n\nThis makes the plots come out in one column, that is, short and\nsquat. I prefer these. I'd still call the highest value in\n`Enriched` an outlier, but the lowest value now looks pretty\nclose to what you'd expect.\n \n$\\blacksquare$\n\n\n\n\n##  Diet and growth in boys\n\n\n A dietician is studying the effect of\ndifferent diets on children's growth. In part of the study, the\ndietician is investigating two religious sects, labelled `a`\nand `b` in our data set. Both sects are vegetarian; the\ndifference between them is that people in Sect A only eat vegetables\nfrom below the ground, and Sect B only eats vegetables from above the\nground. The height and weight of the boys^[This was not sexism, but a recognition that boys and girls will be of different heights for reasons unrelated to diet. Doing it this way makes the analysis simpler.] are measured at regular\nintervals. The data in\n[link](http://ritsokiguess.site/datafiles/kids-diet.txt) are the\nheights of the boys at age 12.\n\n\n\n(a) Read in the data and find out how many observations you have\nand which variables.\n\n\nSolution\n\n\nThe data values are separated by one space, so:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/kids-diet.txt\"\ndiet <- read_delim(my_url, \" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 21 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \" \"\nchr (1): sect\ndbl (1): height\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ndiet\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sect\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"height\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"a\",\"2\":\"140\"},{\"1\":\"a\",\"2\":\"140\"},{\"1\":\"a\",\"2\":\"140\"},{\"1\":\"a\",\"2\":\"143\"},{\"1\":\"a\",\"2\":\"135\"},{\"1\":\"a\",\"2\":\"144\"},{\"1\":\"a\",\"2\":\"156\"},{\"1\":\"a\",\"2\":\"149\"},{\"1\":\"a\",\"2\":\"146\"},{\"1\":\"a\",\"2\":\"148\"},{\"1\":\"a\",\"2\":\"144\"},{\"1\":\"a\",\"2\":\"153\"},{\"1\":\"b\",\"2\":\"151\"},{\"1\":\"b\",\"2\":\"154\"},{\"1\":\"b\",\"2\":\"139\"},{\"1\":\"b\",\"2\":\"159\"},{\"1\":\"b\",\"2\":\"159\"},{\"1\":\"b\",\"2\":\"148\"},{\"1\":\"b\",\"2\":\"140\"},{\"1\":\"b\",\"2\":\"157\"},{\"1\":\"b\",\"2\":\"145\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n     \n\n21 observations on two variables, `sect` and\n`height`. (You should state this; it is not enough to make the\nreader figure it out for themselves.)\n\nThe heights are evidently in centimetres.\n\nYou can call the data frame whatever you like.\n\n\n$\\blacksquare$\n\n(b) Obtain side-by-side boxplots of the heights for boys from\neach sect. Does it look as if the heights of the boys in each sect\nare different? Comment briefly. \n\n\nSolution\n\n\nThe boxplot is the kind of thing we've seen before:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(diet, aes(x = sect, y = height)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/kids-diet-2-1.png){width=672}\n:::\n:::\n\n \n\nIt looks to me as if the boys in Sect B are taller on average.\n\n\n$\\blacksquare$\n\n(c) Looking at your boxplots, do you see any problems with\ndoing a two-sample $t$-test? Explain briefly.\n\n\nSolution\n\n\nThe assumption is that the data in each group are \n\"approximately normal\". Boxplots don't tell you about normality specifically,\nbut they tell you whether there are any outliers (none here) and\nsomething about the shape (via the lengths of the whiskers). I'd\nsay the Sect A values are as symmetric as we could hope for. For\nSect B, you can say either that they're skewed to the left (and\nthat therefore we have a problem), or that the heights are close\nenough to symmetric (and that therefore we don't). For me, either\nis good. \nAs ever, normal quantile plots can offer more insight. With\ndata in this form, the\ntwo samples are mixed up, but using facets is the way to go. Philosophically, we draw a normal quantile plot of *all* the heights, and then say at the end that we would actually like a separate plot for each sect:\n\n::: {.cell}\n\n```{.r .cell-code}\ndiet %>%\n  ggplot(aes(sample = height)) + stat_qq() + stat_qq_line() +\n  facet_wrap(~sect, ncol = 1)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/kids-diet-3-1.png){width=672}\n:::\n:::\n\n \n\nI decided that I wanted short squat plots rather than tall skinny ones.\n\nWith the sizes of the samples, I really don't see any problems\nhere. Most of the evidence for the left skewness in Sect B is actually coming\nfrom that largest value being too small. Sect A is as good as you\ncould wish for. Having extreme values being *not extreme enough* is not a problem, since it won't be distorting the mean. \n\nThe other way of doing this is to use `filter` to pull out the\nrows you want and then feed that into the plot:\n\n::: {.cell}\n\n```{.r .cell-code}\nsecta <- filter(diet, sect == \"a\") %>%\n  ggplot(aes(sample = sect)) + stat_qq() + stat_qq_line()\n```\n:::\n\n \n\nand the same for sect B. This is the usual `ggplot`-in-pipeline\nthing where you don't have a named data frame in the `ggplot`\nbecause it will use whatever came out of the previous step of the\npipeline.\n    \n\n$\\blacksquare$\n\n(d) Run a $t$-test to determine whether the mean heights differ\nsignificantly. What do you conclude? Explain briefly. (Run the\n$t$-test even if your previous work suggests that it is not the\nright thing to do.)\n\n\nSolution\n\n\nThe wording states that a two-sided test is correct, which is the\ndefault, so you don't need anything special:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(height ~ sect, data = diet)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  height by sect\nt = -1.7393, df = 14.629, p-value = 0.103\nalternative hypothesis: true difference in means between group a and group b is not equal to 0\n95 percent confidence interval:\n -12.007505   1.229728\nsample estimates:\nmean in group a mean in group b \n       144.8333        150.2222 \n```\n\n\n:::\n:::\n\n \n\nThis is a two-sample test, so it takes a `data=`. \n\nOur null hypothesis is that the two sects have equal mean height. The\nP-value of 0.103 is larger than 0.05, so we do not reject that null\nhypothesis. That is, there is no evidence that the sects differ in\nmean height. (That is, our earlier thought that the boys in Sect B were taller\nis explainable by chance.)\n\nYou *must* end up with a statement about mean heights, and when\nyou do a test, you must state the conclusion in the context of the\nproblem, whether I ask you to or not. \n\"Don't reject the null hypothesis\" \nis a step on the way to an answer, not an answer in\nitself. If you think it's an answer in itself, you won't be of much\nuse to the world as a statistician.\n\nYou might have been thinking that Mood's median test was the\nthing, if you were worried about that skewness in Sect B. My guess is\nthat the $t$-test is all right, so it will be the better test\n(and give the smaller P-value) here, but if you want to do it, you\ncould do it this way:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(smmr)\nmedian_test(diet, height, sect)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$grand_median\n[1] 146\n\n$table\n     above\ngroup above below\n    a     4     7\n    b     6     3\n\n$test\n       what     value\n1 statistic 1.8181818\n2        df 1.0000000\n3   P-value 0.1775299\n```\n\n\n:::\n:::\n\n \n\nMy suspicion (that I wrote before doing the test) is correct: there is\neven less evidence of a difference in median height between the\nsects. The table shows that both sects are pretty close to 50--50\nabove and below the overall median, and with sample sizes this small,\nthey are certainly not significantly different from an even split. The\nsmall frequencies bring a warning about the chi-squared approximation\npossibly not working (that `smmr` suppresses). We had one like\nthis elsewhere, but there the result was very significant, and this one\nis very non-significant. However, the implication is the same: even if\nthe P-value is not very accurate (because the expected frequencies for\nsect B are both 4.5), the conclusion is unlikely to be wrong because\nthe P-value is so far from 0.05.\n    \n$\\blacksquare$\n\n\n\n\n\n\n## Handspans of males and females\n\n Take your right hand, and stretch the fingers out as far as\nyou can. The distance between the tip of your thumb and the tip of\nyour little (pinky) finger is your handspan. The students in a\nStatistics class at Penn State measured their handspans and also\nwhether they identified as male or female. The data are at [http://ritsokiguess.site/datafiles/handspan.txt](http://ritsokiguess.site/datafiles/handspan.txt),\nwith handspans\nmeasured in inches.  Thinking of these as a random sample of all\npossible students, is it true that males have a larger mean handspan\nthan females? This is what we will explore.\n\n\n(a) Read in and display (some of) the data.\n\nSolution\n\nThis is a delimited (by spaces) file, so:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nmy_url <- \"http://ritsokiguess.site/datafiles/handspan.txt\"\nspan <- read_delim(my_url, \" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 190 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \" \"\nchr (1): sex\ndbl (1): handspan\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nspan\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"handspan\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.25\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"26.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"F\",\"2\":\"17.00\"},{\"1\":\"F\",\"2\":\"16.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.70\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.25\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"19.50\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"20.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"25.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"18.00\"},{\"1\":\"M\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"25.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"13.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"17.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"25.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"18.50\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"12.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"23.00\"},{\"1\":\"F\",\"2\":\"23.25\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.80\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"17.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"20.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"19.00\"},{\"1\":\"M\",\"2\":\"21.50\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n$\\blacksquare$\n\n\n(b) Make a suitable graph of the two columns.\n\nSolution\n\nOne quantitative variable and one categorical one, so a boxplot:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(span, aes(x=sex, y=handspan)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/handspan-2-1.png){width=672}\n:::\n:::\n\n$\\blacksquare$\n\n\n(c) Run a suitable two-sample $t$-test to address the question\nof interest. What do you conclude, in the context of the data?\n\nSolution\n\nWe are trying to show that males have a *larger* mean\nhandspan, so we need an `alternative`. To see which: there\nare two sexes, F and M in that order, and we are trying to show\nthat F is less than M:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(handspan~sex, data=span, alternative=\"less\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  handspan by sex\nt = -10.871, df = 187.92, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group F and group M is less than 0\n95 percent confidence interval:\n      -Inf -2.154173\nsample estimates:\nmean in group F mean in group M \n       20.01699        22.55747 \n```\n\n\n:::\n:::\n\nThe P-value is very small, so there is no doubt that males have larger\naverage handspans than females.\n\n$\\blacksquare$\n\n\n(d) Obtain a 90\\% confidence interval for the difference\nin mean handspan between males and females. Do you need to run\nany more code? Explain briefly.\n\nSolution\n\nA confidence interval is two-sided, so we have to re-run the test\nwithout the \\texttt{alternative} to make it two-sided. Note also that\nwe need a 90\\% interval, which is different from the default 95\\%, so\nwe have to ask for that too:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(handspan~sex, data=span, conf.level=0.90)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  handspan by sex\nt = -10.871, df = 187.92, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group F and group M is not equal to 0\n90 percent confidence interval:\n -2.926789 -2.154173\nsample estimates:\nmean in group F mean in group M \n       20.01699        22.55747 \n```\n\n\n:::\n:::\n\nThe interval is $-2.93$ to $-2.15$, *which you should say*. It\nwould be even better to say that males have a mean handspan between\n2.15 and 2.93 inches larger than that of females. You also need to round off your answer: the data are \ngiven to 0 or 1 decimals, so your interval should be given to 1 or 2 decimals (since the confidence interval is for a mean). \n\nOn a question like this, the grader is looking for three things: \n\n- getting the output\n- saying what the interval is\n- rounding it to a suitable number of decimals. \n\nThus, getting the output alone is only one out of three things.\n\n$\\blacksquare$\n\n\n(e) Explain briefly why you might have some concerns about the\nvalidity of the $t$-tests you ran in this question. Or, if you don't have any concerns, explain briefly why that is.\n\nSolution\n\nThe major assumption here is that the male and female handspans\nhave (approximate) normal distributions. The boxplots we drew\nearlier both had low-end outliers, so the normality is\nquestionable. \n\nAlso, say something about the sample sizes and whether or not you think they are large enough to be helpful.\n\nHow big are our sample sizes?\n\n::: {.cell}\n\n```{.r .cell-code}\nspan %>% count(sex)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"F\",\"2\":\"103\"},{\"1\":\"M\",\"2\":\"87\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nMy suspicion is that we are saved by two things: the sample sizes\nare large enough for the central limit theorem to help us, and in\nany case, the conclusion is so clear that the assumptions can\nafford to be off by a bit. \n\n\nExtra: one way to think about whether we should be concerned about\nthe lack of normality is to use the `bootstrap` to see what\nthe sampling distribution of the sample mean might look like for males and for females. (This is the stuff in Lecture 5a.) The\nway this works is to sample from each distribution *with\nreplacement*, work out the mean of each sample, then repeat many\ntimes, once for the females and once for the males.\n\nTo start with the females, the first thing to do is to grab *only* the rows containing the females. This, using an idea from Lecture 5a that we see again properly later, is `filter`:\n\n::: {.cell}\n\n```{.r .cell-code}\nspan %>% filter(sex==\"F\") -> females\nfemales\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"handspan\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.25\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"17.00\"},{\"1\":\"F\",\"2\":\"16.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.70\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.25\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"13.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"17.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"12.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"23.00\"},{\"1\":\"F\",\"2\":\"23.25\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.80\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"17.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nThere are 103 females. From these we need to take a \"large\" number of bootstrap samples to get a sense of how the mean handspan of the females varies:\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(457299)\ntibble(sim = 1:1000) %>% \n  rowwise() %>% \n  mutate(the_sample = list(sample(females$handspan, replace = TRUE))) %>% \n  mutate(the_mean = mean(the_sample)) -> d\n```\n:::\n\n\n\nThen we make a histogram of the bootstrap sampling distribution of the sample mean for the females:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d, aes(x = the_mean)) + geom_histogram(bins = 10)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/handspan-8-1.png){width=672}\n:::\n:::\n\nI don't know what you think of this. There are a few more extreme values than I would like, and\nit looks otherwise a bit left-skewed to me. But maybe I  am worrying too much.\n\nThe males one works exactly the same way:\n\n::: {.cell}\n\n```{.r .cell-code}\nspan %>% filter(sex==\"M\") -> males\ntibble(sim = 1:1000) %>% \n  rowwise() %>% \n  mutate(the_sample = list(sample(males$handspan, replace = TRUE))) %>% \n  mutate(the_mean = mean(the_sample)) -> d\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d, aes(x = the_mean)) + geom_histogram(bins = 10)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/handspan-10-1.png){width=672}\n:::\n:::\n\nThere is a similar story here. I think these are good enough overall, and so I am happy with the two-sample $t$-test, but it is not as clear-cut as I was expecting.\n\n\n\n$\\blacksquare$\n\n\n\n\n\n\n## The anchoring effect: Australia vs US\n\n Two groups of students (in a class at a American university) were asked what they thought the population of Canada was. (The correct answer at the time was just over 30 million.)\nSome of the students, before having to answer this, were told that the population of the United States was about 270 million. The other students in the class were told that the population of Australia was\nabout 18 million. The data are in [http://ritsokiguess.site/datafiles/anchoring.csv](http://ritsokiguess.site/datafiles/anchoring.csv). The first column contains the country whose population the student was told, and the second contains the student's guess at the population of Canada.\n\nYou might wonder how being told the population of an unrelated country would have any impact on a student's guess at the population of Canada. Psychology says it does: it's called the *anchoring effect*, and the idea is that the number mentioned first acts as an \"anchor\": a person's guess will be closer to the anchor than it would have been otherwise. In this case, that would mean that the guesses for the students given the\nUS as an anchor will be higher than for the students given Australia as an anchor. We are interested in seeing whether there is evidence for that here.\n\n\n\n\n(a) Read in and display (some of)  the data.\n\nSolution\n\n\nI made it as easy as I could:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/anchoring.csv\"\ncanada <- read_csv(my_url)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 21 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): anchor\ndbl (1): estimate\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ncanada\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"anchor\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"US\",\"2\":\"20.0\"},{\"1\":\"US\",\"2\":\"90.0\"},{\"1\":\"US\",\"2\":\"1.5\"},{\"1\":\"US\",\"2\":\"100.0\"},{\"1\":\"US\",\"2\":\"132.0\"},{\"1\":\"US\",\"2\":\"150.0\"},{\"1\":\"US\",\"2\":\"130.0\"},{\"1\":\"US\",\"2\":\"40.0\"},{\"1\":\"US\",\"2\":\"200.0\"},{\"1\":\"US\",\"2\":\"20.0\"},{\"1\":\"australia\",\"2\":\"12.0\"},{\"1\":\"australia\",\"2\":\"20.0\"},{\"1\":\"australia\",\"2\":\"10.0\"},{\"1\":\"australia\",\"2\":\"81.0\"},{\"1\":\"australia\",\"2\":\"15.0\"},{\"1\":\"australia\",\"2\":\"20.0\"},{\"1\":\"australia\",\"2\":\"30.0\"},{\"1\":\"australia\",\"2\":\"20.0\"},{\"1\":\"australia\",\"2\":\"9.0\"},{\"1\":\"australia\",\"2\":\"10.0\"},{\"1\":\"australia\",\"2\":\"20.0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nYou might need to scroll down to see that both \"anchor\" countries are indeed represented.\n\n\n$\\blacksquare$\n\n\n(b) Draw a suitable graph of these data.\n\nSolution\n\n\nOne categorical variable and one quantitative one, so a boxplot:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(canada, aes(x = anchor, y = estimate)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/ozvus-2-1.png){width=672}\n:::\n:::\n\n\n$\\blacksquare$\n\n\n(c) Explain briefly why a Welch $t$-test would be better than a pooled $t$-test in this case.\n\nSolution\n\n\nThe decision between these two tests lies in whether you think the two groups have equal spread (variance, strictly). Here, the spread for the US group is much larger than for the Australia group, even taking into account the big outlier in the latter group. Since the spreads are different, we should do a Welch $t$-test rather than a pooled one.\n\nMake sure you answer the question I asked, not the one you think I should have asked.\n\nThere is a separate question about whether the groups are close enough to normal, but I wasn't asking about that here. I was asking: *given* that we have decided to do some kind of $t$-test, why is the Welch one better than the pooled one? I am not asking whether we should be doing any kind of $t$-test at all; if I had, you could *then* reasonably talk about the outlier in the Australia group, and other possible skewness in its distribution, but that's not what I asked about.\n\n\n$\\blacksquare$\n\n\n(d) Run a suitable Welch $t$-test and display the output.\n\nSolution\n\n\nThe word \"suitable\" is a hint that you may have to think a bit about how you run the test. If the anchoring  effect is real, the mean of the guesses for the students told the population of the US will be higher on average than for those told the population of Australia, so we want a one-sided alternative. Australia is before the US alphabetically, so the alternative has to be `less`:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(estimate~anchor, data = canada, alternative = \"less\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  estimate by anchor\nt = -3.0261, df = 10.558, p-value = 0.006019\nalternative hypothesis: true difference in means between group australia and group US is less than 0\n95 percent confidence interval:\n      -Inf -26.63839\nsample estimates:\nmean in group australia        mean in group US \n               22.45455                88.35000 \n```\n\n\n:::\n:::\n\nNote that the Welch test is the default, so you don't have to do anything special to get it. Your output will tell you that a Welch test is what you have.\nIt's if you want a *pooled* test that you have to ask for it specifically (with `var.equal = TRUE`). \n\nIf you get a P-value close to 1, this is often an indication that you have the alternative the wrong way around.\n\n\n$\\blacksquare$\n\n\n(e) What do you conclude from your test, in the context of the data?\n\nSolution\n\n\nThe P-value is definitely less than 0.05, so we reject the null hypothesis (which says that the mean guess is the same regardless of the anchor the student was given). So we have evidence that the mean guess is higher for the students who were given the US population first. \n\nExtra 1: this is perhaps the place to think about what effect that outlier in the `australia` group might  have had. Since it is a high outlier, its effect will be to make the the `australia` mean higher than it would have been otherwise, and therefore to make the two group means closer together. Despite this, the difference still came out strongly significant, so that we can be *even more sure than the P-value says* that there is a real difference between the means of estimates of the population of Canada. (To say it differently, if the outlier had not been there, the difference in means would have been even bigger and thus even more significant.)\n\nExtra 2: if you are still worried about doing a two-sample $t$-test here, you might consider looking at the bootstrapped sampling distribution of the sample mean of the `australia` group:\n\n::: {.cell}\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncanada %>% filter(anchor == \"australia\") -> oz\ntibble(sim = 1:1000) %>% \n  rowwise() %>% \n  mutate(the_sample = list(sample(oz$estimate, replace = TRUE))) %>% \n  mutate(the_mean = mean(the_sample)) %>% \n  ggplot(aes(x = the_mean)) + geom_histogram(bins=10)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/ozvus-5-1.png){width=672}\n:::\n:::\n\nThis is indeed skewed to the right (though, with 11 observations, not nearly so non-normal as the original data), and so the P-value we got from the $t$-test may not be reliable. But, as discussed in Extra 1, the \"correct\" P-value is, if anything, *even smaller* than the one we got, and so the conclusion we drew earlier (that there is a significant anchoring effect) is not going to change.\n\nExtra 3: looking even further ahead, there is a test that definitely *does* apply here, called Mood's Median Test. You won't have installed the package yet, so this won't work for you just yet ([read ahead](http://ritsokiguess.site/STAC33/inference_5_R_slides.pdf) if you want to learn more), but here's how it goes:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(smmr)\nmedian_test(canada, estimate, anchor)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$grand_median\n[1] 20\n\n$table\n           above\ngroup       above below\n  australia     2     5\n  US            7     1\n\n$test\n       what      value\n1 statistic 5.40178571\n2        df 1.00000000\n3   P-value 0.02011616\n```\n\n\n:::\n:::\n\nThis does (as it is written) a two-sided test, because it can also be used for comparing more than two groups. Since we want a one-sided test here, you can (i) check that we are on the correct side (we are)^[The test works by comparing the data values in each group to the overall median. The students who were given Australia as an anchor mostly guessed below the overall median, and the students given the US as an anchor mostly guessed above.] (ii) halve the P-value to get 0.010.\n\nThis is a P-value you can trust. It is not smaller than the $t$-test one, perhaps because this test is less powerful than the $t$-test in most cases.^[It uses the data less efficiently than the t-test; it just counts the number of values above and below the overall median in each group, rather than using the actual numbers to compute means.]\n\n\n$\\blacksquare$\n\n\n\n\n\n",
=======
    "markdown": "# Two-sample inference\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n##  Children and electronic devices\n\n\n Do children (aged 8--17) spend more time on electronic\ndevices now than they did 10 years ago? Samples of 15 children aged\n8--17 were taken in each of two years, 1999 and 2009, and the children (with\ntheir parents' help) were\nasked to keep a diary of the number of hours they spent using\nelectronic devices on a certain day. The data are in the file\n[http://ritsokiguess.site/datafiles/pluggedin.txt](http://ritsokiguess.site/datafiles/pluggedin.txt).\n\n\n\n(a) Read in the data and  verify that you have 30 rows of data from two\ndifferent years.\n\n\n\n(b) Draw side-by-side boxplots of the number of hours for each\nyear. `year` is a numeric variable that we want to treat as a\nfactor, so we need to *make* it into a factor.\n\n\n\n\n(c) Test whether the mean number of hours has *increased* since 1999. Which test did R do?\n\n\n\n\n(d) Obtain a 99\\% confidence interval for the difference in means.\n\n\n\n\n\n\n\n\n\n\n##  Parking close to the curb\n\n\n In 2009, the Toronto Star commissioned a survey to address\nthe issue of who is better at parking a car: men or women. The\nresearchers recorded 93 drivers who were parallel-parking their car in\ndowntown Toronto, and for each driver, recorded the distance between\nthe car and the curb, in inches, when the driver was finished parking\ntheir car. The data are in an Excel spreadsheet,\n[link](http://ritsokiguess.site/datafiles/parking.xlsx).  Click on the link. The data\nwill probably download automatically. Check the folder on your\ncomputer where things get downloaded.^[Mine is rather  prosaically called `Downloads`.] \nIf the spreadsheet is just\ndisplayed and not downloaded, save it somewhere on your computer.\n\n\n\n(a) There are two sheets in this spreadsheet workbook. They are\nof the same data in two different formats. Take a look at Sheet 1\nand Sheet 2. Describe the format of the data in each case. Which will be the most suitable data layout, bearing in\nmind that one of the first things we do is to make side-by-side\nboxplots of parking distances for males and females? Explain briefly.\n\n\n\n(b) Read your preferred sheet directly into R, *without*\nusing a `.csv` file. (There is a clue in the lecture notes,\nin the section about reading in files.) If you get stuck, make a\n`.csv` file and read that in.\n\n\n\n(c) Obtain side-by-side boxplots of parking distances for\nmales and females. Does one\ngender seem to be better at parking than the other? Explain briefly.\n\n\n\n(d) Explain briefly why this is two independent samples\nrather than matched pairs.\n\n\n\n(e) Run a suitable $t$-test for comparing parking distances\nfor males and females. What do you conclude, in the context of the data?\n\n\n\n(f) Why might you have some doubts about the $t$-test that\nyou just did? Explain briefly.\n\n\n\n(g) The Toronto Star in its report said that females are\nmore accurate at parking their cars. Why do you think they\nconcluded that, and do you think they were right to do so?\nExplain briefly.\n\n\n\n\n\n\n\n\n##  Bell peppers and too much water\n\n\n A pathogen called *Phytophthora capsici* causes bell\npeppers to wilt and die. It is thought that too much water aids in the\nspread of the pathogen. Two fields are under study, labelled\n`a` and `b`. The first step in the research project is\nto compare the mean soil  water content of the two fields.  There is\na suspicion that field `a` will have a higher water content\nthan field `b`. The data\nare in the\nfile\n[link](http://ritsokiguess.site/datafiles/bellpepper.csv).\n\n\n(a) Read the file in using `read_csv`, and\nlist the resulting data frame.\n \n\n(b) Make side-by-side boxplots of the water content values for\nthe two fields. How do the fields seem to compare?\n \n\n(c) Do a two-sample $t$-test to test whether there is evidence\nthat the mean water\ncontent in field `a` is higher than that of field\n`b`. What do you conclude? Explain briefly. (You'll need to\nfigure out a way of doing a one-sided test, or how to adapt the\nresults from a two-sided test.)\n \n\n(d) Is the result of your test consistent with the boxplot, or\nnot? Explain briefly.\n \n\n\n\n\n##  Exercise and anxiety and bullying mice\n\n\n Does exercise help to reduce anxiety?\nTo assess this, some researchers randomly assigned\nmice to either \nan enriched environment where there was an exercise wheel available,\nor a standard environment with no exercise options. After three weeks\nin the specified environment, for five minutes a day for two weeks,\nthe mice were each exposed to a \"mouse bully\" --- a mouse who was very\nstrong, aggressive, and territorial. One measure of mouse anxiety is\namount of time hiding in a dark compartment, with mice who are more\nanxious spending more time in darkness. The amount of time spent in\ndarkness is recorded for each of the mice. \n\nThe data can be found at\n[link](http://ritsokiguess.site/datafiles/stressedmice.txt). \n\n\n\n(a) Read the data into R, and display your data frame. Count the number of mice in each group. \n\n\n(b) Draw side-by-side boxplots of time spent in darkness for each\ngroup of mice.\n\n\n(c) Do the boxplots support the hypothesis about exercise and\nanxiety? Explain briefly.\n\n\n(d) Carry out a $t$-test for comparing the mean time spent in\ndarkness for the mice in the two groups. Think carefully about the\ndetails of the $t$-test (and what you need evidence in favour of).\n\n\n(e) What do you conclude, in terms of anxiety and exercise (at\nleast for mice)? Explain  briefly.\n\n\n(f) Does anything in the previous parts suggest any problems with\nthe analysis you just did? Explain briefly.\n\n\n\n\n\n##  Diet and growth in boys\n\n\n A dietician is studying the effect of\ndifferent diets on children's growth. In part of the study, the\ndietician is investigating two religious sects, labelled `a`\nand `b` in our data set. Both sects are vegetarian; the\ndifference between them is that people in Sect A only eat vegetables\nfrom below the ground, and Sect B only eats vegetables from above the\nground. The height and weight of the boys^[This was not sexism, but a recognition that boys and girls will be of different heights for reasons unrelated to diet. Doing it this way makes the analysis simpler.] are measured at regular\nintervals. The data in\n[link](http://ritsokiguess.site/datafiles/kids-diet.txt) are the\nheights of the boys at age 12.\n\n\n\n(a) Read in the data and find out how many observations you have\nand which variables.\n\n\n\n(b) Obtain side-by-side boxplots of the heights for boys from\neach sect. Does it look as if the heights of the boys in each sect\nare different? Comment briefly. \n\n\n\n(c) Looking at your boxplots, do you see any problems with\ndoing a two-sample $t$-test? Explain briefly.\n\n\n\n(d) Run a $t$-test to determine whether the mean heights differ\nsignificantly. What do you conclude? Explain briefly. (Run the\n$t$-test even if your previous work suggests that it is not the\nright thing to do.)\n\n\n\n\n\n\n\n\n## Handspans of males and females\n\n Take your right hand, and stretch the fingers out as far as\nyou can. The distance between the tip of your thumb and the tip of\nyour little (pinky) finger is your handspan. The students in a\nStatistics class at Penn State measured their handspans and also\nwhether they identified as male or female. The data are at [http://ritsokiguess.site/datafiles/handspan.txt](http://ritsokiguess.site/datafiles/handspan.txt),\nwith handspans\nmeasured in inches.  Thinking of these as a random sample of all\npossible students, is it true that males have a larger mean handspan\nthan females? This is what we will explore.\n\n\n(a) Read in and display (some of) the data.\n\n\n\n(b) Make a suitable graph of the two columns.\n\n\n\n(c) Run a suitable two-sample $t$-test to address the question\nof interest. What do you conclude, in the context of the data?\n\n\n\n(d) Obtain a 90\\% confidence interval for the difference\nin mean handspan between males and females. Do you need to run\nany more code? Explain briefly.\n\n\n\n(e) Explain briefly why you might have some concerns about the\nvalidity of the $t$-tests you ran in this question. Or, if you don't have any concerns, explain briefly why that is.\n\n\n\n\n\n\n\n## The anchoring effect: Australia vs US\n\n Two groups of students (in a class at a American university) were asked what they thought the population of Canada was. (The correct answer at the time was just over 30 million.)\nSome of the students, before having to answer this, were told that the population of the United States was about 270 million. The other students in the class were told that the population of Australia was\nabout 18 million. The data are in [http://ritsokiguess.site/datafiles/anchoring.csv](http://ritsokiguess.site/datafiles/anchoring.csv). The first column contains the country whose population the student was told, and the second contains the student's guess at the population of Canada.\n\nYou might wonder how being told the population of an unrelated country would have any impact on a student's guess at the population of Canada. Psychology says it does: it's called the *anchoring effect*, and the idea is that the number mentioned first acts as an \"anchor\": a person's guess will be closer to the anchor than it would have been otherwise. In this case, that would mean that the guesses for the students given the\nUS as an anchor will be higher than for the students given Australia as an anchor. We are interested in seeing whether there is evidence for that here.\n\n\n\n\n(a) Read in and display (some of)  the data.\n\n\n\n(b) Draw a suitable graph of these data.\n\n\n\n(c) Explain briefly why a Welch $t$-test would be better than a pooled $t$-test in this case.\n\n\n\n(d) Run a suitable Welch $t$-test and display the output.\n\n\n\n(e) What do you conclude from your test, in the context of the data?\n\n\n\n\n\n\n\n\n\nMy solutions follow:\n\n\n\n\n##  Children and electronic devices\n\n\n Do children (aged 8--17) spend more time on electronic\ndevices now than they did 10 years ago? Samples of 15 children aged\n8--17 were taken in each of two years, 1999 and 2009, and the children (with\ntheir parents' help) were\nasked to keep a diary of the number of hours they spent using\nelectronic devices on a certain day. The data are in the file\n[http://ritsokiguess.site/datafiles/pluggedin.txt](http://ritsokiguess.site/datafiles/pluggedin.txt).\n\n\n\n(a) Read in the data and  verify that you have 30 rows of data from two\ndifferent years.\n\n\nSolution\n\n\nI see this:\n\n::: {.cell}\n\n```{.r .cell-code}\nmyurl <- \"http://ritsokiguess.site/datafiles/pluggedin.txt\"\nplugged <- read_delim(myurl,\" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 30 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \" \"\ndbl (2): year, hours\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nplugged\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"year\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"hours\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1999\",\"2\":\"4\"},{\"1\":\"1999\",\"2\":\"5\"},{\"1\":\"1999\",\"2\":\"7\"},{\"1\":\"1999\",\"2\":\"7\"},{\"1\":\"1999\",\"2\":\"5\"},{\"1\":\"1999\",\"2\":\"7\"},{\"1\":\"1999\",\"2\":\"5\"},{\"1\":\"1999\",\"2\":\"6\"},{\"1\":\"1999\",\"2\":\"5\"},{\"1\":\"1999\",\"2\":\"6\"},{\"1\":\"1999\",\"2\":\"7\"},{\"1\":\"1999\",\"2\":\"8\"},{\"1\":\"1999\",\"2\":\"5\"},{\"1\":\"1999\",\"2\":\"6\"},{\"1\":\"1999\",\"2\":\"6\"},{\"1\":\"2009\",\"2\":\"5\"},{\"1\":\"2009\",\"2\":\"9\"},{\"1\":\"2009\",\"2\":\"5\"},{\"1\":\"2009\",\"2\":\"8\"},{\"1\":\"2009\",\"2\":\"7\"},{\"1\":\"2009\",\"2\":\"6\"},{\"1\":\"2009\",\"2\":\"7\"},{\"1\":\"2009\",\"2\":\"9\"},{\"1\":\"2009\",\"2\":\"7\"},{\"1\":\"2009\",\"2\":\"9\"},{\"1\":\"2009\",\"2\":\"6\"},{\"1\":\"2009\",\"2\":\"9\"},{\"1\":\"2009\",\"2\":\"10\"},{\"1\":\"2009\",\"2\":\"9\"},{\"1\":\"2009\",\"2\":\"8\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nIf you want to check for yourself that there are 30 rows, you can click Next a couple of times to get down to row 30, and then see that the Next button cannot be clicked again, and therefore that 30 rows is how many there are. At the same time, you can see that some of the dataset is from 1999 and some of it is from 2009.\n\nOr, you can summarize the years by counting how many there are\nof each:\n\n::: {.cell}\n\n```{.r .cell-code}\nplugged %>% count(year)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"year\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1999\",\"2\":\"15\"},{\"1\":\"2009\",\"2\":\"15\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nor the more verbose form of the same thing:\n\n::: {.cell}\n\n```{.r .cell-code}\nplugged %>% group_by(year) %>% summarize(rows=n())\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"year\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"rows\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1999\",\"2\":\"15\"},{\"1\":\"2009\",\"2\":\"15\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nAny of those says that it looks good. 30 rows, years 1999 and 2009, 15\nmeasurements for each.\n\n$\\blacksquare$\n\n(b) Draw side-by-side boxplots of the number of hours for each\nyear. `year` is a numeric variable that we want to treat as a\nfactor, so we need to *make* it into a factor.\n\n\n\nSolution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(plugged, aes(x = factor(year), y = hours)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/waehingen-1.png){width=672}\n:::\n:::\n\nThe `fct_inorder` trick will also work, since\nthe years are in the data in the order we want them to be displayed. (An option in case  you have seen this.)\n\nThe median for 2009 is noticeably higher, and there is no skewness or\noutliers worth worrying about.\n\nThe measurements for the two years have a very similar spread, so\nthere would be no problem running the pooled test here.\n\nYou might be bothered by the `factor(year)` on the $x$-axis. To\nget around that, you can define year-as-factor *first*, using\n`mutate`, then feed your new column into the boxplot. That goes\nlike this. There is a wrinkle that I explain afterwards:\n\n::: {.cell}\n\n```{.r .cell-code}\nplugged %>% mutate(the_year = factor(year)) %>%\n  ggplot(aes(x = the_year, y=hours)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/bisslerin-1.png){width=672}\n:::\n:::\n\nYou could even redefine `year` to be the factor version of\nitself (if you don't need the year-as-number anywhere else). The\nwrinkle I mentioned above is that in the `ggplot` you *do\nnot* name the data frame first; the data frame used is the\n(nameless) data frame that came out of the previous step, not\n`plugged` but `plugged` with a new column\n`the_year`.\n\nNote how the $x$-axis now has the name of the new variable.\n\nIf you forget to make `year` into a factor, this happens:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(plugged, aes(x = year, y = hours)) + geom_boxplot()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Continuous x aesthetic\nℹ did you forget `aes(group = ...)`?\n```\n:::\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/luotter-1.png){width=672}\n:::\n:::\n\nYou get *one* boxplot, for all the hours, without distinguishing\nby year, and a warning message that tries (and fails) to read our\nmind: yes, we have a continuous, quantitative `x`, but\n`geom_boxplot` doesn't take a `group`. Or maybe it does. Try it and see:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(plugged,aes(x = year, y = hours, group = year)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\nThe $x$-axis treats the year as a number, which looks a little odd, but adding a `group` correctly gets us two boxplots side by side, so this is also a good way to do it. So maybe the error message *did* read our mind after all.\n\n\n$\\blacksquare$\n\n(c) Test whether the mean number of hours has *increased* since 1999. Which test did R do?\n\n\n\nSolution\n\n\nThe hard part to remember is how you specify a one-sided test in\nR; it's `alternative=\"less\"` (rather\nthan \"greater\") because 1999 is \"before\" 2009:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(hours~year,data=plugged,alternative=\"less\")  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  hours by year\nt = -3.3323, df = 24.861, p-value = 0.001348\nalternative hypothesis: true difference in means between group 1999 and group 2009 is less than 0\n95 percent confidence interval:\n       -Inf -0.8121415\nsample estimates:\nmean in group 1999 mean in group 2009 \n          5.933333           7.600000 \n```\n:::\n:::\n\nThe P-value is 0.0013. R does the Welch-Satterthwaite test by default\n(the unequal-variances one). Since we didn't change that, that's what\nwe got. (The pooled test is below.)\n\nThis is the cleanest way to do it, because this version of\n`t.test`, with a \"model formula\" (the thing with the\nsquiggle) allows a `data=` to say which data frame to get\nthings from. The other ways, using (for example) `with`, also work:\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(plugged,t.test(hours~year,alternative=\"less\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  hours by year\nt = -3.3323, df = 24.861, p-value = 0.001348\nalternative hypothesis: true difference in means between group 1999 and group 2009 is less than 0\n95 percent confidence interval:\n       -Inf -0.8121415\nsample estimates:\nmean in group 1999 mean in group 2009 \n          5.933333           7.600000 \n```\n:::\n:::\n\nThis also works, but is *ugly*:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(plugged$hours~plugged$year,alternative=\"less\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  plugged$hours by plugged$year\nt = -3.3323, df = 24.861, p-value = 0.001348\nalternative hypothesis: true difference in means between group 1999 and group 2009 is less than 0\n95 percent confidence interval:\n       -Inf -0.8121415\nsample estimates:\nmean in group 1999 mean in group 2009 \n          5.933333           7.600000 \n```\n:::\n:::\n\nUgly because you've just typed the name of the data frame and the\ndollar sign *twice* for no reason. As a general principle, if you\nas a programmer are repeating yourself, you should stop and ask\nyourself how you can avoid the repeat.\n\nIf you want the pooled test in R, you have to ask for it:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(hours~year, alternative = \"less\", data = plugged, var.equal = TRUE)    \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tTwo Sample t-test\n\ndata:  hours by year\nt = -3.3323, df = 28, p-value = 0.001216\nalternative hypothesis: true difference in means between group 1999 and group 2009 is less than 0\n95 percent confidence interval:\n       -Inf -0.8158312\nsample estimates:\nmean in group 1999 mean in group 2009 \n          5.933333           7.600000 \n```\n:::\n:::\n\nAs is often the case, the P-values for the pooled and\nWelch-Satterthwaite tests are very similar, so from that point of view\nit doesn't matter much which one you use. If you remember back to the\nboxplots, the number of hours had about the same spread for the two\nyears, so if you used the pooled test instead of the\nWelch-Satterthwaite test, that would have been just fine.\n\nThere is a school of thought that says we should learn the\nWelch-Satterthwaite test and use that always. This is because W-S (i)\nworks when the populations from which the groups are sampled have\ndifferent SDs and (ii) is pretty good even when those SDs are the same.\n\nThe pooled test can go badly wrong if the groups have very different\nSDs.  The story is this: if the larger sample is from the population\nwith the larger SD, the probability of a type I error will be smaller\nthan $\\alpha$, and if the larger sample is from the population with\nthe *smaller* SD, the probability of a type I error will be\nlarger than $\\alpha$. This is why you see S-W in STAB22. You see the\npooled test in STAB57 because the logic of its derivation is so much\nclearer, \nnot because it's really the better test in\npractice. The theory says that if your data are normal in both groups\nwith the same variance, then the pooled test is best, but it says\n*nothing* about the quality of the pooled test if any of that\ngoes wrong.\nThe usual approach to assessing things like this is via simulation,\nas we do for estimating power (later): generate some random data\neg. from normal distributions with the same means, SDs 10 and 20\nand sample sizes 15 and 30, run the pooled $t$-test, see if you\nreject, then repeat lots of times and see whether you reject about\n5\\% of the time. Then do the same thing again with the sample sizes\nswitched around. Or, do the same thing with Welch-Satterthwaite.\n\n\n$\\blacksquare$\n\n(d) Obtain a 99\\% confidence interval for the difference in means.\n\n\n\nSolution\n\n\nTake off the thing that made it one-sided, and\nput in a thing that gets the right CI:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(hours~year,data=plugged,conf.level=0.99)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  hours by year\nt = -3.3323, df = 24.861, p-value = 0.002696\nalternative hypothesis: true difference in means between group 1999 and group 2009 is not equal to 0\n99 percent confidence interval:\n -3.0614628 -0.2718705\nsample estimates:\nmean in group 1999 mean in group 2009 \n          5.933333           7.600000 \n```\n:::\n:::\n\n$-3.06$ to $-0.27$. The interval contains only negative values, which\nis consistent with our having rejected a null hypothesis of no\ndifference in means.\n\n$\\blacksquare$\n\n\n\n\n\n\n\n##  Parking close to the curb\n\n\n In 2009, the Toronto Star commissioned a survey to address\nthe issue of who is better at parking a car: men or women. The\nresearchers recorded 93 drivers who were parallel-parking their car in\ndowntown Toronto, and for each driver, recorded the distance between\nthe car and the curb, in inches, when the driver was finished parking\ntheir car. The data are in an Excel spreadsheet,\n[link](http://ritsokiguess.site/datafiles/parking.xlsx).  Click on the link. The data\nwill probably download automatically. Check the folder on your\ncomputer where things get downloaded.^[Mine is rather  prosaically called `Downloads`.] \nIf the spreadsheet is just\ndisplayed and not downloaded, save it somewhere on your computer.\n\n\n\n(a) There are two sheets in this spreadsheet workbook. They are\nof the same data in two different formats. Take a look at Sheet 1\nand Sheet 2. Describe the format of the data in each case. Which will be the most suitable data layout, bearing in\nmind that one of the first things we do is to make side-by-side\nboxplots of parking distances for males and females? Explain briefly.\n\n\nSolution\n\n\nThe data in Sheet 1 has one column of parking distances for\nmales, and another for females. This is often how you see data\nof this sort laid out. Sheet 2 has *one* column of parking\ndistances, all combined together, and a second column indicating\nthe gender of the driver whose distance is in the first column.\nIf you look back at the kind of data we've used to make\nside-by-side boxplots, it's always been in the format of Sheet\n2: one column containing all the values of the variable we're\ninterested in, with a second column indicating which group each\nobservation belongs to (\"group\" here being \n\"gender of driver\"). \nSo we need to use the data in Sheet 2, because the\ndata in Sheet 1 are not easy to handle with R. \nThe layout of Sheet 2 is the way R likes to do most things:\nso-called \"long format\" with a lot of rows and not many\ncolumns. This is true for descriptive stuff: side-by-side\nboxplots or histograms or  means by group, as well as modelling\nsuch as (here) a two-sample $t$-test, or (in other\ncircumstances, as with several groups) a one-way analysis of\nvariance. \nHadley Wickham, the guy behind the `tidyverse`, likes to\ntalk about \"tidy data\" (like Sheet 2), with each column\ncontaining a variable, and \"untidy data\" (like Sheet 1), where\nthe two columns are the same thing (distances), but under\ndifferent circumstances (genders). As we'll see later, it is\npossible to convert from one format to the other. Usually you\nwant to make untidy data tidy (the function for this is called\n`pivot_longer`). \n\n$\\blacksquare$\n\n(b) Read your preferred sheet directly into R, *without*\nusing a `.csv` file. (There is a clue in the lecture notes,\nin the section about reading in files.) If you get stuck, make a\n`.csv` file and read that in.\n\n\nSolution\n\n\nThe direct way is to use the package `readxl`. This has a\n`read_excel` that works the same way as any of the other\n`read_` functions. You'll have to make sure that you\nread in sheet 2, since that's the one you want. \nThere is some setup first. There are a couple of ways you can do that:\n\n\n* Download the spreadsheet to your computer, and upload it\nto your project on `r.datatools` (or, if you are running R\nStudio on your computer, use something like\n`file.choose` to get the file from wherever it got\ndownloaded to).\n\n* Use the function `download.file` to get the file\nfrom the URL and store it in your project folder\ndirectly. This also works on `r.datatools`, and completely\nby-passes the download-upload steps that you would have to do\notherwise. (I am grateful to Rose Gao for this idea.)\nHere is how you can use `download.file` here:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/parking.xlsx\"\nlocal <- \"parking.xlsx\"\ndownload.file(my_url, local, mode = \"wb\")\n```\n:::\n\n         \n\nWhen you've gotten the spreadsheet into your project folder via one of\nthose two ways, you go ahead and do this:    \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nparking <- read_excel(\"parking.xlsx\", sheet = 2)\nparking\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"distance\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"gender\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0.5\",\"2\":\"male\"},{\"1\":\"1.0\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"3.0\",\"2\":\"male\"},{\"1\":\"3.5\",\"2\":\"male\"},{\"1\":\"5.0\",\"2\":\"male\"},{\"1\":\"6.0\",\"2\":\"male\"},{\"1\":\"6.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"8.0\",\"2\":\"male\"},{\"1\":\"8.0\",\"2\":\"male\"},{\"1\":\"8.5\",\"2\":\"male\"},{\"1\":\"8.5\",\"2\":\"male\"},{\"1\":\"9.0\",\"2\":\"male\"},{\"1\":\"9.0\",\"2\":\"male\"},{\"1\":\"9.5\",\"2\":\"male\"},{\"1\":\"10.0\",\"2\":\"male\"},{\"1\":\"10.0\",\"2\":\"male\"},{\"1\":\"11.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"13.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"17.0\",\"2\":\"male\"},{\"1\":\"18.0\",\"2\":\"male\"},{\"1\":\"18.0\",\"2\":\"male\"},{\"1\":\"19.0\",\"2\":\"male\"},{\"1\":\"19.0\",\"2\":\"male\"},{\"1\":\"20.0\",\"2\":\"male\"},{\"1\":\"21.0\",\"2\":\"male\"},{\"1\":\"48.0\",\"2\":\"male\"},{\"1\":\"2.0\",\"2\":\"female\"},{\"1\":\"2.5\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"4.0\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"6.0\",\"2\":\"female\"},{\"1\":\"6.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.5\",\"2\":\"female\"},{\"1\":\"8.0\",\"2\":\"female\"},{\"1\":\"8.5\",\"2\":\"female\"},{\"1\":\"8.5\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"10.0\",\"2\":\"female\"},{\"1\":\"10.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.5\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"15.5\",\"2\":\"female\"},{\"1\":\"16.0\",\"2\":\"female\"},{\"1\":\"18.0\",\"2\":\"female\"},{\"1\":\"20.0\",\"2\":\"female\"},{\"1\":\"21.0\",\"2\":\"female\"},{\"1\":\"25.0\",\"2\":\"female\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n       \n\nYou have to do it this way, using the version of the spreadsheet on\nyour computer, since `read_excel` won't take a\nURL, or if it does, I can't make it work.^[Let me know if you  have more success than I did.] \nI put the spreadsheet in R Studio's\ncurrent folder, so I could read it in by name, or you can do the\n`f <- file.choose()` thing, find it, then read it in.\nThe `sheet=` thing can take either a number (as here: the\nsecond sheet in the workbook), or a name (whatever name the sheet has\non its tab in the workbook). \n\nExtra: Rose actually came up with a better idea, which I will show\nyou and explain:\n\n::: {.cell}\n\n```{.r .cell-code}\ntf <- tempfile()\ndownload.file(my_url, tf, mode = \"wb\")\np <- read_excel(tf, sheet = 2)\n```\n:::\n\n \n\nWhat `tempfile()` does is to create a temporary file to hold the\nspreadsheet that you are about to download. After downloading the\nspreadsheet to the temporary file, you then use `read_excel` to\nread *from the temporary file* into the data frame.\n\nThe advantage of this approach is that the temporary file disappears\nas soon as you close R, and so you don't have a copy of the\nspreadsheet lying around that you don't need (once you have created\nthe dataframe that I called `parking`, anyway).\n\nIf you are wondering about that `mode` thing on\n`download.file`: files are of two different types, \"text\"\n(like the text of an email, that you can open and look at in something\nlike Notepad), and \"binary\" that you can't look at directly, but for\nwhich you need special software like Word or Excel to decode it for\nyou.^[A Word or Excel document has all kinds of formatting  information hidden in the file as well as the text that you see on  the screen.]  \nThe first character in `mode` is either\n`w` for \"write a new file\", which is what we want here, or\n`a` for \"append\", which would mean adding to the end of a\nfile that already exists. Thus `mode=\"wb\"` means \n\"create a new binary file\".\nEnd of Extra.\n\nIf you can't make any of this work, then do it in two steps:\nsave the appropriate sheet as a `.csv` \nfile, and then read the `.csv` file using\n`read_csv`. If you experiment, you'll find that saving a\nspreadsheet workbook as `.csv` only saves the sheet\nyou're looking at, so make sure you are looking at sheet 2\nbefore you Save As `.csv`. I did that, and called my\nsaved `.csv` `parking2.csv` (because it was from\nsheet 2, but you can use any name you like).\nThen I read this into R thus:\n\n::: {.cell}\n\n```{.r .cell-code}\nparking2 <- read_csv(\"parking2.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 93 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): gender\ndbl (1): distance\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nparking2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"distance\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"gender\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0.5\",\"2\":\"male\"},{\"1\":\"1.0\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"1.5\",\"2\":\"male\"},{\"1\":\"3.0\",\"2\":\"male\"},{\"1\":\"3.5\",\"2\":\"male\"},{\"1\":\"5.0\",\"2\":\"male\"},{\"1\":\"6.0\",\"2\":\"male\"},{\"1\":\"6.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"7.0\",\"2\":\"male\"},{\"1\":\"8.0\",\"2\":\"male\"},{\"1\":\"8.0\",\"2\":\"male\"},{\"1\":\"8.5\",\"2\":\"male\"},{\"1\":\"8.5\",\"2\":\"male\"},{\"1\":\"9.0\",\"2\":\"male\"},{\"1\":\"9.0\",\"2\":\"male\"},{\"1\":\"9.5\",\"2\":\"male\"},{\"1\":\"10.0\",\"2\":\"male\"},{\"1\":\"10.0\",\"2\":\"male\"},{\"1\":\"11.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"12.0\",\"2\":\"male\"},{\"1\":\"13.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.0\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"14.5\",\"2\":\"male\"},{\"1\":\"17.0\",\"2\":\"male\"},{\"1\":\"18.0\",\"2\":\"male\"},{\"1\":\"18.0\",\"2\":\"male\"},{\"1\":\"19.0\",\"2\":\"male\"},{\"1\":\"19.0\",\"2\":\"male\"},{\"1\":\"20.0\",\"2\":\"male\"},{\"1\":\"21.0\",\"2\":\"male\"},{\"1\":\"48.0\",\"2\":\"male\"},{\"1\":\"2.0\",\"2\":\"female\"},{\"1\":\"2.5\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"3.0\",\"2\":\"female\"},{\"1\":\"4.0\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"4.5\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"5.0\",\"2\":\"female\"},{\"1\":\"6.0\",\"2\":\"female\"},{\"1\":\"6.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.0\",\"2\":\"female\"},{\"1\":\"7.5\",\"2\":\"female\"},{\"1\":\"8.0\",\"2\":\"female\"},{\"1\":\"8.5\",\"2\":\"female\"},{\"1\":\"8.5\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"9.0\",\"2\":\"female\"},{\"1\":\"10.0\",\"2\":\"female\"},{\"1\":\"10.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.0\",\"2\":\"female\"},{\"1\":\"12.5\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"13.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"14.0\",\"2\":\"female\"},{\"1\":\"15.5\",\"2\":\"female\"},{\"1\":\"16.0\",\"2\":\"female\"},{\"1\":\"18.0\",\"2\":\"female\"},{\"1\":\"20.0\",\"2\":\"female\"},{\"1\":\"21.0\",\"2\":\"female\"},{\"1\":\"25.0\",\"2\":\"female\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n       \n\nThe read-in data frame `parking` \nhas 93 rows ($47+46=93$ drivers) and two columns: the distance from\nthe curb that the driver ended up at, and the gender of the\ndriver. This is as the spreadsheet Sheet 2 was, and the first few\ndistances match the ones in the spreadsheet.\n\nIf I were grading this, you'd get some credit for the `.csv`\nroute, but I really wanted you to figure out how to read the Excel\nspreadsheet directly, so that's what would be worth full marks.\n\nYou might want to check that you have some males and some females, and\nhow many of each, which you could do this way:\n\n::: {.cell}\n\n```{.r .cell-code}\nparking %>% count(gender)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"gender\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"female\",\"2\":\"47\"},{\"1\":\"male\",\"2\":\"46\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\n$\\blacksquare$\n\n(c) Obtain side-by-side boxplots of parking distances for\nmales and females. Does one\ngender seem to be better at parking than the other? Explain briefly.\n\n\nSolution\n\n\nWith the right data set, this is a piece of cake:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = gender, y = distance)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/parking-6-1.png){width=672}\n:::\n:::\n\n         \n\nThe outcome variable is distance from the curb, so smaller should be\nbetter (more accurate parking). With that in mind, the median for\nfemales is a little smaller than for males (about 8.5 vs.\\ about 10),\nso it seems that on average females are more accurate parkers than\nmales are. The difference is small, however (and so you might be\nwondering at this point whether it's a statistically significant\ndifference --- don't worry, that's coming up).\n\nBefore I leave this one, I want to show you something else:\nabove-and-below histograms, as another way of comparing males and\nfemales (two or more groups, in general). First, we make a histogram of all\nthe distances, without distinguishing by gender:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) + geom_histogram(bins = 8)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/parking-7-1.png){width=672}\n:::\n:::\n\n \n\nThat big outlier is the very inaccurate male driver.\n\nNow, how do we get a *separate* histogram for each\n`gender`? In `ggplot`, separate plots for each\n\"something\" are called **facets**, and the way to get facets\narranged as you want them is called `facet_grid`.^[I wrote this question a long time ago, back when I thought that `facet_grid` was the only way to do facets. Now, I would use `facet_wrap`. See the discussion about `facet_wrap` near the bottom.] Let me show you\nthe code first, and then explain how it works:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) +\n  geom_histogram(bins = 7) +\n  facet_grid(gender ~ .)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/parking-8-1.png){width=672}\n:::\n:::\n\n \n\n`facet_grid` takes a \"model formula\" with a squiggle, with $y$\non the left and $x$ on the right. We want to compare our two\nhistograms, one for males and one for females, and I think the best\nway to compare histograms is to have one on top of the other. Note\nthat the same `distance` scale is used for both histograms, so\nthat it is a fair comparison.  The above-and-below is accomplished by\nhaving `gender` as the $y$ in the arrangement of the facets, so\nit goes before the squiggle. We don't have any $x$ in the arrangement\nof the facets, and we tell `ggplot` this by putting a dot where\nthe $x$ would be.^[You might have a second categorical variable  by which you want to arrange the facets left and right, and that  would go where the dot is.]\n\nYou can also use `facet_wrap` for this, but you have to be\nmore careful since you don't have any control over how the histograms\ncome out (you probably get them side by side, which is not so helpful\nfor comparing distributions). You can make it work by using\n`ncol=1` to arrange *all* the histograms in one column:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) +\n  geom_histogram(bins = 7) +\n  facet_wrap(~gender, ncol = 1)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/parking-9-1.png){width=672}\n:::\n:::\n\n \n\nThe centres of both histograms are somewhere around 10, so it's hard\nto see any real difference between males and females here. Maybe this\nis further evidence that the small difference we saw between the\nboxplots is really not worth getting excited about.\n\nYou might be concerned about how you know what to put with the\nsquiggle-thing in `facet_grid` and `facet_wrap`. The\nanswer is that `facet_wrap` *only* has something to the\nright of the squiggle (which `ggplot` then decides how to\narrange), but `facet_grid` *must* have something on\n*both* sides of the squiggle (how to arrange in the $y$ direction\non the left, how to arrange in the $x$ direction on the right), and if\nyou don't have anything else to put there, you put a dot. Here's my\n`facet_grid` code from above, again:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) +\n  geom_histogram(bins = 7) +\n  facet_grid(gender ~ .)\n```\n:::\n\n \n\nWe wanted gender to go up and down, and we had nothing to go left and\nright, hence the dot. Contrast that with my `facet_wrap`\ncode:^[I took out the `ncol` since that confuses the  explanation here.] \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) +\n  geom_histogram(bins = 7) +\n  facet_wrap(~gender)\n```\n:::\n\n \n\nThis says \"make a separate facet for each gender\", but it doesn't\nsay anything about how to arrange them.\nThe choice of bins for my histogram(s) came from Sturges' rule: with\n$n$ being the number of observations, you use $k$ bins where\n$k=\\log_2(n)+1$, rounded up. If we were to make a histogram of all the\nparking distances combined together, we would have $n=47+48=95$\nobservations, so we should use this many bins:\n\n::: {.cell}\n\n```{.r .cell-code}\nsturges <- log(95, 2) + 1\nsturges\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 7.569856\n```\n:::\n:::\n\n \n\nRound this up to 8. (The second thing in `log` is the base of\nthe logs, if you specify it, otherwise it defaults to $e$ and gives\nyou \"natural\" logs.) I seem to have the powers of 2 in my head, so I\ncan do it mentally by saying \"the next power of 2 is 128, which is $2^7$, so I need $7+1=8$ bins.\"\n\nOr:\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(parking, nclass.Sturges(distance))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8\n```\n:::\n:::\n\n \nSturges' rule tends to produce not enough bins if $n$ is small, so be\nprepared to increase it a bit if you don't have much data.\nI think that gives a fairly bare-bones picture of the shape: skewed to\nthe right with outlier.\n\nThe other rule we saw was Freedman-Diaconis:\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(parking, nclass.FD(distance))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 14\n```\n:::\n:::\n\n \n\nand that leads to this histogram: \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(parking, aes(x = distance)) + geom_histogram(bins = 14)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/parking-15-1.png){width=672}\n:::\n:::\n\n \n\nThat gives rather more detail (a lot more bars: the binwidth in the\nSturges-rule histogram is about 7, or twice what you see here), but in\nthis case the overall story is about the same.\n\nIn the case of faceted histograms, you would want to apply a rule that\nuses the number of observations in *each* histogram. The facets\nmight have quite different numbers of observations, but you can only\nuse one `binwidth` (or `bins`), so you may have to\ncompromise. For example, using Sturges' rule based on 47 observations\n(the number of males; the number of females is one more):\n\n::: {.cell}\n\n```{.r .cell-code}\nlog(47, 2) + 1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6.554589\n```\n:::\n:::\n\n \n\nand so each facet should have that many bins, rounded up. That's where\nI got my 7 for the facetted histogram from. This one doesn't work\nimmediately with `nclass.Sturges`, because we do not have\n*one* column whose length is the number of observations we want:\nwe have one column of distances that are males and females mixed\nup. To do *that*, `filter` one of the genders first:\n\n::: {.cell}\n\n```{.r .cell-code}\nparking %>%\n  filter(gender == \"female\") %>%\n  with(., nclass.Sturges(distance))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 7\n```\n:::\n:::\n\n \n\nI used the \"dot\" trick again, which you can read as \"it\": \"from `parking`, take only the rows for the females, and with it, give me the number of bins for a histogram by Sturges' rule.\"\n\n$\\blacksquare$\n\n(d) Explain briefly why this is two independent samples\nrather than matched pairs.\n\n\nSolution\n\n\nThere is no way to pair any male with a corresponding female,\nbecause they are unrelated people. You might also notice that\nthere are not even the *same number* of males and females,\nso there can be no way of pairing them up without leaving one\nover. (In general, if the two samples are paired, there must be\nthe same number of observations in each; if there are different\nnumbers in each, as here, they cannot be paired.)\nIf you want that more mathematically, let $n_1$ and $n_2$ be the\ntwo sample sizes; then:\n\n$$\n\\mbox{Paired} \\Longrightarrow n_1=n_2\n$$\n\nfrom which it follows logically (the \"contrapositive\") that\n\n$$\nn_1 \\ne n_2 \\Longrightarrow \\mbox{not paired}\n$$\n\nYou'll note from the logic that if the two sample sizes are the same,\nthat tells you *nothing* about whether it's paired or independent\nsamples: it could be either, and in that case you have to look at the\ndescription of the data to decide between them.\n\nHere, anything that gets at why the males and females cannot be paired\nup is good.\n\n$\\blacksquare$\n\n(e) Run a suitable $t$-test for comparing parking distances\nfor males and females. What do you conclude, in the context of the data?\n\n\nSolution\n\n\n A two-sample $t$-test. I think either the Welch or the pooled one can\n be justified (and I would expect them to give similar answers). You\n can do the Welch one either without comment or by asserting that the\n boxplots show different spreads; if you are going to do the pooled\n one, you need to say that the spreads are \"about equal\", by\n comparing the heights of the boxes on the boxplots:\n \n::: {.cell}\n\n```{.r .cell-code}\nt.test(distance ~ gender, data = parking)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  distance by gender\nt = -1.3238, df = 79.446, p-value = 0.1894\nalternative hypothesis: true difference in means between group female and group male is not equal to 0\n95 percent confidence interval:\n -4.5884103  0.9228228\nsample estimates:\nmean in group female   mean in group male \n            9.308511            11.141304 \n```\n:::\n:::\n\n  \n\nThis is the Welch-Satterthwaite version of the test, the one that does\nnot assume equal SDs in the two groups. The P-value of 0.1894 is not\nsmall, so there is no evidence of any difference in parking accuracy\nbetween males and females.\n\nOr, this being the pooled one:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(distance ~ gender, data = parking, var.equal = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tTwo Sample t-test\n\ndata:  distance by gender\nt = -1.329, df = 91, p-value = 0.1872\nalternative hypothesis: true difference in means between group female and group male is not equal to 0\n95 percent confidence interval:\n -4.5722381  0.9066506\nsample estimates:\nmean in group female   mean in group male \n            9.308511            11.141304 \n```\n:::\n:::\n\n \n\nYou might have thought, looking at the boxplots, that the groups had\nabout the same SD (based, for example, on noting that the two boxes\nwere about the same height, so the IQRs were about the same). In that\ncase, you might run a pooled $t$-test, which here gives an almost\nidentical P-value of 0.1872, and the exact same conclusion.\n\n$\\blacksquare$\n\n(f) Why might you have some doubts about the $t$-test that\nyou just did? Explain briefly.\n\n\nSolution\n\n\nThe two-sample $t$-test is based on an assumption of\nnormally-distributed data within each group. If you go back\nand look at the boxplots, you'll see either (depending on\nyour point of view) that both groups are right-skewed, or\nthat both groups have outliers, neither of which fits a\nnormal distribution. The outlier in the male group is\nparticularly egregious.^[Google defines this as            meaning \"outstandingly bad, shocking\".] So I think we\nare entitled to question whether a two-sample $t$-test is\nthe right thing to do.\nHaving said that, we should go back and remember that the\n$t$-tests are \"robust to departures from normality\" (since\nwe are working with the Central Limit Theorem here), and\ntherefore that this test might be quite good even though the\ndata are not normal, because the sample sizes of 40-plus are\nlarge (by the standards of what typically makes the Central\nLimit Theorem work for us). So it may not be as bad as it seems.\nA common competitor for the two-sample $t$-test is the\nMann-Whitney test. This doesn't assume normality, but it\n*does* assume symmetric distributions, which it's not\nclear that we have here. I like a test called Mood's Median\nTest, which is kind of the two-sample equivalent of the sign\ntest (which we will also see later). It goes like this:\nWork out the overall median of all the distances, regardless\nof gender:\n\n::: {.cell}\n\n```{.r .cell-code}\nparking %>% summarize(med = median(distance))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"med\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"9\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nThe overall median is 9.\n\nCount up how many distances of each gender were above or below the\noverall median. (Strictly, I'm supposed to throw away any values that\nare exactly equal to the overall median, but I won't here for clarity\nof exposition.)\n\n::: {.cell}\n\n```{.r .cell-code}\ntab <- with(parking, table(gender, distance < 9))\ntab\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        \ngender   FALSE TRUE\n  female    23   24\n  male      27   19\n```\n:::\n:::\n\n \n\nFor example, 19 of the male drivers had a distance (strictly) less than 9.\nBoth genders are pretty close to 50--50 above and below the overall\nmedian, which suggests that the males and females have about the same\nmedian. This can be tested (it's a chi-squared test for independence,\nif you know that):\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(tab, correct = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test\n\ndata:  tab\nX-squared = 0.89075, df = 1, p-value = 0.3453\n```\n:::\n:::\n\n \n\nThis is even less significant (P-value 0.3453) than the two-sample\n$t$-test, and so is consistent with our conclusion from before that\nthere is actually no difference between males and females in terms of\naverage parking distance. The Mood's median test is believable because\nit is not affected by outliers or distribution shape.\n\n$\\blacksquare$\n\n(g) The Toronto Star in its report said that females are\nmore accurate at parking their cars. Why do you think they\nconcluded that, and do you think they were right to do so?\nExplain briefly.\n\n\nSolution\n\n\nThe conclusion from the boxplots was that the female\nmedian distance was less than the males, slightly, in this\nsample. That is probably what the Star seized on.\nWere they right? Well, that was why we did the test of\nsignificance. We were trying to see whether this observed\ndifference between males and females was \"real\" (would\nhold up if you looked at \"all\" male and female drivers)\nor \"reproducible\" (you would expect to see it again if\nyou did another study like this one). The large,\nnon-significant P-values in all our tests tell us that the\ndifference observed here was nothing more than chance. So\nit was not reasonable to conclude that females generally\nare more accurate at parallel-parking than males are.\n\n$\\blacksquare$\n\n\n\n\n\n\n##  Bell peppers and too much water\n\n\n A pathogen called *Phytophthora capsici* causes bell\npeppers to wilt and die. It is thought that too much water aids in the\nspread of the pathogen. Two fields are under study, labelled\n`a` and `b`. The first step in the research project is\nto compare the mean soil  water content of the two fields.  There is\na suspicion that field `a` will have a higher water content\nthan field `b`. The data\nare in the\nfile\n[link](http://ritsokiguess.site/datafiles/bellpepper.csv).\n\n\n(a) Read the file in using `read_csv`, and\nlist the resulting data frame.\n \nSolution\n\n\nReading directly from the URL is easiest:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/bellpepper.csv\"\npepper <- read_csv(my_url)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 30 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): field\ndbl (1): water\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\npepper\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"field\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"water\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"a\",\"2\":\"10.2\"},{\"1\":\"a\",\"2\":\"10.7\"},{\"1\":\"a\",\"2\":\"15.5\"},{\"1\":\"a\",\"2\":\"10.4\"},{\"1\":\"a\",\"2\":\"9.9\"},{\"1\":\"a\",\"2\":\"10.0\"},{\"1\":\"a\",\"2\":\"16.6\"},{\"1\":\"a\",\"2\":\"15.1\"},{\"1\":\"a\",\"2\":\"15.2\"},{\"1\":\"a\",\"2\":\"13.8\"},{\"1\":\"a\",\"2\":\"14.1\"},{\"1\":\"a\",\"2\":\"11.4\"},{\"1\":\"a\",\"2\":\"11.5\"},{\"1\":\"a\",\"2\":\"11.0\"},{\"1\":\"b\",\"2\":\"8.1\"},{\"1\":\"b\",\"2\":\"8.5\"},{\"1\":\"b\",\"2\":\"8.4\"},{\"1\":\"b\",\"2\":\"7.3\"},{\"1\":\"b\",\"2\":\"8.0\"},{\"1\":\"b\",\"2\":\"7.1\"},{\"1\":\"b\",\"2\":\"13.9\"},{\"1\":\"b\",\"2\":\"12.2\"},{\"1\":\"b\",\"2\":\"13.4\"},{\"1\":\"b\",\"2\":\"11.3\"},{\"1\":\"b\",\"2\":\"12.6\"},{\"1\":\"b\",\"2\":\"12.6\"},{\"1\":\"b\",\"2\":\"12.7\"},{\"1\":\"b\",\"2\":\"12.4\"},{\"1\":\"b\",\"2\":\"11.3\"},{\"1\":\"b\",\"2\":\"12.5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n     \n\nIf you like, find out how many observations you have from each field, thus:\n\n::: {.cell}\n\n```{.r .cell-code}\npepper %>% count(field)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"field\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"a\",\"2\":\"14\"},{\"1\":\"b\",\"2\":\"16\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\nFourteen and sixteen.\n \n$\\blacksquare$\n\n(b) Make side-by-side boxplots of the water content values for\nthe two fields. How do the fields seem to compare?\n \nSolution\n\n\nThis kind of thing:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pepper, aes(x = field, y = water)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/dartmouth-1.png){width=672}\n:::\n:::\n\n     \n\nThis one is rather interesting: the distribution of water contents for\nfield `a` is generally higher than that for field `b`,\nbut the median for `a` is actually *lower*.\n\nThe other reasonable plot is a facetted histogram, something like this:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(pepper, aes(x = water)) + geom_histogram(bins = 6) +\n  facet_grid(field ~ .)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/bellpepper-3-1.png){width=672}\n:::\n:::\n\n \n\nThe distribution of water content in field `b` is actually\nbimodal, which is probably the explanation of the funny thing with the\nmedian. What actually seems to be happening (at least for these data)\nis that the water content in field B is either about the same as field\nA, or a lot less (nothing in between).  We can find the five-number summaries for each field. The strategy is to use `reframe` (rather than summarize, because the five-number summary is five numbers rather than one), and pivot wider to make a nice display:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquantile_df <- function(x) { enframe(quantile(x))}\npepper %>% \n  group_by(field) %>% \n  reframe(quantile_df(water)) %>% \n  pivot_wider(names_from=name, values_from=value)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"field\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"0%\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"25%\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"50%\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"75%\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"100%\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"a\",\"2\":\"9.9\",\"3\":\"10.475\",\"4\":\"11.45\",\"5\":\"14.85\",\"6\":\"16.6\"},{\"1\":\"b\",\"2\":\"7.1\",\"3\":\"8.325\",\"4\":\"11.75\",\"5\":\"12.60\",\"6\":\"13.9\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nThis is a weird one: all the quantiles are greater for field A\n*except* for the median.\n \n$\\blacksquare$\n\n(c) Do a two-sample $t$-test to test whether there is evidence\nthat the mean water\ncontent in field `a` is higher than that of field\n`b`. What do you conclude? Explain briefly. (You'll need to\nfigure out a way of doing a one-sided test, or how to adapt the\nresults from a two-sided test.)\n \nSolution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(water ~ field, alternative = \"greater\", data = pepper)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  water by field\nt = 2.0059, df = 27.495, p-value = 0.0274\nalternative hypothesis: true difference in means between group a and group b is greater than 0\n95 percent confidence interval:\n 0.2664399       Inf\nsample estimates:\nmean in group a mean in group b \n       12.52857        10.76875 \n```\n:::\n:::\n\n     \n\nNote the use of `alternative` to specify that the first group\nmean (that of field `a`) is bigger than the second, field\n`b`, under the alternative hypothesis.\n\nThe P-value, 0.0274, is less than 0.05, so we reject the null (equal\nmeans) in favour of the `a` mean being bigger than the\n`b` mean: field `a` really does have a higher mean water\ncontent. \n\nAnother way to tackle this is to do a two-sided test and adapt the P-value:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(water ~ field, data = pepper)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  water by field\nt = 2.0059, df = 27.495, p-value = 0.0548\nalternative hypothesis: true difference in means between group a and group b is not equal to 0\n95 percent confidence interval:\n -0.03878411  3.55842696\nsample estimates:\nmean in group a mean in group b \n       12.52857        10.76875 \n```\n:::\n:::\n\n \n\nThis time we do *not* go straight to the P-value. First we check\nthat we are on the correct side, which we are since the sample mean\nfor field `a` *is* bigger than for field `b`. Then we are\nentitled to take the two-sided P-value 0.0548 and *halve* it to\nget the same 0.0274 that we did before.\n \n$\\blacksquare$\n\n(d) Is the result of your test consistent with the boxplot, or\nnot? Explain briefly.\n \nSolution\n\n\nThe test said that field `a` had a greater mean water\ncontent. Looking at the boxplot, this is consistent with where the\nboxes sit (`a`'s box is higher up than\n`b`'s). However, it is not consistent with the medians,\nwhere `b`'s median is actually *bigger*.\nYou have two possible right answers here: comparing the boxes with\nthe test result (they agree) or comparing the medians with the\ntest result (they disagree). Either is good. If you like, you\ncould also take the angle that the two boxes overlap a fair bit,\nso it is surprising that the test came out significant. (The\nresolution of this one is that we have 30 measurements altogether,\n14 and 16 in the two groups, so the sample size is not tiny. With\nsmaller samples, having overlapping boxes would probably lead to a\nnon-significant difference.) \n \n\n$\\blacksquare$\n\n\n\n\n##  Exercise and anxiety and bullying mice\n\n\n Does exercise help to reduce anxiety?\nTo assess this, some researchers randomly assigned\nmice to either \nan enriched environment where there was an exercise wheel available,\nor a standard environment with no exercise options. After three weeks\nin the specified environment, for five minutes a day for two weeks,\nthe mice were each exposed to a \"mouse bully\" --- a mouse who was very\nstrong, aggressive, and territorial. One measure of mouse anxiety is\namount of time hiding in a dark compartment, with mice who are more\nanxious spending more time in darkness. The amount of time spent in\ndarkness is recorded for each of the mice. \n\nThe data can be found at\n[link](http://ritsokiguess.site/datafiles/stressedmice.txt). \n\n\n\n(a) Read the data into R, and display your data frame. Count the number of mice in each group. \n\nSolution\n\n\nThese are aligned columns with spaces in between, so we need `read_table`:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/stressedmice.txt\"\nmice <- read_table(my_url)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\n── Column specification ────────────────────────────────────────────────────────\ncols(\n  Time = col_double(),\n  Environment = col_character()\n)\n```\n:::\n\n```{.r .cell-code}\nmice\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Time\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Environment\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"359\",\"2\":\"Enriched\"},{\"1\":\"280\",\"2\":\"Enriched\"},{\"1\":\"138\",\"2\":\"Enriched\"},{\"1\":\"227\",\"2\":\"Enriched\"},{\"1\":\"203\",\"2\":\"Enriched\"},{\"1\":\"184\",\"2\":\"Enriched\"},{\"1\":\"231\",\"2\":\"Enriched\"},{\"1\":\"394\",\"2\":\"Standard\"},{\"1\":\"477\",\"2\":\"Standard\"},{\"1\":\"439\",\"2\":\"Standard\"},{\"1\":\"428\",\"2\":\"Standard\"},{\"1\":\"391\",\"2\":\"Standard\"},{\"1\":\"488\",\"2\":\"Standard\"},{\"1\":\"454\",\"2\":\"Standard\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n   \n\nYou can call the data frame whatever you like.\n\nIf you must, you can physically count the number of mice in each group, but you ought to get in the habit of coding this kind of thing:\n\n::: {.cell}\n\n```{.r .cell-code}\nmice %>% count(Environment)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Environment\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Enriched\",\"2\":\"7\"},{\"1\":\"Standard\",\"2\":\"7\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\nSeven in each.\n \n\n$\\blacksquare$\n\n(b) Draw side-by-side boxplots of time spent in darkness for each\ngroup of mice.\n\nSolution\n\n\nThis:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mice, aes(x = Environment, y = Time)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/artichoke-1.png){width=672}\n:::\n:::\n\n     \n\nYou did remember to put capital letters on the variable names, didn't you?\n \n\n$\\blacksquare$\n\n(c) Do the boxplots support the hypothesis about exercise and\nanxiety? Explain briefly.\n\nSolution\n\n\nThe hypothesis about exercise and anxiety is that mice who\nexercise more should be less anxious. How does that play out in\nthis study? Well, mice in the enriched environment at least have\nthe opportunity to exercise, which the mice in the standard\nenvironment do not, and anxiety is measured by the amount of time\nspent in darkness (more equals more anxious).\nSo we'd expect the mice in the standard environment to spend more\ntime in darkness, if that hypothesis is correct.\nThat's exactly what the boxplots show, with very little\ndoubt.^[This means that I would expect to reject a null hypothesis of equal means, but I get ahead of myself.]\nYour answer needs to make two points: (i) what you would expect to\nsee, if the hypothesis about anxiety and exercise is true, and\n(ii) whether you actually did see it. You can do this either way\naround: for example, you can say what you see in the boxplot, and\nthen make the case that this *does* support the idea of more\nexercise corresponding with less anxiety.\n \n\n$\\blacksquare$\n\n(d) Carry out a $t$-test for comparing the mean time spent in\ndarkness for the mice in the two groups. Think carefully about the\ndetails of the $t$-test (and what you need evidence in favour of).\n\nSolution\n\n\nWe are trying to prove that exercise goes with *less*\nanxiety, so a one-sided test is called for. The other thing to\nthink about is how R organizes the groups for\n`Environment`: in alphabetical order. Thus\n`Enriched` is first (like on the boxplot). We're trying to\nprove that the mean `Time` is *less* for\n`Enriched` than for `Standard`, so we need `alternative=\"less\"`:\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(mice, t.test(Time ~ Environment, alternative = \"less\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  Time by Environment\nt = -6.7966, df = 9.1146, p-value = 3.734e-05\nalternative hypothesis: true difference in means between group Enriched and group Standard is less than 0\n95 percent confidence interval:\n      -Inf -151.2498\nsample estimates:\nmean in group Enriched mean in group Standard \n              231.7143               438.7143 \n```\n:::\n:::\n\n     \n\nA common clue that you have the wrong alternative hypothesis is a P-value coming out close to *1*, which is what you would have gotten from something like this:\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(mice, t.test(Time ~ Environment, alternative = \"greater\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  Time by Environment\nt = -6.7966, df = 9.1146, p-value = 1\nalternative hypothesis: true difference in means between group Enriched and group Standard is greater than 0\n95 percent confidence interval:\n -262.7502       Inf\nsample estimates:\nmean in group Enriched mean in group Standard \n              231.7143               438.7143 \n```\n:::\n:::\n\n     \n\nHere, we looked at the pictures and expected to find a difference, so we expected to find a P-value close to 0 rather than close to 1.\n \n\n$\\blacksquare$\n\n(e) What do you conclude, in terms of anxiety and exercise (at\nleast for mice)? Explain  briefly.\n\nSolution\n\n\nThe P-value (from the previous part) is 0.000037, which is way less\nthan 0.05 (or 0.01 or whatever $\\alpha$ you chose). So the null\nhypothesis (equal means) is resoundingly rejected in favour of the\none-sided alternative that the mean anxiety (as measured by time\nspent in darkness) is less for the mice who (can) exercise.\nYou need to end up by doing a one-sided test. An alternative to\nwhat I did is to do a two-sided test in the previous part. Then\nyou can fix it up by recognizing that the means are the right way\naround for the research hypothesis (the mean time in darkness is\nway less for `Enriched`), and then dividing the two-sided\nP-value by 2. But you need to do the \"correct side\" thing: just\nhalving the two-sided P-value is not enough, because the sample\nmean for `Enriched` might have been *more* than for\n`Standard`. \n \n\n$\\blacksquare$\n\n(f) Does anything in the previous parts suggest any problems with\nthe analysis you just did? Explain briefly.\n\nSolution\n\n\nLook at the side-by-side boxplots. The strict assumptions hiding\nbehind the $t$-tests are that the data in each group come from\nnormal distributions (equal standard deviations are not\nrequired). Are the data symmetric? Are there any outliers? Well, I\nsee a high outlier in the `Enriched` group, so I have some\ndoubts about the normality. On the other hand, I only have seven\nobservations in each group, so there is no guarantee even if the\npopulations from which they come are normal that the samples will\nbe. So maybe things are not so bad.\nThis is one of those situations where you make a case and defend it. I\ndon't mind so much which case you make, as long as you can defend\nit. Thus, something like either of these two is good:\n\n\n* I see an outlier in the `Enriched` group. The data\nwithin each group are supposed to be normally distributed, and\nthe `Enriched` group is not. So I see a problem.\n\n* I see an outlier in the `Enriched` group. But the\nsample sizes are small, and an apparent outlier could arise by\nchance. So I do not see a problem.\n\nExtra: another way to think about this is normal quantile plots to assess\nnormality within each group. This uses the facetting trick to get a separate normal quantile plot for each `Environment`:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mice, aes(sample = Time)) + stat_qq() + stat_qq_line() +\n  facet_wrap(~Environment, scales = \"free\")\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/mousebully-5-1.png){width=672}\n:::\n:::\n\n     \n\nFor the `Enriched` group, the upper-end outlier shows up. In a\nway this plot is no more illuminating than the boxplot, because you\nstill have to make a call about whether this is \"too big\". Bear in\nmind also that these facetted normal quantile plots, with two groups,\ncome out tall and skinny, so vertical deviations from the line are\nexaggerated. On this plot, the lowest value also looks too low.\n\nFor the `Standard` group, there are no problems with normality\nat all.\n\nWhat happens if we change the shape of the plots?\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mice, aes(sample = Time)) + stat_qq() + stat_qq_line() +\n  facet_wrap(~Environment, scales = \"free\", ncol = 1)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/mousebully-6-1.png){width=672}\n:::\n:::\n\n     \n\nThis makes the plots come out in one column, that is, short and\nsquat. I prefer these. I'd still call the highest value in\n`Enriched` an outlier, but the lowest value now looks pretty\nclose to what you'd expect.\n \n$\\blacksquare$\n\n\n\n\n##  Diet and growth in boys\n\n\n A dietician is studying the effect of\ndifferent diets on children's growth. In part of the study, the\ndietician is investigating two religious sects, labelled `a`\nand `b` in our data set. Both sects are vegetarian; the\ndifference between them is that people in Sect A only eat vegetables\nfrom below the ground, and Sect B only eats vegetables from above the\nground. The height and weight of the boys^[This was not sexism, but a recognition that boys and girls will be of different heights for reasons unrelated to diet. Doing it this way makes the analysis simpler.] are measured at regular\nintervals. The data in\n[link](http://ritsokiguess.site/datafiles/kids-diet.txt) are the\nheights of the boys at age 12.\n\n\n\n(a) Read in the data and find out how many observations you have\nand which variables.\n\n\nSolution\n\n\nThe data values are separated by one space, so:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/kids-diet.txt\"\ndiet <- read_delim(my_url, \" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 21 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \" \"\nchr (1): sect\ndbl (1): height\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\ndiet\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sect\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"height\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"a\",\"2\":\"140\"},{\"1\":\"a\",\"2\":\"140\"},{\"1\":\"a\",\"2\":\"140\"},{\"1\":\"a\",\"2\":\"143\"},{\"1\":\"a\",\"2\":\"135\"},{\"1\":\"a\",\"2\":\"144\"},{\"1\":\"a\",\"2\":\"156\"},{\"1\":\"a\",\"2\":\"149\"},{\"1\":\"a\",\"2\":\"146\"},{\"1\":\"a\",\"2\":\"148\"},{\"1\":\"a\",\"2\":\"144\"},{\"1\":\"a\",\"2\":\"153\"},{\"1\":\"b\",\"2\":\"151\"},{\"1\":\"b\",\"2\":\"154\"},{\"1\":\"b\",\"2\":\"139\"},{\"1\":\"b\",\"2\":\"159\"},{\"1\":\"b\",\"2\":\"159\"},{\"1\":\"b\",\"2\":\"148\"},{\"1\":\"b\",\"2\":\"140\"},{\"1\":\"b\",\"2\":\"157\"},{\"1\":\"b\",\"2\":\"145\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n     \n\n21 observations on two variables, `sect` and\n`height`. (You should state this; it is not enough to make the\nreader figure it out for themselves.)\n\nThe heights are evidently in centimetres.\n\nYou can call the data frame whatever you like.\n\n\n$\\blacksquare$\n\n(b) Obtain side-by-side boxplots of the heights for boys from\neach sect. Does it look as if the heights of the boys in each sect\nare different? Comment briefly. \n\n\nSolution\n\n\nThe boxplot is the kind of thing we've seen before:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(diet, aes(x = sect, y = height)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/kids-diet-2-1.png){width=672}\n:::\n:::\n\n \n\nIt looks to me as if the boys in Sect B are taller on average.\n\n\n$\\blacksquare$\n\n(c) Looking at your boxplots, do you see any problems with\ndoing a two-sample $t$-test? Explain briefly.\n\n\nSolution\n\n\nThe assumption is that the data in each group are \n\"approximately normal\". Boxplots don't tell you about normality specifically,\nbut they tell you whether there are any outliers (none here) and\nsomething about the shape (via the lengths of the whiskers). I'd\nsay the Sect A values are as symmetric as we could hope for. For\nSect B, you can say either that they're skewed to the left (and\nthat therefore we have a problem), or that the heights are close\nenough to symmetric (and that therefore we don't). For me, either\nis good. \nAs ever, normal quantile plots can offer more insight. With\ndata in this form, the\ntwo samples are mixed up, but using facets is the way to go. Philosophically, we draw a normal quantile plot of *all* the heights, and then say at the end that we would actually like a separate plot for each sect:\n\n::: {.cell}\n\n```{.r .cell-code}\ndiet %>%\n  ggplot(aes(sample = height)) + stat_qq() + stat_qq_line() +\n  facet_wrap(~sect, ncol = 1)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/kids-diet-3-1.png){width=672}\n:::\n:::\n\n \n\nI decided that I wanted short squat plots rather than tall skinny ones.\n\nWith the sizes of the samples, I really don't see any problems\nhere. Most of the evidence for the left skewness in Sect B is actually coming\nfrom that largest value being too small. Sect A is as good as you\ncould wish for. Having extreme values being *not extreme enough* is not a problem, since it won't be distorting the mean. \n\nThe other way of doing this is to use `filter` to pull out the\nrows you want and then feed that into the plot:\n\n::: {.cell}\n\n```{.r .cell-code}\nsecta <- filter(diet, sect == \"a\") %>%\n  ggplot(aes(sample = sect)) + stat_qq() + stat_qq_line()\n```\n:::\n\n \n\nand the same for sect B. This is the usual `ggplot`-in-pipeline\nthing where you don't have a named data frame in the `ggplot`\nbecause it will use whatever came out of the previous step of the\npipeline.\n    \n\n$\\blacksquare$\n\n(d) Run a $t$-test to determine whether the mean heights differ\nsignificantly. What do you conclude? Explain briefly. (Run the\n$t$-test even if your previous work suggests that it is not the\nright thing to do.)\n\n\nSolution\n\n\nThe wording states that a two-sided test is correct, which is the\ndefault, so you don't need anything special:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(height ~ sect, data = diet)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  height by sect\nt = -1.7393, df = 14.629, p-value = 0.103\nalternative hypothesis: true difference in means between group a and group b is not equal to 0\n95 percent confidence interval:\n -12.007505   1.229728\nsample estimates:\nmean in group a mean in group b \n       144.8333        150.2222 \n```\n:::\n:::\n\n \n\nThis is a two-sample test, so it takes a `data=`. \n\nOur null hypothesis is that the two sects have equal mean height. The\nP-value of 0.103 is larger than 0.05, so we do not reject that null\nhypothesis. That is, there is no evidence that the sects differ in\nmean height. (That is, our earlier thought that the boys in Sect B were taller\nis explainable by chance.)\n\nYou *must* end up with a statement about mean heights, and when\nyou do a test, you must state the conclusion in the context of the\nproblem, whether I ask you to or not. \n\"Don't reject the null hypothesis\" \nis a step on the way to an answer, not an answer in\nitself. If you think it's an answer in itself, you won't be of much\nuse to the world as a statistician.\n\nYou might have been thinking that Mood's median test was the\nthing, if you were worried about that skewness in Sect B. My guess is\nthat the $t$-test is all right, so it will be the better test\n(and give the smaller P-value) here, but if you want to do it, you\ncould do it this way:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(smmr)\nmedian_test(diet, height, sect)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$grand_median\n[1] 146\n\n$table\n     above\ngroup above below\n    a     4     7\n    b     6     3\n\n$test\n       what     value\n1 statistic 1.8181818\n2        df 1.0000000\n3   P-value 0.1775299\n```\n:::\n:::\n\n \n\nMy suspicion (that I wrote before doing the test) is correct: there is\neven less evidence of a difference in median height between the\nsects. The table shows that both sects are pretty close to 50--50\nabove and below the overall median, and with sample sizes this small,\nthey are certainly not significantly different from an even split. The\nsmall frequencies bring a warning about the chi-squared approximation\npossibly not working (that `smmr` suppresses). We had one like\nthis elsewhere, but there the result was very significant, and this one\nis very non-significant. However, the implication is the same: even if\nthe P-value is not very accurate (because the expected frequencies for\nsect B are both 4.5), the conclusion is unlikely to be wrong because\nthe P-value is so far from 0.05.\n    \n$\\blacksquare$\n\n\n\n\n\n\n## Handspans of males and females\n\n Take your right hand, and stretch the fingers out as far as\nyou can. The distance between the tip of your thumb and the tip of\nyour little (pinky) finger is your handspan. The students in a\nStatistics class at Penn State measured their handspans and also\nwhether they identified as male or female. The data are at [http://ritsokiguess.site/datafiles/handspan.txt](http://ritsokiguess.site/datafiles/handspan.txt),\nwith handspans\nmeasured in inches.  Thinking of these as a random sample of all\npossible students, is it true that males have a larger mean handspan\nthan females? This is what we will explore.\n\n\n(a) Read in and display (some of) the data.\n\nSolution\n\nThis is a delimited (by spaces) file, so:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nmy_url <- \"http://ritsokiguess.site/datafiles/handspan.txt\"\nspan <- read_delim(my_url, \" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 190 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \" \"\nchr (1): sex\ndbl (1): handspan\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nspan\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"handspan\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.25\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"26.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"F\",\"2\":\"17.00\"},{\"1\":\"F\",\"2\":\"16.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.70\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.25\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"19.50\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"20.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"25.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"18.00\"},{\"1\":\"M\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"25.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"13.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"17.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"25.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"18.50\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"12.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"23.00\"},{\"1\":\"F\",\"2\":\"23.25\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.80\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"17.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"20.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"19.00\"},{\"1\":\"M\",\"2\":\"21.50\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n$\\blacksquare$\n\n\n(b) Make a suitable graph of the two columns.\n\nSolution\n\nOne quantitative variable and one categorical one, so a boxplot:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(span, aes(x=sex, y=handspan)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/handspan-2-1.png){width=672}\n:::\n:::\n\n$\\blacksquare$\n\n\n(c) Run a suitable two-sample $t$-test to address the question\nof interest. What do you conclude, in the context of the data?\n\nSolution\n\nWe are trying to show that males have a *larger* mean\nhandspan, so we need an `alternative`. To see which: there\nare two sexes, F and M in that order, and we are trying to show\nthat F is less than M:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(handspan~sex, data=span, alternative=\"less\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  handspan by sex\nt = -10.871, df = 187.92, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group F and group M is less than 0\n95 percent confidence interval:\n      -Inf -2.154173\nsample estimates:\nmean in group F mean in group M \n       20.01699        22.55747 \n```\n:::\n:::\n\nThe P-value is very small, so there is no doubt that males have larger\naverage handspans than females.\n\n$\\blacksquare$\n\n\n(d) Obtain a 90\\% confidence interval for the difference\nin mean handspan between males and females. Do you need to run\nany more code? Explain briefly.\n\nSolution\n\nA confidence interval is two-sided, so we have to re-run the test\nwithout the \\texttt{alternative} to make it two-sided. Note also that\nwe need a 90\\% interval, which is different from the default 95\\%, so\nwe have to ask for that too:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(handspan~sex, data=span, conf.level=0.90)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  handspan by sex\nt = -10.871, df = 187.92, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group F and group M is not equal to 0\n90 percent confidence interval:\n -2.926789 -2.154173\nsample estimates:\nmean in group F mean in group M \n       20.01699        22.55747 \n```\n:::\n:::\n\nThe interval is $-2.93$ to $-2.15$, *which you should say*. It\nwould be even better to say that males have a mean handspan between\n2.15 and 2.93 inches larger than that of females. You also need to round off your answer: the data are \ngiven to 0 or 1 decimals, so your interval should be given to 1 or 2 decimals (since the confidence interval is for a mean). \n\nOn a question like this, the grader is looking for three things: \n\n- getting the output\n- saying what the interval is\n- rounding it to a suitable number of decimals. \n\nThus, getting the output alone is only one out of three things.\n\n$\\blacksquare$\n\n\n(e) Explain briefly why you might have some concerns about the\nvalidity of the $t$-tests you ran in this question. Or, if you don't have any concerns, explain briefly why that is.\n\nSolution\n\nThe major assumption here is that the male and female handspans\nhave (approximate) normal distributions. The boxplots we drew\nearlier both had low-end outliers, so the normality is\nquestionable. \n\nAlso, say something about the sample sizes and whether or not you think they are large enough to be helpful.\n\nHow big are our sample sizes?\n\n::: {.cell}\n\n```{.r .cell-code}\nspan %>% count(sex)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"F\",\"2\":\"103\"},{\"1\":\"M\",\"2\":\"87\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nMy suspicion is that we are saved by two things: the sample sizes\nare large enough for the central limit theorem to help us, and in\nany case, the conclusion is so clear that the assumptions can\nafford to be off by a bit. \n\n\nExtra: one way to think about whether we should be concerned about\nthe lack of normality is to use the `bootstrap` to see what\nthe sampling distribution of the sample mean might look like for males and for females. (This is the stuff in Lecture 5a.) The\nway this works is to sample from each distribution *with\nreplacement*, work out the mean of each sample, then repeat many\ntimes, once for the females and once for the males.\n\nTo start with the females, the first thing to do is to grab *only* the rows containing the females. This, using an idea from Lecture 5a that we see again properly later, is `filter`:\n\n::: {.cell}\n\n```{.r .cell-code}\nspan %>% filter(sex==\"F\") -> females\nfemales\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"handspan\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.25\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"17.00\"},{\"1\":\"F\",\"2\":\"16.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.70\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.25\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"13.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"17.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"12.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"23.00\"},{\"1\":\"F\",\"2\":\"23.25\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.80\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"17.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nThere are 103 females. From these we need to take a \"large\" number of bootstrap samples to get a sense of how the mean handspan of the females varies:\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(457299)\ntibble(sim = 1:1000) %>% \n  rowwise() %>% \n  mutate(the_sample = list(sample(females$handspan, replace = TRUE))) %>% \n  mutate(the_mean = mean(the_sample)) -> d\n```\n:::\n\n\n\nThen we make a histogram of the bootstrap sampling distribution of the sample mean for the females:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d, aes(x = the_mean)) + geom_histogram(bins = 10)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/handspan-8-1.png){width=672}\n:::\n:::\n\nI don't know what you think of this. There are a few more extreme values than I would like, and\nit looks otherwise a bit left-skewed to me. But maybe I  am worrying too much.\n\nThe males one works exactly the same way:\n\n::: {.cell}\n\n```{.r .cell-code}\nspan %>% filter(sex==\"M\") -> males\ntibble(sim = 1:1000) %>% \n  rowwise() %>% \n  mutate(the_sample = list(sample(males$handspan, replace = TRUE))) %>% \n  mutate(the_mean = mean(the_sample)) -> d\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d, aes(x = the_mean)) + geom_histogram(bins = 10)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/handspan-10-1.png){width=672}\n:::\n:::\n\nThere is a similar story here. I think these are good enough overall, and so I am happy with the two-sample $t$-test, but it is not as clear-cut as I was expecting.\n\n\n\n$\\blacksquare$\n\n\n\n\n\n\n## The anchoring effect: Australia vs US\n\n Two groups of students (in a class at a American university) were asked what they thought the population of Canada was. (The correct answer at the time was just over 30 million.)\nSome of the students, before having to answer this, were told that the population of the United States was about 270 million. The other students in the class were told that the population of Australia was\nabout 18 million. The data are in [http://ritsokiguess.site/datafiles/anchoring.csv](http://ritsokiguess.site/datafiles/anchoring.csv). The first column contains the country whose population the student was told, and the second contains the student's guess at the population of Canada.\n\nYou might wonder how being told the population of an unrelated country would have any impact on a student's guess at the population of Canada. Psychology says it does: it's called the *anchoring effect*, and the idea is that the number mentioned first acts as an \"anchor\": a person's guess will be closer to the anchor than it would have been otherwise. In this case, that would mean that the guesses for the students given the\nUS as an anchor will be higher than for the students given Australia as an anchor. We are interested in seeing whether there is evidence for that here.\n\n\n\n\n(a) Read in and display (some of)  the data.\n\nSolution\n\n\nI made it as easy as I could:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/anchoring.csv\"\ncanada <- read_csv(my_url)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 21 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): anchor\ndbl (1): estimate\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\ncanada\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"anchor\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"US\",\"2\":\"20.0\"},{\"1\":\"US\",\"2\":\"90.0\"},{\"1\":\"US\",\"2\":\"1.5\"},{\"1\":\"US\",\"2\":\"100.0\"},{\"1\":\"US\",\"2\":\"132.0\"},{\"1\":\"US\",\"2\":\"150.0\"},{\"1\":\"US\",\"2\":\"130.0\"},{\"1\":\"US\",\"2\":\"40.0\"},{\"1\":\"US\",\"2\":\"200.0\"},{\"1\":\"US\",\"2\":\"20.0\"},{\"1\":\"australia\",\"2\":\"12.0\"},{\"1\":\"australia\",\"2\":\"20.0\"},{\"1\":\"australia\",\"2\":\"10.0\"},{\"1\":\"australia\",\"2\":\"81.0\"},{\"1\":\"australia\",\"2\":\"15.0\"},{\"1\":\"australia\",\"2\":\"20.0\"},{\"1\":\"australia\",\"2\":\"30.0\"},{\"1\":\"australia\",\"2\":\"20.0\"},{\"1\":\"australia\",\"2\":\"9.0\"},{\"1\":\"australia\",\"2\":\"10.0\"},{\"1\":\"australia\",\"2\":\"20.0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nYou might need to scroll down to see that both \"anchor\" countries are indeed represented.\n\n\n$\\blacksquare$\n\n\n(b) Draw a suitable graph of these data.\n\nSolution\n\n\nOne categorical variable and one quantitative one, so a boxplot:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(canada, aes(x = anchor, y = estimate)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/ozvus-2-1.png){width=672}\n:::\n:::\n\n\n$\\blacksquare$\n\n\n(c) Explain briefly why a Welch $t$-test would be better than a pooled $t$-test in this case.\n\nSolution\n\n\nThe decision between these two tests lies in whether you think the two groups have equal spread (variance, strictly). Here, the spread for the US group is much larger than for the Australia group, even taking into account the big outlier in the latter group. Since the spreads are different, we should do a Welch $t$-test rather than a pooled one.\n\nMake sure you answer the question I asked, not the one you think I should have asked.\n\nThere is a separate question about whether the groups are close enough to normal, but I wasn't asking about that here. I was asking: *given* that we have decided to do some kind of $t$-test, why is the Welch one better than the pooled one? I am not asking whether we should be doing any kind of $t$-test at all; if I had, you could *then* reasonably talk about the outlier in the Australia group, and other possible skewness in its distribution, but that's not what I asked about.\n\n\n$\\blacksquare$\n\n\n(d) Run a suitable Welch $t$-test and display the output.\n\nSolution\n\n\nThe word \"suitable\" is a hint that you may have to think a bit about how you run the test. If the anchoring  effect is real, the mean of the guesses for the students told the population of the US will be higher on average than for those told the population of Australia, so we want a one-sided alternative. Australia is before the US alphabetically, so the alternative has to be `less`:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(estimate~anchor, data = canada, alternative = \"less\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  estimate by anchor\nt = -3.0261, df = 10.558, p-value = 0.006019\nalternative hypothesis: true difference in means between group australia and group US is less than 0\n95 percent confidence interval:\n      -Inf -26.63839\nsample estimates:\nmean in group australia        mean in group US \n               22.45455                88.35000 \n```\n:::\n:::\n\nNote that the Welch test is the default, so you don't have to do anything special to get it. Your output will tell you that a Welch test is what you have.\nIt's if you want a *pooled* test that you have to ask for it specifically (with `var.equal = TRUE`). \n\nIf you get a P-value close to 1, this is often an indication that you have the alternative the wrong way around.\n\n\n$\\blacksquare$\n\n\n(e) What do you conclude from your test, in the context of the data?\n\nSolution\n\n\nThe P-value is definitely less than 0.05, so we reject the null hypothesis (which says that the mean guess is the same regardless of the anchor the student was given). So we have evidence that the mean guess is higher for the students who were given the US population first. \n\nExtra 1: this is perhaps the place to think about what effect that outlier in the `australia` group might  have had. Since it is a high outlier, its effect will be to make the the `australia` mean higher than it would have been otherwise, and therefore to make the two group means closer together. Despite this, the difference still came out strongly significant, so that we can be *even more sure than the P-value says* that there is a real difference between the means of estimates of the population of Canada. (To say it differently, if the outlier had not been there, the difference in means would have been even bigger and thus even more significant.)\n\nExtra 2: if you are still worried about doing a two-sample $t$-test here, you might consider looking at the bootstrapped sampling distribution of the sample mean of the `australia` group:\n\n::: {.cell}\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncanada %>% filter(anchor == \"australia\") -> oz\ntibble(sim = 1:1000) %>% \n  rowwise() %>% \n  mutate(the_sample = list(sample(oz$estimate, replace = TRUE))) %>% \n  mutate(the_mean = mean(the_sample)) %>% \n  ggplot(aes(x = the_mean)) + geom_histogram(bins=10)\n```\n\n::: {.cell-output-display}\n![](two-sample-inference_files/figure-html/ozvus-5-1.png){width=672}\n:::\n:::\n\nThis is indeed skewed to the right (though, with 11 observations, not nearly so non-normal as the original data), and so the P-value we got from the $t$-test may not be reliable. But, as discussed in Extra 1, the \"correct\" P-value is, if anything, *even smaller* than the one we got, and so the conclusion we drew earlier (that there is a significant anchoring effect) is not going to change.\n\nExtra 3: looking even further ahead, there is a test that definitely *does* apply here, called Mood's Median Test. You won't have installed the package yet, so this won't work for you just yet ([read ahead](http://ritsokiguess.site/STAC33/inference_5_R_slides.pdf) if you want to learn more), but here's how it goes:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(smmr)\nmedian_test(canada, estimate, anchor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$grand_median\n[1] 20\n\n$table\n           above\ngroup       above below\n  australia     2     5\n  US            7     1\n\n$test\n       what      value\n1 statistic 5.40178571\n2        df 1.00000000\n3   P-value 0.02011616\n```\n:::\n:::\n\nThis does (as it is written) a two-sided test, because it can also be used for comparing more than two groups. Since we want a one-sided test here, you can (i) check that we are on the correct side (we are)^[The test works by comparing the data values in each group to the overall median. The students who were given Australia as an anchor mostly guessed below the overall median, and the students given the US as an anchor mostly guessed above.] (ii) halve the P-value to get 0.010.\n\nThis is a P-value you can trust. It is not smaller than the $t$-test one, perhaps because this test is less powerful than the $t$-test in most cases.^[It uses the data less efficiently than the t-test; it just counts the number of values above and below the overall median in each group, rather than using the actual numbers to compute means.]\n\n\n$\\blacksquare$\n\n\n\n\n\n",
>>>>>>> 038bb2509ac8e38facb2622be6ad3052b44aca34
    "supporting": [
      "two-sample-inference_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}