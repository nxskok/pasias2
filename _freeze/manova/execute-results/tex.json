{
  "hash": "d2883ea707bd2196a2d9ee9e3c34feeb",
  "result": {
    "markdown": "# Multivariate analysis of variance\n\nPackages for this chapter:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\nlibrary(tidyverse)\n```\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n##  Fabricated data\n\n\n The data in\n[link](http://ritsokiguess.site/datafiles/simple-manova.txt)\n(probably made up) are measurements of two \nvariables `y1` and `y2` on three groups, labelled\n`a`, `b` and `c`. We want to see whether\n`y1` or `y2` or some combination of them differ among\nthe groups.\n\n\n\n(a) Read in the data and check that you have 12 observations on\n2 numeric variables from 3 different groups.\n\n\n\n(b) Run a one-way ANOVA predicting `y1` from\n`group`. Are there any significant differences in `y1`\namong the groups? If necessary, run Tukey. What do you conclude?\n\n\n\n(c) Repeat all the previous part for `y2`.\n\n\n\n(d) Make a plot of `y1` against `y2`, with the\npoints distinguished by which group they are from.\n\n\n\n(e) How is it that group `b` is not distinguishable on\neither `y1` or `y2` individually (from the ANOVAs),\nbut *is* distinguishable on your graph? Explain briefly.\n\n\n\n(f) Run a one-way multivariate analysis of variance, obtaining\na P-value. Note the very small P-value.\n\n\n\n\n\n\n\n\n##  Do characteristics of urine depend on obesity?\n\n\n A study was made of the characteristics of urine of young\nmen. The men were classified into four groups based on their degree of\nobesity. (The groups are labelled `a, b, c, d`.) Four variables\nwere measured, `x` (which you can ignore), pigment creatinine,\nchloride and chlorine. The data are in\n[link](http://ritsokiguess.site/datafiles/urine.csv) as a\n`.csv` file. There are 45 men altogether.\n\n\n\n(a) Read in the data and check that you have the right number\nof observations and the right variables.\n \n\n(b) Make boxplots of each of the three variables of interest\nagainst obesity group. \n \n\n(c) How, if at all, do the groups differ on the variables of interest?\n \n\n(d) Run a multivariate analysis of variance, using the three\nvariables of interest as response variables, and the obesity group\nas explanatory. (This is a so-called one-way MANOVA.)\n \n\n(e) What do you conclude? Is this in line with what your\nboxplots said? Explain briefly.\n \n\n\n\n\n\n\n##  How do height and weight depend on sport played by elite athletes?\n\n\n This question uses the data on Australian elite athletes,\nwhich can be found at\n[link](http://ritsokiguess.site/datafiles/ais.txt). 202 elite\nathletes had various physical and physiological measurements taken,\nand for each athlete, their gender (in the column `Sex`) and\nthe sport they play (`Sport`) was also noted. The data values\nare separated by *tabs*, meaning that `read_tsv` will\nread them in.\n\n\n\n(a) Read in the data and verify that you have 202 rows and 13\ncolumns. \n\n\n(b) We are going to see whether the height-weight combination\nof an athlete depends significantly on which sport they play and which gender\nthey are. Explain (very) briefly why a multivariate analysis of\nvariance will be necessary to do this.\n\n\n(c) Create a response variable for a MANOVA. (You don't need to\nshow what you got, since it is rather big.) The columns you want are\ncalled `Ht` and `Wt`.\n\n\n(d) Run a multivariate analysis of variance to see whether the\nheight-weight combination depends significantly on gender, sport or the\ncombination of both. Display the results. Use the small-m\n`manova` way to do this one.\n\n\n(e) Briefly justify removing the interaction term from your\nprevious model, and fit a model without it. You can use either\n`manova` or `Manova` for this; they should both\nwork. (You only need to use one of them.)  Display your results.\n\n\n\n(f) See if you can make a graph that shows what's going on\nhere. Bear in mind that you have two quantitative variables and\n*two* categorical ones, so you will need to find a way to\ndisplay everything. Hint: what would you do with two quantitative\nvariables and *one* categorical one? Can you find a way to\ngeneralize that idea by displaying the other categorical variable\ndifferently? I think we have seen a couple of ideas that will work,\nsomewhere in the lecture notes (but in a different context). Or you\ncan search for ideas, of course.\nFor full marks, obtain a plot which does not give you any\nwarnings. (The grader will know which of the possible plots give\nwarnings, and will deduct extra marks if you assert that a plot\ngives no warnings when in fact it does. That is to say, if you get\nany warnings, *you need to include those in what you hand in*).\n\n\n\n\n\n\nMy solutions follow:\n\n\n\n\n##  Fabricated data\n\n\n The data in\n[link](http://ritsokiguess.site/datafiles/simple-manova.txt)\n(probably made up) are measurements of two \nvariables `y1` and `y2` on three groups, labelled\n`a`, `b` and `c`. We want to see whether\n`y1` or `y2` or some combination of them differ among\nthe groups.\n\n\n\n(a) Read in the data and check that you have 12 observations on\n2 numeric variables from 3 different groups.\n\n\nSolution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/simple-manova.txt\"\nsimple <- read_delim(my_url, \" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 12 Columns: 3\n-- Column specification --------------------------------------------------------\nDelimiter: \" \"\nchr (1): group\ndbl (2): y1, y2\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nsimple\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 x 3\n   group    y1    y2\n   <chr> <dbl> <dbl>\n 1 a         2     3\n 2 a         3     4\n 3 a         5     4\n 4 a         2     5\n 5 b         4     8\n 6 b         5     6\n 7 b         5     7\n 8 c         7     6\n 9 c         8     7\n10 c        10     8\n11 c         9     5\n12 c         7     6\n```\n:::\n:::\n\n   \n\nAs promised: 12 observations, 2 numeric variables `y1` and\n`y2`, and one categorical variable (as text) containing three\ngroups `a,b,c`.\n    \n\n$\\blacksquare$\n\n(b) Run a one-way ANOVA predicting `y1` from\n`group`. Are there any significant differences in `y1`\namong the groups? If necessary, run Tukey. What do you conclude?\n\n\nSolution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimple.1 <- aov(y1 ~ group, data = simple)\nsummary(simple.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ngroup        2  63.45   31.72    21.2 0.000393 ***\nResiduals    9  13.47    1.50                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nTukeyHSD(simple.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = y1 ~ group, data = simple)\n\n$group\n        diff        lwr      upr     p adj\nb-a 1.666667 -0.9417891 4.275122 0.2289181\nc-a 5.200000  2.9089670 7.491033 0.0003548\nc-b 3.533333  1.0391725 6.027494 0.0083999\n```\n:::\n:::\n\n     \n\nThe $F$-test said that there were differences among the groups, so I\nran Tukey and found that group `c` is significantly bigger on\n`y1` than the other two groups.\n\n\n$\\blacksquare$\n\n(c) Repeat all the previous part for `y2`.\n\n\nSolution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimple.2 <- aov(y2 ~ group, data = simple)\nsummary(simple.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)   \ngroup        2  19.05   9.525   9.318 0.00642 **\nResiduals    9   9.20   1.022                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nTukeyHSD(simple.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = y2 ~ group, data = simple)\n\n$group\n    diff        lwr      upr     p adj\nb-a  3.0  0.8440070 5.155993 0.0093251\nc-a  2.4  0.5063697 4.293630 0.0157279\nc-b -0.6 -2.6615236 1.461524 0.7050026\n```\n:::\n:::\n\n     \n\nSame idea: there is a difference, and Tukey reveals that this time\ngroup `a` is significantly *smaller* than the other groups\non `y2`. \n    \n\n$\\blacksquare$\n\n(d) Make a plot of `y1` against `y2`, with the\npoints distinguished by which group they are from.\n\n\nSolution\n\n\n`y1` and `y2` can be either way around, since\nthey are both response variables (!):\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(simple, aes(x = y1, y = y2, colour = group)) + geom_point()\n```\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/manova1-4-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n    \n\n$\\blacksquare$\n\n(e) How is it that group `b` is not distinguishable on\neither `y1` or `y2` individually (from the ANOVAs),\nbut *is* distinguishable on your graph? Explain briefly.\n\n\nSolution\n\n\nGroup `b` has the same kind of `y1` values as group\n`a` and the same kind of `y2` values as group\n`c`. This means looking at either variable singly is not\nenough to distinguish group `b`. But group `b`\nstands out on the graph as being \"top left\" of the picture. That\nmeans that `y1` has to be low *and* `y2` has to\nbe high, both together, to pick out group `b`. \nThat seems like a lot of work, but the important point\nthat I want you to raise is that the points in group `b`\nare distinguished by a particular *combination* of values of\n`y1` and `y2`.\n    \n\n$\\blacksquare$\n\n(f) Run a one-way multivariate analysis of variance, obtaining\na P-value. Note the very small P-value.\n\n\nSolution\n\n\nThis is just like the seed weight and yield example in class\n(deliberately so):\n\n::: {.cell}\n\n```{.r .cell-code}\nresponse <- with(simple, cbind(y1, y2))\nsimple.3 <- manova(response ~ group, data = simple)\nsummary(simple.3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Df Pillai approx F num Df den Df    Pr(>F)    \ngroup      2 1.3534   9.4196      4     18 0.0002735 ***\nResiduals  9                                            \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nThe P-value here, 0.00027, is smaller than either of the P-values for\nthe one-variable ANOVAs. This expresses the idea that the group\ndifference is essentially multivariate (it depends on the\n*combination* of `y1` and `y2` values). I only\nwanted you to note that it is smaller than either of the other\nANOVAs; you don't need to say anything about why.\n\nFor completeness, we should do Box's M test as well:\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(BoxM(response, simple$group))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Box's M Test \n\nChi-Squared Value = 3.517357 , df = 6  and p-value: 0.742 \n```\n:::\n:::\n\nNo problems here at all.\n\nWe were in the fortunate position of being able to draw a picture,\nbecause we had only two response variables, and we could plot them\nagainst each other with the groups labelled. (If we had three response\nvariables, like the peanuts example, we wouldn't be able to do this,\nbarring some kind of 3D-plotting procedure.)\n    \n$\\blacksquare$\n\n\n\n\n\n\n##  Do characteristics of urine depend on obesity?\n\n\n A study was made of the characteristics of urine of young\nmen. The men were classified into four groups based on their degree of\nobesity. (The groups are labelled `a, b, c, d`.) Four variables\nwere measured, `x` (which you can ignore), pigment creatinine,\nchloride and chlorine. The data are in\n[link](http://ritsokiguess.site/datafiles/urine.csv) as a\n`.csv` file. There are 45 men altogether.\n\n\n\n(a) Read in the data and check that you have the right number\nof observations and the right variables.\n \nSolution\n\n\n`read_csv`:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/urine.csv\"\nurine <- read_csv(my_url)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 45 Columns: 5\n-- Column specification --------------------------------------------------------\nDelimiter: \",\"\nchr (1): obesity\ndbl (4): x, creatinine, chloride, chlorine\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nurine\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 45 x 5\n   obesity     x creatinine chloride chlorine\n   <chr>   <dbl>      <dbl>    <dbl>    <dbl>\n 1 a          24       17.6     5.15      7.5\n 2 a          32       13.4     5.75      7.1\n 3 a          17       20.3     4.35      2.3\n 4 a          30       22.3     7.55      4  \n 5 a          30       20.5     8.5       2  \n 6 a          27       18.5    10.2       2  \n 7 a          25       12.1     5.95     16.8\n 8 a          30       12       6.3      14.5\n 9 a          28       10.1     5.45      0.9\n10 a          24       14.7     3.75      2  \n# i 35 more rows\n```\n:::\n:::\n\n     \n\nThe variables are as promised, and we do indeed have 45 rows. \n \n$\\blacksquare$\n\n(b) Make boxplots of each of the three variables of interest\nagainst obesity group. \n \nSolution\n\n\nJust churn through it:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(urine, aes(x = obesity, y = creatinine)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/peppercorn-1.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\nggplot(urine, aes(x = obesity, y = chlorine)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/peppercorn-2.pdf){fig-pos='H'}\n:::\n\n```{.r .cell-code}\nggplot(urine, aes(x = obesity, y = chloride)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/peppercorn-3.pdf){fig-pos='H'}\n:::\n:::\n\n     \n\nThis also works with facets, though it is different from the other\nones we've done, in that we have to collect together the $y$-variables\nfirst rather than the $x$s:\n\n::: {.cell}\n\n```{.r .cell-code}\nurine %>%\n  pivot_longer(creatinine:chlorine, names_to=\"yname\", values_to=\"y\") %>%\n  ggplot(aes(x = obesity, y = y)) + geom_boxplot() +\n  facet_wrap(~yname, scales = \"free\", ncol = 2)\n```\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/urine-2-1.pdf){fig-pos='H'}\n:::\n:::\n\n \n\nI decided to throw a couple of things in here: first, the\n`scales=\"free\"` thing since the $y$-variables (this time) are\non different scales, and second, the `ncol=2` to arrange the\nfacets in (3 cells of) a $2\\times 2$ grid, rather than having them\ncome out tall and skinny.^[Like one of those crazy drinks at  Starbucks.] It's unusual to have faceted boxplots, but this is one\nof those cases where it makes sense. (The key is different $y$'s but\nthe same $x$, I think.)\n\nThe conclusions about the boxplots are, of course, the same. I think\nit makes it easier to have the three boxplots side by side, but it's\nup to you whether you think that gain is worth the extra coding.\n\nExtra: let's take another look at that longer data frame:\n\n::: {.cell}\n\n```{.r .cell-code}\nurine %>%\n  pivot_longer(creatinine:chlorine, names_to=\"yname\", values_to=\"y\") \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 135 x 4\n   obesity     x yname          y\n   <chr>   <dbl> <chr>      <dbl>\n 1 a          24 creatinine 17.6 \n 2 a          24 chloride    5.15\n 3 a          24 chlorine    7.5 \n 4 a          32 creatinine 13.4 \n 5 a          32 chloride    5.75\n 6 a          32 chlorine    7.1 \n 7 a          17 creatinine 20.3 \n 8 a          17 chloride    4.35\n 9 a          17 chlorine    2.3 \n10 a          30 creatinine 22.3 \n# i 125 more rows\n```\n:::\n:::\n\nYou might say that there is one quantitative variable now, the thing we called `y`, and *two* categorical variables, `obesity` and `yname`. So why not make a grouped boxplot? All right:\n\n::: {.cell}\n\n```{.r .cell-code}\nurine %>%\n  pivot_longer(creatinine:chlorine, names_to=\"yname\", values_to=\"y\") %>%\n  ggplot(aes(x=yname, y=y, colour=obesity)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/urine-4-1.pdf){fig-pos='H'}\n:::\n:::\n\nThis actually looks a lot like the facetted boxplots (if you imagine drawing a box around each group of four boxplots and removing the `scales=\"free\"` before). There is, as the saying goes, more than one way to skin a cat.\n\n$\\blacksquare$\n\n(c) How, if at all, do the groups differ on the variables of interest?\n \nSolution\n\n\nAny sensible comment here is good. You can take the approach that\ngroup D is lowest on creatinine and chloride, but there is not\nmuch to choose (given the amount of variability) on chlorine. Or\nyou can say that groups B and C are generally highest, except for\nchloride where A is higher. Anything of this general kind is fine.\nThe point here is that some of the groups appear to be different\non some of the variables, which would make a multivariate analysis\nof variance (in a moment) come out significant.\n \n$\\blacksquare$\n\n(d) Run a multivariate analysis of variance, using the three\nvariables of interest as response variables, and the obesity group\nas explanatory. (This is a so-called one-way MANOVA.)\n \nSolution\n\n\nCreate the response variable and run `manova`:\n\n::: {.cell}\n\n```{.r .cell-code}\nresponse <- with(urine, cbind(creatinine, chlorine, chloride))\nurine.1 <- manova(response ~ obesity, data = urine)\nsummary(urine.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Df  Pillai approx F num Df den Df  Pr(>F)  \nobesity    3 0.43144   2.2956      9    123 0.02034 *\nResiduals 41                                         \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\nAt some point, you should run Box's M test, either here or at the start of the next part (before you get to your conclusions):\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(BoxM(response, urine$obesity))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Box's M Test \n\nChi-Squared Value = 30.8322 , df = 18  and p-value: 0.0301 \n```\n:::\n:::\n\nThis P-value is small, but not, for this test, small enough to be a problem.\n     \n \n$\\blacksquare$\n\n(e) What do you conclude? Is this in line with what your\nboxplots said? Explain briefly.\n \nSolution\n\n\nThe null hypothesis (that each of the variables have the same mean\nfor each of the groups) is rejected: that is, not all of the\ngroups have the same mean on all of the variables.\nBased on the idea that there seemed to be differences between the\ngroups in the boxplots, this makes sense. (That's what I saw,\nanyway. There was a lot of variability within the groups, which is\nwhy the P-value didn't come out smaller.)\n\nExtra: the other way of doing this is the following, using\n`Manova` from `car`:\n\n::: {.cell}\n\n```{.r .cell-code}\nresponse.1 <- lm(response ~ obesity, data = urine)\nsummary(Manova(response.1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nType II MANOVA Tests:\n\nSum of squares and products for error:\n            creatinine   chlorine   chloride\ncreatinine  496.768761 -225.02136   4.507476\nchlorine   -225.021364 1431.85432  86.226818\nchloride      4.507476   86.22682 152.854274\n\n------------------------------------------\n \nTerm: obesity \n\nSum of squares and products for the hypothesis:\n           creatinine  chlorine  chloride\ncreatinine  181.07035 -66.72530  40.03686\nchlorine    -66.72530 103.80568 -41.37182\nchloride     40.03686 -41.37182  20.03773\n\nMultivariate Tests: obesity\n                 Df test stat approx F num Df    den Df    Pr(>F)   \nPillai            3 0.4314359 2.295559      9 123.00000 0.0203377 * \nWilks             3 0.6080320 2.395937      9  95.06636 0.0171207 * \nHotelling-Lawley  3 0.5800706 2.427703      9 113.00000 0.0146529 * \nRoy               3 0.4336849 5.927027      3  41.00000 0.0018659 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n`manova` gives you the Pillai test, but `Manova` gives you all four; here, they are all significant, but to different degrees.\n\nThe result is the same, or at least consistent. You don't need do this one here (though you\ncan as an alternative), but when you come to repeated measures you\n*will* need to be able to use `Manova`.\n\nTo understand the differences in the variables due to the groups, we\nneed to run a discriminant analysis (coming up later).\n\n \n$\\blacksquare$\n\n\n\n\n\n\n##  How do height and weight depend on sport played by elite athletes?\n\n\n This question uses the data on Australian elite athletes,\nwhich can be found at\n[link](http://ritsokiguess.site/datafiles/ais.txt). 202 elite\nathletes had various physical and physiological measurements taken,\nand for each athlete, their gender (in the column `Sex`) and\nthe sport they play (`Sport`) was also noted. The data values\nare separated by *tabs*, meaning that `read_tsv` will\nread them in.\n\n\n\n(a) Read in the data and verify that you have 202 rows and 13\ncolumns. \n\nSolution\n\n\nAs in the hint:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/ais.txt\"\nathletes <- read_tsv(my_url)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 202 Columns: 13\n-- Column specification --------------------------------------------------------\nDelimiter: \"\\t\"\nchr  (2): Sex, Sport\ndbl (11): RCC, WCC, Hc, Hg, Ferr, BMI, SSF, %Bfat, LBM, Ht, Wt\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nathletes\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 202 x 13\n   Sex    Sport     RCC   WCC    Hc    Hg  Ferr   BMI   SSF `%Bfat`   LBM    Ht\n   <chr>  <chr>   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl> <dbl> <dbl>\n 1 female Netball  4.56  13.3  42.2  13.6    20  19.2  49      11.3  53.1  177.\n 2 female Netball  4.15   6    38    12.7    59  21.2 110.     25.3  47.1  173.\n 3 female Netball  4.16   7.6  37.5  12.3    22  21.4  89      19.4  53.4  176 \n 4 female Netball  4.32   6.4  37.7  12.3    30  21.0  98.3    19.6  48.8  170.\n 5 female Netball  4.06   5.8  38.7  12.8    78  21.8 122.     23.1  56.0  183 \n 6 female Netball  4.12   6.1  36.6  11.8    21  21.4  90.4    16.9  56.4  178.\n 7 female Netball  4.17   5    37.4  12.7   109  21.5 107.     21.3  53.1  177.\n 8 female Netball  3.8    6.6  36.5  12.4   102  24.4 157.     26.6  54.4  174.\n 9 female Netball  3.96   5.5  36.3  12.4    71  22.6 101.     17.9  56.0  174.\n10 female Netball  4.44   9.7  41.4  14.1    64  22.8 126.     25.0  51.6  174.\n# i 192 more rows\n# i 1 more variable: Wt <dbl>\n```\n:::\n:::\n\n     \n\n202 rows and 13 columns indeed.\n\n$\\blacksquare$\n\n(b) We are going to see whether the height-weight combination\nof an athlete depends significantly on which sport they play and which gender\nthey are. Explain (very) briefly why a multivariate analysis of\nvariance will be necessary to do this.\n\nSolution\n\n\nWe now have *two* response variables, height and weight,\nrather than just one. In order to do a test with more than one\nresponse variable, we need to use multivariate ANOVA rather than\nregular ANOVA. (The first sentence is enough.)\n\nExtra: the explanatory variables, sport and gender, are both\ncategorical here, which makes a MANOVA work. If either of them had\nbeen quantitative, we would have needed to do a multivariate\nregression, which is beyond the scope of what we do in this course.\n\n$\\blacksquare$\n\n(c) Create a response variable for a MANOVA. (You don't need to\nshow what you got, since it is rather big.) The columns you want are\ncalled `Ht` and `Wt`.\n\nSolution\n\n\nUse `cbind` to glue the two columns together:\n\n::: {.cell}\n\n```{.r .cell-code}\nresponse <- with(athletes, cbind(Ht, Wt))\n```\n:::\n\n     \n\nEither way around, height or weight first, is good. Also good is the\ndollar sign, which you'll need to do twice (and thus the `with`\nway is more elegant):\n\n::: {.cell}\n\n```{.r .cell-code}\nresponse_a <- cbind(athletes$Ht, athletes$Wt)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nathletes %>% select(Ht, Wt) %>% \n  as.matrix() -> y \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresponse\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Ht     Wt\n  [1,] 176.8  59.90\n  [2,] 172.6  63.00\n  [3,] 176.0  66.30\n  [4,] 169.9  60.70\n  [5,] 183.0  72.90\n  [6,] 178.2  67.90\n  [7,] 177.3  67.50\n  [8,] 174.1  74.10\n  [9,] 173.6  68.20\n [10,] 173.7  68.80\n [11,] 178.7  75.30\n [12,] 183.3  67.40\n [13,] 174.4  70.00\n [14,] 173.3  74.00\n [15,] 168.6  51.90\n [16,] 174.0  74.10\n [17,] 176.0  74.30\n [18,] 172.2  77.80\n [19,] 182.7  66.90\n [20,] 180.5  83.80\n [21,] 179.8  82.90\n [22,] 179.6  64.10\n [23,] 171.7  68.85\n [24,] 195.9  78.90\n [25,] 189.7  74.40\n [26,] 177.8  69.10\n [27,] 185.0  74.90\n [28,] 184.6  64.60\n [29,] 174.0  63.70\n [30,] 186.2  75.20\n [31,] 173.8  62.30\n [32,] 171.4  66.50\n [33,] 179.9  62.90\n [34,] 193.4  96.30\n [35,] 188.7  75.50\n [36,] 169.1  63.00\n [37,] 177.9  80.50\n [38,] 177.5  71.30\n [39,] 179.6  70.50\n [40,] 181.3  73.20\n [41,] 179.7  68.70\n [42,] 185.2  80.50\n [43,] 177.3  72.90\n [44,] 179.3  74.50\n [45,] 175.3  75.40\n [46,] 174.0  69.50\n [47,] 183.3  66.40\n [48,] 184.7  79.70\n [49,] 180.2  73.60\n [50,] 180.2  78.70\n [51,] 176.0  75.00\n [52,] 156.0  49.80\n [53,] 179.7  67.20\n [54,] 180.9  66.00\n [55,] 179.5  74.30\n [56,] 178.9  78.10\n [57,] 182.1  79.50\n [58,] 186.3  78.50\n [59,] 170.0  64.80\n [60,] 170.0  59.00\n [61,] 180.5  72.10\n [62,] 173.3  75.60\n [63,] 173.5  71.40\n [64,] 181.0  69.70\n [65,] 175.0  63.90\n [66,] 170.3  55.10\n [67,] 165.0  60.00\n [68,] 169.8  58.00\n [69,] 174.1  64.70\n [70,] 175.0  87.50\n [71,] 171.1  78.90\n [72,] 172.7  83.90\n [73,] 175.6  82.80\n [74,] 171.6  74.40\n [75,] 172.3  94.80\n [76,] 171.4  49.20\n [77,] 178.0  61.90\n [78,] 162.0  53.60\n [79,] 167.3  63.70\n [80,] 162.0  52.80\n [81,] 170.8  65.20\n [82,] 163.0  50.90\n [83,] 166.1  57.30\n [84,] 176.0  60.00\n [85,] 163.9  60.10\n [86,] 173.0  52.50\n [87,] 177.0  59.70\n [88,] 168.0  57.30\n [89,] 172.0  59.60\n [90,] 167.9  71.50\n [91,] 177.5  69.70\n [92,] 162.5  56.10\n [93,] 172.5  61.10\n [94,] 166.7  47.40\n [95,] 175.0  56.00\n [96,] 157.9  45.80\n [97,] 158.9  47.80\n [98,] 156.9  43.80\n [99,] 148.9  37.80\n[100,] 149.0  45.10\n[101,] 172.7  67.00\n[102,] 176.5  74.40\n[103,] 183.0  79.30\n[104,] 194.4  87.50\n[105,] 193.4  83.50\n[106,] 180.2  78.00\n[107,] 183.0  78.00\n[108,] 184.0  85.00\n[109,] 192.7  84.70\n[110,] 187.2  92.00\n[111,] 183.9  72.30\n[112,] 192.0  83.00\n[113,] 190.4  96.90\n[114,] 190.7  85.70\n[115,] 181.8  85.40\n[116,] 188.3  85.30\n[117,] 198.0  93.50\n[118,] 186.0  86.80\n[119,] 192.0  87.90\n[120,] 185.6  87.20\n[121,] 165.3  53.80\n[122,] 185.6  89.80\n[123,] 189.0  91.10\n[124,] 193.4  88.60\n[125,] 185.6  92.30\n[126,] 194.6  97.00\n[127,] 189.0  89.50\n[128,] 188.1  88.20\n[129,] 200.4  92.20\n[130,] 195.3  78.90\n[131,] 194.1  90.30\n[132,] 187.9  87.00\n[133,] 209.4 113.70\n[134,] 203.4  98.00\n[135,] 198.7 100.20\n[136,] 187.1  79.40\n[137,] 196.6  90.30\n[138,] 186.1  77.70\n[139,] 192.8  83.90\n[140,] 195.2  75.50\n[141,] 169.1  60.60\n[142,] 186.6  71.00\n[143,] 184.4  71.80\n[144,] 187.3  76.80\n[145,] 185.1 102.70\n[146,] 185.5  94.25\n[147,] 184.9  79.00\n[148,] 175.0  66.60\n[149,] 185.4  71.80\n[150,] 181.0  74.80\n[151,] 176.0  68.20\n[152,] 176.2  62.30\n[153,] 174.0  61.00\n[154,] 191.0  77.50\n[155,] 171.0  57.40\n[156,] 174.0  71.40\n[157,] 180.2  70.30\n[158,] 178.5  80.20\n[159,] 190.3  84.20\n[160,] 185.0 111.30\n[161,] 189.0  80.70\n[162,] 180.1  97.90\n[163,] 189.2 123.20\n[164,] 182.6  72.90\n[165,] 186.0  83.00\n[166,] 174.9  75.90\n[167,] 180.6  70.70\n[168,] 178.6  67.10\n[169,] 173.0  69.20\n[170,] 179.7  67.05\n[171,] 174.6  70.50\n[172,] 178.0  70.80\n[173,] 178.5  71.00\n[174,] 171.3  69.10\n[175,] 178.0  62.90\n[176,] 189.1  94.80\n[177,] 195.4  94.60\n[178,] 179.1 108.20\n[179,] 180.1  97.90\n[180,] 179.6  75.20\n[181,] 174.7  74.80\n[182,] 192.7  94.20\n[183,] 179.3  76.10\n[184,] 197.5  94.70\n[185,] 182.7  86.20\n[186,] 190.5  79.60\n[187,] 191.0  85.30\n[188,] 179.6  74.40\n[189,] 192.6  93.50\n[190,] 194.1  87.60\n[191,] 193.0  85.40\n[192,] 193.9 101.00\n[193,] 187.7  74.90\n[194,] 185.3  87.30\n[195,] 191.5  90.00\n[196,] 184.6  94.70\n[197,] 179.9  76.30\n[198,] 183.9  93.20\n[199,] 183.5  80.00\n[200,] 183.1  73.80\n[201,] 178.4  71.10\n[202,] 190.8  76.70\n```\n:::\n:::\n\n \n$\\blacksquare$\n\n(d) Run a multivariate analysis of variance to see whether the\nheight-weight combination depends significantly on gender, sport or the\ncombination of both. Display the results. Use the small-m\n`manova` way to do this one.\n\nSolution\n\n\nThe straightforward way is small-m `manova`. I don't know\nwhat I should be calling my fitted model object, so I'm making\nsomething up. Don't forget to use the right names for the\nvariables, and to include an interaction:\n\n::: {.cell}\n\n```{.r .cell-code}\nhtwt.1 <- manova(response ~ Sex * Sport, data = athletes)\nsummary(htwt.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Df  Pillai approx F num Df den Df Pr(>F)    \nSex         1 0.52412  101.325      2    184 <2e-16 ***\nSport       9 0.87914   16.123     18    370 <2e-16 ***\nSex:Sport   6 0.04105    0.646     12    370 0.8023    \nResiduals 185                                          \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nathletes %>% \n  unite(\"combo\", c(Sex, Sport)) -> athletes_combo\nsummary(BoxM(response, athletes_combo$combo))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Box's M Test \n\nChi-Squared Value = 86.605 , df = 48  and p-value: 0.000537 \n```\n:::\n:::\n\nThis test gives just small enough a P-value to be worried about (remembering that less than 0.001 is the problem zone). It seems unlikely, though, that the right test (whatever it is) would produce a significant interaction.\n\nThe other way is apparently to use large-M `Manova` from package\n`car`. This goes as a two-stage process: fit an `lm`\nfirst with the same model formula as above, and then pass *that*\ninto `Manova`. This way, you just display the final result,\nrather than passing it into `summary`:\n\n::: {.cell}\n\n```{.r .cell-code}\nhtwt.2 <- lm(response ~ Sex * Sport, data = athletes)\nManova(htwt.2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in Anova.mlm(mod, ...): model is singular\n```\n:::\n:::\n\n \n\nExcept that this doesn't work, for reasons that I don't\nunderstand. `htwt.2` is fine; it's the `Manova` that is\nnot working.\n\n$\\blacksquare$\n\n(e) Briefly justify removing the interaction term from your\nprevious model, and fit a model without it. You can use either\n`manova` or `Manova` for this; they should both\nwork. (You only need to use one of them.)  Display your results.\n\nSolution\n\n\nThe interaction should come out, since it is not\nsignificant. (This is what I meant by \"briefly.\")\nTo do that, in each case, replace the `*` with a `+`, or use\n`update`. Most of those work:\n\n::: {.cell}\n\n```{.r .cell-code}\nhtwt.4 <- manova(response ~ Sex + Sport, data = athletes)\nsummary(htwt.4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Df  Pillai approx F num Df den Df    Pr(>F)    \nSex         1 0.51888  102.454      2    190 < 2.2e-16 ***\nSport       9 0.86923   16.314     18    382 < 2.2e-16 ***\nResiduals 191                                             \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n   \n\nor\n\n::: {.cell}\n\n```{.r .cell-code}\nhtwt.5 <- update(htwt.1, . ~ . - Sex:Sport)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in if (projections) qr <- lmcall$qr <- TRUE: the condition has length > 1\n```\n:::\n:::\n\n \n\nIt seems that `manova` things don't like `update`. If\nthat happened to you, try it another way.\n\nor, with `Manova`, the same two ways:\n\n::: {.cell}\n\n```{.r .cell-code}\nhtwt.6 <- lm(response ~ Sex + Sport, data = athletes)\nhtwt.7 <- Manova(htwt.6)\nsummary(htwt.7)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nType II MANOVA Tests:\n\nSum of squares and products for error:\n         Ht        Wt\nHt 6871.978  5842.771\nWt 5842.771 13613.021\n\n------------------------------------------\n \nTerm: Sex \n\nSum of squares and products for the hypothesis:\n         Ht       Wt\nHt 4582.744 6146.078\nWt 6146.078 8242.718\n\nMultivariate Tests: Sex\n                 Df test stat approx F num Df den Df     Pr(>F)    \nPillai            1 0.4427781 75.48862      2    190 < 2.22e-16 ***\nWilks             1 0.5572219 75.48862      2    190 < 2.22e-16 ***\nHotelling-Lawley  1 0.7946171 75.48862      2    190 < 2.22e-16 ***\nRoy               1 0.7946171 75.48862      2    190 < 2.22e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n------------------------------------------\n \nTerm: Sport \n\nSum of squares and products for the hypothesis:\n         Ht        Wt\nHt 6162.455  7070.085\nWt 7070.085 13727.950\n\nMultivariate Tests: Sport\n                 Df test stat approx F num Df den Df     Pr(>F)    \nPillai            9 0.8692278 16.31358     18    382 < 2.22e-16 ***\nWilks             9 0.3132928 16.60578     18    380 < 2.22e-16 ***\nHotelling-Lawley  9 1.6093145 16.89780     18    378 < 2.22e-16 ***\nRoy               9 1.0593835 22.48247      9    191 < 2.22e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n \n\nor\n\n::: {.cell}\n\n```{.r .cell-code}\nhtwt.8 <- update(htwt.2, . ~ . - Sex:Sport)\nhtwt.9 <- Manova(htwt.8)\nsummary(htwt.9)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nType II MANOVA Tests:\n\nSum of squares and products for error:\n         Ht        Wt\nHt 6871.978  5842.771\nWt 5842.771 13613.021\n\n------------------------------------------\n \nTerm: Sex \n\nSum of squares and products for the hypothesis:\n         Ht       Wt\nHt 4582.744 6146.078\nWt 6146.078 8242.718\n\nMultivariate Tests: Sex\n                 Df test stat approx F num Df den Df     Pr(>F)    \nPillai            1 0.4427781 75.48862      2    190 < 2.22e-16 ***\nWilks             1 0.5572219 75.48862      2    190 < 2.22e-16 ***\nHotelling-Lawley  1 0.7946171 75.48862      2    190 < 2.22e-16 ***\nRoy               1 0.7946171 75.48862      2    190 < 2.22e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n------------------------------------------\n \nTerm: Sport \n\nSum of squares and products for the hypothesis:\n         Ht        Wt\nHt 6162.455  7070.085\nWt 7070.085 13727.950\n\nMultivariate Tests: Sport\n                 Df test stat approx F num Df den Df     Pr(>F)    \nPillai            9 0.8692278 16.31358     18    382 < 2.22e-16 ***\nWilks             9 0.3132928 16.60578     18    380 < 2.22e-16 ***\nHotelling-Lawley  9 1.6093145 16.89780     18    378 < 2.22e-16 ***\nRoy               9 1.0593835 22.48247      9    191 < 2.22e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n \n\nThese both work, and give the same answer. I think this is because the\nthing being `update`d is a regular `lm`; the\n`Manova` bit comes after, and is calculated from the\n`lm` fit.\n\nAny of these is good, and gets you the same answer.\n\nThe way you run Box's M test on these is on each explanatory variable separately:\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(BoxM(response, athletes$Sex))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Box's M Test \n\nChi-Squared Value = 3.98602 , df = 3  and p-value: 0.263 \n```\n:::\n\n```{.r .cell-code}\nsummary(BoxM(response, athletes$Sport))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Box's M Test \n\nChi-Squared Value = 68.16926 , df = 27  and p-value: 2.04e-05 \n```\n:::\n:::\n\nThe second of these, the one for Sport, is small enough to be a problem, but the P-value in the MANOVA for Sport is extremely small, so we should be safe.\n\nExtra: more about the `summary` output from `Manova`:\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(htwt.9)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nType II MANOVA Tests:\n\nSum of squares and products for error:\n         Ht        Wt\nHt 6871.978  5842.771\nWt 5842.771 13613.021\n\n------------------------------------------\n \nTerm: Sex \n\nSum of squares and products for the hypothesis:\n         Ht       Wt\nHt 4582.744 6146.078\nWt 6146.078 8242.718\n\nMultivariate Tests: Sex\n                 Df test stat approx F num Df den Df     Pr(>F)    \nPillai            1 0.4427781 75.48862      2    190 < 2.22e-16 ***\nWilks             1 0.5572219 75.48862      2    190 < 2.22e-16 ***\nHotelling-Lawley  1 0.7946171 75.48862      2    190 < 2.22e-16 ***\nRoy               1 0.7946171 75.48862      2    190 < 2.22e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n------------------------------------------\n \nTerm: Sport \n\nSum of squares and products for the hypothesis:\n         Ht        Wt\nHt 6162.455  7070.085\nWt 7070.085 13727.950\n\nMultivariate Tests: Sport\n                 Df test stat approx F num Df den Df     Pr(>F)    \nPillai            9 0.8692278 16.31358     18    382 < 2.22e-16 ***\nWilks             9 0.3132928 16.60578     18    380 < 2.22e-16 ***\nHotelling-Lawley  9 1.6093145 16.89780     18    378 < 2.22e-16 ***\nRoy               9 1.0593835 22.48247      9    191 < 2.22e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n \n\nThere are actually *four* competing tests that generalize the\none-response-variable $F$ statistic in different ways. If you go looking in a text\non multivariate analysis, you'll also see about all four of them, especially\nWilks's $\\Lambda$ (that's a capital lambda). They will generally agree\nin terms of conclusion, but you should probably at least glance at all of them.\n\nI am in danger of running out of numbers for my fitted models (and am\ndefinitely in danger of forgetting which one is which)!\n\n$\\blacksquare$\n\n\n(f) See if you can make a graph that shows what's going on\nhere. Bear in mind that you have two quantitative variables and\n*two* categorical ones, so you will need to find a way to\ndisplay everything. Hint: what would you do with two quantitative\nvariables and *one* categorical one? Can you find a way to\ngeneralize that idea by displaying the other categorical variable\ndifferently? I think we have seen a couple of ideas that will work,\nsomewhere in the lecture notes (but in a different context). Or you\ncan search for ideas, of course.\nFor full marks, obtain a plot which does not give you any\nwarnings. (The grader will know which of the possible plots give\nwarnings, and will deduct extra marks if you assert that a plot\ngives no warnings when in fact it does. That is to say, if you get\nany warnings, *you need to include those in what you hand in*).\n\nSolution\n\n\nThis will probably involve a bit of digging.\nThe starting point would be a scatterplot (the two quantitative\nvariables) with the points distinguished by colour (one of the\ncategorical variables). What other options do we have? \n\nIf you look eg. at the navigation on the left of\n[link](http://sape.inf.usi.ch/quick-reference/ggplot2/size), you'll\nsee that there are two likely possibilities: `shape` and\n`size`. `shape` uses a different plotting symbol for\neach value of a categorical variable; `size` draws the\nplotting symbol bigger or smaller according to the value of a\ncategorical variable. \n\nThe remaining question is the one of which aesthetic to \"map\" to\nwhich variable? To guide you in this, note that we have ten\ndifferent sports and two different genders. In my opinion, colours\nare the easiest to distinguish a lot of, though even then 10 is\npushing it, then plotting symbols. Symbol sizes are hard to\ndistinguish a lot of, so it's best to limit this (if you use it at\nall) to gender.\nWith that in mind, I would go for this one:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(athletes, aes(x = Ht, y = Wt, colour = Sport, shape = Sex)) + geom_point()\n```\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/hatzer-1.pdf){fig-pos='H'}\n:::\n:::\n\n     \n\nIf you investigate, you'll find that `ggplot` can handle about\nsix different shapes (and we have ten sports), and it doesn't care for\nusing `size` to distinguish values of a categorical\nvariable. It will try to draw the graph, but will give you a warning,\nsuch as these:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(athletes, aes(x = Ht, y = Wt, colour = Sport, size = Sex)) + geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using size for a discrete variable is not advised.\n```\n:::\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/delkofer-1.pdf){fig-pos='H'}\n:::\n:::\n\n     \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(athletes, aes(x = Ht, y = Wt, shape = Sport, size = Sex)) + geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using size for a discrete variable is not advised.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The shape palette can deal with a maximum of 6 discrete values because more\nthan 6 becomes difficult to discriminate\ni you have requested 10 values. Consider specifying shapes manually if you need\n  that many have them.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 72 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/vonhoedorff-1.pdf){fig-pos='H'}\n:::\n:::\n\n     \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(athletes, aes(x = Ht, y = Wt, shape = Sport, colour = Sex)) + geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The shape palette can deal with a maximum of 6 discrete values because more\nthan 6 becomes difficult to discriminate\ni you have requested 10 values. Consider specifying shapes manually if you need\n  that many have them.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 72 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/schmit-1.pdf){fig-pos='H'}\n:::\n:::\n\n     \n\nWhatever plot you come up with, you can put height and weight on the\nother axes, since neither one of them is uniquely a response variable.\n\nAny of these graphs with warnings do the job, kind of, so they get 2 points.\n\nOne of the many well-thought-out things about `ggplot2` is that\nmaking this graph was actually not difficult once you had figured out\nthat you also had `shape` and `size` at your\ndisposal. (In addition, `ggplot2` will help you make some\naesthetic decisions about which variable is distinguished by what kind\nof thing. This will help you work towards a plot that doesn't have any\nwarnings. These warnings are pretty clear about what not to do, and by\nimplication what you need to do instead. Colour, for example, is\nalways safe warning-wise.)\n\nThe model for this kind of graph that we saw is the plot of\nprobability (of preferring different brands of a product) as it depended\non age (two quantitative variables) for each brand and gender (two\ncategorical variables). I had three brands and two genders there, so I\nused colour for brand and shape for gender, but it would have worked\nabout as well if I'd used shape for brand and colour for gender.\n\nThe warning message for `shape` contains the words ``specify\nshapes manually if you must have them''. I was wondering how you can\navoid that. Here's how:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(athletes, aes(x = Ht, y = Wt, shape = Sport, colour = Sex)) + geom_point() +\n  scale_shape_manual(values = 1:10)\n```\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/marklin-1.pdf){fig-pos='H'}\n:::\n:::\n\n     \n\nI agree with `ggplot2` that this many shapes are hard to tell\napart,^[Having said that, the shapes are less anbiguous than  the colours, because if you're willing to study the legend, you can  work out exactly which sport a shape belongs to, whereas the colours  might be hard to tell apart at all.] but if you can figure this out,\nyou achieve the goal of producing a plot with no warnings, so you get\nfull marks. (We need 10 shapes because there are 10 different sports,\nso we have to specify 10 different values in `values=`: any 10\ndifferent values will do. A list of the possible shapes is in\n[link](https://stackoverflow.com/questions/16813278/cycling-through-point-shapes-when-more-than-6-factor-levels),\nat the bottom. You can even use regular letters, but you have to refer\nto them by numeric code:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(athletes, aes(x = Ht, y = Wt, shape = Sport, colour = Sex)) + geom_point() +\n  scale_shape_manual(values = c(66, 70, 71, 78, 82, 83, 52, 84, 3, 87))\n```\n\n::: {.cell-output-display}\n![](manova_files/figure-pdf/stahillin-1.pdf){fig-pos='H'}\n:::\n:::\n\n     \n\nI had to find something for `TSprnt`, since all the letters\nappeared to be taken.\n\nOn consideration, I like this last graph the best, because the letters\nare more or less reminders of which sport each point is (they are\n\"mnemonic\", so you don't have to look them up all the time, as with\ncolours or shapes: you can eventually remember which is which). \n\nWhatever you come up with, expect: 3 marks if you get a plot with no\nwarnings, 2 marks if you get a plot with warnings, 1 mark if you get a\nplot that would produce warnings but you don't indicate that there are\nwarnings, either by saying so or by including the warnings in what you\nhand in.\n\nI didn't ask you to interpret your plot (just getting it was enough\nwork), but there seems to be a common theme that, for sports played by\nboth genders, that the athletes are in about the same place relative\nto the other ones in their gender (eg., the basketball players are\ntall and heavy, the field athletes are really heavy but not very\ntall), but male athletes are both taller and heavier than female\nathletes playing the same sport. This consistency of pattern was\nprobably why the interaction was nowhere near significant: there are\nadditive separate effects of sport and of gender on the height-weight\ncombination. \n\n$\\blacksquare$\n\n\n",
    "supporting": [
      "manova_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}