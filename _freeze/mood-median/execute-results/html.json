{
  "hash": "0aed337656beb07d24409666f166cb5f",
  "result": {
    "engine": "knitr",
    "markdown": "# Mood median test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(smmr)\n```\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n##  Sugar in breakfast cereals\n\n\n The data for this question are in\n[http://ritsokiguess.site/datafiles/cereal-sugar.txt](http://ritsokiguess.site/datafiles/cereal-sugar.txt). The\nstory here is whether breakfast cereals marketed to children have a\nlot of sugar in them; in particular, whether they have more sugar on\naverage than cereals marketed to adults.\n\n\n(a) Read in the data (to R) and display the data set. Do you have\na variable that distinguishes the children's cereals from the\nadults' cereals, and another that contains the amount of sugar?\n\n\n\n\n\n(b) Calculate the mean sugar content for each group of cereals (the\nadults' ones and the children's ones). Do they look similar or different?\n\n\n\n\n(c) Make side-by-side boxplots of the sugar contents of the two\ntypes of cereal. What do you see that is out of the ordinary? \n\n\n\n\n\n(d) Explain briefly why you would not trust a two-sample $t$-test\nwith these data. (That is, say what the problem  is, and why it's a\nproblem.)\n\n\n\n\n(e) Run a suitable test to see whether the \"typical\" amount of\nsugar differs between adult's and children's cereals. Justify the test\nthat you run. (You can use the version of your test that lives in a\npackage, if that is easier for you.) What do you conclude, in the\ncontext of the data?\n\n\n\n\n\n\n\n\n\n##  Fear of math\n\n\n Two new short courses have been proposed for helping\nstudents who suffer from severe math phobia. The courses are labelled\nA and B. Ten students were randomly allocated to one of these two\ncourses, and each student's score on a math phobia test was recorded\nafter they completed their course. The math phobia test produces\nwhole-number scores between 0 and 10, with a higher score indicating a\ngreater fear of mathematics. The data can be found in\n[link](http://ritsokiguess.site/datafiles/mathphobia.txt). We start\nwith R for this question.\n\n\n\n(a) Read in the data and check, however you like, that you have 10\nobservations, 5 from each course.\n\n\n\n(b) Do a two-sample $t$-test to assess whether there is a\ndifference in mean phobia scores after the students have taken the two\ncourses. What do you conclude? (You have no \\textsl{a\npriori}^[That is, before looking at the data. This is  Latin. It's also the place that the Bayesian \"prior distribution\"  comes from. The \"posterior distribution\" comes from the Latin  *a posteriori*, which means *afterwards*, that is, after  you have looked at the data.] \nreason to\nsuppose that a particular one of the tests will produce a higher mean\nthan the other, so do a two-sided test.)\n\n\n\n\n(c) Draw boxplots of the math phobia scores for each group (one\nline of code). What is the most striking thing that you notice?\n\n\n\n\n(d) Explain briefly why a $t$-test would not be good for these\ndata. (There are two things that you need to say.)\n\n\n\n\n(e) Run a suitable test to compare the \"typical\" scores for the\ntwo courses. (You can use the version from a package rather than\nbuilding your own.) What do you conclude?\n\n\n\n\n\n\n\n\n\n##  Medical instructions\n\n\nDo people understand medical instructions better at certain\ntimes of the day? In a study, students in a grade 12 class are\nrandomly divided into two groups, A and B. All students see a video\ndescribing how to use an infant forehead thermometer. The students in\nGroup A see the video at 8:30 am, while the students in Group B see\nthe same video at 3:00 pm (on the same day). The next day, all the\nstudents are given a test on the material in the video (graded out of\n100). The observed scores are in\n[link](http://ritsokiguess.site/datafiles/forehead.txt) (values\nseparated by spaces).\n\n\n\n(a) Read the data into R and display the (first ten) values.\n\n\n\n(b) Obtain a suitable plot that will enable you to assess the\nassumptions for a two-sample $t$-test.\n\n\n\n(c) Why might you have doubts about using a two-sample $t$-test here?\n\n\n\n(d) Run Mood's median test as in class (*without* using\n`smmr`). What do you conclude, in the context of the data?\nWhat recommendation would you make about the time of day to see the\nvideo?  (You might get a warning about \"chisquared approximation  being incorrect\", \nwhich you can ignore here.)\n\n\n\n(e) Run Mood's median test on these data using my `smmr`\npackage, and verify that you get the same answer.\n\n\n\n\n\n\n\n## Handspans revisited\n\n Take your right hand, and stretch the fingers out as far as\nyou can. The distance between the tip of your thumb and the tip of\nyour little (pinky) finger is your handspan. The students in a\nStatistics class at Penn State measured their handspans and also\nwhether they identified as male or female.  The data are at [http://ritsokiguess.site/datafiles/handspan.txt](http://ritsokiguess.site/datafiles/handspan.txt),\nwith handspans\nmeasured in inches. We want to\nsee whether male students have a larger mean handspan than female students.\n\n\n(a) Read in and display (some of) the data.\n\n\n\n(b) Make a suitable (facetted) normal quantile plot of the data. (Bear in\nmind what is supposed to have a normal distribution.)\n\n\n\n(c) Discuss briefly whether you might prefer to use Mood's median\ntest to compare the handspans of the male and female students,\ncompared to a two-sample $t$-test.\n\n\n\n(d) Run Mood's median test. What do you conclude from the test, in the context of the data?\n\n\n\n\n\n\n\n\n\n\n\nMy solutions follow:\n\n\n\n\n##  Sugar in breakfast cereals\n\n\n The data for this question are in\n[http://ritsokiguess.site/datafiles/cereal-sugar.txt](http://ritsokiguess.site/datafiles/cereal-sugar.txt). The\nstory here is whether breakfast cereals marketed to children have a\nlot of sugar in them; in particular, whether they have more sugar on\naverage than cereals marketed to adults.\n\n\n(a) Read in the data (to R) and display the data set. Do you have\na variable that distinguishes the children's cereals from the\nadults' cereals, and another that contains the amount of sugar?\n\n\n\nSolution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url=\"http://ritsokiguess.site/datafiles/cereal-sugar.txt\"\ncereals=read_delim(my_url,\" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 40 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \" \"\nchr (1): who\ndbl (1): sugar\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ncereals\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"who\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"sugar\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"children\",\"2\":\"40.3\"},{\"1\":\"children\",\"2\":\"55.0\"},{\"1\":\"children\",\"2\":\"45.7\"},{\"1\":\"children\",\"2\":\"43.3\"},{\"1\":\"children\",\"2\":\"50.3\"},{\"1\":\"children\",\"2\":\"45.9\"},{\"1\":\"children\",\"2\":\"53.5\"},{\"1\":\"children\",\"2\":\"43.0\"},{\"1\":\"children\",\"2\":\"44.2\"},{\"1\":\"children\",\"2\":\"44.0\"},{\"1\":\"children\",\"2\":\"47.4\"},{\"1\":\"children\",\"2\":\"44.0\"},{\"1\":\"children\",\"2\":\"20.0\"},{\"1\":\"children\",\"2\":\"55.1\"},{\"1\":\"children\",\"2\":\"48.8\"},{\"1\":\"children\",\"2\":\"50.4\"},{\"1\":\"children\",\"2\":\"37.8\"},{\"1\":\"children\",\"2\":\"70.3\"},{\"1\":\"children\",\"2\":\"46.6\"},{\"1\":\"adults\",\"2\":\"20.0\"},{\"1\":\"adults\",\"2\":\"40.2\"},{\"1\":\"adults\",\"2\":\"2.2\"},{\"1\":\"adults\",\"2\":\"7.5\"},{\"1\":\"adults\",\"2\":\"4.4\"},{\"1\":\"adults\",\"2\":\"37.2\"},{\"1\":\"adults\",\"2\":\"16.6\"},{\"1\":\"adults\",\"2\":\"14.5\"},{\"1\":\"adults\",\"2\":\"4.1\"},{\"1\":\"adults\",\"2\":\"15.8\"},{\"1\":\"adults\",\"2\":\"4.1\"},{\"1\":\"adults\",\"2\":\"2.4\"},{\"1\":\"adults\",\"2\":\"3.5\"},{\"1\":\"adults\",\"2\":\"8.5\"},{\"1\":\"adults\",\"2\":\"10.0\"},{\"1\":\"adults\",\"2\":\"1.0\"},{\"1\":\"adults\",\"2\":\"4.4\"},{\"1\":\"adults\",\"2\":\"1.3\"},{\"1\":\"adults\",\"2\":\"8.1\"},{\"1\":\"adults\",\"2\":\"4.7\"},{\"1\":\"adults\",\"2\":\"18.4\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nThe variable `who` is a categorical variable saying who the\ncereal is intended for, and the variable `sugar` says how much\nsugar each cereal has.\n\n\n$\\blacksquare$\n\n\n(b) Calculate the mean sugar content for each group of cereals (the\nadults' ones and the children's ones). Do they look similar or different?\n\n\n\nSolution\n\n\n`group_by` and `summarize`:\n\n::: {.cell}\n\n```{.r .cell-code}\ncereals %>% group_by(who) %>%\nsummarize(sugar_mean=mean(sugar))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"who\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"sugar_mean\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"adults\",\"2\":\"10.90000\"},{\"1\":\"children\",\"2\":\"46.61053\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nThese means look very different, though it would be better to look at\na boxplot (coming up in a moment).\n\n$\\blacksquare$\n\n(c) Make side-by-side boxplots of the sugar contents of the two\ntypes of cereal. What do you see that is out of the ordinary? \n\n\n\n\nSolution\n\n\nThe usual:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(cereals,aes(x=who,y=sugar))+geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](mood-median_files/figure-html/cerealsugar-3-1.png){width=672}\n:::\n:::\n\nI see outliers: two high ones on the adults' cereals, and one high and\none low on the children's cereals.\n\nMy thought above about the means being very different is definitely supported by the medians being very different on the boxplots. We should have no trouble declaring that the \"typical\" amounts of sugar in the adults' and children's cereals are different. \n\n\n\n$\\blacksquare$\n\n(d) Explain briefly why you would not trust a two-sample $t$-test\nwith these data. (That is, say what the problem  is, and why it's a\nproblem.)\n\n\n\nSolution\n\n\nThe problem is the outliers (which is rather a giveaway), but the\nreason it's a problem is that the two-sample $t$-test assumes\n(approximately) normal data, and a normal distribution doesn't\nhave outliers.\nNot only do you need to note the outliers, but you also need to\nsay why the outliers cause a problem *in this case*. Anything\nless than that is not a complete answer. \n\n\n$\\blacksquare$\n\n(e) Run a suitable test to see whether the \"typical\" amount of\nsugar differs between adult's and children's cereals. Justify the test\nthat you run. (You can use the version of your test that lives in a\npackage, if that is easier for you.) What do you conclude, in the\ncontext of the data?\n\n\n\nSolution\n\n\nHaving ruled out the two-sample $t$-test, we are left with Mood's\nmedian test. I didn't need you to build it yourself, so you can\nuse package `smmr` to run it with:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(smmr)\nmedian_test(cereals,sugar,who)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$grand_median\n[1] 28.6\n\n$table\n          above\ngroup      above below\n  adults       2    19\n  children    18     1\n\n$test\n       what        value\n1 statistic 2.897243e+01\n2        df 1.000000e+00\n3   P-value 7.341573e-08\n```\n\n\n:::\n:::\n\nWe conclude that there *is* a difference between the median\namounts of sugar between the two groups of cereals, the P-value of 0.00000007\nbeing extremely small.\n\nWhy did it come out so small? Because the amount of sugar was smaller\nthan the overall median for almost all the adult cereals, and larger\nthan the overall median for almost all the children's ones. That is,\nthe children's cereals really do have more sugar.\n\nMood's median test doesn't come with a confidence interval (for the\ndifference in population medians), because whether or not a certain\ndifference in medians is rejected depends on what those medians\nactually are, and the idea of the duality of the test and CI doesn't\ncarry over as we would like.\n\nMy daughter likes chocolate Cheerios, but she also likes Shredded\nWheat and *Bran Flakes*. Go figure. (Her current favourite is\nRaisin Bran, even though she doesn't like raisins by themselves.)\n\nMood's median test is the test we should trust, but you might be\ncurious about how the $t$-test stacks up here:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(sugar~who,data=cereals)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  sugar by who\nt = -11.002, df = 37.968, p-value = 2.278e-13\nalternative hypothesis: true difference in means between group adults and group children is not equal to 0\n95 percent confidence interval:\n -42.28180 -29.13925\nsample estimates:\n  mean in group adults mean in group children \n              10.90000               46.61053 \n```\n\n\n:::\n:::\n\nThe P-value is *even smaller*, and we have the advantage of\ngetting a confidence interval for the difference in means: from about\n30 to about 40 units less sugar in the adult cereals. Whatever the\nunits were.\n\n$\\blacksquare$\n\n\n\n\n\n\n##  Fear of math\n\n\n Two new short courses have been proposed for helping\nstudents who suffer from severe math phobia. The courses are labelled\nA and B. Ten students were randomly allocated to one of these two\ncourses, and each student's score on a math phobia test was recorded\nafter they completed their course. The math phobia test produces\nwhole-number scores between 0 and 10, with a higher score indicating a\ngreater fear of mathematics. The data can be found in\n[link](http://ritsokiguess.site/datafiles/mathphobia.txt). We start\nwith R for this question.\n\n\n\n(a) Read in the data and check, however you like, that you have 10\nobservations, 5 from each course.\n\n\nSolution\n\n\nThis doesn't need much comment:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/mathphobia.txt\"\nmath <- read_delim(my_url, \" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 10 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \" \"\nchr (1): course\ndbl (1): phobia\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nmath\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"course\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"phobia\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"a\",\"2\":\"8\"},{\"1\":\"a\",\"2\":\"7\"},{\"1\":\"a\",\"2\":\"7\"},{\"1\":\"a\",\"2\":\"6\"},{\"1\":\"a\",\"2\":\"6\"},{\"1\":\"b\",\"2\":\"9\"},{\"1\":\"b\",\"2\":\"8\"},{\"1\":\"b\",\"2\":\"7\"},{\"1\":\"b\",\"2\":\"2\"},{\"1\":\"b\",\"2\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\nThis will do, counting the `a` and `b`. Or, to save\nyourself that trouble:\n\n::: {.cell}\n\n```{.r .cell-code}\nmath %>% count(course)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"course\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"a\",\"2\":\"5\"},{\"1\":\"b\",\"2\":\"5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\nFive each. The story is to get the computer to do the grunt work for\nyou, if you can make it do so. Other ways:\n\n::: {.cell}\n\n```{.r .cell-code}\nmath %>% group_by(course) %>% summarize(count = n())\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"course\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"count\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"a\",\"2\":\"5\"},{\"1\":\"b\",\"2\":\"5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\nand this:\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(math, table(course))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ncourse\na b \n5 5 \n```\n\n\n:::\n:::\n\n \n\ngiving the same answer. Lots of ways.\n\nExtra: there is an experimental design issue here. You might have noticed that each student did only *one* of the courses. Couldn't students do both, in a matched-pairs kind of way? Well, it's a bit like the kids learning to read in that if the first of the courses reduces a student's anxiety, the second course won't appear to do much good (even if it actually would have been helpful had the student done that one first). This is the same idea as the kids learning to read: once you've learned to read, you've learned to read, and learning to read a second way won't help much. The place where matched pairs scores is when you can \"wipe out\" the effect of one treatment before a subject gets the other one. We have an example of kids throwing baseballs and softballs that is like that: if you throw one kind of ball, that won't affect how far you can throw the other kind.\n\n$\\blacksquare$\n\n(b) Do a two-sample $t$-test to assess whether there is a\ndifference in mean phobia scores after the students have taken the two\ncourses. What do you conclude? (You have no \\textsl{a\npriori}^[That is, before looking at the data. This is  Latin. It's also the place that the Bayesian \"prior distribution\"  comes from. The \"posterior distribution\" comes from the Latin  *a posteriori*, which means *afterwards*, that is, after  you have looked at the data.] \nreason to\nsuppose that a particular one of the tests will produce a higher mean\nthan the other, so do a two-sided test.)\n\n\n\nSolution\n\n\nA two-sided test is the default, so there is not much to do here:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(phobia ~ course, data = math)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  phobia by course\nt = 0.83666, df = 4.4199, p-value = 0.4456\nalternative hypothesis: true difference in means between group a and group b is not equal to 0\n95 percent confidence interval:\n -3.076889  5.876889\nsample estimates:\nmean in group a mean in group b \n            6.8             5.4 \n```\n\n\n:::\n:::\n\n \n\nThe P-value of 0.4456 is nowhere near less than 0.05, so there is no\nevidence at all that the  \nmean math phobia scores are different between the two courses. \n\n\n$\\blacksquare$\n\n(c) Draw boxplots of the math phobia scores for each group (one\nline of code). What is the most striking thing that you notice?\n\n\n\nSolution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(math, aes(x = course, y = phobia)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](mood-median_files/figure-html/mathphobia-6-1.png){width=672}\n:::\n:::\n\n \n\nBoxplot `a` is just weird. The bar across the middle is\nactually at the top, and it has no bottom. (Noting something sensible\nlike this is enough.) Boxplot `b` is hugely spread\nout.^[The two groups have very different spreads, but that is  not a problem as long as we remember to do the Welch-Satterthwaite  test that does not assume equal spreads. This is the default in R,  so we are good, at least with that.]\n\nBy way of explanation: the course `a` scores have a number of\nvalues equal so that the 3rd quartile and the median are the name, and\nalso that the first quartile and the minimum value are the same:\n\n::: {.cell}\n\n```{.r .cell-code}\ntmp <- math %>% filter(course == \"a\")\ntmp %>% count(phobia)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"phobia\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"6\",\"2\":\"2\"},{\"1\":\"7\",\"2\":\"2\"},{\"1\":\"8\",\"2\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nsummary(tmp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    course              phobia   \n Length:5           Min.   :6.0  \n Class :character   1st Qu.:6.0  \n Mode  :character   Median :7.0  \n                    Mean   :6.8  \n                    3rd Qu.:7.0  \n                    Max.   :8.0  \n```\n\n\n:::\n:::\n\n \n\nThe phobia scores from course A are two 6's, two 7's and an 8. The\nmedian and third quartile are both 7, and the first quartile is the\nsame as the lowest value, 6.\n\nTechnique note: I wanted to do two things with the phobia scores from\ncourse A: count up how many of each score, and show you what the\nfive-number summary looks like. One pipe won't do this (the pipe\n\"branches\"), so I saved what I needed to use, before it branched,\ninto a data frame `tmp` and then used `tmp` twice. Pipes\nare powerful, but not *all*-powerful.\n\n\n\n$\\blacksquare$\n\n(d) Explain briefly why a $t$-test would not be good for these\ndata. (There are two things that you need to say.)\n\n\n\nSolution\n\n\nThe easiest way to structure this is to ask yourself first what the\n$t$-test needs, and second whether you have it.\nThe $t$-test assumes (approximately) normal data. The boxplot for\ngroup `a` doesn't even look symmetric, and the one for group\n`b` has an oddly asymmetric box. So I think the normality is\nin question here, and therefore another test would be\nbetter. (This is perhaps a bit glib of an answer, since there are\nonly 5 values in each group, and so they can certainly look\nnon-normal even if they actually are normal, but these values are\nall integers, so it is perhaps wise to be cautious.)\nWe have the machinery to assess the normality for these, in one shot:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(math, aes(sample = phobia)) +\n  stat_qq() + stat_qq_line() +\n  facet_wrap(~course, ncol = 1, scales = \"free\")\n```\n\n::: {.cell-output-display}\n![](mood-median_files/figure-html/mathphobia-8-1.png){width=672}\n:::\n:::\n\n   \n\nI don't know what *you* make of those, but they both look pretty\nstraight to me (and there are only five observations, so it's hard to\njudge). Course `b` maybe has a \"hole\" in it (three large\nvalues and two small ones). Maybe. I dunno. What I would *really*\nbe worried about is outliers, and at least we don't have those.\nI mentioned in class that the $t$-tests are robust to non-normality. I\nought to have expanded on that a bit: what really makes the $t$-test\nstill behave itself with non-normality is when you have *large*\nsamples, that is, when the Central Limit Theorem has had a chance to\ntake hold. (That's what drives the normality not really being\nnecessary in most cases.) But, even with small samples, exact\nnormality doesn't matter so much.  Here, we have two tiny samples, and\nso we have to insist a bit more, but only a bit more, on a\nmore-or-less normal shape in each group. (It's kind of a double\njeopardy in that the situation where normality matters most, namely\nwith small samples, is where it's the hardest to judge, because\nsamples of size 5 even from a normal distribution can look very\nnon-normal.)\nBut, the biggest threats to the $t$-test are big-time skewness and\noutliers, and we are not suffering too badly from those.\n  \n\n$\\blacksquare$\n\n(e) Run a suitable test to compare the \"typical\" scores for the\ntwo courses. (You can use the version from a package rather than\nbuilding your own.) What do you conclude?\n\n\n\nSolution\n\n\nThis is an invite to use `smmr`:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(smmr)\nmedian_test(math, phobia, course)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$grand_median\n[1] 7\n\n$table\n     above\ngroup above below\n    a     1     2\n    b     2     2\n\n$test\n       what     value\n1 statistic 0.1944444\n2        df 1.0000000\n3   P-value 0.6592430\n```\n\n\n:::\n:::\n\n     \n\nWe are nowhere near rejecting equal medians; in fact, both courses are\nvery close to 50--50 above and below the overall median.\n\nIf you look at the frequency table, you might be confused by\nsomething: there were 10 observations, but there are only $1+2+2+2=7$\nin the table. This is because three of the observations were equal to\nthe overall median, and had to be thrown away:\n\n::: {.cell}\n\n```{.r .cell-code}\nmath %>% summarize(med = median(phobia))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"med\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"7\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nmath %>% count(phobia)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"phobia\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"1\"},{\"1\":\"2\",\"2\":\"1\"},{\"1\":\"6\",\"2\":\"2\"},{\"1\":\"7\",\"2\":\"3\"},{\"1\":\"8\",\"2\":\"2\"},{\"1\":\"9\",\"2\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\nThe overall median was 7. Because the actual data were really discrete\n(the phobia scores could only be whole numbers), we risked losing a\nlot of our data when we did this test (and we didn't have much to\nbegin with). The other thing to say is that with small sample sizes,\nthe frequencies in the table have to be *very* lopsided for you\nto have a chance of rejecting the null. Something like this is what\nyou'd need:\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(1, 1, 2, 6, 6, 6, 7, 8, 9, 10)\ng <- c(1, 1, 1, 1, 1, 2, 2, 2, 2, 2)\nd <- tibble(x, g)\nmedian_test(d, x, g)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$grand_median\n[1] 6\n\n$table\n     above\ngroup above below\n    1     0     3\n    2     4     0\n\n$test\n       what       value\n1 statistic 7.000000000\n2        df 1.000000000\n3   P-value 0.008150972\n```\n\n\n:::\n:::\n\n \n\nI faked it up so that we had 10 observations, three of which were\nequal to the overall median. Of the rest, all the small ones were in\ngroup 1 and all the large ones were in group 2. This is lopsided\nenough to reject with, though, because of the small frequencies, there\nactually was a warning about \n\"chi-squared approximation may be inaccurate\".^[There *was*, in the `chisq.test` inside `median_test`, but in  `smmr` I didn't pass that warning back to the outside world.]\n\n$\\blacksquare$\n\n\n\n\n\n\n##  Medical instructions\n\n\n Do people understand medical instructions better at certain\ntimes of the day? In a study, students in a grade 12 class are\nrandomly divided into two groups, A and B. All students see a video\ndescribing how to use an infant forehead thermometer. The students in\nGroup A see the video at 8:30 am, while the students in Group B see\nthe same video at 3:00 pm (on the same day). The next day, all the\nstudents are given a test on the material in the video (graded out of\n100). The observed scores are in\n[link](http://ritsokiguess.site/datafiles/forehead.txt) (values\nseparated by spaces).\n\n\n\n(a) Read the data into R and display the (first ten) values.\n\n\nSolution\n\n\nSeparated by spaces, so `read_delim`:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/forehead.txt\"\ninstr <- read_delim(my_url, \" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 18 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \" \"\nchr (1): group\ndbl (1): score\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\ninstr\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"group\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"score\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"A\",\"2\":\"88\"},{\"1\":\"A\",\"2\":\"89\"},{\"1\":\"A\",\"2\":\"79\"},{\"1\":\"A\",\"2\":\"100\"},{\"1\":\"A\",\"2\":\"98\"},{\"1\":\"A\",\"2\":\"89\"},{\"1\":\"A\",\"2\":\"65\"},{\"1\":\"A\",\"2\":\"94\"},{\"1\":\"A\",\"2\":\"95\"},{\"1\":\"A\",\"2\":\"91\"},{\"1\":\"B\",\"2\":\"87\"},{\"1\":\"B\",\"2\":\"69\"},{\"1\":\"B\",\"2\":\"78\"},{\"1\":\"B\",\"2\":\"79\"},{\"1\":\"B\",\"2\":\"83\"},{\"1\":\"B\",\"2\":\"90\"},{\"1\":\"B\",\"2\":\"85\"},{\"1\":\"B\",\"2\":\"58\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n    \n\n$\\blacksquare$\n\n(b) Obtain a suitable plot that will enable you to assess the\nassumptions for a two-sample $t$-test.\n\n\nSolution\n\n\nWe need the values in each group to be approximately normally\ndistributed. Side-by-side boxplots will do it:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(instr, aes(x = group, y = score)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](mood-median_files/figure-html/forehead-2-1.png){width=672}\n:::\n:::\n\n     \n\nor, if you like, separate (facetted) normal quantile plots, which I\nwould do this way:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(instr, aes(sample = score)) +\n  stat_qq() + stat_qq_line() +\n  facet_wrap(~group, ncol = 1)\n```\n\n::: {.cell-output-display}\n![](mood-median_files/figure-html/forehead-3-1.png){width=672}\n:::\n:::\n\n \n    \n\n$\\blacksquare$\n\n(c) Why might you have doubts about using a two-sample $t$-test here?\n\n\nSolution\n\n\nWe are looking for non-normality in at least one of the\ngroups. Here, both groups have an outlier at the low end that\nwould be expected to pull the mean downward. I don't think there\nis left-skewness here, since there is no particular evidence of\nthe high-end values being bunched up: the problem in both cases\nwith normality is at the low end. \nOne way or another, I'm expecting you to have noticed the outliers.\nExtra: last year, when I first drew the normal quantile plots,\nthere was no `stat_qq_line`, so you had to imagine where\nthe line went if you did it this way. Without the line, these\nplots look somewhat curved, which would have pointed to\nleft-skewness, but now we see that the lowest observation is too\nlow, and maybe the second-lowest one as well, while the other\nobservations are just fine.\n    \n\n$\\blacksquare$\n\n(d) Run Mood's median test as in class (*without* using\n`smmr`). What do you conclude, in the context of the data?\nWhat recommendation would you make about the time of day to see the\nvideo?  (You might get a warning about \"chisquared approximation  being incorrect\", \nwhich you can ignore here.)\n\n\nSolution\n\n\nThe overall median first:\n\n::: {.cell}\n\n```{.r .cell-code}\ninstr %>% summarize(med = median(score))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"med\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"87.5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n     \n\n87.5, which is not equal to any of the data values (they are all\nintegers). This will avoid any issues with values-equal-to-median later.\n\nThen, create and save a table of the value by group and above/below\nmedian. You can count either above or below (it comes out equivalently\neither way):\n\n::: {.cell}\n\n```{.r .cell-code}\ntab <- with(instr, table(group, score > 87.5))\ntab\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     \ngroup FALSE TRUE\n    A     2    8\n    B     7    1\n```\n\n\n:::\n:::\n\n \n\nThen, chi-squared test for independence (the null) or association of\nsome kind (the alternative). The `correct=F` is saying not to\ndo Yates's correction, so that it would come out the same if you were\ndoing it by hand (\"observed minus expected, squared, divided by expected\" \nand all that stuff).\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(tab, correct = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in chisq.test(tab, correct = F): Chi-squared approximation may be\nincorrect\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  tab\nX-squared = 8.1, df = 1, p-value = 0.004427\n```\n\n\n:::\n:::\n\n \n\nThe P-value is 0.0044, which is (much) smaller than 0.05, and\ntherefore you can reject independence and conclude association: that\nis, whether a student scores above or below the median depends on\nwhich group they are in, or, that the median scores are different for\nthe two groups.\n\nThe warning is because the expected frequencies are on the small side\n(if you have done this kind of problem by hand, you might remember\nsomething about \"expected frequencies less than 5\". This is that.)\nHere, the P-value is so small that we can afford to have it be\ninaccurate by a bit and still not affect the conclusion, so I think we\nare safe.\n\nAs for which group is better, well, the easiest way is to go back to\nyour boxplots and see that the median for group A (8:30 am) is\nsubstantially higher than for group B (3:00pm). But you can also see\nit from your frequency table, if you displayed it:\n\n::: {.cell}\n\n```{.r .cell-code}\ntab\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     \ngroup FALSE TRUE\n    A     2    8\n    B     7    1\n```\n\n\n:::\n:::\n\n \n\nMost of the people in the 8:30 am group scored above the median, and\nmost of the people in the 3:00 pm group scored below the median. So\nthe scores at 8:30 am were better overall.\n\nAs I write this, it is just after 3:00 pm and I am about to make\nmyself a pot of tea!\n\nExtra: about that `correct=F` thing. There was a point of view for a\nlong time that when you are dealing with a $2 \\times 2$ table, you can\nget better P-values by, before squaring \"observed minus expected\",\ntaking 0.5 away from the absolute value of the difference. This is\ncalled Yates's correction. It is in the same spirit as the\n\"continuity correction\" that you might have encountered in the\nnormal approximation to the binomial, where in the binomial you have\nto have a whole number of successes, but the normal allows fractional\nvalues as well.  In about the 1960s, the usefulness of Yates's\ncorrection was shot down, for general contingency tables. There is,\nhowever, one case where it *is* useful, and that is the case\nwhere the row totals and column totals are *fixed*.\n\nWhat do I mean by that? Well, first let's look at a case where the\ntotals are *not* all fixed. Consider a survey in which you want\nto see whether males and females agree or disagree on some burning\nissue of the day. You collect random samples of, say, 500 males and\n500 females, and you count how many of them say Yes or No to your\nstatement.^[To simplify things, we'll assume that everyone gave a Yes or a No answer, though you could add a column like \"No answer\" if you wanted to make it more realistic.]\nYou might get results like this:\n\n\n```\n\nYes  No  Total\nMales    197 303   500\nFemales  343 157   500\nTotal    540 460  1000\n\n```\n\n\nIn this table, the row totals must be 500, because you asked this many\nmales and this many females, and each one must have answered\nsomething. The column totals, however, are not fixed: you didn't know,\nahead of time, that 540 people would answer \"yes\". That was just the\nway the data turned out, and if you did another survey with the same\ndesign, you'd probably get a different number of people saying\n\"yes\". \n\nFor another example, let's go back to Fisher (yes, *that*\nFisher). A \"lady\" of his acquaintance claimed to be able, by\ndrinking a cup of tea with milk and sugar in it, whether the milk or\nthe sugar had been added first. Fisher, or, more likely, his\nhousekeeper, prepared 8 cups of tea, 4 with milk first and 4 with\nsugar first. The lady knew that four of the cups had milk first, and\nher job was to say which four. The results might have been like this:\n\n\n```\n\nActual \nMilk first  sugar first  Total\nLady   Milk first        3            1         4\nsays   sugar first       1            3         4\nTotal             4            4         8\n\n```\n\n\nThis time, all of the row totals and all of the column totals must be\n4, regardless of what the lady thinks. Even if she thinks 5 of the\ncups of tea actually had milk first, she is going to pick 4 of them to\nsay that they have milk first, since she knows there are only 4. In\nthis case, all of the row and column totals are fixed at 4, and the\nright analysis is called Fisher's Exact Test, based on the\nhypergeometric distribution. In a $2\\times 2$ table like this one,\nthere is only one \"degree of freedom\", since as soon as you specify\none of the frequencies, say the number of cups where the lady said\nmilk first and they actually were milk first, you can work out the\nothers.  But, leaving that aside, the usual chi-squared analysis is a\nperfectly good approximation, especially if the frequencies are large,\nand especially if you use Yates's correction.\n\nIt is clear that Fisher must have been English, since he was able to\nget a publication out of drinking tea.\n\nHow does that apply to Mood's median test? Well, let's remind\nourselves of the table we had:\n\n::: {.cell}\n\n```{.r .cell-code}\ntab\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     \ngroup FALSE TRUE\n    A     2    8\n    B     7    1\n```\n\n\n:::\n:::\n\n \n\nWe know how many students were in each group: 10 in group A and 8 in\nB. So the row totals are fixed. What about the columns? These are\nwhether each observation was above or below the overall median. There\nwere 18 observations altogether, so there *must* be 9 above and 9\nbelow.^[Except in the case of the previous problem, where there were multiple observations equal to the overall median. Which we ignore for the moment.] \nSo the column totals are fixed as well. All\ntotals fixed, so we should be using Yates's correction. I didn't,\nbecause I wanted to keep things simple, but I should have done.\n\nR's `chisq.test` by default *always* uses Yates's\ncorrection, and if you don't want it, you have to say\n`correct=F`.  Which is why I have been doing so all through.\n    \n\n$\\blacksquare$\n\n(e) Run Mood's median test on these data using my `smmr`\npackage, and verify that you get the same answer.\n\n\nSolution\n\n\nNot much to it, since the data is already read in:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(smmr)\nmedian_test(instr, score, group)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$grand_median\n[1] 87.5\n\n$table\n     above\ngroup above below\n    A     8     2\n    B     1     7\n\n$test\n       what       value\n1 statistic 8.100000000\n2        df 1.000000000\n3   P-value 0.004426526\n```\n\n\n:::\n:::\n\n     \n\nIdentical, test statistic, degrees of freedom and P-value. The table\nof frequencies is also the same, just with columns rearranged. (In\n`smmr` I counted the number of values below the overall median,\nwhereas in my build-it-yourself I counted  the number of\nvalues above.)\n    \n$\\blacksquare$\n\n\n\n\n\n## Handspans revisited\n\n Take your right hand, and stretch the fingers out as far as\nyou can. The distance between the tip of your thumb and the tip of\nyour little (pinky) finger is your handspan. The students in a\nStatistics class at Penn State measured their handspans and also\nwhether they identified as male or female.  The data are at [http://ritsokiguess.site/datafiles/handspan.txt](http://ritsokiguess.site/datafiles/handspan.txt),\nwith handspans\nmeasured in inches. We want to\nsee whether male students have a larger mean handspan than female students.\n\n\n(a) Read in and display (some of) the data.\n\nSolution\n\n\nDelimited by a single space, so:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/handspan.txt\"\nspan <- read_delim(my_url, \" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 190 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \" \"\nchr (1): sex\ndbl (1): handspan\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nspan\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"handspan\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.25\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"26.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"F\",\"2\":\"17.00\"},{\"1\":\"F\",\"2\":\"16.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.70\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.25\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"19.50\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"20.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"25.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"18.00\"},{\"1\":\"M\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"25.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"13.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"17.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"25.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"18.50\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"23.50\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"22.00\"},{\"1\":\"F\",\"2\":\"12.50\"},{\"1\":\"F\",\"2\":\"18.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"18.50\"},{\"1\":\"F\",\"2\":\"19.00\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"21.50\"},{\"1\":\"F\",\"2\":\"23.00\"},{\"1\":\"F\",\"2\":\"23.25\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.80\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"17.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"F\",\"2\":\"19.50\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"21.00\"},{\"1\":\"F\",\"2\":\"20.00\"},{\"1\":\"M\",\"2\":\"20.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"24.50\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\"},{\"1\":\"M\",\"2\":\"21.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\"},{\"1\":\"M\",\"2\":\"21.50\"},{\"1\":\"M\",\"2\":\"19.00\"},{\"1\":\"M\",\"2\":\"21.50\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n$\\blacksquare$\n\n\n(b) Make a suitable (facetted) normal quantile plot of the data. (Bear in\nmind what is supposed to have a normal distribution.)\n\nSolution\n\nHere, we need *each* group to be approximately\nnormal, so make normal quantile plots of handspan, facetted by sex:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(span, aes(sample=handspan)) + stat_qq() + stat_qq_line() +\nfacet_wrap(~sex)\n```\n\n::: {.cell-output-display}\n![](mood-median_files/figure-html/handspan2-2-1.png){width=672}\n:::\n:::\n\n$\\blacksquare$\n\n\n(c) Discuss briefly whether you might prefer to use Mood's median\ntest to compare the handspans of the male and female students,\ncompared to a two-sample $t$-test.\n\nSolution\n\nA two-sample $t$-test assumes that each of the two samples comes\nfrom a (approximately) normal distribution (\"the data\nare normal\" is not precise enough). The female values, on the left, definitely have some\noutliers at the low end (or a long lower tail), so these are\ndefinitely not normal.\nThe male values (on the right) are\nslightly skewed to the left, or there are some mild outliers at the low end, or, if you prefer, these are\napproximately normal. \n(You need discussion of each of the males and\nfemales, or of why looking at one group is enough.) Because the males are not close enough to normal (or,\nbecause neither group is close enough to normal), we would prefer\nto use Mood's median test. (Say this.) You do yourself a favour by making it clear that you know that *both* groups have to be normal enough;\nif one is good but the other is not, that is not enough.\n\nThe other relevant issue is sample size. The best answer discusses that as well, even though you have a lot to think about already. This data set has 190 observations in it, so the samples must be pretty big:\n\n::: {.cell}\n\n```{.r .cell-code}\nspan %>% count(sex)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"F\",\"2\":\"103\"},{\"1\":\"M\",\"2\":\"87\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nWith these sample sizes, we can expect a lot of help from the central limit theorem. The apparent outliers in the males won't be a problem, and maybe we could even get away with those \noutliers in the females.\n\nExtra: you could also think about bootstrapped sampling distributions of the sample mean here. The one we are most concerned about is the females; if it turns out that they are all right, then the males must be all right too, since the plot for them is showing less non-normality (or, without the double negative, is closer to being normal). So let's do the females:\n\n::: {.cell}\n\n```{.r .cell-code}\nspan %>% \n  filter(sex == \"F\") -> females \ntibble(sim = 1:1000) %>% \n  rowwise() %>% \n  mutate(my_sample = list(sample(females$handspan, replace = TRUE))) %>% \n  mutate(my_mean = mean(my_sample)) %>% \n  ggplot(aes(sample = my_mean)) + stat_qq() + stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](mood-median_files/figure-html/handspan2-4-1.png){width=672}\n:::\n:::\n\nMy take is that the sampling distribution of the sample mean for the females is normal enough, therefore the one for the males is also normal enough, therefore the two-sample $t$-test is actually fine.\n\nThe reason that this one is close to normal is different from the other one, though. In the other question, we had milder non-normality but a smaller sample; in this one, the data distribution is less normal, but we had a much larger sample size to compensate.\n\n\n$\\blacksquare$\n\n\n(d) Run Mood's median test. What do you conclude from the test, in the context of the data?\n\nSolution\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(smmr)\nmedian_test(span, handspan, sex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$grand_median\n[1] 21.5\n\n$table\n     above\ngroup above below\n    F    17    82\n    M    65    11\n\n$test\n       what       value\n1 statistic 8.06725e+01\n2        df 1.00000e+00\n3   P-value 2.66404e-19\n```\n\n\n:::\n:::\n\nThe P-value of $2.66 \\times 10^{-19}$ is extremely small, so we\ncan conclude that males and females have different median\nhandspans. Remember that we are now comparing medians, and that\nthis test is *two*-sided. \n\nYou can stop here, or you can go on and note that most of the\nmales have a handspan bigger than the median, and most of the\nfemales have a handspan smaller than the median, so that males\nhave on average a larger handspan. But you have to make the case\nthat males have a larger handspan; you cannot just assert this\nfrom the P-value.\n\nA more formal way to do this is to  make the same observation as\nabove, then note that this is \"on the correct side\" (for males\nto have a larger handspan), and thus that you can halve the\nP-value, and conclude that males' handspans are indeed larger in\nterms of median.\n\nExtra: you are probably expecting a confidence interval now for\nthe difference in medians. I haven't talked about that in lecture, because the ideas are a bit trickier than they were for the confidence interval for the sign test. The sign test could be used for testing any median, so we could try a bunch of medians and see whether each one was rejected or not. The problem with Mood's median test is that it only tests that the medians are *the same*. If you could easily test that the difference in medians was 3, say, you would know whether 3 was inside or outside the confidence interval for the difference in medians.\n\nWhat were the actual sample medians, anyway?\n\n::: {.cell}\n\n```{.r .cell-code}\nspan %>% group_by(sex) %>% \nsummarize(med = median(handspan))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"med\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"F\",\"2\":\"20.0\"},{\"1\":\"M\",\"2\":\"22.5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nHere's an idea: if we shift all the female handspans up by 2.5 inches, the medians would be the same:\n\n::: {.cell}\n\n```{.r .cell-code}\nspan %>% mutate(x = ifelse(sex==\"F\", handspan+2.5, handspan)) -> d\nd\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"handspan\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"x\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"M\",\"2\":\"21.50\",\"3\":\"21.50\"},{\"1\":\"M\",\"2\":\"22.50\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.50\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"20.50\",\"3\":\"23.00\"},{\"1\":\"F\",\"2\":\"20.50\",\"3\":\"23.00\"},{\"1\":\"F\",\"2\":\"20.25\",\"3\":\"22.75\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"24.50\",\"3\":\"24.50\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"26.00\",\"3\":\"26.00\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"F\",\"2\":\"18.00\",\"3\":\"20.50\"},{\"1\":\"M\",\"2\":\"21.50\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"20.50\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"21.50\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"22.00\",\"3\":\"24.50\"},{\"1\":\"M\",\"2\":\"24.50\",\"3\":\"24.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"21.50\",\"3\":\"24.00\"},{\"1\":\"M\",\"2\":\"23.50\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"17.00\",\"3\":\"19.50\"},{\"1\":\"F\",\"2\":\"16.00\",\"3\":\"18.50\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"F\",\"2\":\"22.00\",\"3\":\"24.50\"},{\"1\":\"F\",\"2\":\"22.00\",\"3\":\"24.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.50\",\"3\":\"23.50\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"24.50\",\"3\":\"24.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"21.70\",\"3\":\"24.20\"},{\"1\":\"F\",\"2\":\"22.00\",\"3\":\"24.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"20.25\",\"3\":\"22.75\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"22.00\",\"3\":\"24.50\"},{\"1\":\"F\",\"2\":\"18.00\",\"3\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"19.50\",\"3\":\"19.50\"},{\"1\":\"M\",\"2\":\"22.50\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"20.50\",\"3\":\"20.50\"},{\"1\":\"M\",\"2\":\"21.50\",\"3\":\"21.50\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"21.50\",\"3\":\"21.50\"},{\"1\":\"M\",\"2\":\"25.00\",\"3\":\"25.00\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"22.50\",\"3\":\"25.00\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"20.50\",\"3\":\"23.00\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"22.00\",\"3\":\"24.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"18.00\",\"3\":\"20.50\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"22.50\",\"3\":\"25.00\"},{\"1\":\"F\",\"2\":\"22.50\",\"3\":\"25.00\"},{\"1\":\"M\",\"2\":\"24.00\",\"3\":\"24.00\"},{\"1\":\"M\",\"2\":\"21.50\",\"3\":\"21.50\"},{\"1\":\"M\",\"2\":\"21.50\",\"3\":\"21.50\"},{\"1\":\"M\",\"2\":\"18.00\",\"3\":\"18.00\"},{\"1\":\"M\",\"2\":\"20.00\",\"3\":\"20.00\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"24.00\",\"3\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"25.50\",\"3\":\"25.50\"},{\"1\":\"M\",\"2\":\"24.00\",\"3\":\"24.00\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"22.50\",\"3\":\"25.00\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"13.00\",\"3\":\"15.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"22.50\",\"3\":\"25.00\"},{\"1\":\"F\",\"2\":\"19.50\",\"3\":\"22.00\"},{\"1\":\"F\",\"2\":\"18.50\",\"3\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"17.50\",\"3\":\"20.00\"},{\"1\":\"F\",\"2\":\"18.00\",\"3\":\"20.50\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"19.50\",\"3\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"21.50\",\"3\":\"24.00\"},{\"1\":\"F\",\"2\":\"18.00\",\"3\":\"20.50\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"19.50\",\"3\":\"22.00\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"22.50\",\"3\":\"25.00\"},{\"1\":\"M\",\"2\":\"23.50\",\"3\":\"23.50\"},{\"1\":\"M\",\"2\":\"21.00\",\"3\":\"21.00\"},{\"1\":\"M\",\"2\":\"25.50\",\"3\":\"25.50\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"24.00\",\"3\":\"24.00\"},{\"1\":\"M\",\"2\":\"21.50\",\"3\":\"21.50\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.50\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"18.50\",\"3\":\"18.50\"},{\"1\":\"M\",\"2\":\"21.00\",\"3\":\"21.00\"},{\"1\":\"M\",\"2\":\"24.00\",\"3\":\"24.00\"},{\"1\":\"M\",\"2\":\"23.50\",\"3\":\"23.50\"},{\"1\":\"M\",\"2\":\"24.50\",\"3\":\"24.50\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"24.00\",\"3\":\"24.00\"},{\"1\":\"M\",\"2\":\"24.50\",\"3\":\"24.50\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"18.00\",\"3\":\"20.50\"},{\"1\":\"F\",\"2\":\"22.00\",\"3\":\"24.50\"},{\"1\":\"F\",\"2\":\"18.50\",\"3\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"22.00\",\"3\":\"24.50\"},{\"1\":\"F\",\"2\":\"12.50\",\"3\":\"15.00\"},{\"1\":\"F\",\"2\":\"18.00\",\"3\":\"20.50\"},{\"1\":\"F\",\"2\":\"20.50\",\"3\":\"23.00\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"18.50\",\"3\":\"21.00\"},{\"1\":\"F\",\"2\":\"19.00\",\"3\":\"21.50\"},{\"1\":\"F\",\"2\":\"21.50\",\"3\":\"24.00\"},{\"1\":\"F\",\"2\":\"21.50\",\"3\":\"24.00\"},{\"1\":\"F\",\"2\":\"23.00\",\"3\":\"25.50\"},{\"1\":\"F\",\"2\":\"23.25\",\"3\":\"25.75\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"18.80\",\"3\":\"21.30\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"17.00\",\"3\":\"19.50\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"20.50\",\"3\":\"23.00\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"F\",\"2\":\"19.50\",\"3\":\"22.00\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"21.00\",\"3\":\"23.50\"},{\"1\":\"F\",\"2\":\"20.00\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"20.50\",\"3\":\"20.50\"},{\"1\":\"M\",\"2\":\"24.00\",\"3\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"21.00\",\"3\":\"21.00\"},{\"1\":\"M\",\"2\":\"22.50\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"21.50\",\"3\":\"21.50\"},{\"1\":\"M\",\"2\":\"24.50\",\"3\":\"24.50\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"22.00\",\"3\":\"22.00\"},{\"1\":\"M\",\"2\":\"21.00\",\"3\":\"21.00\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"22.50\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"24.00\",\"3\":\"24.00\"},{\"1\":\"M\",\"2\":\"22.50\",\"3\":\"22.50\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"23.00\",\"3\":\"23.00\"},{\"1\":\"M\",\"2\":\"21.50\",\"3\":\"21.50\"},{\"1\":\"M\",\"2\":\"19.00\",\"3\":\"19.00\"},{\"1\":\"M\",\"2\":\"21.50\",\"3\":\"21.50\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nDataframe `d` has a new column `x` that is the handspan plus 2.5 inches for females, and the unchanged handspan for males. So the median of `x` should be the same for males and females:\n\n::: {.cell}\n\n```{.r .cell-code}\nd %>% group_by(sex) %>% \nsummarize(med_x = median(x))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"sex\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"med_x\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"F\",\"2\":\"22.5\"},{\"1\":\"M\",\"2\":\"22.5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nand also the medians of `x` cannot possibly be significantly different:\n\n::: {.cell}\n\n```{.r .cell-code}\nmedian_test(d, x, sex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$grand_median\n[1] 22.5\n\n$table\n     above\ngroup above below\n    F    46    36\n    M    41    35\n\n$test\n       what      value\n1 statistic 0.07369901\n2        df 1.00000000\n3   P-value 0.78602526\n```\n\n\n:::\n:::\nQuite a lot of the values of `x` are exactly equal to the overall median (and are discarded), so the P-value is not exactly 1 as you would expect. But it is definitely not significant, and so a difference of 2.5 inches smaller for females is going to be in a confidence interval for the difference in medians.\n\nThe strategy now is to try shifting the female handspans by different amounts, run Mood's median test for each one, and see which shifts are not rejected. These are the ones for which that difference in medians would be in the confidence interval. Before we get to that, though, I want to simplify the procedure we have, so that it is easier to run it lots of times. First, let's get just the P-value out of the median test:\n\n::: {.cell}\n\n```{.r .cell-code}\nd.1 <- median_test(d, x, sex)\nd.1 %>% pluck(\"test\", \"value\", 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7860253\n```\n\n\n:::\n:::\n\nThat's the P-value. `pluck` pulls individual things out of bigger things. The variable I called `d.1` has two things in it. The one called `table` has the numbers of data values above and below the overall median; the one called `test` has the test statistic and P-value in it. `test` is a dataframe; inside *that* is a column called `what` and a column called `value` with the number we want in it, and we want the third thing in that (the other two are the chi-squared test statistic and its degrees of freedom). Hence the `pluck` statement got the right thing.\n\nLet's think strategy: we want to shift the female handspans by a bunch of different amounts, run the test on each one, and get the P-value each time. When you're running a big for-each like this, you want the thing you do each time to be as simple as possible. So let's write a function that takes the shift as input, works out the new `x`, runs the test, and returns the P-value. We have all the ingredients, so it's a matter of putting them together:\n\n::: {.cell}\n\n```{.r .cell-code}\nshift_pval <- function(shift) {\n  span %>% mutate(x = ifelse(sex == \"F\", handspan + shift, handspan)) -> d\n  d.1 <- median_test(d, x, sex)\n  d.1 %>% pluck(\"test\", \"value\", 3)\n}\n```\n:::\n\nIn the function, the `shift` is input. The first line computes the handspans shifted by the input amount, whatever it is; the second line runs the median test on the shifted data; the last line pulls out, and returns, the P-value.\n\nI am being a little sloppy here (but R is letting me get away with it): the function is also using a dataframe called `span`, which is the one we read in from the file earlier. That *was not input to the function*, so, if you have experience with other programming languages, you might be wondering whether that is \"in the scope\" of inside the function: that is, whether R will know about it. R does; anything the function needs that is not part of the input, it will take from your workspace. This is, you might imagine, dangerous; if the input to your function is called, say, `x`, you might easily have an `x` lying around in your workspace from some other analysis that has nothing to do with the `x` you want as the input to your function. The safe way to do it, and what I should have done, is to have `span` be input to my function as well. However, that clutters up the discussion below, so we'll leave things as I did them here.\n\nLet's test this on a shift of 2.5 inches, and on the original data (a shift of zero):\n\n::: {.cell}\n\n```{.r .cell-code}\nshift_pval(2.5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7860253\n```\n\n\n:::\n\n```{.r .cell-code}\nshift_pval(0)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.66404e-19\n```\n\n\n:::\n:::\n\nThose are the same P-values we got before, so good.\n\nNow, let's get a bunch of shifts, say from 0 to 5 in steps of 0.5:\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(shift = seq(0, 5, 0.5))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"shift\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.0\"},{\"1\":\"0.5\"},{\"1\":\"1.0\"},{\"1\":\"1.5\"},{\"1\":\"2.0\"},{\"1\":\"2.5\"},{\"1\":\"3.0\"},{\"1\":\"3.5\"},{\"1\":\"4.0\"},{\"1\":\"4.5\"},{\"1\":\"5.0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nwork out the P-value for each one, rowwise: \n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(shift = seq(0, 5, 0.5)) %>%\n  rowwise() %>% \n  mutate(p_value = shift_pval(shift))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"shift\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p_value\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.0\",\"2\":\"2.664040e-19\"},{\"1\":\"0.5\",\"2\":\"7.383053e-15\"},{\"1\":\"1.0\",\"2\":\"6.407439e-09\"},{\"1\":\"1.5\",\"2\":\"5.463857e-05\"},{\"1\":\"2.0\",\"2\":\"5.288111e-02\"},{\"1\":\"2.5\",\"2\":\"7.860253e-01\"},{\"1\":\"3.0\",\"2\":\"5.152925e-03\"},{\"1\":\"3.5\",\"2\":\"1.127859e-05\"},{\"1\":\"4.0\",\"2\":\"1.885053e-09\"},{\"1\":\"4.5\",\"2\":\"1.841319e-14\"},{\"1\":\"5.0\",\"2\":\"1.609545e-18\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nand finally decide whether each shift is inside or outside the CI (because I am too lazy to figure out the scientific notation):\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(shift = seq(0, 5, 0.5)) %>%\n  rowwise() %>% \n  mutate(p_value = shift_pval(shift)) %>% \n  mutate(where = ifelse(p_value<0.05, \"outside\", \"inside\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"shift\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p_value\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"where\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0.0\",\"2\":\"2.664040e-19\",\"3\":\"outside\"},{\"1\":\"0.5\",\"2\":\"7.383053e-15\",\"3\":\"outside\"},{\"1\":\"1.0\",\"2\":\"6.407439e-09\",\"3\":\"outside\"},{\"1\":\"1.5\",\"2\":\"5.463857e-05\",\"3\":\"outside\"},{\"1\":\"2.0\",\"2\":\"5.288111e-02\",\"3\":\"inside\"},{\"1\":\"2.5\",\"2\":\"7.860253e-01\",\"3\":\"inside\"},{\"1\":\"3.0\",\"2\":\"5.152925e-03\",\"3\":\"outside\"},{\"1\":\"3.5\",\"2\":\"1.127859e-05\",\"3\":\"outside\"},{\"1\":\"4.0\",\"2\":\"1.885053e-09\",\"3\":\"outside\"},{\"1\":\"4.5\",\"2\":\"1.841319e-14\",\"3\":\"outside\"},{\"1\":\"5.0\",\"2\":\"1.609545e-18\",\"3\":\"outside\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nThe confidence interval goes from 2 inches to 2.5 inches on this scale. I checked and it goes up to 3 really, except that 3 itself is outside the interval. So let's call it 2 to 3 inches. This means that the median female handspan is between 2 and 3 inches *smaller* than the median male handspan, because we had to shift the female handspans up by that much to make them not significantly different.\n\nYou, of course, would do just the last pipeline; I showed you the steps so you could see what was going on.\n\nThe final observation is that this interval is a long way from containing zero, because the P-value was so tiny. \n\nLet's see how the $t$-interval looks in comparison (two-sided, because we want the confidence interval):\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(handspan~sex, data = span)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  handspan by sex\nt = -10.871, df = 187.92, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group F and group M is not equal to 0\n95 percent confidence interval:\n -3.001496 -2.079466\nsample estimates:\nmean in group F mean in group M \n       20.01699        22.55747 \n```\n\n\n:::\n:::\n\nAlmost exactly the same (except that F is before M). So it made no difference at all whether we did a $t$-test or a Mood's median test, as the bootstrapped sampling distribution suggested.\n\n\n$\\blacksquare$\n\n\n\n\n\n\n",
    "supporting": [
      "mood-median_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}