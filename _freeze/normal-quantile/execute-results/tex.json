{
  "hash": "15a9316732344ab67efcd1cc784dc98b",
  "result": {
    "engine": "knitr",
    "markdown": "# Normal quantile plots\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n##  Lengths of heliconia flowers\n\n\n The tropical flower *Heliconia* is\nfertilized by hummingbirds, a different species for each variety of\nHeliconia. Over time, the lengths of the flowers and the form of the\nhummingbirds' beaks have evolved to match each other. The length of\nthe Heliconia flower is therefore an important measurement. Does it\nhave a normal distribution for each variety?\n\nThe data set at\n[http://ritsokiguess.site/datafiles/heliconia.csv](http://ritsokiguess.site/datafiles/heliconia.csv) contains\nthe lengths (in millimetres) of samples of flowers from each of three\nvarieties of Heliconia: *bihai*, *caribaea* red, and\n*caribaea* yellow.\n\n\n\n(a) Read the data into R. There are different numbers of length\nmeasurements for each variety. How does this show up in the data\nframe? (Look at all the rows, not just the first ten.)\n\n\n\n(b) Make a normal quantile plot for the variety\n*bihai*. \n\n\n\n(c) Make a normal quantile plot for the variety\n*Caribaea* red (note that the variable name in the data\nframe has an underscore in it).\n\n\n\n(d) Make a normal quantile plot for the variety\n*Caribaea* yellow (this also has an underscore in it).\n\n\n\n(e) Which of the three varieties is closest to having a normal\ndistribution? Explain (very) briefly.\n\n\n\n(f) For each of the two other varieties, apart from the one you\nmentioned in the last part, describe briefly how their distributions fail\nto be normal.\n\n\n\n\n\n\n\n## Ferritin and normality\n\n\n\n In the lecture notes, we looked at some\ndata on different athletes from the Australian Institute of\nSport. This data set can be found at\n[http://ritsokiguess.site/datafiles/ais.txt](http://ritsokiguess.site/datafiles/ais.txt). Recall that the\nvalues are separated by *tabs*.  In this question, we will assess\none of the variables in the data set for normality.\n\n\n\n(a) Read the data set into R. \n  \n\n\n(b) One of the variables, `Ferr`, is a measurement of\nFerritin for each athlete. Obtain a normal quantile plot of the\nFerritin values, for all the athletes together. What do you\nconclude about the shape of the distribution? Explain briefly.\n  \n\n\n(c) It is possible that the shape you found in the previous\npart is because the athletes from all the different sports were\nmixed together. Use `ggplot` to obtain one normal quantile\nplot for each sport, collected together on one plot. \n  \n\n\n(d) Looking at the plots in the previous part, would you say\nthat the Ferritin values for each sport individually have a more\nnormal shape than they do for all the sports together? Explain\nbriefly. \n  \n\n\n\n\n\n\n\nMy solutions follow:\n\n\n\n\n##  Lengths of heliconia flowers\n\n\n The tropical flower *Heliconia* is\nfertilized by hummingbirds, a different species for each variety of\nHeliconia. Over time, the lengths of the flowers and the form of the\nhummingbirds' beaks have evolved to match each other. The length of\nthe Heliconia flower is therefore an important measurement. Does it\nhave a normal distribution for each variety?\n\nThe data set at\n[http://ritsokiguess.site/datafiles/heliconia.csv](http://ritsokiguess.site/datafiles/heliconia.csv) contains\nthe lengths (in millimetres) of samples of flowers from each of three\nvarieties of Heliconia: *bihai*, *caribaea* red, and\n*caribaea* yellow.\n\n\n\n(a) Read the data into R. There are different numbers of length\nmeasurements for each variety. How does this show up in the data\nframe? (Look at all the rows, not just the first ten.)\n\n\nSolution\n\n\nThe usual `read_csv`:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/heliconia.csv\"\nheliconia <- read_csv(my_url)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 23 Columns: 3\n-- Column specification --------------------------------------------------------\nDelimiter: \",\"\ndbl (3): bihai, caribaea_red, caribaea_yellow\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\nI suggested to look at *all* the rows. Here's why:\n\n::: {.cell}\n\n```{.r .cell-code}\nheliconia \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 23 x 3\n   bihai caribaea_red caribaea_yellow\n   <dbl>        <dbl>           <dbl>\n 1  47.1         41.9            36.8\n 2  46.8         42.0            37.0\n 3  46.8         41.9            36.5\n 4  47.1         43.1            36.1\n 5  46.7         41.5            36.0\n 6  47.4         41.7            35.4\n 7  46.4         39.8            38.1\n 8  46.6         40.6            37.1\n 9  48.1         39.6            35.2\n10  48.3         42.2            36.8\n# i 13 more rows\n```\n\n\n:::\n:::\n\nThe varieties with fewer values have missings (NAs) attached to the\nend. This is because all the columns in a data frame have to have the\nsame number of values. (The missings won't impact what we do below ---\nwe get a warning but not an error, and the plots are the same as they\nwould be without the missings --- but you might be aesthetically\noffended by them, in which case you can read what I do later on.)\n\n$\\blacksquare$\n\n(b) Make a normal quantile plot for the variety\n*bihai*. \n\n\nSolution\n\n\nThere's a certain amount of repetitiveness here (that we work\naround later):\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(heliconia,aes(sample=bihai))+stat_qq()+stat_qq_line()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 7 rows containing non-finite outside the scale range\n(`stat_qq()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 7 rows containing non-finite outside the scale range\n(`stat_qq_line()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](normal-quantile_files/figure-pdf/heliconia-3-1.pdf){fig-pos='H'}\n:::\n:::\n\nI'm saving the comments until we've seen all three, other than to say that the warning here is the missing values we found above.\n\n$\\blacksquare$\n\n(c) Make a normal quantile plot for the variety\n*Caribaea* red (note that the variable name in the data\nframe has an underscore in it).\n\n\nSolution\n\n          \nSame idea again:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(heliconia,aes(sample=caribaea_red))+stat_qq()+stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](normal-quantile_files/figure-pdf/heliconia-4-1.pdf){fig-pos='H'}\n:::\n:::\n\n$\\blacksquare$\n\n(d) Make a normal quantile plot for the variety\n*Caribaea* yellow (this also has an underscore in it).\n\n\nSolution\n\n\nAnd, one more time:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(heliconia,aes(sample=caribaea_yellow))+stat_qq()+stat_qq_line()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing non-finite outside the scale range\n(`stat_qq()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 8 rows containing non-finite outside the scale range\n(`stat_qq_line()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](normal-quantile_files/figure-pdf/heliconia-5-1.pdf){fig-pos='H'}\n:::\n:::\n\nI did a lot of copying and pasting there. (The warning is missing values again.)\n\n$\\blacksquare$\n\n(e) Which of the three varieties is closest to having a normal\ndistribution? Explain (very) briefly.\n\n\nSolution\n\n\nLook at the three plots, and see which one stays closest to the\nline. To my mind, this is clearly the last one, *Caribaea*\nyellow. So your answer ought to be \"*Caribaea* yellow,     because the points are closest to the line\". \nThis, I would say,\nis acceptably close to normal, so using a $t$-test here would be fine.\nThe answer \"the last one\" is not quite complete, because I\nasked you which *variety*, so your answer needs to name a variety.\n\n$\\blacksquare$\n\n(f) For each of the two other varieties, apart from the one you\nmentioned in the last part, describe briefly how their distributions fail\nto be normal.\n\n\nSolution\n\n\nLet's look at *bihai* first. I see this one as an almost\nclassic curve: the points are above the line, then below, then\nabove again. If you look at the data scale ($y$-axis), the points\nare too bunched up to be normal at the bottom, and too spread out\nat the top: that is, skewed to the *right*.\nYou might also (reasonably) take the view that the points at the\nbottom are close to the line (not sure about the very smallest\none, though), but the points at the top are farther away, so that\nwhat we have here is two outliers at the top. I'm OK with that.\nIt's often difficult to distinguish between skewness and outliers\n(at the end of the long tail). What you conclude can often depend\non how you look.\nWe also had to look at the second plot, *caribaea*\nred. This is a rather strange one: the points veer away from the\nline at the ends, but look carefully: it is *not* outliers\nat both ends, but rather the points are *too bunched up* to\nbe normal at both ends: that is, the distribution has *short     tails* \ncompared to the normal. It is something more like a\nuniform distribution, which has no tails at all, than a normal\ndistribution, which won't have outliers but it *does* have\nsome kind of tails. So, \"short tails\". \n\nExtra: that's all you needed, but I mentioned above that you might have\nbeen offended aesthetically by those missing values that were not\nreally missing. Let's see if we can do this aesthetically. As you\nmight expect, it uses several of the tools from the \"tidyverse\", some of which you will see later, but are getting an introduction to now.\n\nFirst, tidy the data. The three columns of the data frame are all\nlengths, just lengths of different things, which need to be\nlabelled. This is `pivot_longer` from `tidyr`:\n\n::: {.cell}\n\n```{.r .cell-code}\nheliconia %>% \n  pivot_longer(everything(), names_to=\"variety\", values_to=\"length\", \n               values_drop_na = TRUE) -> heliconia.long\nheliconia.long  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 54 x 2\n   variety         length\n   <chr>            <dbl>\n 1 bihai             47.1\n 2 caribaea_red      41.9\n 3 caribaea_yellow   36.8\n 4 bihai             46.8\n 5 caribaea_red      42.0\n 6 caribaea_yellow   37.0\n 7 bihai             46.8\n 8 caribaea_red      41.9\n 9 caribaea_yellow   36.5\n10 bihai             47.1\n# i 44 more rows\n```\n\n\n:::\n:::\n\nThis is now aesthetic as well as tidy: all those `NA` lines\nhave gone (you can check that \nthere are now $16+23+15=54$ rows of actual data, as there should be). This was accomplished by the last thing in the `pivot_longer`: \"in the values (that is, the lengths), drop any missing values.\"\n\nNow, how to get a normal quantile plot for each variety? This is\n`facet_wrap` on the end of the `ggplot` again. \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(heliconia.long, aes(sample=length)) + \n  stat_qq() + stat_qq_line() + \n  facet_wrap(~variety, scales=\"free\")\n```\n\n::: {.cell-output-display}\n![](normal-quantile_files/figure-pdf/heliconia-7-1.pdf){fig-pos='H'}\n:::\n:::\n\nThese are a bit elongated vertically. The `scales=\"free\"` allows\na different vertical scale for each plot (otherwise there would be one\nvertical scale for all three plots); I decided that was best here\nsince the typical lengths for the three varieties are\ndifferent. *Caribaea* yellow is more or less straight,\n*bihai*  has outliers (and may also be curved), *caribaea*\nred has that peculiar S-bend shape.\n\nI didn't really like the vertical elongation. I'd rather have the\nplots be almost square, which they would be if we put them in three\ncells of a $2 \\times 2$ grid. `facet_wrap` has `nrow`\nand `ncol` which you can use one or both of to make this\nhappen. This creates an array of plots with two columns and as many\nrows as needed:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(heliconia.long, aes(sample=length)) + \n  stat_qq() + stat_qq_line() + \n  facet_wrap(~variety, scales=\"free\", ncol=2)\n```\n\n::: {.cell-output-display}\n![](normal-quantile_files/figure-pdf/heliconia-8-1.pdf){fig-pos='H'}\n:::\n:::\n\nI think the squarer plots make it easier to see the shape of these:\ncurved, S-bend, straightish.\nAlmost the same code will get a histogram for each variety, which I'll\nalso make squarish:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(heliconia.long, aes(x = length)) + \n  geom_histogram(bins = 5) + facet_wrap(~variety, scales = \"free\", ncol=2)\n```\n\n::: {.cell-output-display}\n![](normal-quantile_files/figure-pdf/heliconia-9-1.pdf){fig-pos='H'}\n:::\n:::\n\n*bihai* has those two outliers, *caribaea* red has no tails\nto speak of (or you might say \"it's bimodal\", which would be another\nexplanation of the pattern on the normal quantile \nplot^[If you  have studied a thing called kurtosis, the fourth moment about  the mean, you'll know that this measures *both* tail length  *and* peakedness, so a short-tailed distribution also has a  strong peak. Or, maybe, in this case, two strong peaks.]) and\n*caribaea* yellow is shoulder-shruggingly normal (I looked at\nthat and said, \"well, I *guess* it's normal\".)  After you've\nlooked at the normal quantile plots, you see what a crude tool a\nhistogram is for assessing normality.\n\n$\\blacksquare$\n\n\n\n\n\n## Ferritin and normality\n\n\n\n In the lecture notes, we looked at some\ndata on different athletes from the Australian Institute of\nSport. This data set can be found at\n[http://ritsokiguess.site/datafiles/ais.txt](http://ritsokiguess.site/datafiles/ais.txt). Recall that the\nvalues are separated by *tabs*.  In this question, we will assess\none of the variables in the data set for normality.\n\n\n\n(a) Read the data set into R. \n  \n\nSolution\n\n\n`read_tsv` is the right thing:\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url=\"http://ritsokiguess.site/datafiles/ais.txt\"\nathletes=read_tsv(my_url)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 202 Columns: 13\n-- Column specification --------------------------------------------------------\nDelimiter: \"\\t\"\nchr  (2): Sex, Sport\ndbl (11): RCC, WCC, Hc, Hg, Ferr, BMI, SSF, %Bfat, LBM, Ht, Wt\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nathletes\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 202 x 13\n   Sex    Sport     RCC   WCC    Hc    Hg  Ferr   BMI   SSF `%Bfat`   LBM    Ht\n   <chr>  <chr>   <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>   <dbl> <dbl> <dbl>\n 1 female Netball  4.56  13.3  42.2  13.6    20  19.2  49      11.3  53.1  177.\n 2 female Netball  4.15   6    38    12.7    59  21.2 110.     25.3  47.1  173.\n 3 female Netball  4.16   7.6  37.5  12.3    22  21.4  89      19.4  53.4  176 \n 4 female Netball  4.32   6.4  37.7  12.3    30  21.0  98.3    19.6  48.8  170.\n 5 female Netball  4.06   5.8  38.7  12.8    78  21.8 122.     23.1  56.0  183 \n 6 female Netball  4.12   6.1  36.6  11.8    21  21.4  90.4    16.9  56.4  178.\n 7 female Netball  4.17   5    37.4  12.7   109  21.5 107.     21.3  53.1  177.\n 8 female Netball  3.8    6.6  36.5  12.4   102  24.4 157.     26.6  54.4  174.\n 9 female Netball  3.96   5.5  36.3  12.4    71  22.6 101.     17.9  56.0  174.\n10 female Netball  4.44   9.7  41.4  14.1    64  22.8 126.     25.0  51.6  174.\n# i 192 more rows\n# i 1 more variable: Wt <dbl>\n```\n\n\n:::\n:::\n\nI listed the data to check that I had it right, but I didn't ask you\nto. (If you didn't have it right, that will show up soon enough.)\n  \n$\\blacksquare$\n\n(b) One of the variables, `Ferr`, is a measurement of\nFerritin for each athlete. Obtain a normal quantile plot of the\nFerritin values, for all the athletes together. What do you\nconclude about the shape of the distribution? Explain briefly.\n  \n\nSolution\n\n\nAs you would expect:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(athletes, aes(sample=Ferr))+\nstat_qq()+stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](normal-quantile_files/figure-pdf/aus-qq-2-1.pdf){fig-pos='H'}\n:::\n:::\n\nThis is almost a classic right skew: the values are too bunched up at\nthe bottom and too spread out at the top. The curved shape should be\nmaking you think \"skewed\" and then you can work out which way it's\nskewed. \n  \n$\\blacksquare$\n\n(c) It is possible that the shape you found in the previous\npart is because the athletes from all the different sports were\nmixed together. Use `ggplot` to obtain one normal quantile\nplot for each sport, collected together on one plot. \n  \n\nSolution\n\n\nYour previous plot had all the sports mixed together. To that\nyou add something that will put each sport in its own facet:\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(athletes,aes(sample=Ferr))+stat_qq()+stat_qq_line()+\nfacet_wrap(~Sport)\n```\n\n::: {.cell-output-display}\n![](normal-quantile_files/figure-pdf/aus-qq-3-1.pdf){fig-pos='H'}\n:::\n:::\n  \n$\\blacksquare$\n\n(d) Looking at the plots in the previous part, would you say\nthat the Ferritin values for each sport individually have a more\nnormal shape than they do for all the sports together? Explain\nbriefly. \n  \n\nSolution\n\n\nThere are a couple of ways you can go, and as ever I'm looking\nmostly for consistency of argument. The two major directions you\ncan go are (i) most of these plots are still curved the same way\nas the previous one, and (ii) they are mostly straighter than\nthey were before.\nPossible lines of argument include that pretty much all of these\nplots are right-skewed still, with the same upward-opening\ncurve. Pretty much the only one that doesn't is Gymnastics, for\nwhich there are only four observations, so you can't really\ntell. So, by this argument, Ferritin just *does* have a\nright-skewed distribution, and breaking things out by sport\ndoesn't make much difference to that.\nOr, you could go another way and say that the plot of all the\ndata together was *very* curved, and these plots are much\nless curved, that is to say, much less skewed. Some of them,\nsuch as basketball and netball, are almost straight, and they\nare almost normally distributed. Some of the distributions, such\nas track sprinting (`TSprnt`), are definitely still\nright-skewed, but not as seriously so as before.\nDecide what you think and then discuss how you see it.\n  \n$\\blacksquare$\n\n\n\n",
    "supporting": [
      "normal-quantile_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}