<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>39&nbsp; Multidimensional Scaling – Problems and Solutions in Applied Statistics (2nd ed)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./pc.html" rel="next">
<link href="./maps.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./mds.html"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Multidimensional Scaling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Problems and Solutions in Applied Statistics (2nd ed)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_used.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting used to R and R Studio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reading-in.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reading in data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./making-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Drawing graphs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-summaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data exploration</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./working-with-dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Working with dataframes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./one-sample-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">One-sample inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-sample-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Two-sample inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Power and sample size</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The sign test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mood-median.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Mood median test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matched-pairs-sign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Matched pairs t and sign test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Normal quantile plots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis-of-variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Analysis of variance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing reports</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Learning to code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dandruff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Treating dandruff</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidying-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Tidying data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Simple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Multiple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Regression with categorical variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dates-and-times.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Dates and times</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vector-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Vector and matrix algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Bootstrap</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Bayesian Statistics with Stan</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-revisited.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Regression revisited</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ordinal-response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Logistic regression with ordinal response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nominal-response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Logistic regression with nominal response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Survival analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova-revisited.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Analysis of variance revisited</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Analysis of covariance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Multivariate analysis of variance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Repeated measures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discriminant-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Discriminant analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Hierarchical cluster analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kmeans-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">K-means cluster analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Drawing maps with Leaflet</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mds.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Principal Components</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Factor Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loglin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Frequency table analysis</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#making-a-map-of-wisconsin" id="toc-making-a-map-of-wisconsin" class="nav-link active" data-scroll-target="#making-a-map-of-wisconsin"><span class="header-section-number">39.1</span> Making a map of Wisconsin</a></li>
  <li><a href="#things-that-feel-similar-to-each-other" id="toc-things-that-feel-similar-to-each-other" class="nav-link" data-scroll-target="#things-that-feel-similar-to-each-other"><span class="header-section-number">39.2</span> Things that feel similar to each other</a></li>
  <li><a href="#confusing-letters" id="toc-confusing-letters" class="nav-link" data-scroll-target="#confusing-letters"><span class="header-section-number">39.3</span> Confusing letters</a></li>
  <li><a href="#more-beer-please" id="toc-more-beer-please" class="nav-link" data-scroll-target="#more-beer-please"><span class="header-section-number">39.4</span> More beer please</a></li>
  <li><a href="#feeling-similar-again" id="toc-feeling-similar-again" class="nav-link" data-scroll-target="#feeling-similar-again"><span class="header-section-number">39.5</span> Feeling similar, again</a></li>
  <li><a href="#making-a-map-of-wisconsin-1" id="toc-making-a-map-of-wisconsin-1" class="nav-link" data-scroll-target="#making-a-map-of-wisconsin-1"><span class="header-section-number">39.6</span> Making a map of Wisconsin</a></li>
  <li><a href="#things-that-feel-similar-to-each-other-1" id="toc-things-that-feel-similar-to-each-other-1" class="nav-link" data-scroll-target="#things-that-feel-similar-to-each-other-1"><span class="header-section-number">39.7</span> Things that feel similar to each other</a></li>
  <li><a href="#confusing-letters-1" id="toc-confusing-letters-1" class="nav-link" data-scroll-target="#confusing-letters-1"><span class="header-section-number">39.8</span> Confusing letters</a></li>
  <li><a href="#more-beer-please-1" id="toc-more-beer-please-1" class="nav-link" data-scroll-target="#more-beer-please-1"><span class="header-section-number">39.9</span> More beer please</a></li>
  <li><a href="#feeling-similar-again-1" id="toc-feeling-similar-again-1" class="nav-link" data-scroll-target="#feeling-similar-again-1"><span class="header-section-number">39.10</span> Feeling similar, again</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Multidimensional Scaling</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Packages for this chapter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbiplot)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="making-a-map-of-wisconsin" class="level2" data-number="39.1">
<h2 data-number="39.1" class="anchored" data-anchor-id="making-a-map-of-wisconsin"><span class="header-section-number">39.1</span> Making a map of Wisconsin</h2>
<p>The file <a href="http://ritsokiguess.site/datafiles/wisconsin.txt">link</a> contains the road distances (in miles) between 12 cities in Wisconsin and neighbouring states. We are going to try to reproduce a map of the area using multidimensional scaling.</p>
<ol type="a">
<li><p>Read in the data and create a <code>dist</code> object, bearing in mind that the data in the file are already distances. Display your <code>dist</code> object. Probably, displaying the data that you read in is a good idea also.</p></li>
<li><p>Obtain a vector containing the city names. (This is easy, and not really necessary, but it was here before when I did things a different way.)</p></li>
<li><p>Run a (metric) multidimensional scaling on the data, to obtain a two-dimensional representation of the cities. (You don’t need to look at the results yet.)</p></li>
<li><p>Plot the results of the multidimensional scaling, labelling the cities with their names. Use your judgement to decide where to place the city names, and how to make sure the whole city names are shown on the map.</p></li>
<li><p>Are cities close together on your map also close together in real life? Give an example or two.</p></li>
<li><p>Obtain a Google (or other) map of the area containing these twelve cities. (The way I expected you to do this when this was a hand-in problem was to take a screenshot or similar and include that in your document.)</p></li>
<li><p>Discuss how the map that came out of the multidimensional scaling corresponds to the actual (Google) map.</p></li>
<li><p>Calculate something that demonstrates that a one-dimensional map of the cities is a much worse representation than the two-dimensional one that we made before. (I’m planning to get to this in class, but if we skip it, don’t worry about this part.)</p></li>
</ol>
</section>
<section id="things-that-feel-similar-to-each-other" class="level2" data-number="39.2">
<h2 data-number="39.2" class="anchored" data-anchor-id="things-that-feel-similar-to-each-other"><span class="header-section-number">39.2</span> Things that feel similar to each other</h2>
<p>Which objects feel similar to one another and which ones feel different? Can we draw them on a “map”? 30 subjects<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> were each given 17 different objects to feel, for example “inner surface of pine bark”, “rubber eraser” and “nylon scouring pad”. The subjects had to group the objects into a maximum of 8 groups such that the objects within a group felt similar, and the ones in different groups felt different.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> A dissimilarity matrix was formed by counting how many subjects put each pair of objects into <em>different</em> groups, so that the dissimilarity ranged from 0 (the objects were always put together in the same group) to 30 (the objects were not put together into the same group by any of the subjects).</p>
<p>The data are in <a href="http://ritsokiguess.site/datafiles/stimuli.txt">link</a>.</p>
<ol type="a">
<li><p>Look at the data, and read in the file appropriately. Do you have something square in shape, apart from any columns of object names? Do your columns have the same names as the objects?</p></li>
<li><p>Obtain the names of the objects. Note that they are rather long.</p></li>
<li><p>Set the column names of your data frame to be your object names, using <code>names</code>. Before you rush to do that, figure out how many column names you need, and supply values for any extra ones. Check that your data frame now has the right column names.</p></li>
<li><p><a name="part:distances">*</a><br>
Convert your data frame into a distance object. Take a look at the (rather long) result.</p></li>
<li><p>Obtain and plot a (metric) multidimensional scaling map of these data. Label the points with the name of the object they represent. (Note that <code>geom_text_repel</code> has an option <code>size</code> that controls the size of the text.)</p></li>
<li><p>Find a pair of objects that are close together on your plot. Look back at your answer to part~(<a href="#part:distances">here</a>): is the distance between those objects small? Explain briefly.</p></li>
<li><p>Obtain a measure of goodness of fit for this multidimensional scaling map.</p></li>
<li><p>Obtain a cluster analysis for the same data, using Ward’s method. Obtain a dendrogram. What seems to be an appropriate number of clusters? Mark them on your dendrogram too.</p></li>
<li><p>Discuss as briefly as seems reasonable whether your clusters tell the same story as the map that came from multidimensional scaling. (There were only three marks for this, so you don’t need to go overboard.) Optionally, think about creating a plot that will make it easier to see the correspondence between your clusters and the MDS map.</p></li>
</ol>
</section>
<section id="confusing-letters" class="level2" data-number="39.3">
<h2 data-number="39.3" class="anchored" data-anchor-id="confusing-letters"><span class="header-section-number">39.3</span> Confusing letters</h2>
<p>Two researchers studied how often people mistook one letter for another one. They did this by showing their subjects each (uppercase) letter for a few milliseconds only, and asking them which letter (out of a list) they just saw. The researchers obtain a “confusion matrix” in which, for example, the W-Q entry is the total of W’s taken as Q and Q’s taken as W. This confusion matrix is in <a href="http://ritsokiguess.site/datafiles/letterrec.txt">link</a>. Note that the confusions are actually <em>similarities</em> rather than dissimilarities: a large number means that the two letters concerned are easily confused, that is, similar. Similarities can be converted to dissimilarities by subtracting them from a larger number than anything in the table (that is, subtracting from 21 is good here).</p>
<ol type="a">
<li><p>Read in the confusion matrix and convert it to dissimilarities and then to a <code>dist</code> object, displaying the <code>dist</code> object that you obtain.</p></li>
<li><p>Run a multidimensional scaling, with the default two dimensions, on your <code>dist</code> object, and display the results. (Making a graph is coming later.)</p></li>
<li><p>Obtain a vector of the names of the letters that were confused in this study.</p></li>
<li><p>Plot your multidimensional scaling map. To do this, first create a data frame containing the points you want to plot and their labels, and then plot the points labelled by the right thing.</p></li>
<li><p>Pick a pair of letters appear close together on your map. Does it make sense, from looking at these letters, that they would be easy to confuse? Explain briefly.</p></li>
<li><p>Verify that your chosen pair of letters was often confused in the data.</p></li>
</ol>
</section>
<section id="more-beer-please" class="level2" data-number="39.4">
<h2 data-number="39.4" class="anchored" data-anchor-id="more-beer-please"><span class="header-section-number">39.4</span> More beer please</h2>
<p>Previously, you did a cluster analysis of ten brands of beer, as rated by 32 students. This time, we will do a non-metric multidimensional scaling of those same brands of beer. The data are in <a href="http://ritsokiguess.site/datafiles/beer.txt">link</a>.</p>
<ol type="a">
<li><p>Noting that we want to assess distances between brands of beer, read in the data and do whatever you need to do to work out distances between the beers. Show your result.</p></li>
<li><p>Obtain a non-metric multidimensional scaling of the beers. (Comment coming up in a moment.)</p></li>
<li><p>Obtain the <code>stress</code> value of the map, and comment on it.</p></li>
<li><p>Obtain a map of the beers, labelled with the names of the beers.</p></li>
<li><p>Find a pair of beers close together on your map. Are they similar in terms of student ratings? Explain briefly.</p></li>
<li><p>In our cluster analysis, we found that Anchor Steam, Pete’s Wicked Ale, Guinness and Sierra Nevada were all in the same cluster. Would you expect them to be close together on your map? Are they? Explain briefly.</p></li>
</ol>
</section>
<section id="feeling-similar-again" class="level2" data-number="39.5">
<h2 data-number="39.5" class="anchored" data-anchor-id="feeling-similar-again"><span class="header-section-number">39.5</span> Feeling similar, again</h2>
<p>Previously, we looked at an experiment about which objects feel similar to one another and which ones feel different.</p>
<p>30 subjects were each given 17 different objects to feel, for example “inner surface of pine bark”, “rubber eraser” and “nylon scouring pad”. The subjects had to group the objects into a maximum of 8 groups such that the objects within a group felt similar, and the ones in different groups felt different. A dissimilarity matrix was formed by counting how many subjects put each pair of objects into <em>different</em> groups, so that the dissimilarity ranged from 0 (the objects were always put together in the same group) to 30 (the objects were not put together into the same group by any of the subjects).</p>
<p>The data are in <a href="http://ritsokiguess.site/datafiles/stimuli.txt">link</a>. These have <em>no</em> column names.</p>
<p>This time we are going to try <em>non-metric</em> multidimensional scaling, to see whether that produces a more reasonable map. The reading in of the data is the same as before (so I have reduced the marks given for it).</p>
<ol type="a">
<li><p>Obtain and display the distance matrix that you used last time for these data. (I don’t care whether you run all the code again, or whether you just produce the matrix from where you had it before on R Studio. Correct is all I care about.)</p></li>
<li><p>Obtain a non-metric multidimensional scaling map of the objects. (No plotting or comments yet.)</p></li>
<li><p><a name="part:stress">*</a> Obtain a number that says how well the map reproduces the distances in the data, and comment on that number.</p></li>
<li><p>Plot the non-metric multidimensional scaling map. Label each point with its (full) object name, sized suitably.</p></li>
<li><p><a name="part:incons">*</a> Find all the distances in your distance matrix that are 10 or less (there should be three of them). Find these pairs of objects on your map. Describe where they are on your map. Do they appear to be the three closest pairs of objects?</p></li>
<li><p>Consider again your conclusions in parts (<a href="#part:stress">here</a>) and (<a href="#part:incons">here</a>). Explain briefly how they are consistent.</p></li>
<li><p>Would a three-dimensional map work better than a two-dimensional one, bearing in mind that a three-dimensional map will need something like <code>rgl</code> to interpret? Calculate something that will help you decide, and explain what you think.</p></li>
</ol>
<p>My solutions follow:</p>
</section>
<section id="making-a-map-of-wisconsin-1" class="level2" data-number="39.6">
<h2 data-number="39.6" class="anchored" data-anchor-id="making-a-map-of-wisconsin-1"><span class="header-section-number">39.6</span> Making a map of Wisconsin</h2>
<p>The file <a href="http://ritsokiguess.site/datafiles/wisconsin.txt">link</a> contains the road distances (in miles) between 12 cities in Wisconsin and neighbouring states. We are going to try to reproduce a map of the area using multidimensional scaling.</p>
<ol type="a">
<li>Read in the data and create a <code>dist</code> object, bearing in mind that the data in the file are already distances. Display your <code>dist</code> object. Probably, displaying the data that you read in is a good idea also.</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/wisconsin.txt"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>wisc <span class="ot">&lt;-</span> <span class="fu">read_table</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
── Column specification ────────────────────────────────────────────────────────
cols(
  location = col_character(),
  Appleton = col_double(),
  Beloit = col_double(),
  Fort.Atkinson = col_double(),
  Madison = col_double(),
  Marshfield = col_double(),
  Milwaukee = col_double(),
  Monroe = col_double(),
  Superior = col_double(),
  Wausau = col_double(),
  Dubuque = col_double(),
  St.Paul = col_double(),
  Chicago = col_double()
)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>wisc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["location"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Appleton"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Beloit"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Fort.Atkinson"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Madison"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Marshfield"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Milwaukee"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Monroe"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Superior"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Wausau"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Dubuque"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["St.Paul"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Chicago"],"name":[13],"type":["dbl"],"align":["right"]}],"data":[{"1":"Appleton","2":"0","3":"130","4":"98","5":"102","6":"103","7":"100","8":"149","9":"315","10":"91","11":"196","12":"257","13":"186"},{"1":"Beloit","2":"130","3":"0","4":"33","5":"50","6":"185","7":"73","8":"33","9":"377","10":"186","11":"94","12":"304","13":"97"},{"1":"Fort.Atkinson","2":"98","3":"33","4":"0","5":"36","6":"164","7":"54","8":"58","9":"359","10":"166","11":"119","12":"287","13":"113"},{"1":"Madison","2":"102","3":"50","4":"36","5":"0","6":"138","7":"77","8":"47","9":"330","10":"139","11":"95","12":"258","13":"146"},{"1":"Marshfield","2":"103","3":"185","4":"164","5":"138","6":"0","7":"184","8":"170","9":"219","10":"45","11":"186","12":"161","13":"276"},{"1":"Milwaukee","2":"100","3":"73","4":"54","5":"77","6":"184","7":"0","8":"107","9":"394","10":"181","11":"168","12":"322","13":"92"},{"1":"Monroe","2":"149","3":"33","4":"58","5":"47","6":"170","7":"107","8":"0","9":"362","10":"186","11":"61","12":"289","13":"130"},{"1":"Superior","2":"315","3":"377","4":"359","5":"330","6":"219","7":"394","8":"362","9":"0","10":"223","11":"351","12":"162","13":"467"},{"1":"Wausau","2":"91","3":"186","4":"166","5":"139","6":"45","7":"181","8":"186","9":"223","10":"0","11":"215","12":"175","13":"275"},{"1":"Dubuque","2":"196","3":"94","4":"119","5":"95","6":"186","7":"168","8":"61","9":"351","10":"215","11":"0","12":"274","13":"184"},{"1":"St.Paul","2":"257","3":"304","4":"287","5":"258","6":"161","7":"322","8":"289","9":"162","10":"175","11":"274","12":"0","13":"395"},{"1":"Chicago","2":"186","3":"97","4":"113","5":"146","6":"276","7":"93","8":"130","9":"467","10":"275","11":"184","12":"395","13":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The first time I did this, I had a blank line on the end of the data file, so I had a blank <code>location</code> and missing values for all the distances for it. I tidied that up before sharing the file with you, though.</p>
<p>So, the first column is the names of the places, which we should get rid of before we make a <code>dist</code> object using <code>as.dist</code> (since what we read in is already distances). The columns are also the names of the places, so we won’t lose anything by getting rid of the <code>location</code> column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> wisc <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>location) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.dist</span>()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Appleton Beloit Fort.Atkinson Madison Marshfield Milwaukee Monroe
Beloit             130                                                         
Fort.Atkinson       98     33                                                  
Madison            102     50            36                                    
Marshfield         103    185           164     138                            
Milwaukee          100     73            54      77        184                 
Monroe             149     33            58      47        170       107       
Superior           315    377           359     330        219       394    362
Wausau              91    186           166     139         45       181    186
Dubuque            196     94           119      95        186       168     61
St.Paul            257    304           287     258        161       322    289
Chicago            186     97           113     146        276        93    130
              Superior Wausau Dubuque St.Paul
Beloit                                       
Fort.Atkinson                                
Madison                                      
Marshfield                                   
Milwaukee                                    
Monroe                                       
Superior                                     
Wausau             223                       
Dubuque            351    215                
St.Paul            162    175     274        
Chicago            467    275     184     395</code></pre>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Obtain a vector containing the city names. (This is easy, and not really necessary, but it was here before when I did things a different way.)</li>
</ol>
<p>Solution</p>
<p>The <code>location</code> column of the data frame you read in from the file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cities <span class="ot">&lt;-</span> wisc<span class="sc">$</span>location</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Appleton"      "Beloit"        "Fort.Atkinson" "Madison"      
 [5] "Marshfield"    "Milwaukee"     "Monroe"        "Superior"     
 [9] "Wausau"        "Dubuque"       "St.Paul"       "Chicago"      </code></pre>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>Run a (metric) multidimensional scaling on the data, to obtain a two-dimensional representation of the cities. (You don’t need to look at the results yet.)</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>wisc<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Plot the results of the multidimensional scaling, labelling the cities with their names. Use your judgement to decide where to place the city names, and how to make sure the whole city names are shown on the map.</li>
</ol>
<p>Solution</p>
<p>Let’s see what <code>wisc.1</code> has in it, and make a data frame of the right thing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wisc<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    [,1]       [,2]
Appleton       -13.37076  85.067148
Beloit         -92.94157 -20.205916
Fort.Atkinson  -74.07473   4.804039
Madison        -44.68148 -11.252521
Marshfield      80.61250  27.097882
Milwaukee     -102.87582  49.849552</code></pre>
</div>
</div>
<p>Two unnamed columns (the display indicates that it’s a <code>matrix</code> rather than a data frame). As we saw in class, if we make a data frame out of this, the columns will get names <code>X1</code> and <code>X2</code>. Those are perfectly good names for coordinates. The city names on the left of <code>wisc.1</code> are actually row names rather than an actual genuine column. It’s probably best <em>not</em> to assume that they will make it through the transition to a data frame, so we’ll explicitly create a column called <code>city</code> with the city names (that we saved before):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(wisc<span class="fl">.1</span>, <span class="at">city =</span> cities)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>dd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["city"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"-13.37076","2":"85.067148","3":"Appleton","_rn_":"Appleton"},{"1":"-92.94157","2":"-20.205916","3":"Beloit","_rn_":"Beloit"},{"1":"-74.07473","2":"4.804039","3":"Fort.Atkinson","_rn_":"Fort.Atkinson"},{"1":"-44.68148","2":"-11.252521","3":"Madison","_rn_":"Madison"},{"1":"80.61250","2":"27.097882","3":"Marshfield","_rn_":"Marshfield"},{"1":"-102.87582","2":"49.849552","3":"Milwaukee","_rn_":"Milwaukee"},{"1":"-74.66603","2":"-48.422639","3":"Monroe","_rn_":"Monroe"},{"1":"279.27573","2":"-8.621892","3":"Superior","_rn_":"Superior"},{"1":"79.19504","2":"60.997371","3":"Wausau","_rn_":"Wausau"},{"1":"-50.92029","2":"-108.488036","3":"Dubuque","_rn_":"Dubuque"},{"1":"199.16640","2":"-39.595481","3":"St.Paul","_rn_":"St.Paul"},{"1":"-184.71900","2":"8.770492","3":"Chicago","_rn_":"Chicago"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>There are only 12 rows, so it’s fine to display them all.</p>
<p>I’m calling this one <code>dd</code> since I have another <code>d</code> elsewhere that I want to keep. I should use better names.</p>
<p>I think the best use of your judgement is to go straight to <code>geom_text_repel</code> from package <code>ggrepel</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dd, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">label =</span> city)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/wisconsin-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Your map may come out different from mine, but subject to the usual stuff about rotation and reflection it should be equivalent to mine. You should include the <code>coord_fixed</code> to get the scales the same (a corresponding distance on the two scales should take the same space). This one didn’t come out quite square because the MDS says the points should be in a rectangle (stretching further one way than the other).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Are cities close together on your map also close together in real life? Give an example or two.</li>
</ol>
<p>Solution</p>
<p>On the map, the trio of cities Madison, Beloit and Fort Atkinson are closest together. How far apart are they actually? Well, you can go back to the original file (or display of what I called <code>d</code>) and find them, or you can do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>cities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Appleton"      "Beloit"        "Fort.Atkinson" "Madison"      
 [5] "Marshfield"    "Milwaukee"     "Monroe"        "Superior"     
 [9] "Wausau"        "Dubuque"       "St.Paul"       "Chicago"      </code></pre>
</div>
</div>
<p>Cities 2, 3 and 4, so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>wisc <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["location"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Beloit"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Fort.Atkinson"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Madison"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Beloit","2":"0","3":"33","4":"50"},{"1":"Fort.Atkinson","2":"33","3":"0","4":"36"},{"1":"Madison","2":"50","3":"36","4":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The column numbers are off by one, since the first column is the names of the cities, which I decided to display here. It came out right, anyway.</p>
<p>These are all less than 50 miles or less apart. There are some others this close in the original data: Monroe and Madison are 47 miles apart, Wausau and Marshfield are 45 miles apart, but these appear further apart on the map. Extra: the slice-select thing doesn’t work on <code>d</code> because that is not a data frame. It is actually stored internally as a <em>one</em>-dimensional vector that displays nicely, but if you want to pull things out of it you have to figure out where in the vector they are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print.default</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 130  98 102 103 100 149 315  91 196 257 186  33  50 185  73  33 377 186  94
[20] 304  97  36 164  54  58 359 166 119 287 113 138  77  47 330 139  95 258 146
[39] 184 170 219  45 186 161 276 107 394 181 168 322  93 362 186  61 289 130 223
[58] 351 162 467 215 175 275 274 184 395
attr(,"Labels")
 [1] "Appleton"      "Beloit"        "Fort.Atkinson" "Madison"      
 [5] "Marshfield"    "Milwaukee"     "Monroe"        "Superior"     
 [9] "Wausau"        "Dubuque"       "St.Paul"       "Chicago"      
attr(,"Size")
[1] 12
attr(,"call")
as.dist.default(m = .)
attr(,"class")
[1] "dist"
attr(,"Diag")
[1] FALSE
attr(,"Upper")
[1] FALSE</code></pre>
</div>
</div>
<p>If you compare that with the usual display of <code>d</code>, this way goes all the way down the first column ending at 130, then all the way down the second column (which has one fewer entry), ending at 467, and so on. Thus the three entries we picked out are at <span class="math inline">\(11+1=12\)</span>, <span class="math inline">\(11+2=13\)</span>, and <span class="math inline">\(11+10+1=22\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">12</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">13</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>d[<span class="dv">22</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36</code></pre>
</div>
</div>
<p>It’s very easy to be off by one in this sort of calculation. There are 12 cities altogether, so <em>11</em> distances in the first column, 10 in the second, and so on. This was about my third attempt.</p>
<p>I don’t much care which cities you look at. Finding some cities that are reasonably close on the map and doing some kind of critical assessment of their actual distances apart is all I want.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Obtain a Google (or other) map of the area containing these twelve cities. (The way I expected you to do this when this was a hand-in problem was to take a screenshot or similar and include that in your document.)</li>
</ol>
<p>Solution</p>
<p>I do this using R in the maps chapter. See there for how to do it this way.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Discuss how the map that came out of the multidimensional scaling corresponds to the actual (Google) map.</li>
</ol>
<p>Solution</p>
<p>Let’s pick a few places from the actual map, and make a table of where they are on the actual map and the <code>cmdscale</code> map:</p>
<pre><code>
 Place        Real              Cmdscale       
----------------------------------------------
 Superior     northwest         central east   
 St. Paul     central west      southeast      
 Dubuque      central south     central south  
 Chicago      southeast         central west   
 Appleton     central east      central north  

</code></pre>
<p>This is a bit tricky. Dubuque is the only one in the right place, and the others that were west have become east and vice versa. So I think there is a flipping across a line going through Dubuque. That seems to be the most important thing; if you imagine the other points being flipped across a line going north-south through Dubuque, they all end up in about the right place. There might be a little rotation as well, but I’ll call that close enough.</p>
<p>(For you, any comment along the lines of “flipped around this line” or “rotated about this much” that seems to describe what has happened, is fine.)</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" type="a">
<li>Calculate something that demonstrates that a one-dimensional map of the cities is a much worse representation than the two-dimensional one that we made before. (I’m planning to get to this in class, but if we skip it, don’t worry about this part.)</li>
</ol>
<p>Solution</p>
<p>Run again with <code>eig=T</code> and take a look at <code>GOF</code> (uppercase):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cmdscale</span>(d, <span class="dv">2</span>, <span class="at">eig =</span> T)<span class="sc">$</span>GOF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9129333 0.9315871</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cmdscale</span>(d, <span class="dv">1</span>, <span class="at">eig =</span> T)<span class="sc">$</span>GOF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7916925 0.8078690</code></pre>
</div>
</div>
<p>The goodness-of-fit of the two-dimensional solution is pretty good,<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> but that of the one-dimensional solution (which arranges all the cities along a line) is pretty awful in comparison.</p>
<p>How awful? Let’s find out. I should have saved it from just above, but now I have to do it again. For the plot, <code>ones</code> is a string of ones, as many as there are cities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ones <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">12</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(d, <span class="dv">1</span>, <span class="at">eig =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(v<span class="sc">$</span>points, <span class="at">.name_repair =</span> <span class="st">"unique"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">one =</span> ones, <span class="at">city =</span> cities) <span class="ot">-&gt;</span> ddd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...1`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ddd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["...1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["one"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["city"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"-13.37076","2":"1","3":"Appleton"},{"1":"-92.94157","2":"1","3":"Beloit"},{"1":"-74.07473","2":"1","3":"Fort.Atkinson"},{"1":"-44.68148","2":"1","3":"Madison"},{"1":"80.61250","2":"1","3":"Marshfield"},{"1":"-102.87582","2":"1","3":"Milwaukee"},{"1":"-74.66603","2":"1","3":"Monroe"},{"1":"279.27573","2":"1","3":"Superior"},{"1":"79.19504","2":"1","3":"Wausau"},{"1":"-50.92029","2":"1","3":"Dubuque"},{"1":"199.16640","2":"1","3":"St.Paul"},{"1":"-184.71900","2":"1","3":"Chicago"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The one-column matrix of points didn’t have column names, so I needed to give <code>as_tibble</code> explicit permission to create one, and it acquired the name <code>...1</code>). The plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ddd, <span class="fu">aes</span>(<span class="at">x =</span> one, <span class="at">y =</span> ...<span class="dv">1</span>, <span class="at">label =</span> city)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text_repel</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/wisconsin-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The cities get mapped onto a line that goes northwest (top) to southeast (bottom). This is not completely terrible, since there aren’t really any cities in the northeast of the state, but it <em>is</em> pretty awful.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="things-that-feel-similar-to-each-other-1" class="level2" data-number="39.7">
<h2 data-number="39.7" class="anchored" data-anchor-id="things-that-feel-similar-to-each-other-1"><span class="header-section-number">39.7</span> Things that feel similar to each other</h2>
<p>Which objects feel similar to one another and which ones feel different? Can we draw them on a “map”? 30 subjects<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> were each given 17 different objects to feel, for example “inner surface of pine bark”, “rubber eraser” and “nylon scouring pad”. The subjects had to group the objects into a maximum of 8 groups such that the objects within a group felt similar, and the ones in different groups felt different.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> A dissimilarity matrix was formed by counting how many subjects put each pair of objects into <em>different</em> groups, so that the dissimilarity ranged from 0 (the objects were always put together in the same group) to 30 (the objects were not put together into the same group by any of the subjects).</p>
<p>The data are in <a href="http://ritsokiguess.site/datafiles/stimuli.txt">link</a>.</p>
<ol type="a">
<li>Look at the data, and read in the file appropriately. Do you have something square in shape, apart from any columns of object names? Do your columns have the same names as the objects?</li>
</ol>
<p>Solution</p>
<p>Looking at the file first, there are <em>no column names</em>. So we have to tell <code>read_delim</code> that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/stimuli.txt"</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>stimuli <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 17 Columns: 18
── Column specification ────────────────────────────────────────────────────────
Delimiter: " "
chr  (1): X1
dbl (17): X2, X3, X4, X5, X6, X7, X8, X9, X10, X11, X12, X13, X14, X15, X16,...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>stimuli</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["X1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["X2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["X3"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["X4"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["X5"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["X6"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["X7"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["X8"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["X9"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["X10"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["X11"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["X12"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["X13"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["X14"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["X15"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["X16"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["X17"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["X18"],"name":[18],"type":["dbl"],"align":["right"]}],"data":[{"1":"innersurfaceofpinebark","2":"0","3":"22","4":"23","5":"24","6":"26","7":"27","8":"26","9":"23","10":"24","11":"23","12":"23","13":"18","14":"23","15":"21","16":"28","17":"24","18":"22"},{"1":"brick","2":"22","3":"0","4":"27","5":"27","6":"27","7":"29","8":"29","9":"28","10":"16","11":"18","12":"28","13":"25","14":"24","15":"10","16":"29","17":"28","18":"27"},{"1":"cardboard","2":"23","3":"27","4":"0","5":"18","6":"19","7":"28","8":"23","9":"24","10":"24","11":"29","12":"27","13":"28","14":"21","15":"26","16":"28","17":"24","18":"23"},{"1":"cork","2":"24","3":"27","4":"18","5":"0","6":"15","7":"28","8":"25","9":"26","10":"28","11":"28","12":"20","13":"27","14":"10","15":"26","16":"28","17":"28","18":"29"},{"1":"rubbereraser","2":"26","3":"27","4":"19","5":"15","6":"0","7":"28","8":"20","9":"27","10":"24","11":"27","12":"24","13":"25","14":"19","15":"24","16":"29","17":"24","18":"28"},{"1":"felt","2":"27","3":"29","4":"28","5":"28","6":"28","7":"0","8":"24","9":"28","10":"29","11":"26","12":"26","13":"29","14":"28","15":"29","16":"4","17":"28","18":"29"},{"1":"leatherwallet","2":"26","3":"29","4":"23","5":"25","6":"20","7":"24","8":"0","9":"22","10":"28","11":"28","12":"27","13":"26","14":"25","15":"29","16":"24","17":"21","18":"20"},{"1":"rigidplasticsheet","2":"23","3":"28","4":"24","5":"26","6":"27","7":"28","8":"22","9":"0","10":"27","11":"29","12":"29","13":"27","14":"25","15":"25","16":"29","17":"12","18":"13"},{"1":"veryfinesandpaper","2":"24","3":"16","4":"24","5":"28","6":"24","7":"29","8":"28","9":"27","10":"0","11":"21","12":"24","13":"26","14":"25","15":"12","16":"29","17":"29","18":"27"},{"1":"nylonscouringpad","2":"23","3":"18","4":"29","5":"28","6":"27","7":"26","8":"28","9":"29","10":"21","11":"0","12":"22","13":"16","14":"25","15":"24","16":"27","17":"29","18":"28"},{"1":"cellulosekitchensponge","2":"23","3":"28","4":"27","5":"20","6":"24","7":"26","8":"27","9":"29","10":"24","11":"22","12":"0","13":"19","14":"21","15":"26","16":"27","17":"29","18":"27"},{"1":"wovenstraw","2":"18","3":"25","4":"28","5":"27","6":"25","7":"29","8":"26","9":"27","10":"26","11":"16","12":"19","13":"0","14":"26","15":"26","16":"28","17":"27","18":"25"},{"1":"blockofstyrofoam","2":"23","3":"24","4":"21","5":"10","6":"19","7":"28","8":"25","9":"25","10":"25","11":"25","12":"21","13":"26","14":"0","15":"25","16":"29","17":"26","18":"29"},{"1":"unglazedceramictile","2":"21","3":"10","4":"26","5":"26","6":"24","7":"29","8":"29","9":"25","10":"12","11":"24","12":"26","13":"26","14":"25","15":"0","16":"29","17":"28","18":"26"},{"1":"velvet","2":"28","3":"29","4":"28","5":"28","6":"29","7":"4","8":"24","9":"29","10":"29","11":"27","12":"27","13":"28","14":"29","15":"29","16":"0","17":"27","18":"26"},{"1":"waxpaper","2":"24","3":"28","4":"24","5":"28","6":"24","7":"28","8":"21","9":"12","10":"29","11":"29","12":"29","13":"27","14":"26","15":"28","16":"27","17":"0","18":"12"},{"1":"glossypaintedwood","2":"22","3":"27","4":"23","5":"29","6":"28","7":"29","8":"20","9":"13","10":"27","11":"28","12":"27","13":"25","14":"29","15":"26","16":"26","17":"12","18":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>I have 17 rows and 18 columns, but one of the columns is the column of object names. So I really do have the same number of rows and columns of dissimilarities: that is, it <em>is</em> square in shape apart from the names.</p>
<p>The columns <em>do not</em> have the same names as the objects; R has used the <code>X1, X2, ...</code> names that it uses when you do not have column headers.</p>
<p>I could have supplied the object names to <code>col_names</code>, but that is a lot more work than what we do below.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Obtain the names of the objects. Note that they are rather long.</li>
</ol>
<p>Solution</p>
<p>The object names are in the first column, <code>X1</code>, of the data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>objects <span class="ot">&lt;-</span> stimuli<span class="sc">$</span>X1</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>objects</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "innersurfaceofpinebark" "brick"                  "cardboard"             
 [4] "cork"                   "rubbereraser"           "felt"                  
 [7] "leatherwallet"          "rigidplasticsheet"      "veryfinesandpaper"     
[10] "nylonscouringpad"       "cellulosekitchensponge" "wovenstraw"            
[13] "blockofstyrofoam"       "unglazedceramictile"    "velvet"                
[16] "waxpaper"               "glossypaintedwood"     </code></pre>
</div>
</div>
<p>I’m saving these for later.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>Set the column names of your data frame to be your object names, using <code>names</code>. Before you rush to do that, figure out how many column names you need, and supply values for any extra ones. Check that your data frame now has the right column names.</li>
</ol>
<p>Solution</p>
<p>I have 18 columns to name (including the column of object names), but only 17 names, so I need to supply an extra one:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stimuli) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"object"</span>, objects)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>stimuli</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["object"],"name":[1],"type":["chr"],"align":["left"]},{"label":["innersurfaceofpinebark"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["brick"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cardboard"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["cork"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["rubbereraser"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["felt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["leatherwallet"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["rigidplasticsheet"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["veryfinesandpaper"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["nylonscouringpad"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["cellulosekitchensponge"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["wovenstraw"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["blockofstyrofoam"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["unglazedceramictile"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["velvet"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["waxpaper"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["glossypaintedwood"],"name":[18],"type":["dbl"],"align":["right"]}],"data":[{"1":"innersurfaceofpinebark","2":"0","3":"22","4":"23","5":"24","6":"26","7":"27","8":"26","9":"23","10":"24","11":"23","12":"23","13":"18","14":"23","15":"21","16":"28","17":"24","18":"22"},{"1":"brick","2":"22","3":"0","4":"27","5":"27","6":"27","7":"29","8":"29","9":"28","10":"16","11":"18","12":"28","13":"25","14":"24","15":"10","16":"29","17":"28","18":"27"},{"1":"cardboard","2":"23","3":"27","4":"0","5":"18","6":"19","7":"28","8":"23","9":"24","10":"24","11":"29","12":"27","13":"28","14":"21","15":"26","16":"28","17":"24","18":"23"},{"1":"cork","2":"24","3":"27","4":"18","5":"0","6":"15","7":"28","8":"25","9":"26","10":"28","11":"28","12":"20","13":"27","14":"10","15":"26","16":"28","17":"28","18":"29"},{"1":"rubbereraser","2":"26","3":"27","4":"19","5":"15","6":"0","7":"28","8":"20","9":"27","10":"24","11":"27","12":"24","13":"25","14":"19","15":"24","16":"29","17":"24","18":"28"},{"1":"felt","2":"27","3":"29","4":"28","5":"28","6":"28","7":"0","8":"24","9":"28","10":"29","11":"26","12":"26","13":"29","14":"28","15":"29","16":"4","17":"28","18":"29"},{"1":"leatherwallet","2":"26","3":"29","4":"23","5":"25","6":"20","7":"24","8":"0","9":"22","10":"28","11":"28","12":"27","13":"26","14":"25","15":"29","16":"24","17":"21","18":"20"},{"1":"rigidplasticsheet","2":"23","3":"28","4":"24","5":"26","6":"27","7":"28","8":"22","9":"0","10":"27","11":"29","12":"29","13":"27","14":"25","15":"25","16":"29","17":"12","18":"13"},{"1":"veryfinesandpaper","2":"24","3":"16","4":"24","5":"28","6":"24","7":"29","8":"28","9":"27","10":"0","11":"21","12":"24","13":"26","14":"25","15":"12","16":"29","17":"29","18":"27"},{"1":"nylonscouringpad","2":"23","3":"18","4":"29","5":"28","6":"27","7":"26","8":"28","9":"29","10":"21","11":"0","12":"22","13":"16","14":"25","15":"24","16":"27","17":"29","18":"28"},{"1":"cellulosekitchensponge","2":"23","3":"28","4":"27","5":"20","6":"24","7":"26","8":"27","9":"29","10":"24","11":"22","12":"0","13":"19","14":"21","15":"26","16":"27","17":"29","18":"27"},{"1":"wovenstraw","2":"18","3":"25","4":"28","5":"27","6":"25","7":"29","8":"26","9":"27","10":"26","11":"16","12":"19","13":"0","14":"26","15":"26","16":"28","17":"27","18":"25"},{"1":"blockofstyrofoam","2":"23","3":"24","4":"21","5":"10","6":"19","7":"28","8":"25","9":"25","10":"25","11":"25","12":"21","13":"26","14":"0","15":"25","16":"29","17":"26","18":"29"},{"1":"unglazedceramictile","2":"21","3":"10","4":"26","5":"26","6":"24","7":"29","8":"29","9":"25","10":"12","11":"24","12":"26","13":"26","14":"25","15":"0","16":"29","17":"28","18":"26"},{"1":"velvet","2":"28","3":"29","4":"28","5":"28","6":"29","7":"4","8":"24","9":"29","10":"29","11":"27","12":"27","13":"28","14":"29","15":"29","16":"0","17":"27","18":"26"},{"1":"waxpaper","2":"24","3":"28","4":"24","5":"28","6":"24","7":"28","8":"21","9":"12","10":"29","11":"29","12":"29","13":"27","14":"26","15":"28","16":"27","17":"0","18":"12"},{"1":"glossypaintedwood","2":"22","3":"27","4":"23","5":"29","6":"28","7":"29","8":"20","9":"13","10":"27","11":"28","12":"27","13":"25","14":"29","15":"26","16":"26","17":"12","18":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li><a name="part:distances">*</a><br>
Convert your data frame into a distance object. Take a look at the (rather long) result.</li>
</ol>
<p>Solution</p>
<p>This is <code>as.dist</code>, since we have distances (dissimilarities) already. Don’t forget to take off the first column!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> stimuli <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">as.dist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I can try and show it all here, tiny, but even then it’s long because the column names are long:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">getOption</span>(<span class="st">"width"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> <span class="dv">132</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       innersurfaceofpinebark brick cardboard cork rubbereraser felt leatherwallet rigidplasticsheet
brick                                      22                                                                       
cardboard                                  23    27                                                                 
cork                                       24    27        18                                                       
rubbereraser                               26    27        19   15                                                  
felt                                       27    29        28   28           28                                     
leatherwallet                              26    29        23   25           20   24                                
rigidplasticsheet                          23    28        24   26           27   28            22                  
veryfinesandpaper                          24    16        24   28           24   29            28                27
nylonscouringpad                           23    18        29   28           27   26            28                29
cellulosekitchensponge                     23    28        27   20           24   26            27                29
wovenstraw                                 18    25        28   27           25   29            26                27
blockofstyrofoam                           23    24        21   10           19   28            25                25
unglazedceramictile                        21    10        26   26           24   29            29                25
velvet                                     28    29        28   28           29    4            24                29
waxpaper                                   24    28        24   28           24   28            21                12
glossypaintedwood                          22    27        23   29           28   29            20                13
                       veryfinesandpaper nylonscouringpad cellulosekitchensponge wovenstraw blockofstyrofoam unglazedceramictile
brick                                                                                                                           
cardboard                                                                                                                       
cork                                                                                                                            
rubbereraser                                                                                                                    
felt                                                                                                                            
leatherwallet                                                                                                                   
rigidplasticsheet                                                                                                               
veryfinesandpaper                                                                                                               
nylonscouringpad                      21                                                                                        
cellulosekitchensponge                24               22                                                                       
wovenstraw                            26               16                     19                                                
blockofstyrofoam                      25               25                     21         26                                     
unglazedceramictile                   12               24                     26         26               25                    
velvet                                29               27                     27         28               29                  29
waxpaper                              29               29                     29         27               26                  28
glossypaintedwood                     27               28                     27         25               29                  26
                       velvet waxpaper
brick                                 
cardboard                             
cork                                  
rubbereraser                          
felt                                  
leatherwallet                         
rigidplasticsheet                     
veryfinesandpaper                     
nylonscouringpad                      
cellulosekitchensponge                
wovenstraw                            
blockofstyrofoam                      
unglazedceramictile                   
velvet                                
waxpaper                   27         
glossypaintedwood          26       12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The stuff with <code>width</code> was to make it display lots of columns, and then setting it back afterwards so as not to mess things up later. If you try and take <code>head</code> of this, you’ll lose the structure. I don’t know of a good way to display part of one of these.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Obtain and plot a (metric) multidimensional scaling map of these data. Label the points with the name of the object they represent. (Note that <code>geom_text_repel</code> has an option <code>size</code> that controls the size of the text.)</li>
</ol>
<p>Solution</p>
<p>This is the procedure. Talking about it is coming in a minute.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(d, <span class="dv">2</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(d<span class="fl">.1</span>, <span class="at">stim =</span> objects) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">label =</span> stim)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/stimuli-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>cmdscale</code> gets the coordinates to plot, then we plot them, and then we place the object names next to the points. I’m not quite sure what the scale is for <code>size</code>, but <code>size=2</code> worked for me here, making the text a bit smaller (so that the labels don’t overlap), but not so small that you can’t read it. You’ll probably have to experiment to find a <code>size</code> that you like.</p>
<p>If you forget the <code>2</code> after the distance matrix in <code>cmdscale</code>, you’ll get a two-dimensional solution anyway (since two dimensions is the default). The output is an array of coordinates in two dimensions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              [,1]       [,2]
innersurfaceofpinebark  -2.7066290   1.694420
brick                  -12.2011332   5.147970
cardboard                3.8630322  -9.322759
cork                    -0.8424358 -14.884926
rubbereraser             0.1676463 -11.733873
felt                     5.1803473   9.328562
leatherwallet           10.4636668  -1.016525
rigidplasticsheet       11.0208731   1.201504
veryfinesandpaper      -11.0869483   2.800988
nylonscouringpad       -10.4469053   7.232787
cellulosekitchensponge  -5.3886609  -2.770991
wovenstraw              -5.2762142   3.836948
blockofstyrofoam        -2.9950151 -11.927717
unglazedceramictile    -10.5902291   2.926805
velvet                   6.3768882  10.477972
waxpaper                13.1702265   1.677039
glossypaintedwood       11.2914904   5.331796</code></pre>
</div>
</div>
<p>I note that any map that is the same as this apart from rotation and reflection is also fine (since the distances will be the same). I saw a lot of maps that were like mine but upside down (with <code>cork</code> at the top).<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> No problem there.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Find a pair of objects that are close together on your plot. Look back at your answer to part~(<a href="#part:distances">here</a>): is the distance between those objects small? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>I don’t mind (much) which objects you pick (as long as they are reasonably close together). Find the actual distance between them from what I called <code>d</code> in part~(<a href="#part:distances">here</a>). Some possibilities:</p>
<ul>
<li><p>Felt and velvet, Distance 4.</p></li>
<li><p>Block of styrofoam and rubber eraser. Distance 19 (not that small, but one of the smaller ones).</p></li>
<li><p>Rigid plastic sheet and wax paper. Distance 12. Smallish.</p></li>
<li><p>unglazed ceramic tile<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> and very fine sandpaper. Distance 12. Smallish.</p></li>
</ul>
<p>There won’t be a perfect relationship between distance in the distance matrix and on the map. In this case, there is an upper limit on distance (30, because 30 people rated the objects for similarity) and that upper limit is approached by many of the distances. (This suggests that non-metric multidimensional scaling, that just reproduces the order of the distances, might be a better idea for these data.) If objects A and B, and also B and C, are each close to 30 apart, then objects A and C will also be close to 30 apart, and that constrains them to be nearly in a triangle on the map. There are some 10s in the distance matrix, for example between block of styrofoam and cork, and also between unglazed ceramic tile and brick; these are a bit further apart on the map, but still close.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Obtain a measure of goodness of fit for this multidimensional scaling map.</li>
</ol>
<p>Solution</p>
<p>This means fitting again, but this time with <code>eig=T</code>, and pulling out the thing called <code>GOF</code>. You can omit the 2, since that’s the default 2 dimensions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(d, <span class="dv">2</span>, <span class="at">eig =</span> T)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.2</span><span class="sc">$</span>GOF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4019251 0.4110603</code></pre>
</div>
</div>
<p>I didn’t ask you to comment on this, but the adjective that came to my mind was “disappointing”. I think that’s to do with the upper-limit-30 thing again. Also, this time (unlike with Wisconsin) there was no “right answer”, so maybe it just isn’t going to be very good. If you looked at several pairs of points above, you might have noticed that the correspondence between map distance and actual distance isn’t very good; this is the same issue.</p>
<p>I was curious about whether 3 dimensions would be any better:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.2</span>a <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(d, <span class="dv">3</span>, <span class="at">eig =</span> T)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.2</span>a<span class="sc">$</span>GOF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5775841 0.5907117</code></pre>
</div>
</div>
<p>That is quite a bit better. The problem with this, though, is that we need something like <code>rgl</code> to explore it with.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" type="a">
<li>Obtain a cluster analysis for the same data, using Ward’s method. Obtain a dendrogram. What seems to be an appropriate number of clusters? Mark them on your dendrogram too.</li>
</ol>
<p>Solution</p>
<p>This seems to be a throwback to last week, but I have my reasons, which you’ll see in a moment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d, <span class="at">method =</span> <span class="st">"ward.D"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/stimuli-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That looks like 5 clusters to me (chopping the tree at a height of 30). Drawing them:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d<span class="fl">.3</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(d<span class="fl">.3</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/stimuli-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol type="i">
<li>Discuss as briefly as seems reasonable whether your clusters tell the same story as the map that came from multidimensional scaling. (There were only three marks for this, so you don’t need to go overboard.) Optionally, think about creating a plot that will make it easier to see the correspondence between your clusters and the MDS map.</li>
</ol>
<p>Solution</p>
<p>I would take my clusters and think about whether the objects in them are (a) close together on the map and (b) distinct from other objects on the map. Working from left to right of my dendrogram:</p>
<ul>
<li><p>Together at the bottom of the plot.</p></li>
<li><p>Together at the top left.</p></li>
<li><p>Together at the top left, but rather mixed up with the previous cluster (in particular, <code>nylonscouringpad</code> looks as if it belongs in the previous cluster).</p></li>
<li><p>Together at the top of the plot.</p></li>
<li><p>Together at the top right.</p></li>
</ul>
<p>If you had a different number of clusters, work with what you have, and if you have done that, you’ll be good.</p>
<p>My general conclusion from the above is that my five clusters are mostly distinct from each other, but the MDS map really only has four. (If you look at the dendrogram, the two clusters that are not really distinct from each other were the last ones to be split.) This is a lot more detail than you need. What I want to see is some kind of association of clusters with (hopefully) nearby points on the map, some kind of discussion of whether the clusters are really distinct groupings on the map, and a sense of whether you feel the clusters are consistent with what appears on the map.</p>
<p>Extra: this is where I have to say I cheated. I thought this would be hard to do by trying to match those names in the clusters with the ones on the MDS map. So I put myself through some short-term R coding pain for some substantial long-term gain. I was thinking, “can I extract the clusters from this analysis, and plot them on the MDS map in different colours?” That would go like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(d<span class="fl">.3</span>, <span class="dv">5</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(d<span class="fl">.1</span>, <span class="at">names =</span> stimuli[, <span class="dv">1</span>], <span class="at">cluster =</span> <span class="fu">factor</span>(clusters)) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">label =</span> objects, <span class="at">colour =</span> cluster)) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/stimuli-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The first line obtains the clusters as numbers, which I then had to turn into a factor (to make the plot different colours). I copied the rest from above, and then I added to them, colouring the points according to what cluster they belonged to. Three of my “rough” objects have broken off into a cluster of their own; they are, kind of, in their own little area on the map.</p>
<p>Another, non-graphical, way of doing this is to list the MDS coordinates along with the clusters, probably sorted by cluster:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(d<span class="fl">.1</span>, <span class="at">object =</span> stimuli[, <span class="dv">1</span>], clusters) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(clusters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["object"],"name":[3],"type":["chr"],"align":["left"]},{"label":["clusters"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"-2.7066290","2":"1.694420","3":"innersurfaceofpinebark","4":"1","_rn_":"innersurfaceofpinebark"},{"1":"-10.4469053","2":"7.232787","3":"nylonscouringpad","4":"1","_rn_":"nylonscouringpad"},{"1":"-5.3886609","2":"-2.770991","3":"cellulosekitchensponge","4":"1","_rn_":"cellulosekitchensponge"},{"1":"-5.2762142","2":"3.836948","3":"wovenstraw","4":"1","_rn_":"wovenstraw"},{"1":"-12.2011332","2":"5.147970","3":"brick","4":"2","_rn_":"brick"},{"1":"-11.0869483","2":"2.800988","3":"veryfinesandpaper","4":"2","_rn_":"veryfinesandpaper"},{"1":"-10.5902291","2":"2.926805","3":"unglazedceramictile","4":"2","_rn_":"unglazedceramictile"},{"1":"3.8630322","2":"-9.322759","3":"cardboard","4":"3","_rn_":"cardboard"},{"1":"-0.8424358","2":"-14.884926","3":"cork","4":"3","_rn_":"cork"},{"1":"0.1676463","2":"-11.733873","3":"rubbereraser","4":"3","_rn_":"rubbereraser"},{"1":"-2.9950151","2":"-11.927717","3":"blockofstyrofoam","4":"3","_rn_":"blockofstyrofoam"},{"1":"5.1803473","2":"9.328562","3":"felt","4":"4","_rn_":"felt"},{"1":"6.3768882","2":"10.477972","3":"velvet","4":"4","_rn_":"velvet"},{"1":"10.4636668","2":"-1.016525","3":"leatherwallet","4":"5","_rn_":"leatherwallet"},{"1":"11.0208731","2":"1.201504","3":"rigidplasticsheet","4":"5","_rn_":"rigidplasticsheet"},{"1":"13.1702265","2":"1.677039","3":"waxpaper","4":"5","_rn_":"waxpaper"},{"1":"11.2914904","2":"5.331796","3":"glossypaintedwood","4":"5","_rn_":"glossypaintedwood"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Then you can think about what makes the clusters different in terms of <code>X1</code> and <code>X2</code>. For me, clusters 1 and 2 are kind of mixed up, with <code>X1</code> and (usually) <code>X2</code> negative; cluster 3 has strongly positive <code>X2</code>; cluster 4 has very <em>negative</em> <code>X2</code>;<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> and cluster 5 has strongly positive <code>X1</code>.</p>
<p>I wonder whether our three-dimensional solution distinguishes clusters 1 and 2 at all? Same approach again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>save<span class="fl">.3</span>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(d<span class="fl">.2</span>a<span class="sc">$</span>points, objects, clusters) <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(clusters)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>save<span class="fl">.3</span>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["X3"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["objects"],"name":[4],"type":["chr"],"align":["left"]},{"label":["clusters"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"-2.7066290","2":"1.694420","3":"4.1176385","4":"innersurfaceofpinebark","5":"1","_rn_":"innersurfaceofpinebark"},{"1":"-10.4469053","2":"7.232787","3":"-1.9720211","4":"nylonscouringpad","5":"1","_rn_":"nylonscouringpad"},{"1":"-5.3886609","2":"-2.770991","3":"-6.8039573","4":"cellulosekitchensponge","5":"1","_rn_":"cellulosekitchensponge"},{"1":"-5.2762142","2":"3.836948","3":"-0.3083513","4":"wovenstraw","5":"1","_rn_":"wovenstraw"},{"1":"-12.2011332","2":"5.147970","3":"5.9802631","4":"brick","5":"2","_rn_":"brick"},{"1":"-11.0869483","2":"2.800988","3":"4.9686770","4":"veryfinesandpaper","5":"2","_rn_":"veryfinesandpaper"},{"1":"-10.5902291","2":"2.926805","3":"7.2124679","4":"unglazedceramictile","5":"2","_rn_":"unglazedceramictile"},{"1":"3.8630322","2":"-9.322759","3":"1.2376174","4":"cardboard","5":"3","_rn_":"cardboard"},{"1":"-0.8424358","2":"-14.884926","3":"-5.6157998","4":"cork","5":"3","_rn_":"cork"},{"1":"0.1676463","2":"-11.733873","3":"-2.3880857","4":"rubbereraser","5":"3","_rn_":"rubbereraser"},{"1":"-2.9950151","2":"-11.927717","3":"-2.9877666","4":"blockofstyrofoam","5":"3","_rn_":"blockofstyrofoam"},{"1":"5.1803473","2":"9.328562","3":"-15.2730895","4":"felt","5":"4","_rn_":"felt"},{"1":"6.3768882","2":"10.477972","3":"-14.1837552","4":"velvet","5":"4","_rn_":"velvet"},{"1":"10.4636668","2":"-1.016525","3":"-1.9005177","4":"leatherwallet","5":"5","_rn_":"leatherwallet"},{"1":"11.0208731","2":"1.201504","3":"10.0016248","4":"rigidplasticsheet","5":"5","_rn_":"rigidplasticsheet"},{"1":"13.1702265","2":"1.677039","3":"8.2862272","4":"waxpaper","5":"5","_rn_":"waxpaper"},{"1":"11.2914904","2":"5.331796","3":"9.6288283","4":"glossypaintedwood","5":"5","_rn_":"glossypaintedwood"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>It looks as if the combo of negative <code>X1</code> and positive <code>X3</code> distinguishes cluster 2 from cluster 1.</p>
<p>As I was writing this, I was thinking that we should throw the coordinates and the <code>clusters</code> into a <em>discriminant analysis</em>, to find out what distinguishes the clusters. Which is way too weird, and therefore deserves to be explored (with the three-dimensional solution, for example):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>save<span class="fl">.3</span>d.lda <span class="ot">&lt;-</span> <span class="fu">lda</span>(clusters <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3, <span class="at">data =</span> save<span class="fl">.3</span>d)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>ppp <span class="ot">&lt;-</span> <span class="fu">predict</span>(save<span class="fl">.3</span>d.lda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I snuck a look at the output and found that <code>LD3</code> is basically worthless, so I can plot <code>LD1</code> against <code>LD2</code>, coloured by cluster:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(ppp<span class="sc">$</span>x, <span class="at">cluster =</span> <span class="fu">factor</span>(save<span class="fl">.3</span>d<span class="sc">$</span>clusters)) <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> LD1, <span class="at">y =</span> LD2, <span class="at">colour =</span> cluster)) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/stimuli-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This says that the three-dimensional MDS <em>has</em> separated clusters 1 and 2, and if we were to plot <code>d.2a</code> in <code>rgl</code> and rotate it the right way, we <em>would</em> be able to see a difference between those two clusters as well. (They wouldn’t look mixed up as they do on the two-dimensional map.)</p>
<p>So we can look at the three-dimensional map coordinates and the discriminant analysis and ask “what distinguishes the clusters?”. Map coordinates first. I need <code>points</code> since I ran the scaling with <code>eig=T</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>save<span class="fl">.3</span>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["X3"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["objects"],"name":[4],"type":["chr"],"align":["left"]},{"label":["clusters"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"-2.7066290","2":"1.694420","3":"4.1176385","4":"innersurfaceofpinebark","5":"1","_rn_":"innersurfaceofpinebark"},{"1":"-10.4469053","2":"7.232787","3":"-1.9720211","4":"nylonscouringpad","5":"1","_rn_":"nylonscouringpad"},{"1":"-5.3886609","2":"-2.770991","3":"-6.8039573","4":"cellulosekitchensponge","5":"1","_rn_":"cellulosekitchensponge"},{"1":"-5.2762142","2":"3.836948","3":"-0.3083513","4":"wovenstraw","5":"1","_rn_":"wovenstraw"},{"1":"-12.2011332","2":"5.147970","3":"5.9802631","4":"brick","5":"2","_rn_":"brick"},{"1":"-11.0869483","2":"2.800988","3":"4.9686770","4":"veryfinesandpaper","5":"2","_rn_":"veryfinesandpaper"},{"1":"-10.5902291","2":"2.926805","3":"7.2124679","4":"unglazedceramictile","5":"2","_rn_":"unglazedceramictile"},{"1":"3.8630322","2":"-9.322759","3":"1.2376174","4":"cardboard","5":"3","_rn_":"cardboard"},{"1":"-0.8424358","2":"-14.884926","3":"-5.6157998","4":"cork","5":"3","_rn_":"cork"},{"1":"0.1676463","2":"-11.733873","3":"-2.3880857","4":"rubbereraser","5":"3","_rn_":"rubbereraser"},{"1":"-2.9950151","2":"-11.927717","3":"-2.9877666","4":"blockofstyrofoam","5":"3","_rn_":"blockofstyrofoam"},{"1":"5.1803473","2":"9.328562","3":"-15.2730895","4":"felt","5":"4","_rn_":"felt"},{"1":"6.3768882","2":"10.477972","3":"-14.1837552","4":"velvet","5":"4","_rn_":"velvet"},{"1":"10.4636668","2":"-1.016525","3":"-1.9005177","4":"leatherwallet","5":"5","_rn_":"leatherwallet"},{"1":"11.0208731","2":"1.201504","3":"10.0016248","4":"rigidplasticsheet","5":"5","_rn_":"rigidplasticsheet"},{"1":"13.1702265","2":"1.677039","3":"8.2862272","4":"waxpaper","5":"5","_rn_":"waxpaper"},{"1":"11.2914904","2":"5.331796","3":"9.6288283","4":"glossypaintedwood","5":"5","_rn_":"glossypaintedwood"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>and the business end of the LDA output:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>save<span class="fl">.3</span>d.lda<span class="sc">$</span>svd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.593922  5.767636  3.007893</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>save<span class="fl">.3</span>d.lda<span class="sc">$</span>scaling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          LD1         LD2        LD3
X1  0.5463715  0.22819994 0.03521147
X2  0.4370065 -0.28250040 0.10269853
X3 -0.3512713  0.09616153 0.19930252</code></pre>
</div>
</div>
<p>The plot said that cluster 2 was lowest of all on <code>LD1</code>, a bit lower than cluster 1. What would make <code>LD1</code> small (negative) would be if <code>X1</code> was small and <code>X2</code> and <code>X3</code> were large. The cluster 2 observations are the smallest on <code>X1</code> (smaller than cluster 1) and larger on <code>X3</code> than cluster 1. So we <em>can</em> enumerate what makes clusters 1 and 2 different. The plot of the first two <code>LD</code>s says, in fact, that under the 3-dimensional multidimensional scaling, all five groups are distinct.</p>
<p>A biplot would be another way to look at that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(save<span class="fl">.3</span>d.lda, <span class="at">groups =</span> <span class="fu">factor</span>(save<span class="fl">.3</span>d<span class="sc">$</span>clusters))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/stimuli-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Points on the right have <code>X1</code> and <code>X2</code> large, and <code>X3</code> small (cluster 4, and to a lesser extent, cluster 5). Points on the left are the other way around. None of the arrows point up or down really, but <code>X1</code> points up a bit and <code>X2</code> down a bit, so points at the top of the plot are likely to be high on <code>X1</code> and low on <code>X2</code>, like cluster 5.</p>
<p>Was that all confusing enough for you?</p>
<p>Anyway, the key to gaining some insight here is to find a way to <em>combine</em> the output from the cluster analysis and the multidimensional scaling. That way you can see both in the same place, and see how they compare.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="confusing-letters-1" class="level2" data-number="39.8">
<h2 data-number="39.8" class="anchored" data-anchor-id="confusing-letters-1"><span class="header-section-number">39.8</span> Confusing letters</h2>
<p>Two researchers studied how often people mistook one letter for another one. They did this by showing their subjects each (uppercase) letter for a few milliseconds only, and asking them which letter (out of a list) they just saw. The researchers obtain a “confusion matrix” in which, for example, the W-Q entry is the total of W’s taken as Q and Q’s taken as W. This confusion matrix is in <a href="http://ritsokiguess.site/datafiles/letterrec.txt">link</a>. Note that the confusions are actually <em>similarities</em> rather than dissimilarities: a large number means that the two letters concerned are easily confused, that is, similar. Similarities can be converted to dissimilarities by subtracting them from a larger number than anything in the table (that is, subtracting from 21 is good here).</p>
<ol type="a">
<li>Read in the confusion matrix and convert it to dissimilarities and then to a <code>dist</code> object, displaying the <code>dist</code> object that you obtain.</li>
</ol>
<p>Solution</p>
<p><code>read_table</code> to read in the data, having first noted that we have aligned columns with spaces between:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/letterrec.txt"</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>letters <span class="ot">&lt;-</span> <span class="fu">read_table</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
── Column specification ────────────────────────────────────────────────────────
cols(
  C = col_character(),
  D = col_double(),
  G = col_double(),
  H = col_double(),
  M = col_double(),
  N = col_double(),
  Q = col_double(),
  W = col_double()
)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 8 parsing failures.
row col  expected     actual                                               file
  1  -- 8 columns 10 columns 'http://ritsokiguess.site/datafiles/letterrec.txt'
  2  -- 8 columns 9 columns  'http://ritsokiguess.site/datafiles/letterrec.txt'
  3  -- 8 columns 9 columns  'http://ritsokiguess.site/datafiles/letterrec.txt'
  4  -- 8 columns 9 columns  'http://ritsokiguess.site/datafiles/letterrec.txt'
  5  -- 8 columns 9 columns  'http://ritsokiguess.site/datafiles/letterrec.txt'
... ... ......... .......... ..................................................
See problems(...) for more details.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>letters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["C"],"name":[1],"type":["chr"],"align":["left"]},{"label":["D"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["G"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["H"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["M"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["N"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Q"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["W"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"C","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0"},{"1":"D","2":"5","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0"},{"1":"G","2":"12","3":"2","4":"0","5":"0","6":"0","7":"0","8":"0"},{"1":"H","2":"2","3":"4","4":"3","5":"0","6":"0","7":"0","8":"0"},{"1":"M","2":"2","3":"3","4":"2","5":"10","6":"0","7":"0","8":"0"},{"1":"N","2":"2","3":"4","4":"1","5":"18","6":"16","7":"0","8":"0"},{"1":"Q","2":"9","3":"20","4":"9","5":"1","6":"2","7":"8","8":"0"},{"1":"W","2":"1","3":"5","4":"2","5":"5","6":"18","7":"13","8":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The first column didn’t have a heading, so <code>read_table</code> filled in <code>X1</code> for it (there was data down below, so it needed to have a name). This is in contrast to something like <code>read_delim</code>, where you have to have as many headers as columns. In <code>read_table</code>, you know where the headers have to be, so if any are missing they can be filled in, but with <code>read_delim</code> you don’t have that knowledge, so you have to have exactly the right number of headers, one per data column exactly.</p>
<p>These are similarities, so convert to dissimilarities by subtracting from 21. This is a shortcut way to do that, once you’ve gotten rid of everything that is not numbers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>letters <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>X1) <span class="ot">-&gt;</span> letters2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `dplyr::select()`:
! Can't subset columns that don't exist.
✖ Column `X1` doesn't exist.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>letters2 <span class="ot">&lt;-</span> <span class="dv">21</span> <span class="sc">-</span> letters2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'letters2' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>letters2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'letters2' not found</code></pre>
</div>
</div>
<p>This looks weird, or at least the stuff above the diagonal does, but <code>dist</code> works with the stuff <em>below</em> the diagonal (unless you tell it otherwise), so all will be good.</p>
<p><code>as.dist</code> comes next:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(letters2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'letters2' not found</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       innersurfaceofpinebark brick cardboard cork rubbereraser
brick                                      22                                  
cardboard                                  23    27                            
cork                                       24    27        18                  
rubbereraser                               26    27        19   15             
felt                                       27    29        28   28           28
leatherwallet                              26    29        23   25           20
rigidplasticsheet                          23    28        24   26           27
veryfinesandpaper                          24    16        24   28           24
nylonscouringpad                           23    18        29   28           27
cellulosekitchensponge                     23    28        27   20           24
wovenstraw                                 18    25        28   27           25
blockofstyrofoam                           23    24        21   10           19
unglazedceramictile                        21    10        26   26           24
velvet                                     28    29        28   28           29
waxpaper                                   24    28        24   28           24
glossypaintedwood                          22    27        23   29           28
                       felt leatherwallet rigidplasticsheet veryfinesandpaper
brick                                                                        
cardboard                                                                    
cork                                                                         
rubbereraser                                                                 
felt                                                                         
leatherwallet            24                                                  
rigidplasticsheet        28            22                                    
veryfinesandpaper        29            28                27                  
nylonscouringpad         26            28                29                21
cellulosekitchensponge   26            27                29                24
wovenstraw               29            26                27                26
blockofstyrofoam         28            25                25                25
unglazedceramictile      29            29                25                12
velvet                    4            24                29                29
waxpaper                 28            21                12                29
glossypaintedwood        29            20                13                27
                       nylonscouringpad cellulosekitchensponge wovenstraw
brick                                                                    
cardboard                                                                
cork                                                                     
rubbereraser                                                             
felt                                                                     
leatherwallet                                                            
rigidplasticsheet                                                        
veryfinesandpaper                                                        
nylonscouringpad                                                         
cellulosekitchensponge               22                                  
wovenstraw                           16                     19           
blockofstyrofoam                     25                     21         26
unglazedceramictile                  24                     26         26
velvet                               27                     27         28
waxpaper                             29                     29         27
glossypaintedwood                    28                     27         25
                       blockofstyrofoam unglazedceramictile velvet waxpaper
brick                                                                      
cardboard                                                                  
cork                                                                       
rubbereraser                                                               
felt                                                                       
leatherwallet                                                              
rigidplasticsheet                                                          
veryfinesandpaper                                                          
nylonscouringpad                                                           
cellulosekitchensponge                                                     
wovenstraw                                                                 
blockofstyrofoam                                                           
unglazedceramictile                  25                                    
velvet                               29                  29                
waxpaper                             26                  28     27         
glossypaintedwood                    29                  26     26       12</code></pre>
</div>
</div>
<p>This works because the letters that are confused are actually column names of the data frame.</p>
<p>You can check (and probably should, at least for yourself) that the distances in <code>d</code> correspond properly to the ones in <code>letters</code>. For example, the letters C and G were confused 12 times, <span class="math inline">\(21-12=9\)</span>, and the entry for C and G in <code>d</code> is indeed 9.</p>
<p>Note that the actual confusion numbers were in the data file as the bottom half of the matrix, with the top half being zeroes. <code>as.dist</code> handled this with no problem. (You can check the help for <code>as.dist</code> to find out how it deals with this kind of thing.)</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Run a multidimensional scaling, with the default two dimensions, on your <code>dist</code> object, and display the results. (Making a graph is coming later.)</li>
</ol>
<p>Solution</p>
<p>This:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(d)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              [,1]       [,2]
innersurfaceofpinebark  -2.7066290   1.694420
brick                  -12.2011332   5.147970
cardboard                3.8630322  -9.322759
cork                    -0.8424358 -14.884926
rubbereraser             0.1676463 -11.733873
felt                     5.1803473   9.328562
leatherwallet           10.4636668  -1.016525
rigidplasticsheet       11.0208731   1.201504
veryfinesandpaper      -11.0869483   2.800988
nylonscouringpad       -10.4469053   7.232787
cellulosekitchensponge  -5.3886609  -2.770991
wovenstraw              -5.2762142   3.836948
blockofstyrofoam        -2.9950151 -11.927717
unglazedceramictile    -10.5902291   2.926805
velvet                   6.3768882  10.477972
waxpaper                13.1702265   1.677039
glossypaintedwood       11.2914904   5.331796</code></pre>
</div>
</div>
<p>Or you can do it with <code>eig=T</code>, which gets you some more information:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.1</span>a <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(d, <span class="at">eig =</span> T)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.1</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$points
                              [,1]       [,2]
innersurfaceofpinebark  -2.7066290   1.694420
brick                  -12.2011332   5.147970
cardboard                3.8630322  -9.322759
cork                    -0.8424358 -14.884926
rubbereraser             0.1676463 -11.733873
felt                     5.1803473   9.328562
leatherwallet           10.4636668  -1.016525
rigidplasticsheet       11.0208731   1.201504
veryfinesandpaper      -11.0869483   2.800988
nylonscouringpad       -10.4469053   7.232787
cellulosekitchensponge  -5.3886609  -2.770991
wovenstraw              -5.2762142   3.836948
blockofstyrofoam        -2.9950151 -11.927717
unglazedceramictile    -10.5902291   2.926805
velvet                   6.3768882  10.477972
waxpaper                13.1702265   1.677039
glossypaintedwood       11.2914904   5.331796

$eig
 [1]  1.181313e+03  9.394546e+02  9.268689e+02  6.314409e+02  3.467493e+02
 [6]  2.705989e+02  2.575474e+02  1.937616e+02  1.485443e+02  1.186640e+02
[11]  8.449108e+01  4.651045e+01  1.331767e+01 -1.421085e-13 -1.739199e+01
[16] -3.204147e+01 -6.782875e+01

$x
NULL

$ac
[1] 0

$GOF
[1] 0.4019251 0.4110603</code></pre>
</div>
</div>
<p>The most interesting thing here is the <code>GOF</code> at the bottom, which is not that high (whichever one of the two values you take), suggesting that the two-dimensional representation is not very good. Further evidence for that is in <code>eig</code>, the “eigenvalues”, which are about 493, 232, 140, 50, 40, 0 and some negative ones, which suggests that three dimensions might be better than two for representing the data, because the first <em>three</em> eigenvalues seem noticeably bigger than the others. (This is the same thinking as the <code>svd</code> or percent of trace in discriminant analysis.) But that’s by the way: we’ll stick with two dimensions.</p>
<p>The important thing to remember is that if you go the <code>eig=T</code> way, you have to pull out the points to plot from the thing called <code>points</code>, so that you plot <code>d.1</code> itself but <code>d.1a$points</code>.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>Obtain a vector of the names of the letters that were confused in this study.</li>
</ol>
<p>Solution</p>
<p>Easiest way is to pull out the first column of the data frame that you read in from the file (if you can remember what it was called):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>letter_names <span class="ot">&lt;-</span> letters<span class="sc">$</span>X1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `X1`.</code></pre>
</div>
</div>
<p>That silly column name <code>X1</code> that <code>read_table</code> supplied.</p>
<p>Extra: You can even get the letter names from the thing I called <code>d</code>, but I can’t remember how, so I have to cheat. I said that <code>d</code> has a “print method”<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> that controls how it looks:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       innersurfaceofpinebark brick cardboard cork rubbereraser
brick                                      22                                  
cardboard                                  23    27                            
cork                                       24    27        18                  
rubbereraser                               26    27        19   15             
felt                                       27    29        28   28           28
leatherwallet                              26    29        23   25           20
rigidplasticsheet                          23    28        24   26           27
veryfinesandpaper                          24    16        24   28           24
nylonscouringpad                           23    18        29   28           27
cellulosekitchensponge                     23    28        27   20           24
wovenstraw                                 18    25        28   27           25
blockofstyrofoam                           23    24        21   10           19
unglazedceramictile                        21    10        26   26           24
velvet                                     28    29        28   28           29
waxpaper                                   24    28        24   28           24
glossypaintedwood                          22    27        23   29           28
                       felt leatherwallet rigidplasticsheet veryfinesandpaper
brick                                                                        
cardboard                                                                    
cork                                                                         
rubbereraser                                                                 
felt                                                                         
leatherwallet            24                                                  
rigidplasticsheet        28            22                                    
veryfinesandpaper        29            28                27                  
nylonscouringpad         26            28                29                21
cellulosekitchensponge   26            27                29                24
wovenstraw               29            26                27                26
blockofstyrofoam         28            25                25                25
unglazedceramictile      29            29                25                12
velvet                    4            24                29                29
waxpaper                 28            21                12                29
glossypaintedwood        29            20                13                27
                       nylonscouringpad cellulosekitchensponge wovenstraw
brick                                                                    
cardboard                                                                
cork                                                                     
rubbereraser                                                             
felt                                                                     
leatherwallet                                                            
rigidplasticsheet                                                        
veryfinesandpaper                                                        
nylonscouringpad                                                         
cellulosekitchensponge               22                                  
wovenstraw                           16                     19           
blockofstyrofoam                     25                     21         26
unglazedceramictile                  24                     26         26
velvet                               27                     27         28
waxpaper                             29                     29         27
glossypaintedwood                    28                     27         25
                       blockofstyrofoam unglazedceramictile velvet waxpaper
brick                                                                      
cardboard                                                                  
cork                                                                       
rubbereraser                                                               
felt                                                                       
leatherwallet                                                              
rigidplasticsheet                                                          
veryfinesandpaper                                                          
nylonscouringpad                                                           
cellulosekitchensponge                                                     
wovenstraw                                                                 
blockofstyrofoam                                                           
unglazedceramictile                  25                                    
velvet                               29                  29                
waxpaper                             26                  28     27         
glossypaintedwood                    29                  26     26       12</code></pre>
</div>
</div>
<p>but its innards are a whole lot more complicated than that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print.default</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 22 23 24 26 27 26 23 24 23 23 18 23 21 28 24 22 27 27 27 29 29 28 16 18 28
 [26] 25 24 10 29 28 27 18 19 28 23 24 24 29 27 28 21 26 28 24 23 15 28 25 26 28
 [51] 28 20 27 10 26 28 28 29 28 20 27 24 27 24 25 19 24 29 24 28 24 28 29 26 26
 [76] 29 28 29  4 28 29 22 28 28 27 26 25 29 24 21 20 27 29 29 27 25 25 29 12 13
[101] 21 24 26 25 12 29 29 27 22 16 25 24 27 29 28 19 21 26 27 29 27 26 26 28 27
[126] 25 25 29 26 29 29 28 26 27 26 12
attr(,"Labels")
 [1] "innersurfaceofpinebark" "brick"                  "cardboard"             
 [4] "cork"                   "rubbereraser"           "felt"                  
 [7] "leatherwallet"          "rigidplasticsheet"      "veryfinesandpaper"     
[10] "nylonscouringpad"       "cellulosekitchensponge" "wovenstraw"            
[13] "blockofstyrofoam"       "unglazedceramictile"    "velvet"                
[16] "waxpaper"               "glossypaintedwood"     
attr(,"Size")
[1] 17
attr(,"call")
as.dist.default(m = .)
attr(,"class")
[1] "dist"
attr(,"Diag")
[1] FALSE
attr(,"Upper")
[1] FALSE</code></pre>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unclass</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 22 23 24 26 27 26 23 24 23 23 18 23 21 28 24 22 27 27 27 29 29 28 16 18 28
 [26] 25 24 10 29 28 27 18 19 28 23 24 24 29 27 28 21 26 28 24 23 15 28 25 26 28
 [51] 28 20 27 10 26 28 28 29 28 20 27 24 27 24 25 19 24 29 24 28 24 28 29 26 26
 [76] 29 28 29  4 28 29 22 28 28 27 26 25 29 24 21 20 27 29 29 27 25 25 29 12 13
[101] 21 24 26 25 12 29 29 27 22 16 25 24 27 29 28 19 21 26 27 29 27 26 26 28 27
[126] 25 25 29 26 29 29 28 26 27 26 12
attr(,"Labels")
 [1] "innersurfaceofpinebark" "brick"                  "cardboard"             
 [4] "cork"                   "rubbereraser"           "felt"                  
 [7] "leatherwallet"          "rigidplasticsheet"      "veryfinesandpaper"     
[10] "nylonscouringpad"       "cellulosekitchensponge" "wovenstraw"            
[13] "blockofstyrofoam"       "unglazedceramictile"    "velvet"                
[16] "waxpaper"               "glossypaintedwood"     
attr(,"Size")
[1] 17
attr(,"call")
as.dist.default(m = .)
attr(,"Diag")
[1] FALSE
attr(,"Upper")
[1] FALSE</code></pre>
</div>
</div>
<p>This one gets rid of any special kind of thing that <code>d</code> is, and displays it like a thing without any special properties.</p>
<p>It’s the “attribute” called <code>Labels</code> that we need to grab:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(d)<span class="sc">$</span>Labels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "innersurfaceofpinebark" "brick"                  "cardboard"             
 [4] "cork"                   "rubbereraser"           "felt"                  
 [7] "leatherwallet"          "rigidplasticsheet"      "veryfinesandpaper"     
[10] "nylonscouringpad"       "cellulosekitchensponge" "wovenstraw"            
[13] "blockofstyrofoam"       "unglazedceramictile"    "velvet"                
[16] "waxpaper"               "glossypaintedwood"     </code></pre>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Plot your multidimensional scaling map. To do this, first create a data frame containing the points you want to plot and their labels, and then plot the points labelled by the right thing.</li>
</ol>
<p>Solution</p>
<p>The “labels” need to be the letter names, which is why I made you find them in the previous part. I’m going to do this with a pipe, or else I’ll create <em>another</em> thing called <code>d</code> and overwrite the one I wanted to keep, again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(d<span class="fl">.1</span>, <span class="at">names =</span> letter_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in data.frame(d.1, names = letter_names): arguments imply differing number of rows: 17, 0</code></pre>
</div>
</div>
<p>So far so good. The coordinates have gained names <code>X1</code> and <code>X2</code> (as they did before, but I wanted to check). This is what happens when you turn a matrix with nameless columns into a data frame. So I can proceed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(d<span class="fl">.1</span>, <span class="at">names =</span> letter_names) <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">label =</span> names)) <span class="sc">+</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text_repel</span>() <span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in data.frame(d.1, names = letter_names): arguments imply differing number of rows: 17, 0</code></pre>
</div>
</div>
<p>I need the last line for the same reason as before: I want to treat the two axes equally. If you don’t have that, you have a distorted map where one of the coordinates appears to be more important than the other.</p>
<p>If you can’t get <code>ggrepel</code> to behave itself, an equally good alternative is to plot the letter names instead of the labelled dots. To do that, take out the <code>geom_point</code> and add an ordinary <code>geom_text</code>. This will plot, <em>at</em> the location given by the <code>x</code> and <code>y</code>, the text in <code>label</code>, centred at the location. (If you have <code>geom_point()</code> as well, you’ll get a black dot in the middle of each piece of text.) <code>geom_text</code> has options to justify the text relative to the point, so you can see both, but I’ve always found these rather finicky, so I’d rather let <code>geom_text_repel</code> do the work of figuring out where to put the text relative to the point.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(d<span class="fl">.1</span>, <span class="at">names =</span> letter_names) <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">label =</span> names)) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>() <span class="sc">+</span> <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in data.frame(d.1, names = letter_names): arguments imply differing number of rows: 17, 0</code></pre>
</div>
</div>
<p>Then pick (in the next part) a pair of letters that is close together, and proceed. I like the labelled dots better (as a matter of taste), but this way is a perfectly good way to answer the question, so is perfectly acceptable here.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Pick a pair of letters appear close together on your map. Does it make sense, from looking at these letters, that they would be easy to confuse? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>My map has four pairs of close-together letters: C and G, H and M, N and W, Q and D. Pick one of those pairs. I don’t mind which pair you pick. (If you got something different, pick from what your map shows.) I think it is not at all surprising that these pairs of letters got confused, because the letters of each pair have similar shapes (which is all you’d have to react to if you see them for “a few milliseconds” each): C and G circular with a hole on the right, H, M, N and W vertical lines on the outside with something across the middle, Q and D almost circular. (It’s up to you whether you consider H, M, N and W as a group of four or as two pairs.)</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Verify that your chosen pair of letters was often confused in the data.</li>
</ol>
<p>Solution</p>
<p>The data we read in from the file was this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>letters</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["C"],"name":[1],"type":["chr"],"align":["left"]},{"label":["D"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["G"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["H"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["M"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["N"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Q"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["W"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"C","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0"},{"1":"D","2":"5","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0"},{"1":"G","2":"12","3":"2","4":"0","5":"0","6":"0","7":"0","8":"0"},{"1":"H","2":"2","3":"4","4":"3","5":"0","6":"0","7":"0","8":"0"},{"1":"M","2":"2","3":"3","4":"2","5":"10","6":"0","7":"0","8":"0"},{"1":"N","2":"2","3":"4","4":"1","5":"18","6":"16","7":"0","8":"0"},{"1":"Q","2":"9","3":"20","4":"9","5":"1","6":"2","7":"8","8":"0"},{"1":"W","2":"1","3":"5","4":"2","5":"5","6":"18","7":"13","8":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Then look for your pair of letters:</p>
<p>These are four of the biggest numbers in the matrix, which is as it should be. You need to find the number of confusions for your pair of letters and assert that it is large (compared to the others).</p>
<p>These are actually not <em>all</em> the large ones: M and W, H and N, M and N are also large (which lends some support to these letters being a foursome<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> rather than two pairs).</p>
<p>If you prefer, you can work from your <code>dist</code> object, the thing I called <code>d</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       innersurfaceofpinebark brick cardboard cork rubbereraser
brick                                      22                                  
cardboard                                  23    27                            
cork                                       24    27        18                  
rubbereraser                               26    27        19   15             
felt                                       27    29        28   28           28
leatherwallet                              26    29        23   25           20
rigidplasticsheet                          23    28        24   26           27
veryfinesandpaper                          24    16        24   28           24
nylonscouringpad                           23    18        29   28           27
cellulosekitchensponge                     23    28        27   20           24
wovenstraw                                 18    25        28   27           25
blockofstyrofoam                           23    24        21   10           19
unglazedceramictile                        21    10        26   26           24
velvet                                     28    29        28   28           29
waxpaper                                   24    28        24   28           24
glossypaintedwood                          22    27        23   29           28
                       felt leatherwallet rigidplasticsheet veryfinesandpaper
brick                                                                        
cardboard                                                                    
cork                                                                         
rubbereraser                                                                 
felt                                                                         
leatherwallet            24                                                  
rigidplasticsheet        28            22                                    
veryfinesandpaper        29            28                27                  
nylonscouringpad         26            28                29                21
cellulosekitchensponge   26            27                29                24
wovenstraw               29            26                27                26
blockofstyrofoam         28            25                25                25
unglazedceramictile      29            29                25                12
velvet                    4            24                29                29
waxpaper                 28            21                12                29
glossypaintedwood        29            20                13                27
                       nylonscouringpad cellulosekitchensponge wovenstraw
brick                                                                    
cardboard                                                                
cork                                                                     
rubbereraser                                                             
felt                                                                     
leatherwallet                                                            
rigidplasticsheet                                                        
veryfinesandpaper                                                        
nylonscouringpad                                                         
cellulosekitchensponge               22                                  
wovenstraw                           16                     19           
blockofstyrofoam                     25                     21         26
unglazedceramictile                  24                     26         26
velvet                               27                     27         28
waxpaper                             29                     29         27
glossypaintedwood                    28                     27         25
                       blockofstyrofoam unglazedceramictile velvet waxpaper
brick                                                                      
cardboard                                                                  
cork                                                                       
rubbereraser                                                               
felt                                                                       
leatherwallet                                                              
rigidplasticsheet                                                          
veryfinesandpaper                                                          
nylonscouringpad                                                           
cellulosekitchensponge                                                     
wovenstraw                                                                 
blockofstyrofoam                                                           
unglazedceramictile                  25                                    
velvet                               29                  29                
waxpaper                             26                  28     27         
glossypaintedwood                    29                  26     26       12</code></pre>
</div>
</div>
<p>This time, you’re looking for a <em>small</em> dissimilarity between your pair of letters:</p>
<p>These, again, are smaller than most, though not the smallest overall. So, if you go this way, you need to assert that the corresponding number in your <code>dist</code> object is <em>small</em>.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="more-beer-please-1" class="level2" data-number="39.9">
<h2 data-number="39.9" class="anchored" data-anchor-id="more-beer-please-1"><span class="header-section-number">39.9</span> More beer please</h2>
<p>Previously, you did a cluster analysis of ten brands of beer, as rated by 32 students. This time, we will do a non-metric multidimensional scaling of those same brands of beer. The data are in <a href="http://ritsokiguess.site/datafiles/beer.txt">link</a>.</p>
<ol type="a">
<li>Noting that we want to assess distances between brands of beer, read in the data and do whatever you need to do to work out distances between the beers. Show your result.</li>
</ol>
<p>Solution</p>
<p>This is really a copy of last time. We need to transpose the data frame to get the beers in <em>rows</em> (<code>dist</code> works on distances between rows), then feed everything but the student IDs into <code>dist</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/beer.txt"</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>beer <span class="ot">&lt;-</span> <span class="fu">read_table</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
── Column specification ────────────────────────────────────────────────────────
cols(
  student = col_character(),
  AnchorS = col_double(),
  Bass = col_double(),
  Becks = col_double(),
  Corona = col_double(),
  GordonB = col_double(),
  Guinness = col_double(),
  Heineken = col_double(),
  PetesW = col_double(),
  SamAdams = col_double(),
  SierraN = col_double()
)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>beer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["student"],"name":[1],"type":["chr"],"align":["left"]},{"label":["AnchorS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Bass"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Becks"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Corona"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["GordonB"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Guinness"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Heineken"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["PetesW"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["SamAdams"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["SierraN"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"S001","2":"5","3":"9","4":"7","5":"1","6":"7","7":"6","8":"6","9":"5","10":"9","11":"5"},{"1":"S008","2":"7","3":"5","4":"6","5":"8","6":"8","7":"4","8":"8","9":"8","10":"7","11":"7"},{"1":"S015","2":"7","3":"7","4":"5","5":"6","6":"6","7":"1","8":"8","9":"4","10":"7","11":"5"},{"1":"S022","2":"7","3":"7","4":"5","5":"2","6":"5","7":"8","8":"4","9":"6","10":"8","11":"9"},{"1":"S029","2":"9","3":"7","4":"3","5":"1","6":"6","7":"8","8":"2","9":"7","10":"6","11":"8"},{"1":"S036","2":"7","3":"6","4":"4","5":"3","6":"7","7":"6","8":"6","9":"5","10":"4","11":"9"},{"1":"S043","2":"5","3":"5","4":"5","5":"6","6":"6","7":"4","8":"7","9":"5","10":"5","11":"6"},{"1":"S050","2":"5","3":"3","4":"1","5":"5","6":"5","7":"5","8":"3","9":"5","10":"5","11":"9"},{"1":"S057","2":"9","3":"3","4":"2","5":"6","6":"4","7":"6","8":"1","9":"5","10":"3","11":"6"},{"1":"S064","2":"2","3":"6","4":"6","5":"5","6":"6","7":"4","8":"8","9":"4","10":"4","11":"3"},{"1":"S071","2":"7","3":"7","4":"7","5":"5","6":"7","7":"8","8":"6","9":"7","10":"7","11":"8"},{"1":"S078","2":"8","3":"3","4":"3","5":"9","6":"9","7":"2","8":"1","9":"9","10":"7","11":"8"},{"1":"S085","2":"6","3":"5","4":"3","5":"7","6":"6","7":"5","8":"8","9":"6","10":"7","11":"5"},{"1":"S092","2":"5","3":"6","4":"3","5":"8","6":"6","7":"7","8":"6","9":"7","10":"6","11":"7"},{"1":"S099","2":"4","3":"7","4":"2","5":"8","6":"5","7":"9","8":"8","9":"3","10":"8","11":"8"},{"1":"S106","2":"3","3":"3","4":"4","5":"5","6":"6","7":"5","8":"9","9":"7","10":"5","11":"5"},{"1":"S113","2":"2","3":"4","4":"5","5":"7","6":"6","7":"6","8":"8","9":"1","10":"7","11":"4"},{"1":"S120","2":"9","3":"3","4":"7","5":"4","6":"2","7":"4","8":"6","9":"3","10":"8","11":"6"},{"1":"S127","2":"5","3":"3","4":"4","5":"7","6":"7","7":"7","8":"6","9":"6","10":"6","11":"6"},{"1":"S134","2":"2","3":"4","4":"4","5":"8","6":"5","7":"5","8":"5","9":"4","10":"6","11":"6"},{"1":"S141","2":"5","3":"7","4":"6","5":"7","6":"5","7":"8","8":"8","9":"7","10":"5","11":"7"},{"1":"S148","2":"8","3":"9","4":"6","5":"7","6":"7","7":"8","8":"6","9":"8","10":"8","11":"8"},{"1":"S162","2":"5","3":"6","4":"6","5":"7","6":"5","7":"3","8":"7","9":"3","10":"4","11":"3"},{"1":"S169","2":"5","3":"5","4":"6","5":"7","6":"7","7":"4","8":"6","9":"3","10":"7","11":"6"},{"1":"S176","2":"5","3":"5","4":"7","5":"8","6":"7","7":"6","8":"7","9":"5","10":"4","11":"7"},{"1":"S183","2":"3","3":"5","4":"4","5":"7","6":"3","7":"1","8":"2","9":"6","10":"6","11":"5"},{"1":"S190","2":"4","3":"3","4":"6","5":"8","6":"6","7":"1","8":"8","9":"2","10":"7","11":"7"},{"1":"S197","2":"3","3":"8","4":"4","5":"8","6":"6","7":"2","8":"8","9":"4","10":"6","11":"1"},{"1":"S204","2":"3","3":"5","4":"1","5":"5","6":"5","7":"3","8":"4","9":"6","10":"7","11":"5"},{"1":"S211","2":"3","3":"8","4":"5","5":"8","6":"7","7":"5","8":"5","9":"3","10":"7","11":"8"},{"1":"S218","2":"8","3":"8","4":"5","5":"7","6":"9","7":"9","8":"7","9":"7","10":"6","11":"8"},{"1":"S225","2":"7","3":"6","4":"2","5":"2","6":"6","7":"6","8":"2","9":"7","10":"5","11":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> beer <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>student) <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I did it the funny-looking way. The cluster analysis question offers an alternative.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Obtain a non-metric multidimensional scaling of the beers. (Comment coming up in a moment.)</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>beer<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">isoMDS</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>initial  value 13.344792 
iter   5 value 10.855662
iter  10 value 10.391446
final  value 10.321949 
converged</code></pre>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>Obtain the <code>stress</code> value of the map, and comment on it.</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>beer<span class="fl">.1</span><span class="sc">$</span>stress</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.32195</code></pre>
</div>
</div>
<p>The stress is around 10%, on the boundary between “good” and “fair”. It seems as if the map should be more or less worth using. (Insert your own hand-waving language here.)</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Obtain a map of the beers, labelled with the names of the beers.</li>
</ol>
<p>Solution</p>
<p>This is slightly different from class, where I plotted the languages actually <em>at</em> their locations. But here, the beer names are longer, so we should plot the points and label them. I’d make a data frame first, and probably pipe it into the plot, thus. Don’t forget we have to get the names of the 10 beers, and not the 32 students! The names of the columns of the data frame include an identifier column for the students, so skip the first one:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>beer_names <span class="ot">&lt;-</span> beer <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>student) <span class="sc">%&gt;%</span> <span class="fu">names</span>()</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>beer_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "AnchorS"  "Bass"     "Becks"    "Corona"   "GordonB"  "Guinness"
 [7] "Heineken" "PetesW"   "SamAdams" "SierraN" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(beer<span class="fl">.1</span><span class="sc">$</span>points, <span class="at">beer =</span> beer_names) <span class="sc">%&gt;%</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">label =</span> beer)) <span class="sc">+</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text_repel</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/beermds-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Find a pair of beers close together on your map. Are they similar in terms of student ratings? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>I think Sam Adams and Gordon Biersch, right in the middle of the map. We can pull them out by name:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>beer <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(SamAdams, GordonB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["SamAdams"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["GordonB"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"9","2":"7"},{"1":"7","2":"8"},{"1":"7","2":"6"},{"1":"8","2":"5"},{"1":"6","2":"6"},{"1":"4","2":"7"},{"1":"5","2":"6"},{"1":"5","2":"5"},{"1":"3","2":"4"},{"1":"4","2":"6"},{"1":"7","2":"7"},{"1":"7","2":"9"},{"1":"7","2":"6"},{"1":"6","2":"6"},{"1":"8","2":"5"},{"1":"5","2":"6"},{"1":"7","2":"6"},{"1":"8","2":"2"},{"1":"6","2":"7"},{"1":"6","2":"5"},{"1":"5","2":"5"},{"1":"8","2":"7"},{"1":"4","2":"5"},{"1":"7","2":"7"},{"1":"4","2":"7"},{"1":"6","2":"3"},{"1":"7","2":"6"},{"1":"6","2":"6"},{"1":"7","2":"5"},{"1":"7","2":"7"},{"1":"6","2":"9"},{"1":"5","2":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>These are, with a few exceptions (the most glaring being the 18th student), within a couple of points of each other. So I would say they are similar. Another way to show this is to make a scatterplot of them, and draw on it the line where the ratings are the same. Since the ratings are whole numbers, they are likely to be duplicated, so I “jitter” them as I plot them, to prevent overplotting:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beer, <span class="fu">aes</span>(<span class="at">x =</span> SamAdams, <span class="at">y =</span> GordonB)) <span class="sc">+</span> <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/adkjalkjdsg-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Are they close to the line, or not? Dunno. Maybe I should plot the ratings of some far-apart beers, and see whether it looks any different, for example <code>Becks</code> and <code>SierraN</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(beer, <span class="fu">aes</span>(<span class="at">x =</span> Becks, <span class="at">y =</span> SierraN)) <span class="sc">+</span> <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/adkjalkjdsh-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Not much. I was expecting something a lot more impressive. Another way is to summarize the rating <em>differences</em> for the pairs of beers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">&lt;-</span> <span class="fu">with</span>(beer, SamAdams <span class="sc">-</span> GordonB)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-3.0000 -1.0000  0.0000  0.1562  1.0000  6.0000 </code></pre>
</div>
</div>
<p>and</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">&lt;-</span> <span class="fu">with</span>(beer, Becks <span class="sc">-</span> SierraN)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  -8.00   -4.00   -1.50   -1.75    0.00    3.00 </code></pre>
</div>
</div>
<p>Now we see something: two beers that are similar ought to have a median rating difference close to 0 most of the time. That is the case for the first pair; the median <em>is</em> zero, and the IQR is only 2. But for the second pair, Becks is typically rated lower than Sierra Nevada (negative median) and the IQR is larger (4 rather than 2).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>In our cluster analysis, we found that Anchor Steam, Pete’s Wicked Ale, Guinness and Sierra Nevada were all in the same cluster. Would you expect them to be close together on your map? Are they? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>If they are in the same cluster, we would expect them to “cluster” together on the map. Except that they don’t, really. These are the four beers over on the right of our map. They are kind of in the same general neighbourhood, but not really what you would call close together. (This is a judgement call, again.) In fact, none of the beers, with the exception of Sam Adams and Gordon Biersch in the centre, are really very close to any of the others.</p>
<p>That may be the story, in the end. With the cluster analysis, we were forcing the clustering to happen, whether it was really there or not. We haven’t seen a test for the “significance” of clusters, so the clusters we found may not mean very much.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="feeling-similar-again-1" class="level2" data-number="39.10">
<h2 data-number="39.10" class="anchored" data-anchor-id="feeling-similar-again-1"><span class="header-section-number">39.10</span> Feeling similar, again</h2>
<p>Previously, we looked at an experiment about which objects feel similar to one another and which ones feel different.</p>
<p>30 subjects were each given 17 different objects to feel, for example “inner surface of pine bark”, “rubber eraser” and “nylon scouring pad”. The subjects had to group the objects into a maximum of 8 groups such that the objects within a group felt similar, and the ones in different groups felt different. A dissimilarity matrix was formed by counting how many subjects put each pair of objects into <em>different</em> groups, so that the dissimilarity ranged from 0 (the objects were always put together in the same group) to 30 (the objects were not put together into the same group by any of the subjects).</p>
<p>The data are in <a href="http://ritsokiguess.site/datafiles/stimuli.txt">link</a>. These have <em>no</em> column names.</p>
<p>This time we are going to try <em>non-metric</em> multidimensional scaling, to see whether that produces a more reasonable map. The reading in of the data is the same as before (so I have reduced the marks given for it).</p>
<ol type="a">
<li>Obtain and display the distance matrix that you used last time for these data. (I don’t care whether you run all the code again, or whether you just produce the matrix from where you had it before on R Studio. Correct is all I care about.)</li>
</ol>
<p>Solution</p>
<p>Copied and pasted from last time:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/stimuli.txt"</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>stimuli <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>, <span class="at">col_names =</span> F)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>objects <span class="ot">&lt;-</span> stimuli<span class="sc">$</span>X1</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stimuli) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"object"</span>, objects)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>stimuli</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["object"],"name":[1],"type":["chr"],"align":["left"]},{"label":["innersurfaceofpinebark"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["brick"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["cardboard"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["cork"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["rubbereraser"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["felt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["leatherwallet"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["rigidplasticsheet"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["veryfinesandpaper"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["nylonscouringpad"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["cellulosekitchensponge"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["wovenstraw"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["blockofstyrofoam"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["unglazedceramictile"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["velvet"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["waxpaper"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["glossypaintedwood"],"name":[18],"type":["dbl"],"align":["right"]}],"data":[{"1":"innersurfaceofpinebark","2":"0","3":"22","4":"23","5":"24","6":"26","7":"27","8":"26","9":"23","10":"24","11":"23","12":"23","13":"18","14":"23","15":"21","16":"28","17":"24","18":"22"},{"1":"brick","2":"22","3":"0","4":"27","5":"27","6":"27","7":"29","8":"29","9":"28","10":"16","11":"18","12":"28","13":"25","14":"24","15":"10","16":"29","17":"28","18":"27"},{"1":"cardboard","2":"23","3":"27","4":"0","5":"18","6":"19","7":"28","8":"23","9":"24","10":"24","11":"29","12":"27","13":"28","14":"21","15":"26","16":"28","17":"24","18":"23"},{"1":"cork","2":"24","3":"27","4":"18","5":"0","6":"15","7":"28","8":"25","9":"26","10":"28","11":"28","12":"20","13":"27","14":"10","15":"26","16":"28","17":"28","18":"29"},{"1":"rubbereraser","2":"26","3":"27","4":"19","5":"15","6":"0","7":"28","8":"20","9":"27","10":"24","11":"27","12":"24","13":"25","14":"19","15":"24","16":"29","17":"24","18":"28"},{"1":"felt","2":"27","3":"29","4":"28","5":"28","6":"28","7":"0","8":"24","9":"28","10":"29","11":"26","12":"26","13":"29","14":"28","15":"29","16":"4","17":"28","18":"29"},{"1":"leatherwallet","2":"26","3":"29","4":"23","5":"25","6":"20","7":"24","8":"0","9":"22","10":"28","11":"28","12":"27","13":"26","14":"25","15":"29","16":"24","17":"21","18":"20"},{"1":"rigidplasticsheet","2":"23","3":"28","4":"24","5":"26","6":"27","7":"28","8":"22","9":"0","10":"27","11":"29","12":"29","13":"27","14":"25","15":"25","16":"29","17":"12","18":"13"},{"1":"veryfinesandpaper","2":"24","3":"16","4":"24","5":"28","6":"24","7":"29","8":"28","9":"27","10":"0","11":"21","12":"24","13":"26","14":"25","15":"12","16":"29","17":"29","18":"27"},{"1":"nylonscouringpad","2":"23","3":"18","4":"29","5":"28","6":"27","7":"26","8":"28","9":"29","10":"21","11":"0","12":"22","13":"16","14":"25","15":"24","16":"27","17":"29","18":"28"},{"1":"cellulosekitchensponge","2":"23","3":"28","4":"27","5":"20","6":"24","7":"26","8":"27","9":"29","10":"24","11":"22","12":"0","13":"19","14":"21","15":"26","16":"27","17":"29","18":"27"},{"1":"wovenstraw","2":"18","3":"25","4":"28","5":"27","6":"25","7":"29","8":"26","9":"27","10":"26","11":"16","12":"19","13":"0","14":"26","15":"26","16":"28","17":"27","18":"25"},{"1":"blockofstyrofoam","2":"23","3":"24","4":"21","5":"10","6":"19","7":"28","8":"25","9":"25","10":"25","11":"25","12":"21","13":"26","14":"0","15":"25","16":"29","17":"26","18":"29"},{"1":"unglazedceramictile","2":"21","3":"10","4":"26","5":"26","6":"24","7":"29","8":"29","9":"25","10":"12","11":"24","12":"26","13":"26","14":"25","15":"0","16":"29","17":"28","18":"26"},{"1":"velvet","2":"28","3":"29","4":"28","5":"28","6":"29","7":"4","8":"24","9":"29","10":"29","11":"27","12":"27","13":"28","14":"29","15":"29","16":"0","17":"27","18":"26"},{"1":"waxpaper","2":"24","3":"28","4":"24","5":"28","6":"24","7":"28","8":"21","9":"12","10":"29","11":"29","12":"29","13":"27","14":"26","15":"28","16":"27","17":"0","18":"12"},{"1":"glossypaintedwood","2":"22","3":"27","4":"23","5":"29","6":"28","7":"29","8":"20","9":"13","10":"27","11":"28","12":"27","13":"25","14":"29","15":"26","16":"26","17":"12","18":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>That gets a data frame with the right column names. Then:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> stimuli <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">as.dist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and just to check:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">getOption</span>(<span class="st">"width"</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> <span class="dv">132</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       innersurfaceofpinebark brick cardboard cork rubbereraser felt leatherwallet rigidplasticsheet
brick                                      22                                                                       
cardboard                                  23    27                                                                 
cork                                       24    27        18                                                       
rubbereraser                               26    27        19   15                                                  
felt                                       27    29        28   28           28                                     
leatherwallet                              26    29        23   25           20   24                                
rigidplasticsheet                          23    28        24   26           27   28            22                  
veryfinesandpaper                          24    16        24   28           24   29            28                27
nylonscouringpad                           23    18        29   28           27   26            28                29
cellulosekitchensponge                     23    28        27   20           24   26            27                29
wovenstraw                                 18    25        28   27           25   29            26                27
blockofstyrofoam                           23    24        21   10           19   28            25                25
unglazedceramictile                        21    10        26   26           24   29            29                25
velvet                                     28    29        28   28           29    4            24                29
waxpaper                                   24    28        24   28           24   28            21                12
glossypaintedwood                          22    27        23   29           28   29            20                13
                       veryfinesandpaper nylonscouringpad cellulosekitchensponge wovenstraw blockofstyrofoam unglazedceramictile
brick                                                                                                                           
cardboard                                                                                                                       
cork                                                                                                                            
rubbereraser                                                                                                                    
felt                                                                                                                            
leatherwallet                                                                                                                   
rigidplasticsheet                                                                                                               
veryfinesandpaper                                                                                                               
nylonscouringpad                      21                                                                                        
cellulosekitchensponge                24               22                                                                       
wovenstraw                            26               16                     19                                                
blockofstyrofoam                      25               25                     21         26                                     
unglazedceramictile                   12               24                     26         26               25                    
velvet                                29               27                     27         28               29                  29
waxpaper                              29               29                     29         27               26                  28
glossypaintedwood                     27               28                     27         25               29                  26
                       velvet waxpaper
brick                                 
cardboard                             
cork                                  
rubbereraser                          
felt                                  
leatherwallet                         
rigidplasticsheet                     
veryfinesandpaper                     
nylonscouringpad                      
cellulosekitchensponge                
wovenstraw                            
blockofstyrofoam                      
unglazedceramictile                   
velvet                                
waxpaper                   27         
glossypaintedwood          26       12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width =</span> w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Obtain a non-metric multidimensional scaling map of the objects. (No plotting or comments yet.)</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>stimuli<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">isoMDS</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>initial  value 25.537169 
iter   5 value 20.521473
final  value 20.216103 
converged</code></pre>
</div>
</div>
<p>I’m going to remind myself of what this has in it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stimuli<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "points" "stress"</code></pre>
</div>
</div>
<p>This is rather like running <code>cmdscale</code> with <code>eig=T</code>: a thing called <code>points</code> with coordinates to plot, and a measure of fit, here called <code>stress</code>, with, as you’d guess, a smaller <code>stress</code> being better.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li><a name="part:stress">*</a> Obtain a number that says how well the map reproduces the distances in the data, and comment on that number.</li>
</ol>
<p>Solution</p>
<p>What you need here is the “stress”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>stimuli<span class="fl">.1</span><span class="sc">$</span>stress</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.2161</code></pre>
</div>
</div>
<p>This is just over 20%, which is described in the notes as “poor”. We should thus be skeptical about the map that this produces.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Plot the non-metric multidimensional scaling map. Label each point with its (full) object name, sized suitably.</li>
</ol>
<p>Solution</p>
<p>Make a data frame first of things to plot, the points and the names. I’m going to plot the names smaller). I am <em>not</em> naming this data frame <code>d</code>, in an attempt to avoid overwriting things I want to keep:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>stimuli.<span class="fl">1.</span>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(stimuli<span class="fl">.1</span><span class="sc">$</span>points, <span class="at">names =</span> objects)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>stimuli.<span class="fl">1.</span>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["X2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["names"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"-1.5343296","2":"1.3163495","3":"innersurfaceofpinebark","_rn_":"innersurfaceofpinebark"},{"1":"-11.1198228","2":"4.1255022","3":"brick","_rn_":"brick"},{"1":"3.7481838","2":"-9.4875599","3":"cardboard","_rn_":"cardboard"},{"1":"-0.8637631","2":"-11.6740046","3":"cork","_rn_":"cork"},{"1":"0.9478406","2":"-9.9955340","3":"rubbereraser","_rn_":"rubbereraser"},{"1":"3.7030786","2":"15.0204325","3":"felt","_rn_":"felt"},{"1":"9.5323886","2":"-3.3715939","3":"leatherwallet","_rn_":"leatherwallet"},{"1":"11.3370118","2":"-0.5134769","3":"rigidplasticsheet","_rn_":"rigidplasticsheet"},{"1":"-12.7743812","2":"1.1092242","3":"veryfinesandpaper","_rn_":"veryfinesandpaper"},{"1":"-9.1348586","2":"8.0045364","3":"nylonscouringpad","_rn_":"nylonscouringpad"},{"1":"-8.2296607","2":"-6.3368839","3":"cellulosekitchensponge","_rn_":"cellulosekitchensponge"},{"1":"-4.3321533","2":"5.1303993","3":"wovenstraw","_rn_":"wovenstraw"},{"1":"-3.3540109","2":"-9.7135472","3":"blockofstyrofoam","_rn_":"blockofstyrofoam"},{"1":"-10.7345424","2":"-0.4673140","3":"unglazedceramictile","_rn_":"unglazedceramictile"},{"1":"7.0712701","2":"15.3712514","3":"velvet","_rn_":"velvet"},{"1":"14.2695604","2":"-0.7584453","3":"waxpaper","_rn_":"waxpaper"},{"1":"11.4681889","2":"2.2406642","3":"glossypaintedwood","_rn_":"glossypaintedwood"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The repeated stimuli down the left are row names, but since they’re row names, we won’t be able to use them in <code>ggplot</code>.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<p>Remember that we are turning a matrix and a column into a data frame, so we need either the more forgiving <code>data.frame</code>, or to turn <code>points</code> into a data frame first, which would go like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(stimuli<span class="fl">.1</span><span class="sc">$</span>points) <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> objects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if
`.name_repair` is omitted as of tibble 2.0.0.
ℹ Using compatibility `.name_repair`.</code></pre>
</div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["V1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["V2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["name"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"-1.5343296","2":"1.3163495","3":"innersurfaceofpinebark"},{"1":"-11.1198228","2":"4.1255022","3":"brick"},{"1":"3.7481838","2":"-9.4875599","3":"cardboard"},{"1":"-0.8637631","2":"-11.6740046","3":"cork"},{"1":"0.9478406","2":"-9.9955340","3":"rubbereraser"},{"1":"3.7030786","2":"15.0204325","3":"felt"},{"1":"9.5323886","2":"-3.3715939","3":"leatherwallet"},{"1":"11.3370118","2":"-0.5134769","3":"rigidplasticsheet"},{"1":"-12.7743812","2":"1.1092242","3":"veryfinesandpaper"},{"1":"-9.1348586","2":"8.0045364","3":"nylonscouringpad"},{"1":"-8.2296607","2":"-6.3368839","3":"cellulosekitchensponge"},{"1":"-4.3321533","2":"5.1303993","3":"wovenstraw"},{"1":"-3.3540109","2":"-9.7135472","3":"blockofstyrofoam"},{"1":"-10.7345424","2":"-0.4673140","3":"unglazedceramictile"},{"1":"7.0712701","2":"15.3712514","3":"velvet"},{"1":"14.2695604","2":"-0.7584453","3":"waxpaper"},{"1":"11.4681889","2":"2.2406642","3":"glossypaintedwood"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This time, the columns are called <code>V1</code> and <code>V2</code>, since that’s what <code>as_tibble</code> does. Also note the slightly different look: fewer decimals, since displaying a tibble rounds numerical things to three significant digits. Back to my data frame <code>stimuli.1.d</code>. The points have acquired names <code>X1</code> and <code>X2</code>, as usual, so we have all we need:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stimuli.<span class="fl">1.</span>d, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, <span class="at">label =</span> names)) <span class="sc">+</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/hon-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I think the full names are good with the text this small.</p>
<p>Actually, this came out a lot like the metric multidimensional scaling that we did earlier.</p>
<p>I was expecting a greater difference. See whether you can find out what moved, if anything.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li><a name="part:incons">*</a> Find all the distances in your distance matrix that are 10 or less (there should be three of them). Find these pairs of objects on your map. Describe where they are on your map. Do they appear to be the three closest pairs of objects?</li>
</ol>
<p>Solution</p>
<p>These are:</p>
<ul>
<li><p><code>velvet</code> and <code>felt</code> (distance 4). On the map, close together at the top.</p></li>
<li><p><code>block of styrofoam</code> and <code>cork</code> (distance 10). On the map, close together at the bottom (though they appear to be slightly farther apart than <code>rubbereraser</code> and <code>cardboard</code>).</p></li>
<li><p><code>unglazed ceramic tile</code> and <code>brick</code> (distance 10). On the map, on the left but not especially close together (for example, <code>very fine sandpaper</code> is in between them and thus closer to both).</p></li>
</ul>
<p>I would say that they are not anything like the three closest pairs of objects on the map. Consider, for example, and <code>wax paper</code>, or and <code>unglazed ceramic tile</code>, or and <code>cardboard</code>, all of which are closer together on the map than the three pairs of objects with distances 10 or less. Three points for saying something about the three pairs of objects of distance 10 or less, and one point for making some relevant comment about whether these are the three closest pairs on the map, eg. by finding one pair (or more than one) of objects on the map that are closer.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Consider again your conclusions in parts (<a href="#part:stress">here</a>) and (<a href="#part:incons">here</a>). Explain briefly how they are consistent.</li>
</ol>
<p>Solution</p>
<p>The stress is rather high, which means that the map distances and actual distances may not correspond very well. This is also exactly what we found in the last part, by finding one (or two) pairs of objects that were really close in actuality, but not so much on the map. The point here is that a high stress <em>means</em> that distances in real life and on the map won’t correspond very well. That’s what I want you to say. Extra: another way to assess this is with a Shepard<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> diagram. That would go like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>stimuli.sh <span class="ot">&lt;-</span> <span class="fu">Shepard</span>(d, stimuli<span class="fl">.1</span><span class="sc">$</span>points)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(stimuli.sh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "x"  "y"  "yf"</code></pre>
</div>
</div>
<p>In here, we plot the actual distances <code>x</code> against the map distances <code>y</code>, making a data frame first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(stimuli.sh, <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">%&gt;%</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mds_files/figure-html/sporers-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The actual distances are on the <span class="math inline">\(x\)</span>-axis and the map distances are on the <span class="math inline">\(y\)</span> axis, as far as I can tell (the help file is not clear on this). But I think I am right, since a lot of the actual distances were 28 or 29. Notice how the upward trend, such as it is, is very fuzzy: when the actual distance is very large, the map distance could be almost anything.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Would a three-dimensional map work better than a two-dimensional one, bearing in mind that a three-dimensional map will need something like <code>rgl</code> to interpret? Calculate something that will help you decide, and explain what you think.</li>
</ol>
<p>Solution</p>
<p>The calculation part is to figure out the stress value for a three-dimensional map, and compare it with the 20% that we had before. <code>k=3</code> gets the three dimensions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">isoMDS</span>(d, <span class="at">k =</span> <span class="dv">3</span>)<span class="sc">$</span>stress</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>initial  value 14.934110 
iter   5 value 11.280474
iter  10 value 10.094796
iter  15 value 9.938456
final  value 9.859657 
converged</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.859657</code></pre>
</div>
</div>
<p>What this does is to obtain the map and throw all of it away except for the stress value.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></p>
<p>I think this stress value, just under 10%, or on the “fair” end of “good”, is a worthwhile improvement over the just-over-20% that we had in two dimensions. So I think this is worth the trouble of having to use a 3-dimensional plotting tool like <code>rgl</code> to interpret it with. You might agree with me, or you might not: for example, you might be looking for a bigger improvement. Either is good, as far as I’m concerned, as long as your answer does something to balance the smaller stress value<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a> with the difficulty of interpreting it.</p>
<p>The kind of <code>rgl</code> code you’ll need is something like this (not tested):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgl)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>stimuli<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">isoMDS</span>(d, <span class="at">k =</span> <span class="dv">3</span>)<span class="sc">$</span>points</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot3d</span>(stimuli<span class="fl">.2</span>)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text3d</span>(stimuli<span class="fl">.2</span>, <span class="at">text =</span> object.abb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What you should find, looking at this (try it!) is that objects close together in this 3-dimensional place are more nearly close together in actuality as well, because of the in my opinion notably smaller stress value.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Probably students in a psychology course. You know how it goes.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The maximum number of groups was to ensure that each subject actually <em>did</em> group some objects together, rather than saying that they all feel different.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>As it ought to be, since there is a real answer here: the cities <em>do</em> exist as locations in two dimensions, if you ignore the curvature of the earth. The goodness of fit isn’t 100% because the roads bend a bit.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Probably students in a psychology course. You know how it goes.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The maximum number of groups was to ensure that each subject actually <em>did</em> group some objects together, rather than saying that they all feel different.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>I lie. Last year, <em>I</em> got cork at the top, and a lot of other people got cork at the bottom as you see here.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>The first association that <em>unglazed</em> made for me was <em>donut</em>!<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Oxford semicolon, for the grammar mavens among you.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>The way that a multicoloured function like <code>print</code> works is that when you ask to show something, like <code>d</code>, R first looks to see what kind of thing you want to show (by calling <code>class</code>), and determines that it is a <code>dist</code> object. Then it looks to see if there is a function called <code>print.dist</code> (there is), and if there is, it calls that (to produce that nice display). If there isn’t, it calls <code>print.default</code>, which just displays its input without doing anything special. This is why printing the output from an <code>lm</code> looks very different from printing a data frame: the first calls <code>print.lm</code> and the second calls <code>print.data.frame</code>, or <code>print.tbl_df</code> for a tibble.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>Set of four. Match-play golf has a game called <em>foursomes</em> where the two players on each team take it in turns to hit the ball, as opposed to the game called <em>fourballs</em>, where each of the two players plays their own ball, and the team’s score on a hole is the better of the two players’ scores.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>In the future, I’ll make everyone turn matrices into data frames first so that we won’t deal with old-fashioned data frames, row names and the like.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>This always makes me think of the number 985 bus, but that’s the wrong spelling. Spelled like this, this is also the name of the illustrator of the original pre-Disney Winnie-the-Pooh stories. <a href="https://en.wikipedia.org/wiki/E._H._Shepard">See here</a>.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>Which is a very SAS way of doing things: compute a whole bunch of stuff, most of which you ignore.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>Using more dimensions will <em>certainly</em> decrease the stress, in the same way that adding an <span class="math inline">\(x\)</span>-variable to a regression will increase R-squared; it’s the same issue, of whether the change is big enough to be worth having.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./maps.html" class="pagination-link" aria-label="Drawing maps with Leaflet">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Drawing maps with Leaflet</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./pc.html" class="pagination-link" aria-label="Principal Components">
        <span class="nav-page-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Principal Components</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>