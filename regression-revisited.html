<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Problems and Solutions in Applied Statistics (2nd ed) - 26&nbsp; Regression revisited</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./logistic-regression.html" rel="next">
<link href="./stan.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./regression-revisited.html"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Regression revisited</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Problems and Solutions in Applied Statistics (2nd ed)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_used.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting used to R and R Studio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reading-in.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reading in data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./making-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Drawing graphs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-summaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data exploration</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./working-with-dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Working with dataframes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./one-sample-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">One-sample inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-sample-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Two-sample inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Power and sample size</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The sign test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mood-median.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Mood median test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matched-pairs-sign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Matched pairs t and sign test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Normal quantile plots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis-of-variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Analysis of variance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing reports</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Learning to code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dandruff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Treating dandruff</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidying-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Tidying data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Simple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Multiple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Regression with categorical variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dates-and-times.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Dates and times</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vector-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Vector and matrix algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Bootstrap</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Bayesian Statistics with Stan</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-revisited.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Regression revisited</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ordinal-response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Logistic regression with ordinal response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nominal-response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Logistic regression with nominal response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Survival analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova-revisited.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Analysis of variance revisited</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Analysis of covariance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Multivariate analysis of variance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Repeated measures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discriminant-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Discriminant analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Hierarchical cluster analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kmeans-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">K-means cluster analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Drawing maps with Leaflet</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Principal Components</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Factor Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loglin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Frequency table analysis</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#veggie-burgers" id="toc-veggie-burgers" class="nav-link active" data-scroll-target="#veggie-burgers"><span class="header-section-number">26.1</span> Veggie burgers</a></li>
  <li><a href="#blood-pressure" id="toc-blood-pressure" class="nav-link" data-scroll-target="#blood-pressure"><span class="header-section-number">26.2</span> Blood pressure</a></li>
  <li><a href="#contraction-of-heart-muscle" id="toc-contraction-of-heart-muscle" class="nav-link" data-scroll-target="#contraction-of-heart-muscle"><span class="header-section-number">26.3</span> Contraction of heart muscle</a></li>
  <li><a href="#veggie-burgers-1" id="toc-veggie-burgers-1" class="nav-link" data-scroll-target="#veggie-burgers-1"><span class="header-section-number">26.4</span> Veggie burgers</a></li>
  <li><a href="#blood-pressure-1" id="toc-blood-pressure-1" class="nav-link" data-scroll-target="#blood-pressure-1"><span class="header-section-number">26.5</span> Blood pressure</a></li>
  <li><a href="#contraction-of-heart-muscle-1" id="toc-contraction-of-heart-muscle-1" class="nav-link" data-scroll-target="#contraction-of-heart-muscle-1"><span class="header-section-number">26.6</span> Contraction of heart muscle</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Regression revisited</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="veggie-burgers" class="level2" data-number="26.1">
<h2 data-number="26.1" class="anchored" data-anchor-id="veggie-burgers"><span class="header-section-number">26.1</span> Veggie burgers</h2>
<p>You like hamburgers, but you are a vegetarian. What to do? Today, there are many brands of hamburgers without any meat in them. Some of these are designed to taste like meat, and some have their own flavour. A magazine rated the flavour and texture of 12 different (numbered) brands of meatless hamburgers (to give a rating score between 0 and 100), along with the price (in cents), the number of calories, the grams of fat, and the milligrams of sodium. These measurements are per burger. Is it possible to predict the rating score of a brand of meatless hamburger from the other measurements, and if so, how? The data are in <a href="http://ritsokiguess.site/datafiles/veggie-burgers.txt">http://ritsokiguess.site/datafiles/veggie-burgers.txt</a>, in aligned columns.</p>
<ol type="a">
<li><p>Read in and display (most of) the data.</p></li>
<li><p>Fit a suitable regression to predict score from the other measured variables. Display the results.</p></li>
<li><p>It looks as if both <code>price</code> and <code>sodium</code> will be able to be removed from this regression. Do so, explain briefly why another test is necessary, and do that other test. What do you conclude? (Note: if you display your output to the second regression, something rather odd will appear. You can safely ignore that.)</p></li>
<li><p>Another veggie burger (not in the original dataset) has the following values for the explanatory variables: price 91, calories 140, fat 5, sodium 450. What can you say about the likely score for a veggie burger with these values? Obtain a suitable interval, for <em>each</em> of your two models.</p></li>
<li><p>Compare the lengths of your two intervals. Does it make sense that your shorter one should be shorter? Explain briefly.</p></li>
<li><p>Using our second model (the one with only <code>calories</code> and <code>fat</code> in it), find a suitable interval for the mean score when (i) calories is 140 and fat is 5, (ii) calories is 120 and fat is 3. (You should have two intervals.)</p></li>
<li><p>Explain briefly why the second interval is shorter than the first one. Make sure you justify your answer.</p></li>
</ol>
</section>
<section id="blood-pressure" class="level2" data-number="26.2">
<h2 data-number="26.2" class="anchored" data-anchor-id="blood-pressure"><span class="header-section-number">26.2</span> Blood pressure</h2>
<p>Twenty people with high blood pressure had various other measurements taken. The aim was to see which of these were associated with blood pressure, with the aim of understanding what causes high blood pressure. The variables observed were:</p>
<ul>
<li><code>Pt</code>: patient number (ignore)</li>
<li><code>BP</code>: (diastolic) blood pressure, in mmHg</li>
<li><code>Age</code> in years</li>
<li><code>Weight</code> in kg</li>
<li><code>BSA</code>: body surface area, in m<span class="math inline">\(^2\)</span></li>
<li><code>Dur</code>: length of time since diagnosis of high blood pressure, in years</li>
<li><code>Pulse</code>: pulse rate, in beats per minute</li>
<li><code>Stress</code>: score on a questionnaire about stress levels (higher score is more stressed)</li>
</ul>
<p>The data values, separated by <em>tabs</em>, are in <a href="https://ritsokiguess.site/datafiles/bloodpress.txt">https://ritsokiguess.site/datafiles/bloodpress.txt</a>.</p>
<ol type="a">
<li><p>Read in and display (some of) the data.</p></li>
<li><p>Make a plot of the blood pressure against each of the measured explanatory variables. Hint: use the idea from C32 of making a suitable long dataframe and using facets in your graph.</p></li>
<li><p>Which explanatory variables seem to have a moderate or strong linear relationship with blood pressure?</p></li>
<li><p>Run a regression predicting blood pressure from <code>BSA</code> and <code>Weight</code>, and display the output. Does the significance or lack of significance of each of your explanatory variables surprise you? Explain briefly.</p></li>
<li><p>Explain briefly why it does in fact make sense that the regression results came out as they did. You may wish to draw another graph to support your explanation.</p></li>
</ol>
</section>
<section id="contraction-of-heart-muscle" class="level2" data-number="26.3">
<h2 data-number="26.3" class="anchored" data-anchor-id="contraction-of-heart-muscle"><span class="header-section-number">26.3</span> Contraction of heart muscle</h2>
<p>An experiment was carried out on heart muscle in rats. The original description of the experiment was as follows:</p>
<blockquote class="blockquote">
<p>The purpose of this experiment was to assess the influence of calcium in solution on the contraction of heart muscle in rats. The left auricle of 21 rat hearts was isolated and on several occasions a constant-length strip of tissue was electrically stimulated and dipped into various concentrations of calcium chloride solution, after which the shortening of the strip was accurately measured as the response.</p>
</blockquote>
<p>The data are in <a href="http://ritsokiguess.site/datafiles/regression2_muscle.csv">http://ritsokiguess.site/datafiles/regression2_muscle.csv</a>. There are three columns:</p>
<ul>
<li><code>Strip</code>: a label for the strip of tissue treated with calcium chloride (text, ignored by us)</li>
<li><code>Conc</code>: the concentration of calcium chloride, in suitable units</li>
<li><code>Length</code>: the change in length (shortening) of the strip of tissue, mm.</li>
</ul>
<p>There are actually 60 measurements, so some of them came from the same rat, a fact that we ignore in this question.</p>
<ol type="a">
<li><p>Read in and display (some of) the data.</p></li>
<li><p>Make a suitable graph of the two quantitative variables, with a smooth trend.</p></li>
<li><p>Why does your plot suggest that a regression with a squared term would be useful? Fit a suitable regression, and display the results.</p></li>
<li><p>How do you know that adding the squared term was a good idea (or, was not a good idea, depending how your output came out)?</p></li>
<li><p>For concentrations of 2, 3, and 4 units, obtain 95% confidence intervals for the mean <code>Length</code>. Display only the relevant columns of your result, and save it.</p></li>
<li><p>Work out the length of each of your confidence intervals. Does it make sense that the lengths compare as they do? Explain briefly.</p></li>
<li><p>Suppose you have some new rat tissues, not part of the original dataset, and run the same experiment on these with concentrations 2, 3, and 4 units. What are 95% intervals for the predicted <code>Length</code>s that you will observe for these tissues? Display your intervals next to the concentrations they are predictions for.</p></li>
</ol>
<p>My solutions follow:</p>
</section>
<section id="veggie-burgers-1" class="level2" data-number="26.4">
<h2 data-number="26.4" class="anchored" data-anchor-id="veggie-burgers-1"><span class="header-section-number">26.4</span> Veggie burgers</h2>
<p>You like hamburgers, but you are a vegetarian. What to do? Today, there are many brands of hamburgers without any meat in them. Some of these are designed to taste like meat, and some have their own flavour. A magazine rated the flavour and texture of 12 different (numbered) brands of meatless hamburgers (to give a rating score between 0 and 100), along with the price (in cents), the number of calories, the grams of fat, and the milligrams of sodium. These measurements are per burger. Is it possible to predict the rating score of a brand of meatless hamburger from the other measurements, and if so, how? The data are in <a href="http://ritsokiguess.site/datafiles/veggie-burgers.txt">http://ritsokiguess.site/datafiles/veggie-burgers.txt</a>, in aligned columns.</p>
<ol type="a">
<li>Read in and display (most of) the data.</li>
</ol>
<p>Solution</p>
<p>Aligned columns says <code>read_table</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/veggie-burgers.txt"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>burgers <span class="ot">&lt;-</span> <span class="fu">read_table</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
── Column specification ────────────────────────────────────────────────────────
cols(
  brand = col_double(),
  score = col_double(),
  price = col_double(),
  calories = col_double(),
  fat = col_double(),
  sodium = col_double()
)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>burgers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["brand"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["score"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["price"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["calories"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["fat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["sodium"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"70","3":"91","4":"110","5":"4","6":"310"},{"1":"2","2":"45","3":"68","4":"90","5":"0","6":"420"},{"1":"3","2":"43","3":"92","4":"80","5":"1","6":"280"},{"1":"4","2":"41","3":"75","4":"120","5":"5","6":"370"},{"1":"5","2":"39","3":"88","4":"90","5":"0","6":"410"},{"1":"6","2":"30","3":"67","4":"140","5":"4","6":"440"},{"1":"7","2":"68","3":"73","4":"120","5":"4","6":"430"},{"1":"8","2":"56","3":"92","4":"170","5":"6","6":"520"},{"1":"9","2":"40","3":"71","4":"130","5":"4","6":"180"},{"1":"10","2":"34","3":"67","4":"110","5":"2","6":"180"},{"1":"11","2":"30","3":"92","4":"100","5":"1","6":"330"},{"1":"12","2":"26","3":"95","4":"130","5":"2","6":"340"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>There are 12 rows, one per brand, and the columns are as promised (and all quantitative, except for <code>brand</code>, which is an identifier).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Fit a suitable regression to predict score from the other measured variables. Display the results.</li>
</ol>
<p>Solution</p>
<p>The brand is an identifier, so skip that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>burgers<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> price <span class="sc">+</span> calories <span class="sc">+</span> fat <span class="sc">+</span> sodium, <span class="at">data =</span> burgers)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(burgers<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ price + calories + fat + sodium, data = burgers)

Residuals:
    Min      1Q  Median      3Q     Max 
-19.376  -5.358   1.843   7.027  13.454 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) 59.84879   35.67526   1.678   0.1373  
price        0.12868    0.33907   0.380   0.7156  
calories    -0.58048    0.28876  -2.010   0.0843 .
fat          8.49825    3.47215   2.448   0.0443 *
sodium       0.04876    0.04062   1.200   0.2690  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.72 on 7 degrees of freedom
Multiple R-squared:  0.4991,    Adjusted R-squared:  0.2128 
F-statistic: 1.744 on 4 and 7 DF,  p-value: 0.2443</code></pre>
</div>
</div>
<p>My numbering scheme for models is based on the name of the dataframe. Base yours on the response variable <code>score</code> if you prefer. But have a scheme, since there is going to be more than one model in this question.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>It looks as if both <code>price</code> and <code>sodium</code> will be able to be removed from this regression. Do so, explain briefly why another test is necessary, and do that other test. What do you conclude? (Note: if you display your output to the second regression, something rather odd will appear. You can safely ignore that.)</li>
</ol>
<p>Solution</p>
<p>There are several things to keep straight. The first thing is to fit a model without <code>price</code> and <code>sodium</code>. The easiest way to do this is to copy, paste and edit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>burgers<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> calories <span class="sc">+</span> fat, <span class="at">data =</span> burgers)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(burgers<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ calories + fat, data = burgers)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.919  -6.786  -4.352  11.198  16.786 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  75.5907    24.4377   3.093   0.0129 *
calories     -0.4600     0.2701  -1.703   0.1227  
fat           7.7047     3.3703   2.286   0.0481 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.56 on 9 degrees of freedom
Multiple R-squared:  0.3725,    Adjusted R-squared:  0.233 
F-statistic: 2.671 on 2 and 9 DF,  p-value: 0.1228</code></pre>
</div>
</div>
<p>Aside: the odd thing is that <code>calories</code> is no longer significant. This is confusing, because usually what happens is that explanatory variables become <em>more</em> significant when other non-significant variables are removed. So now you may be thinking that <code>calories</code> should be removed as well. But see the Extra for what happens when you do that. This is why I said to ignore the odd thing. End of aside.</p>
<p>However, we removed <em>two</em> explanatory variables at once. This is not supported by the <span class="math inline">\(t\)</span>-tests in the output from <code>burgers.1</code>, because they only say what will happen if we remove <em>one</em> <span class="math inline">\(x\)</span>-variable. Hence, we need a test that says whether removing those two <span class="math inline">\(x\)</span>s at once was reasonable. That is this test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(burgers<span class="fl">.2</span>, burgers<span class="fl">.1</span>, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"9","2":"1418.828","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"7","2":"1132.568","3":"2","4":"286.2603","5":"0.8846367","6":"0.4544337","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>(That is <code>F</code> in quotes, saying to do an <span class="math inline">\(F\)</span>-test, not that anything is <code>FALSE</code>.)</p>
<p>With a P-value of 0.45, this is saying that there is no significant difference in fit between the two models, and so we should prefer the smaller, simpler one <code>burgers.2</code>, with just <code>calories</code> and <code>fat</code> in it, because it fits just as well as the bigger, more complicated one (and therefore we do not need the extra complication).</p>
<p>Extra: What happens if you do backward elimination from here, starting from the best model found so far?</p>
<p>The previous part told us that predicting score from just calories and fat was the best thing to do so far. That was the model I called <code>burgers.2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(burgers<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ calories + fat, data = burgers)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.919  -6.786  -4.352  11.198  16.786 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  75.5907    24.4377   3.093   0.0129 *
calories     -0.4600     0.2701  -1.703   0.1227  
fat           7.7047     3.3703   2.286   0.0481 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.56 on 9 degrees of freedom
Multiple R-squared:  0.3725,    Adjusted R-squared:  0.233 
F-statistic: 2.671 on 2 and 9 DF,  p-value: 0.1228</code></pre>
</div>
</div>
<p>Evidently, <code>calories</code> comes out now:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>burgers<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> fat, <span class="at">data =</span> burgers)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(burgers<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ fat, data = burgers)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.186  -8.538  -2.136   5.898  22.814 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   35.390      6.906   5.124 0.000448 ***
fat            2.949      2.059   1.432 0.182578    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.7 on 10 degrees of freedom
Multiple R-squared:  0.1702,    Adjusted R-squared:  0.08724 
F-statistic: 2.051 on 1 and 10 DF,  p-value: 0.1826</code></pre>
</div>
</div>
<p>Now, there is only one explanatory variable left, and it is <em>no longer significant</em>, so it too has to come out now! This seems to make no sense, since <code>fat</code> was definitely significant before, and we would expect it still to be significant after removing something that was not significant. (Sometimes this happens; this is one of those cases.)</p>
<p>Another way of expressing your surprise is to look at the R-squared values (or the adjusted R-squared values) for the models we have fit so far:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">Model</th>
<th style="text-align: left;">Explanatory</th>
<th style="text-align: right;">R-squared</th>
<th style="text-align: right;">Adj R-sq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;"><code>price + calories + fat + sodium</code></td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.21</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;"><code>calories + fat</code></td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;"><code>fat</code></td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.09</td>
</tr>
</tbody>
</table>
<p>As we go through the models, R-squared goes <em>dramatically</em> down (it will go down because it <em>always</em> goes down when you take things out, but this seems too dramatic). Adjusted R-squared goes up when we take out <code>price</code> and <code>sodium</code>, but it too goes sharply down when we take out <code>calories</code>, which doesn’t seem right.</p>
<p>There is no need to go any further than this, but if you want to take out <code>fat</code> as well, leaving you with no explanatory variables at all, there are a couple of non-obvious ways to do it. One is to use <code>update</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>burgers<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(burgers<span class="fl">.3</span>, . <span class="sc">~</span> . <span class="sc">-</span>fat)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(burgers<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ 1, data = burgers)

Residuals:
   Min     1Q Median     3Q    Max 
-17.50 -10.50  -3.00   4.25  26.50 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   43.500      4.139   10.51 4.49e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.34 on 11 degrees of freedom</code></pre>
</div>
</div>
<p>This says that the predicted <code>score</code> is 43.5, regardless of the values of anything else! There is no R-squared displayed, because that is <em>zero</em> for a model with no <span class="math inline">\(x\)</span>-variables.</p>
<p>The other way is to find out that R understands <code>1</code> to mean a model with just an intercept:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>burgers<span class="fl">.4</span>a <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> burgers)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(burgers<span class="fl">.4</span>a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ 1, data = burgers)

Residuals:
   Min     1Q Median     3Q    Max 
-17.50 -10.50  -3.00   4.25  26.50 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   43.500      4.139   10.51 4.49e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 14.34 on 11 degrees of freedom</code></pre>
</div>
</div>
<p>Once again, the R-squared is zero.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Another veggie burger (not in the original dataset) has the following values for the explanatory variables: price 91, calories 140, fat 5, sodium 450. What can you say about the likely score for a veggie burger with these values? Obtain a suitable interval, for <em>each</em> of your two models.</li>
</ol>
<p>Solution</p>
<p>This is talking about the predicted response for an individual (<em>this</em> burger), not the mean response for <em>all</em> veggie burgers with those values for the explanatory variables, so it calls for a <em>prediction interval</em> in each case. This is the one that uses <code>predict</code>, not the one that uses the <code>marginaleffects</code> package (the one we did second in lecture).</p>
<p>The first step is to make a dataframe, by my tradition called <code>new</code>, of values to predict for. Any way that produces you a one-row dataframe is good, for example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>price, <span class="sc">~</span>calories, <span class="sc">~</span>fat, <span class="sc">~</span>sodium,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">91</span>,        <span class="dv">140</span>,      <span class="dv">5</span>,      <span class="dv">450</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["price"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["calories"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["fat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sodium"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"91","2":"140","3":"5","4":"450"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>If you are stuck, type the values into a file (or even a spreadsheet) and read that in. But find a way.</p>
<p>For the model with all four explanatory variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(burgers<span class="fl">.1</span>, new, <span class="at">interval =</span> <span class="st">"p"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 54.72593 20.13798 89.31389</code></pre>
</div>
</div>
<p>and for the model with only two:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(burgers<span class="fl">.2</span>, new, <span class="at">interval =</span> <span class="st">"p"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 49.71981 18.63013 80.80949</code></pre>
</div>
</div>
<p>These intervals are distressingly wide, as is usually the way with prediction intervals (and we only have 12 observations to base the interval on). Also, it didn’t matter that in the second case, <code>new</code> had some extra columns in it; these were just ignored.</p>
<p>Extra: these values are one SD above the mean in each case. How did I work them out? Like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>burgers <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(price<span class="sc">:</span>sodium, <span class="fu">list</span>(<span class="at">mean =</span> \(x) <span class="fu">mean</span>(x), <span class="at">sd =</span> \(x) <span class="fu">sd</span>(x)))) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"variable"</span>, <span class="st">".value"</span>), <span class="at">names_sep =</span> <span class="st">"_"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"price","2":"80.91667","3":"11.555859"},{"1":"calories","2":"115.83333","3":"25.030285"},{"1":"fat","2":"2.75000","3":"2.005674"},{"1":"sodium","2":"350.83333","3":"103.173141"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>To work out summary statistics for a whole bunch of columns, use <code>across</code> inside the <code>summarize</code>. First is the columns you want to summarize, and then is how you want to summarize them. In this case, I wanted the mean <em>and</em> SD of each variable, two things, so I had to put them in a <code>list</code>. Something possibly new here is that I “named” the elements of the <code>list</code> (the <code>mean =</code> and <code>sd =</code>); what this does is to add <code>mean</code> and <code>sd</code> onto the name of each variable, so that I can tell which variable and which statistic I am looking at:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>burgers <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(price<span class="sc">:</span>sodium, <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(.), <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(.)))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["price_mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["price_sd"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["calories_mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["calories_sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["fat_mean"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["fat_sd"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["sodium_mean"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["sodium_sd"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"80.91667","2":"11.55586","3":"115.8333","4":"25.03028","5":"2.75","6":"2.005674","7":"350.8333","8":"103.1731"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This is all right, but I was hoping for something tidier. How about the names of the variables in the rows, and the names of the statistics in the columns? This is evidently some kind of <code>pivot_longer</code>. It’s one of the fancy ones where the column names we have here encode two things, separated by an underscore. That means having <em>two</em> things in <code>names_to</code>, and also having a <code>names_sep</code> that says what those two things are separated by (an underscore).</p>
<p>To get the variable names in rows, we need to create a new column called something like <code>variable</code>. This is the usual kind of <code>pivot_longer</code> thing: put that first in <code>names_to</code>, because the things that are going in <code>variable</code> are the first part of the column names we have here. The second part of the column names we have so far, <code>mean</code> or <code>sd</code>, are going to make <em>names of new columns</em>, which is different from what would normally happen, which is this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>burgers <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(price<span class="sc">:</span>sodium, <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(.), <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(.)))) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"variable"</span>, <span class="st">"stat"</span>), <span class="at">names_sep =</span> <span class="st">"_"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["stat"],"name":[2],"type":["chr"],"align":["left"]},{"label":["value"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"price","2":"mean","3":"80.916667"},{"1":"price","2":"sd","3":"11.555859"},{"1":"calories","2":"mean","3":"115.833333"},{"1":"calories","2":"sd","3":"25.030285"},{"1":"fat","2":"mean","3":"2.750000"},{"1":"fat","2":"sd","3":"2.005674"},{"1":"sodium","2":"mean","3":"350.833333"},{"1":"sodium","2":"sd","3":"103.173141"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This has created a <em>column</em> called <code>stat</code>, with the names of the statistics in it. This is all right, but is not as tidy as we<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> would like.</p>
<p>To use the things in <code>stat</code> as column names (and to fill the columns with the thing currently in <code>value</code>), what you do is to replace the appropriate thing in <code>names_to</code> with the special label <code>.value</code>. When you do this, you can take out the <code>values_to</code>, since <code>pivot_longer</code> now knows where the values are going (into the new columns you are creating):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>burgers <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(price<span class="sc">:</span>sodium, <span class="fu">list</span>(<span class="at">mean =</span> \(x) <span class="fu">mean</span>(x), <span class="at">sd =</span> \(x) <span class="fu">sd</span>(x)))) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"variable"</span>, <span class="st">".value"</span>), <span class="at">names_sep =</span> <span class="st">"_"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"price","2":"80.91667","3":"11.555859"},{"1":"calories","2":"115.83333","3":"25.030285"},{"1":"fat","2":"2.75000","3":"2.005674"},{"1":"sodium","2":"350.83333","3":"103.173141"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Isn’t that pretty?</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Compare the lengths of your two intervals. Does it make sense that your shorter one should be shorter? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>After my long Extra, I need to display them again so that I can see them:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(burgers<span class="fl">.1</span>, new, <span class="at">interval =</span> <span class="st">"p"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 54.72593 20.13798 89.31389</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(burgers<span class="fl">.2</span>, new, <span class="at">interval =</span> <span class="st">"p"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 49.71981 18.63013 80.80949</code></pre>
</div>
</div>
<p>The first interval is about 69 points long and the second one is about 62 points long. Therefore the second interval is shorter.</p>
<p>Why is that? This is different from the other interval comparisons we have done, because this time we are comparing the <em>same</em> prediction from two <em>different</em> models.</p>
<p>Our previous work showed that the model <code>burgers.2</code> was better than <code>burgers.1</code>. This was because it had fewer explanatory variables in it, and we showed that the ones we removed from <code>burgers.1</code> could safely be removed (the <span class="math inline">\(F\)</span>-test in <code>anova</code>). Or similar wording; you might have concluded that the extra explanatory variables in <code>burgers.1</code> were not needed and could be taken out.</p>
<p>This is another reason for trying to find a good model: not only is a smaller model easier to explain, but it also gives better predictions, in the sense that the uncertainty around the prediction (as measured by the length of the interval) is smaller.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Using our second model (the one with only <code>calories</code> and <code>fat</code> in it), find a suitable interval for the mean score when (i) calories is 140 and fat is 5, (ii) calories is 120 and fat is 3. (You should have two intervals.)</li>
</ol>
<p>Solution</p>
<p>This is the “mean of all possible scores” when the explanatory variables take the values shown, so it’s the confidence interval for the mean response rather than the prediction interval we had before. To start, make another <code>new</code> with the two rows of values in it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>calories, <span class="sc">~</span>fat,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">140</span>,        <span class="dv">1</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">120</span>,        <span class="dv">3</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["calories"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fat"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"140","2":"1"},{"1":"120","2":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Check. Then, <code>predictions</code> (from the <code>marginaleffects</code> package, which of course you remembered to install (once) and load first):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">predictions</span>(burgers<span class="fl">.2</span>, <span class="at">newdata =</span> new)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(calories, fat, estimate, conf.low, conf.high)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["calories"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fat"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"140","2":"1","3":"18.90120","4":"-5.444696","5":"43.24710"},{"1":"120","2":"3","3":"43.50967","4":"36.296984","5":"50.72236"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>(if you use the wrong model, you’ll get an error, because the bigger model has some other things in it that we don’t have values for.)</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Explain briefly why the second interval is shorter than the first one. Make sure you justify your answer.</li>
</ol>
<p>Solution</p>
<p>First, verify that the second interval really <em>is</em> shorter than the first one. (If, for some reason, it is not, then <em>say that</em>.) The first interval is of length about <span class="math inline">\(62-37 = 25\)</span>, and the second one is of length about <span class="math inline">\(52-35 = 17\)</span>.</p>
<p>Aside: you might be thinking about working those out with R rather than by hand, and so you can:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">predictions</span>(burgers<span class="fl">.2</span>, <span class="at">newdata =</span> new)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ci_length =</span> conf.high <span class="sc">-</span> conf.low) <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(calories, fat, conf.low, conf.high, ci_length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["calories"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fat"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["ci_length"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"140","2":"1","3":"-5.444696","4":"43.24710","5":"48.69180"},{"1":"120","2":"3","3":"36.296984","4":"50.72236","5":"14.42537"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now we are in the familiar situation where we are comparing predictions for different <em>values</em> for the <em>same</em> model. So you might be suspecting that the second pair of values is closer to the mean (for the data as a whole) than the first pair is.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> But we should check that this is indeed the case.</p>
<p>Let’s look at the values we predicted for first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["calories"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fat"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"140","2":"1"},{"1":"120","2":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>To get the means, the easiest way is <code>summary</code>, on the whole dataframe or the bit of it containing only <code>calories</code> and <code>fat</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>burgers <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(calories, fat)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    calories          fat      
 Min.   : 80.0   Min.   :0.00  
 1st Qu.: 97.5   1st Qu.:1.00  
 Median :115.0   Median :3.00  
 Mean   :115.8   Mean   :2.75  
 3rd Qu.:130.0   3rd Qu.:4.00  
 Max.   :170.0   Max.   :6.00  </code></pre>
</div>
</div>
<p>The values for both variables are both above their means, but the second values for both <code>calories</code> and <code>fat</code> are closer to their means.</p>
<p>There is a tidyverse way to do this, which uses <code>across</code> again, but it’s a bit simpler than the other one I did (in an Extra above):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>burgers <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(<span class="fu">c</span>(calories, fat), \(x) <span class="fu">mean</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["calories"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fat"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"115.8333","2":"2.75"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>(“for each of <code>calories</code> and <code>fat</code>, work out the mean of it”). Another way to do the same thing is the <code>map</code> idea for running functions over each of something. <code>mean</code> returns a decimal number, so <code>map_dbl</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>burgers <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(calories, fat) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dbl</span>(\(x) <span class="fu">mean</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>calories      fat 
115.8333   2.7500 </code></pre>
</div>
</div>
<p>The <code>map</code>, by default, works on each <em>column</em> of the dataframe it is fed,<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> namely the dataframe with only <code>calories</code> and <code>fat</code> in it.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>Somehow, make the assertion that the second values for <code>calories</code> and <code>fat</code> are closer to their means than the first values of each of them, and then demonstrate that this is indeed true. Or, think to yourself “this probably depends on the means somehow”, find the means, and then say that the second values are closer to the means, so the prediction for them should be better (in the sense of having a shorter confidence interval).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="blood-pressure-1" class="level2" data-number="26.5">
<h2 data-number="26.5" class="anchored" data-anchor-id="blood-pressure-1"><span class="header-section-number">26.5</span> Blood pressure</h2>
<p>Twenty people with high blood pressure had various other measurements taken. The aim was to see which of these were associated with blood pressure, with the aim of understanding what causes high blood pressure. The variables observed were:</p>
<ul>
<li><code>Pt</code>: patient number (ignore)</li>
<li><code>BP</code>: (diastolic) blood pressure, in mmHg</li>
<li><code>Age</code> in years</li>
<li><code>Weight</code> in kg</li>
<li><code>BSA</code>: body surface area, in m<span class="math inline">\(^2\)</span></li>
<li><code>Dur</code>: length of time since diagnosis of high blood pressure, in years</li>
<li><code>Pulse</code>: pulse rate, in beats per minute</li>
<li><code>Stress</code>: score on a questionnaire about stress levels (higher score is more stressed)</li>
</ul>
<p>The data values, separated by <em>tabs</em>, are in <a href="https://ritsokiguess.site/datafiles/bloodpress.txt">https://ritsokiguess.site/datafiles/bloodpress.txt</a>.</p>
<ol type="a">
<li>Read in and display (some of) the data.</li>
</ol>
<p>Solution</p>
<p>The data values are separated by tabs, so <code>read_tsv</code> is what you need:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"https://ritsokiguess.site/datafiles/bloodpress.txt"</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 20 Columns: 8
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
dbl (8): Pt, BP, Age, Weight, BSA, Dur, Pulse, Stress

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>bp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Pt"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["BP"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Weight"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["BSA"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Dur"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Pulse"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Stress"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"105","3":"47","4":"85.4","5":"1.75","6":"5.1","7":"63","8":"33"},{"1":"2","2":"115","3":"49","4":"94.2","5":"2.10","6":"3.8","7":"70","8":"14"},{"1":"3","2":"116","3":"49","4":"95.3","5":"1.98","6":"8.2","7":"72","8":"10"},{"1":"4","2":"117","3":"50","4":"94.7","5":"2.01","6":"5.8","7":"73","8":"99"},{"1":"5","2":"112","3":"51","4":"89.4","5":"1.89","6":"7.0","7":"72","8":"95"},{"1":"6","2":"121","3":"48","4":"99.5","5":"2.25","6":"9.3","7":"71","8":"10"},{"1":"7","2":"121","3":"49","4":"99.8","5":"2.25","6":"2.5","7":"69","8":"42"},{"1":"8","2":"110","3":"47","4":"90.9","5":"1.90","6":"6.2","7":"66","8":"8"},{"1":"9","2":"110","3":"49","4":"89.2","5":"1.83","6":"7.1","7":"69","8":"62"},{"1":"10","2":"114","3":"48","4":"92.7","5":"2.07","6":"5.6","7":"64","8":"35"},{"1":"11","2":"114","3":"47","4":"94.4","5":"2.07","6":"5.3","7":"74","8":"90"},{"1":"12","2":"115","3":"49","4":"94.1","5":"1.98","6":"5.6","7":"71","8":"21"},{"1":"13","2":"114","3":"50","4":"91.6","5":"2.05","6":"10.2","7":"68","8":"47"},{"1":"14","2":"106","3":"45","4":"87.1","5":"1.92","6":"5.6","7":"67","8":"80"},{"1":"15","2":"125","3":"52","4":"101.3","5":"2.19","6":"10.0","7":"76","8":"98"},{"1":"16","2":"114","3":"46","4":"94.5","5":"1.98","6":"7.4","7":"69","8":"95"},{"1":"17","2":"106","3":"46","4":"87.0","5":"1.87","6":"3.6","7":"62","8":"18"},{"1":"18","2":"113","3":"46","4":"94.5","5":"1.90","6":"4.3","7":"70","8":"12"},{"1":"19","2":"110","3":"48","4":"90.5","5":"1.88","6":"9.0","7":"71","8":"99"},{"1":"20","2":"122","3":"56","4":"95.7","5":"2.09","6":"7.0","7":"75","8":"99"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>20 patients, and all the columns as listed. Remember that in R, uppercase and lowercase are <em>different</em>, so there is no problem in using (lowercase) <code>bp</code> for the name of a dataframe that has a column called (uppercase) <code>BP</code> in it. But if that confuses you, feel free to give your dataframe a more descriptive name like <code>blood_pressure</code> or even something like <code>health_stats</code>.</p>
<p>Extra: you can also use <code>read_delim</code> for this, but you have to do it right. If you do it as <code>read_delim(my_url, " ")</code> or similar, it won’t work, because the data values are not separated by single spaces:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>bpxx <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 20 Columns: 1
── Column specification ────────────────────────────────────────────────────────
Delimiter: " "
chr (1): Pt BP  Age Weight  BSA Dur Pulse   Stress

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>bpxx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Pt\tBP\tAge\tWeight\tBSA\tDur\tPulse\tStress"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"1\\t105\\t47\\t85.4\\t1.75\\t5.1\\t63\\t33"},{"1":"2\\t115\\t49\\t94.2\\t2.10\\t3.8\\t70\\t14"},{"1":"3\\t116\\t49\\t95.3\\t1.98\\t8.2\\t72\\t10"},{"1":"4\\t117\\t50\\t94.7\\t2.01\\t5.8\\t73\\t99"},{"1":"5\\t112\\t51\\t89.4\\t1.89\\t7.0\\t72\\t95"},{"1":"6\\t121\\t48\\t99.5\\t2.25\\t9.3\\t71\\t10"},{"1":"7\\t121\\t49\\t99.8\\t2.25\\t2.5\\t69\\t42"},{"1":"8\\t110\\t47\\t90.9\\t1.90\\t6.2\\t66\\t8"},{"1":"9\\t110\\t49\\t89.2\\t1.83\\t7.1\\t69\\t62"},{"1":"10\\t114\\t48\\t92.7\\t2.07\\t5.6\\t64\\t35"},{"1":"11\\t114\\t47\\t94.4\\t2.07\\t5.3\\t74\\t90"},{"1":"12\\t115\\t49\\t94.1\\t1.98\\t5.6\\t71\\t21"},{"1":"13\\t114\\t50\\t91.6\\t2.05\\t10.2\\t68\\t47"},{"1":"14\\t106\\t45\\t87.1\\t1.92\\t5.6\\t67\\t80"},{"1":"15\\t125\\t52\\t101.3\\t2.19\\t10.0\\t76\\t98"},{"1":"16\\t114\\t46\\t94.5\\t1.98\\t7.4\\t69\\t95"},{"1":"17\\t106\\t46\\t87.0\\t1.87\\t3.6\\t62\\t18"},{"1":"18\\t113\\t46\\t94.5\\t1.90\\t4.3\\t70\\t12"},{"1":"19\\t110\\t48\\t90.5\\t1.88\\t9.0\\t71\\t99"},{"1":"20\\t122\\t56\\t95.7\\t2.09\\t7.0\\t75\\t99"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>All of the data values have been smooshed together into a <em>single</em> column with a rather amusing name. The rather odd <code>\t</code> is the key to understanding what has happened. The simplest way to make it work is to use <code>read_delim</code>, but <em>without</em> saying what the delimiter character is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>bpx <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 20 Columns: 8
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
dbl (8): Pt, BP, Age, Weight, BSA, Dur, Pulse, Stress

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>bpx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Pt"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["BP"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Weight"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["BSA"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Dur"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Pulse"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Stress"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"105","3":"47","4":"85.4","5":"1.75","6":"5.1","7":"63","8":"33"},{"1":"2","2":"115","3":"49","4":"94.2","5":"2.10","6":"3.8","7":"70","8":"14"},{"1":"3","2":"116","3":"49","4":"95.3","5":"1.98","6":"8.2","7":"72","8":"10"},{"1":"4","2":"117","3":"50","4":"94.7","5":"2.01","6":"5.8","7":"73","8":"99"},{"1":"5","2":"112","3":"51","4":"89.4","5":"1.89","6":"7.0","7":"72","8":"95"},{"1":"6","2":"121","3":"48","4":"99.5","5":"2.25","6":"9.3","7":"71","8":"10"},{"1":"7","2":"121","3":"49","4":"99.8","5":"2.25","6":"2.5","7":"69","8":"42"},{"1":"8","2":"110","3":"47","4":"90.9","5":"1.90","6":"6.2","7":"66","8":"8"},{"1":"9","2":"110","3":"49","4":"89.2","5":"1.83","6":"7.1","7":"69","8":"62"},{"1":"10","2":"114","3":"48","4":"92.7","5":"2.07","6":"5.6","7":"64","8":"35"},{"1":"11","2":"114","3":"47","4":"94.4","5":"2.07","6":"5.3","7":"74","8":"90"},{"1":"12","2":"115","3":"49","4":"94.1","5":"1.98","6":"5.6","7":"71","8":"21"},{"1":"13","2":"114","3":"50","4":"91.6","5":"2.05","6":"10.2","7":"68","8":"47"},{"1":"14","2":"106","3":"45","4":"87.1","5":"1.92","6":"5.6","7":"67","8":"80"},{"1":"15","2":"125","3":"52","4":"101.3","5":"2.19","6":"10.0","7":"76","8":"98"},{"1":"16","2":"114","3":"46","4":"94.5","5":"1.98","6":"7.4","7":"69","8":"95"},{"1":"17","2":"106","3":"46","4":"87.0","5":"1.87","6":"3.6","7":"62","8":"18"},{"1":"18","2":"113","3":"46","4":"94.5","5":"1.90","6":"4.3","7":"70","8":"12"},{"1":"19","2":"110","3":"48","4":"90.5","5":"1.88","6":"9.0","7":"71","8":"99"},{"1":"20","2":"122","3":"56","4":"95.7","5":"2.09","6":"7.0","7":"75","8":"99"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>If you look at the R Console now, you’ll see a line in the file-reading message that says</p>
<pre><code>Delimiter: "\t"</code></pre>
<p>What happened is that <code>read_delim</code> successfully <em>guessed</em> what was separating the data values, by looking at the first few lines of the data file and seeing that there were a lot of tabs apparently separating data values. This behaviour is new in the latest version of <code>readr</code>;<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> if you use this idea, you should be able to explain why it worked. If you cannot, it looks like a lucky guess.</p>
<p>By this point, you might have guessed that the mysterious <code>\t</code> is the way R represents a tab (you would be right), and that therefore you should be able to do this:<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>bpxxxx <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 20 Columns: 8
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
dbl (8): Pt, BP, Age, Weight, BSA, Dur, Pulse, Stress

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>bpxxxx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Pt"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["BP"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Weight"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["BSA"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Dur"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Pulse"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Stress"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"105","3":"47","4":"85.4","5":"1.75","6":"5.1","7":"63","8":"33"},{"1":"2","2":"115","3":"49","4":"94.2","5":"2.10","6":"3.8","7":"70","8":"14"},{"1":"3","2":"116","3":"49","4":"95.3","5":"1.98","6":"8.2","7":"72","8":"10"},{"1":"4","2":"117","3":"50","4":"94.7","5":"2.01","6":"5.8","7":"73","8":"99"},{"1":"5","2":"112","3":"51","4":"89.4","5":"1.89","6":"7.0","7":"72","8":"95"},{"1":"6","2":"121","3":"48","4":"99.5","5":"2.25","6":"9.3","7":"71","8":"10"},{"1":"7","2":"121","3":"49","4":"99.8","5":"2.25","6":"2.5","7":"69","8":"42"},{"1":"8","2":"110","3":"47","4":"90.9","5":"1.90","6":"6.2","7":"66","8":"8"},{"1":"9","2":"110","3":"49","4":"89.2","5":"1.83","6":"7.1","7":"69","8":"62"},{"1":"10","2":"114","3":"48","4":"92.7","5":"2.07","6":"5.6","7":"64","8":"35"},{"1":"11","2":"114","3":"47","4":"94.4","5":"2.07","6":"5.3","7":"74","8":"90"},{"1":"12","2":"115","3":"49","4":"94.1","5":"1.98","6":"5.6","7":"71","8":"21"},{"1":"13","2":"114","3":"50","4":"91.6","5":"2.05","6":"10.2","7":"68","8":"47"},{"1":"14","2":"106","3":"45","4":"87.1","5":"1.92","6":"5.6","7":"67","8":"80"},{"1":"15","2":"125","3":"52","4":"101.3","5":"2.19","6":"10.0","7":"76","8":"98"},{"1":"16","2":"114","3":"46","4":"94.5","5":"1.98","6":"7.4","7":"69","8":"95"},{"1":"17","2":"106","3":"46","4":"87.0","5":"1.87","6":"3.6","7":"62","8":"18"},{"1":"18","2":"113","3":"46","4":"94.5","5":"1.90","6":"4.3","7":"70","8":"12"},{"1":"19","2":"110","3":"48","4":"90.5","5":"1.88","6":"9.0","7":"71","8":"99"},{"1":"20","2":"122","3":"56","4":"95.7","5":"2.09","6":"7.0","7":"75","8":"99"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>and you would once again be right.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Make a plot of the blood pressure against each of the measured explanatory variables. Hint: use the idea from C32 of making a suitable long dataframe and using facets in your graph.</li>
</ol>
<p>Solution</p>
<p>Use <code>pivot_longer</code> with all the columns containing <span class="math inline">\(x\)</span>-variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>bp <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Age<span class="sc">:</span>Stress, <span class="at">names_to =</span> <span class="st">"xname"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Pt"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["BP"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["xname"],"name":[3],"type":["chr"],"align":["left"]},{"label":["x"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"105","3":"Age","4":"47.00"},{"1":"1","2":"105","3":"Weight","4":"85.40"},{"1":"1","2":"105","3":"BSA","4":"1.75"},{"1":"1","2":"105","3":"Dur","4":"5.10"},{"1":"1","2":"105","3":"Pulse","4":"63.00"},{"1":"1","2":"105","3":"Stress","4":"33.00"},{"1":"2","2":"115","3":"Age","4":"49.00"},{"1":"2","2":"115","3":"Weight","4":"94.20"},{"1":"2","2":"115","3":"BSA","4":"2.10"},{"1":"2","2":"115","3":"Dur","4":"3.80"},{"1":"2","2":"115","3":"Pulse","4":"70.00"},{"1":"2","2":"115","3":"Stress","4":"14.00"},{"1":"3","2":"116","3":"Age","4":"49.00"},{"1":"3","2":"116","3":"Weight","4":"95.30"},{"1":"3","2":"116","3":"BSA","4":"1.98"},{"1":"3","2":"116","3":"Dur","4":"8.20"},{"1":"3","2":"116","3":"Pulse","4":"72.00"},{"1":"3","2":"116","3":"Stress","4":"10.00"},{"1":"4","2":"117","3":"Age","4":"50.00"},{"1":"4","2":"117","3":"Weight","4":"94.70"},{"1":"4","2":"117","3":"BSA","4":"2.01"},{"1":"4","2":"117","3":"Dur","4":"5.80"},{"1":"4","2":"117","3":"Pulse","4":"73.00"},{"1":"4","2":"117","3":"Stress","4":"99.00"},{"1":"5","2":"112","3":"Age","4":"51.00"},{"1":"5","2":"112","3":"Weight","4":"89.40"},{"1":"5","2":"112","3":"BSA","4":"1.89"},{"1":"5","2":"112","3":"Dur","4":"7.00"},{"1":"5","2":"112","3":"Pulse","4":"72.00"},{"1":"5","2":"112","3":"Stress","4":"95.00"},{"1":"6","2":"121","3":"Age","4":"48.00"},{"1":"6","2":"121","3":"Weight","4":"99.50"},{"1":"6","2":"121","3":"BSA","4":"2.25"},{"1":"6","2":"121","3":"Dur","4":"9.30"},{"1":"6","2":"121","3":"Pulse","4":"71.00"},{"1":"6","2":"121","3":"Stress","4":"10.00"},{"1":"7","2":"121","3":"Age","4":"49.00"},{"1":"7","2":"121","3":"Weight","4":"99.80"},{"1":"7","2":"121","3":"BSA","4":"2.25"},{"1":"7","2":"121","3":"Dur","4":"2.50"},{"1":"7","2":"121","3":"Pulse","4":"69.00"},{"1":"7","2":"121","3":"Stress","4":"42.00"},{"1":"8","2":"110","3":"Age","4":"47.00"},{"1":"8","2":"110","3":"Weight","4":"90.90"},{"1":"8","2":"110","3":"BSA","4":"1.90"},{"1":"8","2":"110","3":"Dur","4":"6.20"},{"1":"8","2":"110","3":"Pulse","4":"66.00"},{"1":"8","2":"110","3":"Stress","4":"8.00"},{"1":"9","2":"110","3":"Age","4":"49.00"},{"1":"9","2":"110","3":"Weight","4":"89.20"},{"1":"9","2":"110","3":"BSA","4":"1.83"},{"1":"9","2":"110","3":"Dur","4":"7.10"},{"1":"9","2":"110","3":"Pulse","4":"69.00"},{"1":"9","2":"110","3":"Stress","4":"62.00"},{"1":"10","2":"114","3":"Age","4":"48.00"},{"1":"10","2":"114","3":"Weight","4":"92.70"},{"1":"10","2":"114","3":"BSA","4":"2.07"},{"1":"10","2":"114","3":"Dur","4":"5.60"},{"1":"10","2":"114","3":"Pulse","4":"64.00"},{"1":"10","2":"114","3":"Stress","4":"35.00"},{"1":"11","2":"114","3":"Age","4":"47.00"},{"1":"11","2":"114","3":"Weight","4":"94.40"},{"1":"11","2":"114","3":"BSA","4":"2.07"},{"1":"11","2":"114","3":"Dur","4":"5.30"},{"1":"11","2":"114","3":"Pulse","4":"74.00"},{"1":"11","2":"114","3":"Stress","4":"90.00"},{"1":"12","2":"115","3":"Age","4":"49.00"},{"1":"12","2":"115","3":"Weight","4":"94.10"},{"1":"12","2":"115","3":"BSA","4":"1.98"},{"1":"12","2":"115","3":"Dur","4":"5.60"},{"1":"12","2":"115","3":"Pulse","4":"71.00"},{"1":"12","2":"115","3":"Stress","4":"21.00"},{"1":"13","2":"114","3":"Age","4":"50.00"},{"1":"13","2":"114","3":"Weight","4":"91.60"},{"1":"13","2":"114","3":"BSA","4":"2.05"},{"1":"13","2":"114","3":"Dur","4":"10.20"},{"1":"13","2":"114","3":"Pulse","4":"68.00"},{"1":"13","2":"114","3":"Stress","4":"47.00"},{"1":"14","2":"106","3":"Age","4":"45.00"},{"1":"14","2":"106","3":"Weight","4":"87.10"},{"1":"14","2":"106","3":"BSA","4":"1.92"},{"1":"14","2":"106","3":"Dur","4":"5.60"},{"1":"14","2":"106","3":"Pulse","4":"67.00"},{"1":"14","2":"106","3":"Stress","4":"80.00"},{"1":"15","2":"125","3":"Age","4":"52.00"},{"1":"15","2":"125","3":"Weight","4":"101.30"},{"1":"15","2":"125","3":"BSA","4":"2.19"},{"1":"15","2":"125","3":"Dur","4":"10.00"},{"1":"15","2":"125","3":"Pulse","4":"76.00"},{"1":"15","2":"125","3":"Stress","4":"98.00"},{"1":"16","2":"114","3":"Age","4":"46.00"},{"1":"16","2":"114","3":"Weight","4":"94.50"},{"1":"16","2":"114","3":"BSA","4":"1.98"},{"1":"16","2":"114","3":"Dur","4":"7.40"},{"1":"16","2":"114","3":"Pulse","4":"69.00"},{"1":"16","2":"114","3":"Stress","4":"95.00"},{"1":"17","2":"106","3":"Age","4":"46.00"},{"1":"17","2":"106","3":"Weight","4":"87.00"},{"1":"17","2":"106","3":"BSA","4":"1.87"},{"1":"17","2":"106","3":"Dur","4":"3.60"},{"1":"17","2":"106","3":"Pulse","4":"62.00"},{"1":"17","2":"106","3":"Stress","4":"18.00"},{"1":"18","2":"113","3":"Age","4":"46.00"},{"1":"18","2":"113","3":"Weight","4":"94.50"},{"1":"18","2":"113","3":"BSA","4":"1.90"},{"1":"18","2":"113","3":"Dur","4":"4.30"},{"1":"18","2":"113","3":"Pulse","4":"70.00"},{"1":"18","2":"113","3":"Stress","4":"12.00"},{"1":"19","2":"110","3":"Age","4":"48.00"},{"1":"19","2":"110","3":"Weight","4":"90.50"},{"1":"19","2":"110","3":"BSA","4":"1.88"},{"1":"19","2":"110","3":"Dur","4":"9.00"},{"1":"19","2":"110","3":"Pulse","4":"71.00"},{"1":"19","2":"110","3":"Stress","4":"99.00"},{"1":"20","2":"122","3":"Age","4":"56.00"},{"1":"20","2":"122","3":"Weight","4":"95.70"},{"1":"20","2":"122","3":"BSA","4":"2.09"},{"1":"20","2":"122","3":"Dur","4":"7.00"},{"1":"20","2":"122","3":"Pulse","4":"75.00"},{"1":"20","2":"122","3":"Stress","4":"99.00"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>and then plot <code>BP</code> against <code>x</code> facetting by <code>xname</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>bp <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(Age<span class="sc">:</span>Stress, <span class="at">names_to =</span> <span class="st">"xname"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> BP)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>xname, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression-revisited_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Use <code>scales = "free"</code> to have each scatterplot fill its facet.</p>
<p>If you don’t get to this, you are faced with making six scatterplots one by one, which will be a lot of work in comparison (and it’s easy to mess up the copy/paste and miss one of them out).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>Which explanatory variables seem to have a moderate or strong linear relationship with blood pressure?</li>
</ol>
<p>Solution</p>
<p>I would say <code>BSA</code>, <code>Weight</code> and maybe <code>Pulse</code>. For me, the <code>Age</code> relationship is not quite strong enough, and there is basically no relationship with <code>Dur</code> or <code>Stress</code>.</p>
<p>I don’t mind precisely where you draw the line. You could include <code>Pulse</code> and <code>Age</code> or not, but I think you should definitely include <code>BSA</code> and <code>Weight</code> and definitely exclude <code>Dur</code> and <code>Stress</code>.</p>
<p>Extra: Stress is often considered to be a cause of high blood pressure, but it seems from this dataset that it is not.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Run a regression predicting blood pressure from <code>BSA</code> and <code>Weight</code>, and display the output. Does the significance or lack of significance of each of your explanatory variables surprise you? Explain briefly.</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>bp<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> BSA <span class="sc">+</span> Weight, <span class="at">data =</span> bp)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bp<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ BSA + Weight, data = bp)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8932 -1.1961 -0.4061  1.0764  4.7524 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   5.6534     9.3925   0.602    0.555    
BSA           5.8313     6.0627   0.962    0.350    
Weight        1.0387     0.1927   5.392 4.87e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.744 on 17 degrees of freedom
Multiple R-squared:  0.9077,    Adjusted R-squared:  0.8968 
F-statistic: 83.54 on 2 and 17 DF,  p-value: 1.607e-09</code></pre>
</div>
</div>
<p>suppose we (foolishly) took out weight</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>bp<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> BSA, <span class="at">data =</span> bp)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bp<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ BSA, data = bp)

Residuals:
   Min     1Q Median     3Q    Max 
-5.314 -1.963 -0.197  1.934  4.831 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   45.183      9.392   4.811  0.00014 ***
BSA           34.443      4.690   7.343 8.11e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.79 on 18 degrees of freedom
Multiple R-squared:  0.7497,    Adjusted R-squared:  0.7358 
F-statistic: 53.93 on 1 and 18 DF,  p-value: 8.114e-07</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>bp<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> Weight, <span class="at">data =</span> bp)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bp<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ Weight, data = bp)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.6933 -0.9318 -0.4935  0.7703  4.8656 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.20531    8.66333   0.255    0.802    
Weight       1.20093    0.09297  12.917 1.53e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.74 on 18 degrees of freedom
Multiple R-squared:  0.9026,    Adjusted R-squared:  0.8972 
F-statistic: 166.9 on 1 and 18 DF,  p-value: 1.528e-10</code></pre>
</div>
</div>
<p>Both explanatory variables have a strong relationship with blood pressure according to the scatterplots, so we would expect them both to be significant. <code>Weight</code> is, but <code>BSA</code> is not. This I find surprising.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Explain briefly why it does in fact make sense that the regression results came out as they did. You may wish to draw another graph to support your explanation.</li>
</ol>
<p>Solution</p>
<p>The way we learned this in C32 is that <code>BSA</code> has nothing to <em>add</em> to a regression that also contains <code>Weight</code>, when it comes to predicting blood pressure. That is to say, the way <code>BSA</code> is related to blood pressure is similar to the way <code>Weight</code> is .</p>
<p>To gain a bit more insight, we might be suffering from multicollinearity here, and the reason that <code>BSA</code> is not significant as we expected could be that it and <code>Weight</code> are related to <em>each other</em>. To find out about <em>that</em>, make a scatterplot of the two explanatory variables:<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(bp, <span class="fu">aes</span>(<span class="at">y =</span> BSA, <span class="at">x =</span> Weight)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression-revisited_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These are clearly related. To be more precise about “not needing <code>BSA</code> as well”: if we know a person’s weight, we already know something about their body surface area (if the weight is bigger, so is their body surface area). So there is less information than you would otherwise expect in <code>BSA</code> if you already know their weight.</p>
<p>This is a less dramatic example than the one in lecture (with the football punters), but the point is the same: if the <span class="math inline">\(x\)</span>-variables are correlated, one or more of them could be less significant than you would expect, because the information it contains is mostly already contained in other <span class="math inline">\(x\)</span>-variables.</p>
<p>Extra: another way of looking at all this is via pairwise correlations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Pt         BP        Age     Weight         BSA       Dur
Pt      1.00000000 0.03113499 0.04269354 0.02485650 -0.03128800 0.1762455
BP      0.03113499 1.00000000 0.65909298 0.95006765  0.86587887 0.2928336
Age     0.04269354 0.65909298 1.00000000 0.40734926  0.37845460 0.3437921
Weight  0.02485650 0.95006765 0.40734926 1.00000000  0.87530481 0.2006496
BSA    -0.03128800 0.86587887 0.37845460 0.87530481  1.00000000 0.1305400
Dur     0.17624551 0.29283363 0.34379206 0.20064959  0.13054001 1.0000000
Pulse   0.11228508 0.72141316 0.61876426 0.65933987  0.46481881 0.4015144
Stress  0.34315169 0.16390139 0.36822369 0.03435475  0.01844634 0.3116398
           Pulse     Stress
Pt     0.1122851 0.34315169
BP     0.7214132 0.16390139
Age    0.6187643 0.36822369
Weight 0.6593399 0.03435475
BSA    0.4648188 0.01844634
Dur    0.4015144 0.31163982
Pulse  1.0000000 0.50631008
Stress 0.5063101 1.00000000</code></pre>
</div>
</div>
<p>The correlations with <code>BP</code> (second column, or second row) are mostly as you would expect from the scatterplots: very high with <code>Weight</code> and <code>BSA</code>, moderately high for <code>Age</code> and <code>Pulse</code>, and low for the others. I usually find that the correlation suggests a stronger relationship than the scatterplot does.</p>
<p>The other thing is that the correlation between <code>Weight</code> and <code>BSA</code> is the highest of all the correlations between variables that are not the response. So if you know a person’s weight, you can already make a good guess at their body surface area, even without having the actual values. Hence, including <code>BSA</code> in the regression when you already have <code>Weight</code> is not very helpful.</p>
<p>The data for this question came from <a href="https://online.stat.psu.edu/stat501/lesson/12/12.1">here</a>.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="contraction-of-heart-muscle-1" class="level2" data-number="26.6">
<h2 data-number="26.6" class="anchored" data-anchor-id="contraction-of-heart-muscle-1"><span class="header-section-number">26.6</span> Contraction of heart muscle</h2>
<p>An experiment was carried out on heart muscle in rats. The original description of the experiment was as follows:</p>
<blockquote class="blockquote">
<p>The purpose of this experiment was to assess the influence of calcium in solution on the contraction of heart muscle in rats. The left auricle of 21 rat hearts was isolated and on several occasions a constant-length strip of tissue was electrically stimulated and dipped into various concentrations of calcium chloride solution, after which the shortening of the strip was accurately measured as the response.</p>
</blockquote>
<p>The data are in <a href="http://ritsokiguess.site/datafiles/regression2_muscle.csv">http://ritsokiguess.site/datafiles/regression2_muscle.csv</a>. There are three columns:</p>
<ul>
<li><code>Strip</code>: a label for the strip of tissue treated with calcium chloride (text, ignored by us)</li>
<li><code>Conc</code>: the concentration of calcium chloride, in suitable units</li>
<li><code>Length</code>: the change in length (shortening) of the strip of tissue, mm.</li>
</ul>
<p>There are actually 60 measurements, so some of them came from the same rat, a fact that we ignore in this question.</p>
<ol type="a">
<li>Read in and display (some of) the data.</li>
</ol>
<p>Solution</p>
<p>As usual:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/regression2_muscle.csv"</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>muscle <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 60 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): Strip
dbl (2): Conc, Length

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>muscle</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Strip"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Conc"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Length"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"S01","2":"1.00","3":"15.8"},{"1":"S01","2":"2.00","3":"20.8"},{"1":"S01","2":"3.00","3":"22.6"},{"1":"S01","2":"4.00","3":"23.8"},{"1":"S02","2":"1.00","3":"20.6"},{"1":"S02","2":"2.00","3":"26.8"},{"1":"S02","2":"3.00","3":"28.4"},{"1":"S02","2":"4.00","3":"27.0"},{"1":"S03","2":"0.25","3":"7.2"},{"1":"S03","2":"0.50","3":"15.4"},{"1":"S03","2":"1.00","3":"22.8"},{"1":"S03","2":"2.00","3":"27.4"},{"1":"S04","2":"0.25","3":"2.2"},{"1":"S04","2":"0.50","3":"9.0"},{"1":"S04","2":"1.00","3":"16.6"},{"1":"S05","2":"0.25","3":"2.0"},{"1":"S05","2":"0.50","3":"6.0"},{"1":"S05","2":"1.00","3":"15.2"},{"1":"S06","2":"0.25","3":"5.0"},{"1":"S06","2":"0.50","3":"9.2"},{"1":"S06","2":"1.00","3":"14.2"},{"1":"S07","2":"1.00","3":"28.0"},{"1":"S07","2":"2.00","3":"32.0"},{"1":"S08","2":"0.25","3":"5.6"},{"1":"S08","2":"1.00","3":"26.0"},{"1":"S09","2":"0.50","3":"15.4"},{"1":"S09","2":"1.00","3":"23.2"},{"1":"S10","2":"0.25","3":"11.8"},{"1":"S10","2":"1.00","3":"29.0"},{"1":"S11","2":"0.25","3":"11.0"},{"1":"S11","2":"0.50","3":"18.8"},{"1":"S11","2":"1.00","3":"26.2"},{"1":"S12","2":"1.00","3":"26.0"},{"1":"S12","2":"2.00","3":"33.8"},{"1":"S13","2":"1.00","3":"24.2"},{"1":"S13","2":"2.00","3":"28.8"},{"1":"S14","2":"0.50","3":"15.0"},{"1":"S14","2":"1.00","3":"24.0"},{"1":"S15","2":"0.50","3":"20.8"},{"1":"S15","2":"1.00","3":"29.0"},{"1":"S16","2":"1.00","3":"18.2"},{"1":"S16","2":"2.00","3":"25.8"},{"1":"S16","2":"3.00","3":"30.0"},{"1":"S16","2":"4.00","3":"32.2"},{"1":"S17","2":"1.00","3":"21.5"},{"1":"S17","2":"2.00","3":"28.4"},{"1":"S17","2":"3.00","3":"32.0"},{"1":"S17","2":"4.00","3":"29.6"},{"1":"S18","2":"1.00","3":"15.4"},{"1":"S18","2":"2.00","3":"19.0"},{"1":"S18","2":"3.00","3":"19.4"},{"1":"S19","2":"1.00","3":"29.0"},{"1":"S19","2":"2.00","3":"34.0"},{"1":"S19","2":"3.00","3":"37.0"},{"1":"S20","2":"1.00","3":"22.2"},{"1":"S20","2":"2.00","3":"29.0"},{"1":"S20","2":"3.00","3":"32.2"},{"1":"S21","2":"1.00","3":"23.0"},{"1":"S21","2":"2.00","3":"27.4"},{"1":"S21","2":"3.00","3":"30.4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Make a suitable graph of the two quantitative variables, with a smooth trend.</li>
</ol>
<p>Solution</p>
<p>Scatterplot, with <code>Length</code> as the response:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(muscle, <span class="fu">aes</span>(<span class="at">x =</span> Conc, <span class="at">y =</span> Length)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="regression-revisited_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>Why does your plot suggest that a regression with a squared term would be useful? Fit a suitable regression, and display the results.</li>
</ol>
<p>Solution</p>
<p>The trend is not linear; it appears to go up and level off, with maybe a hint that it is coming down again. This is the most complete answer; “the relationship is curved” is also reasonable.</p>
<p>So, we add a squared term to the regression right away:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>muscle<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(Length <span class="sc">~</span> Conc <span class="sc">+</span> <span class="fu">I</span>(Conc<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> muscle)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(muscle<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Length ~ Conc + I(Conc^2), data = muscle)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.4159  -3.8516   0.6172   3.6172   8.5672 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   5.0144     1.8014   2.784  0.00728 ** 
Conc         18.8273     2.3028   8.176 3.51e-11 ***
I(Conc^2)    -3.4089     0.5644  -6.040 1.24e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.05 on 57 degrees of freedom
Multiple R-squared:  0.6721,    Adjusted R-squared:  0.6606 
F-statistic: 58.41 on 2 and 57 DF,  p-value: 1.581e-14</code></pre>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>How do you know that adding the squared term was a good idea (or, was not a good idea, depending how your output came out)?</li>
</ol>
<p>Solution</p>
<p>The coefficient of concentration squared is significantly different from zero. This shows that the relationship really does curve, more than chance (not a very surprising conclusion, given the scatterplot).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>For concentrations of 2, 3, and 4 units, obtain 95% confidence intervals for the mean <code>Length</code>. Display only the relevant columns of your result, and save it.</li>
</ol>
<p>Solution</p>
<p>Use <code>predictions</code>, and to set that up, create a dataframe (by my tradition called <code>new</code>) that contains the concentrations you want to predict for:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Conc =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">predictions</span>(muscle<span class="fl">.1</span>, <span class="at">newdata =</span> new)) <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Conc, estimate, conf.low, conf.high) <span class="ot">-&gt;</span> preds</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>preds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Conc"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"29.03327","3":"26.96336","4":"31.10317"},{"1":"3","2":"30.81589","3":"28.61536","4":"33.01642"},{"1":"4","2":"25.78063","3":"21.36451","4":"30.19674"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Extra: I note that the predictions increase from 2 to 3, and then decrease sharply after that. This is not quite what the scatterplot said:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_predictions</span>(muscle<span class="fl">.1</span>, <span class="at">condition =</span> <span class="st">"Conc"</span>) <span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> muscle, <span class="fu">aes</span>(<span class="at">x =</span> Conc, <span class="at">y =</span> Length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="regression-revisited_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The shape of the parabola seems to require a drop at concentration 4, judging by the way it is increasing and then levelling off before that. Maybe the data support that, maybe they don’t.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Work out the length of each of your confidence intervals. Does it make sense that the lengths compare as they do? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>I realized at this point that I needed to save the predictions, so I went back and did that. Thus I don’t have to compute them again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>preds <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">conf_len =</span> conf.high <span class="sc">-</span> conf.low)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Conc"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["conf_len"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"29.03327","3":"26.96336","4":"31.10317","5":"4.139812"},{"1":"3","2":"30.81589","3":"28.61536","4":"33.01642","5":"4.401065"},{"1":"4","2":"25.78063","3":"21.36451","4":"30.19674","5":"8.832231"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The confidence interval for the mean response at 4 is the longest, which makes sense since it is at the upper extreme of the data and there are fewer nearby observations.</p>
<p>The shortest interval here is at a concentration of 2, which is presumably nearest the mean of the concentration values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>muscle <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_conc =</span> <span class="fu">mean</span>(Conc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mean_conc"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.5125"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>It’s the nearest of the ones here, anyway.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>(2 points) Suppose you have some new rat tissues, not part of the original dataset, and run the same experiment on these with concentrations 2, 3, and 4 units. What are 95% intervals for the predicted <code>Length</code>s that you will observe for these tissues? Display your intervals next to the concentrations they are predictions for.</li>
</ol>
<p>Solution</p>
<p>These are prediction intervals, not confidence intervals for the mean response, so we have to do them the other way:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(muscle<span class="fl">.1</span>, new, <span class="at">interval =</span> <span class="st">"p"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(new, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Conc"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fit"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["lwr"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["upr"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"29.03327","3":"18.70277","4":"39.36376","_rn_":"1"},{"1":"3","2":"30.81589","3":"20.45725","4":"41.17453","_rn_":"2"},{"1":"4","2":"25.78063","3":"14.70796","4":"36.85329","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Extra: these go down and up a lot further than the confidence intervals for the mean response, because there is more uncertainty involved: these are from individual rats, rather than the average of many, so by chance we could happen to get a <code>Length</code> value that is unusually low or high here.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Well, <em>I</em>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is <em>one</em> pair of values in each case, hence a <em>singular</em> verb.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Because a dataframe is, to R, a <code>list</code> of columns, and so the obvious thing to for-each over is what the dataframe is a list of.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>To be precise, <code>map_dbl</code> because the calculation of a mean is a decimal number, and the results get glued back together into a vector.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The part of the <code>tidyverse</code> where the file-reading functions live.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>This looks like two characters, but it is actually only one. The backslash is called an “escape character” and doesn’t count as a character for these purposes. It’s used as a way to represent some characters that you cannot normally print. Another one is <code>\n</code>, which is the “newline” at the end of each line of a file. This is how R Studio or anything else knows to start a new line at this point and not somewhere else. Otherwise the file would be all one (very long) line on the screen. To convince yourself of that, run the code <code>cat("Hello\nWorld")</code> and see what it displays.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Either axis for either variable is good, since neither of these is a response.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stan.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Bayesian Statistics with Stan</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./logistic-regression.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Logistic regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>