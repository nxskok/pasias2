<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Problems and Solutions in Applied Statistics (2nd ed) - 31&nbsp; Analysis of variance revisited</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ancova.html" rel="next">
<link href="./survival-analysis.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./anova-revisited.html"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Analysis of variance revisited</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Problems and Solutions in Applied Statistics (2nd ed)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_used.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting used to R and R Studio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reading-in.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Reading in data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./making-graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Drawing graphs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-summaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data exploration</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./working-with-dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Working with dataframes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./one-sample-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">One-sample inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./two-sample-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Two-sample inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Power and sample size</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The sign test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mood-median.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Mood median test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matched-pairs-sign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Matched pairs t and sign test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Normal quantile plots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis-of-variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Analysis of variance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing reports</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Learning to code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dandruff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Treating dandruff</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidying-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Tidying data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Simple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Multiple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Regression with categorical variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dates-and-times.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Dates and times</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vector-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Vector and matrix algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Bootstrap</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Bayesian Statistics with Stan</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-revisited.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Regression revisited</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ordinal-response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Logistic regression with ordinal response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nominal-response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Logistic regression with nominal response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Survival analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova-revisited.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Analysis of variance revisited</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Analysis of covariance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Multivariate analysis of variance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Repeated measures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discriminant-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Discriminant analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Hierarchical cluster analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kmeans-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">K-means cluster analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Multidimensional Scaling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Principal Components</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Factor Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loglin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Frequency table analysis</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#acid-rain" id="toc-acid-rain" class="nav-link active" data-scroll-target="#acid-rain"><span class="header-section-number">31.1</span> Acid rain</a></li>
  <li><a href="#treating-hay-fever" id="toc-treating-hay-fever" class="nav-link" data-scroll-target="#treating-hay-fever"><span class="header-section-number">31.2</span> Treating hay fever</a></li>
  <li><a href="#focused-comparisons-of-the-effect-of-caffeine" id="toc-focused-comparisons-of-the-effect-of-caffeine" class="nav-link" data-scroll-target="#focused-comparisons-of-the-effect-of-caffeine"><span class="header-section-number">31.3</span> Focused comparisons of the effect of caffeine</a></li>
  <li><a href="#who-studies-the-most-outside-class" id="toc-who-studies-the-most-outside-class" class="nav-link" data-scroll-target="#who-studies-the-most-outside-class"><span class="header-section-number">31.4</span> Who studies the most outside class?</a></li>
  <li><a href="#mental-context" id="toc-mental-context" class="nav-link" data-scroll-target="#mental-context"><span class="header-section-number">31.5</span> Mental context</a></li>
  <li><a href="#trying-on-shirts" id="toc-trying-on-shirts" class="nav-link" data-scroll-target="#trying-on-shirts"><span class="header-section-number">31.6</span> Trying on shirts</a></li>
  <li><a href="#acid-rain-1" id="toc-acid-rain-1" class="nav-link" data-scroll-target="#acid-rain-1"><span class="header-section-number">31.7</span> Acid rain</a></li>
  <li><a href="#treating-hay-fever-1" id="toc-treating-hay-fever-1" class="nav-link" data-scroll-target="#treating-hay-fever-1"><span class="header-section-number">31.8</span> Treating hay fever</a></li>
  <li><a href="#focused-comparisons-of-the-effect-of-caffeine-1" id="toc-focused-comparisons-of-the-effect-of-caffeine-1" class="nav-link" data-scroll-target="#focused-comparisons-of-the-effect-of-caffeine-1"><span class="header-section-number">31.9</span> Focused comparisons of the effect of caffeine</a></li>
  <li><a href="#who-studies-the-most-outside-class-1" id="toc-who-studies-the-most-outside-class-1" class="nav-link" data-scroll-target="#who-studies-the-most-outside-class-1"><span class="header-section-number">31.10</span> Who studies the most outside class?</a></li>
  <li><a href="#mental-context-1" id="toc-mental-context-1" class="nav-link" data-scroll-target="#mental-context-1"><span class="header-section-number">31.11</span> Mental context</a></li>
  <li><a href="#trying-on-shirts-1" id="toc-trying-on-shirts-1" class="nav-link" data-scroll-target="#trying-on-shirts-1"><span class="header-section-number">31.12</span> Trying on shirts</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Analysis of variance revisited</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Packages for this chapter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="acid-rain" class="level2" data-number="31.1">
<h2 data-number="31.1" class="anchored" data-anchor-id="acid-rain"><span class="header-section-number">31.1</span> Acid rain</h2>
<p>One of the first noticeable effects of climate change was “acid rain”. This is formed by the water vapour in clouds combining with nitrous oxide and sulfur dioxide, which come from coal and oil production. How does the acidity of rain affect the acidity of the soil on which it falls? (This will have an effect on the kind of plants that can be grown in that soil.) Acidity is measured using the pH scale, where a pH of 7 is chemically neutral, a number less than 7 is acidic, and a number greater than 7 is alkaline.</p>
<p>An experiment was conducted at the Florida Institute of Food and Agricultural Sciences, to determine how acidity of rain affects soil acidity. Experimental plots were irrigated with rainwater that was prepared to have one of two different pH levels, 3.7 and 4.5. The acidity of the soil was then measured at three different depths, 0–15, 15–30, and 30–46 centimetres. This was done on three different dates, in April and June 1991. The data are in <a href="http://ritsokiguess.site/datafiles/acidrain.csv">link</a>.</p>
<ol type="a">
<li><p>Read in and display the data.</p></li>
<li><p>Draw a grouped boxplot to show how soil acidity depends on the pH of the rain and the soil depth. (The first time you do this you might not get the boxplot you want. How can you fix that?)</p></li>
<li><p>What does your grouped boxplot say about likely interactions? Explain briefly.</p></li>
<li><p>Fit an ANOVA with interaction. What do you conclude from it? You may want to create a column that is the factor version of <code>rain_pH</code> first.</p></li>
</ol>
</section>
<section id="treating-hay-fever" class="level2" data-number="31.2">
<h2 data-number="31.2" class="anchored" data-anchor-id="treating-hay-fever"><span class="header-section-number">31.2</span> Treating hay fever</h2>
<p>Hay fever is an allergic reaction to things like grasses or pollen which can make it unpleasant to go outside when the weather is at its best. A research lab is developing a new compound to relieve severe cases of hay fever. There were two active ingredients, labelled A and B, with each one having three levels, low, medium and high. There were thus <span class="math inline">\(3\times 3=9\)</span> treatment combinations. 36 subjects were available, and these were randomly assigned to combinations of levels of factor A and factor B, so that each combination was tested on 4 people. The response variable was the number of hours of relief from symptoms (so a higher value is better). The data are in <a href="http://ritsokiguess.site/datafiles/hayfever.txt">link</a>.</p>
<ol type="a">
<li><p>Read the data and display its structure. Verify that you have what you were expecting.</p></li>
<li><p>Calculate the mean hours of relief for each combination of levels of the two active ingredients. Save your results in a data frame and display that.</p></li>
<li><p>Make an interaction plot, showing how the mean pain relief depends on the combination of levels of A and B. It is probably easiest to use the data frame you obtained in the previous part.</p></li>
<li><p>What do you conclude from your interaction plot? Explain briefly.</p></li>
<li><p>Run an analysis of variance with interaction. What do you conclude?</p></li>
<li><p>Analyze the simple effects of B when A is <code>medium</code>. (This means doing an appropriate <code>aov</code> and an appropriate Tukey, if warranted.)</p></li>
<li><p>Analyze the simple effects of B when A is <code>high</code>.</p></li>
</ol>
</section>
<section id="focused-comparisons-of-the-effect-of-caffeine" class="level2" data-number="31.3">
<h2 data-number="31.3" class="anchored" data-anchor-id="focused-comparisons-of-the-effect-of-caffeine"><span class="header-section-number">31.3</span> Focused comparisons of the effect of caffeine</h2>
<p>Does caffeine help students do better on a certain test? To find out, 36 students were randomly allocated to three groups (12 in each group). Each student received a fixed number of cups of coffee while they were studying, but the students didn’t know whether they were receiving all full-strength coffee (“high”), all decaf coffee (“low”) or a 50-50 mixture of the two (“moderate”). For each subject, their group was recorded as well as their score on the test. The data are in <a href="http://ritsokiguess.site/datafiles/caffeine.csv">link</a>, as a <code>.csv</code> file.</p>
<p>This time we look at contrasts. Suppose I knew ahead of time that I wanted to compare moderate caffeine with high, and any caffeine with none. (In the latter case, we’re comparing “no caffeine” against the average of the other two groups.)</p>
<p>In the previous go-through of the caffeine data, we discovered that <code>amount</code> was actually text rather than a factor, but we also discovered that it <em>didn’t matter</em>. Here it does matter, so the first thing we have to do is to re-do the <code>pivot_longer</code>, creating a factor version of <code>amount</code>.</p>
<ol type="a">
<li><p>Read in the data again, from <a href="http://ritsokiguess.site/datafiles/caffeine.csv">link</a>, and display it. This is the untidy format, so name it appropriately:</p></li>
<li><p>Copy your <code>pivot_longer</code> from before, only this time add <code>names_ptypes = list(amount=factor())</code> to the end of it. Take a look at the results. What has changed from before?</p></li>
<li><p>Using the newly tidied caffeine data, run the ANOVA <em>as a regression</em> (that is, using <code>lm</code>). Look at the <code>summary</code> of the output. What do you see?</p></li>
<li><p>Obtain the different values of <code>amount</code>, in the order that R has them.</p></li>
<li><p>Create a contrast that compares High with Moderate, ignoring None. That is, create a vector whose length is the same as the number of levels of <code>amount</code>, and which has a 1 to represent High and a <span class="math inline">\(-1\)</span> to represent Moderate.</p></li>
<li><p>Create a contrast that compares “any caffeine” against “none” by comparing None against the average of Moderate and High.</p></li>
<li><p>Verify that your two contrasts are orthogonal.</p></li>
<li><p>Arrange your contrasts as columns of a matrix (using <code>cbind</code>), and say that you want to use these as contrasts for <code>amount</code> (in data frame <code>caffeine</code> or whatever you called it).</p></li>
<li><p>Fit the ANOVA as an <code>lm</code>, and look at the <code>summary</code>. What do you conclude about your contrasts?</p></li>
<li><p>What happens if you try to use high caffeine vs.&nbsp;moderate caffeine and moderate vs.&nbsp;none as your two contrasts?</p></li>
</ol>
</section>
<section id="who-studies-the-most-outside-class" class="level2" data-number="31.4">
<h2 data-number="31.4" class="anchored" data-anchor-id="who-studies-the-most-outside-class"><span class="header-section-number">31.4</span> Who studies the most outside class?</h2>
<p>A social scientist wanted to see how many hours students studied outside of class. She took a random sample of 75 students from three different majors: math, social science and English, and recorded the number of weekly outside-class study hours for each student. The data can be found at <a href="http://ritsokiguess.site/datafiles/studyhours.txt">link</a>. The social scientist had two research questions: whether math students study more outside of class than the other students, and whether English and social science students study different amounts of time outside class.</p>
<ol type="a">
<li><p>Explain briefly why contrasts would be a better idea here than ANOVA with Tukey.</p></li>
<li><p>Read in the data and make side-by-side boxplots of study hours by major. What do the boxplots suggest about the comparisons that the researcher wants to make?</p></li>
<li><p>Set up contrasts for each of the researcher’s research questions, bearing in mind the levels of <code>major</code> and the order in which they come. (For the <code>Math</code> contrast, you want Math against the average of the other two.)</p></li>
<li><p>Verify that your two contrasts are orthogonal.</p></li>
<li><p>Create a matrix of contrasts (using <code>cbind</code>) and let <code>lm</code> know that these are contrasts for <code>major</code>, in data frame <code>studyhours</code> (or whatever you called it).</p></li>
<li><p>Fit the model using <code>lm</code>. What do you conclude about your contrasts?</p></li>
<li><p>Are you surprised by the significance or non-significance you found in the previous part? Explain briefly.</p></li>
</ol>
</section>
<section id="mental-context" class="level2" data-number="31.5">
<h2 data-number="31.5" class="anchored" data-anchor-id="mental-context"><span class="header-section-number">31.5</span> Mental context</h2>
<p>It is believed that being in the same mental context for learning and for testing leads to better test scores. An experiment was carried out to test this. During the learning phase, subjects learned a list of 80 words in a room painted orange and decorated with posters, paintings and other paraphernalia.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> A memory test was given to all subjects immediately after they had learned the words, to give the impression that the experiment was over. (The results of this test were discarded.) One day later, subjects were unexpectedly re-tested under different experimental conditions and asked to write down all the words of the original list that they could remember. The re-test took place in five different conditions, which subjects were randomly allocated to one of:</p>
<ul>
<li><p>Same context: in the original orange-painted room.</p></li>
<li><p>Different context: in a very different room, painted grey and located in a different part of campus.</p></li>
<li><p>Imaginary context: in the grey room, but subjects are asked to remember the orange room in which they took the original test. To help them with this, the experimenter begins by asking them several questions about the orange room and the objects in it.</p></li>
<li><p>Photographed context: in the grey room, but subjects are shown photographs of the orange room.</p></li>
<li><p>Placebo context: in the grey room, with subjects first being asked to recall their living room.</p></li>
</ul>
<p>In each case, the response variable was the number of words on the original list successfully recalled by each subject.</p>
<p>50 subjects in total completed the experiment, 10 under each of the 5 conditions.</p>
<p>The researchers had four research hypotheses to test with the data:</p>
<ul>
<li><p>Groups where the context matches (is the same, or is simulated by imagining or photograph) will perform better than groups with different or placebo contexts.</p></li>
<li><p>The group with the same context will differ from the group with imaginary or photographed contexts.</p></li>
<li><p>The imaginary-context group will differ from the photographed-context group.</p></li>
<li><p>The different-context group will differ from the placebo-context group.</p></li>
</ul>
<p>The research hypotheses are (as is usual) written as <em>alternative</em> hypotheses. We can rewrite them as null hypotheses, with some extra wording to facilitate converting them into contrasts, like this:</p>
<ul>
<li><p>The mean of the <code>same</code>, <code>imaginary</code> and <code>photograph</code> groups (group means) is equal to the mean of the <code>different</code> and <code>placebo</code> groups (group means).</p></li>
<li><p>The mean of the <code>imaginary</code> and <code>photograph</code> groups is equal to the (mean of the) <code>same</code> group.</p></li>
<li><p>The <code>imaginary</code> and the <code>photograph</code> groups will have the same mean.</p></li>
<li><p>The <code>different</code> and the <code>placebo</code> groups will have the same mean.</p></li>
</ul>
<p>The data are in <a href="http://ritsokiguess.site/datafiles/smith.txt">link</a> (the original researcher’s name was Smith).</p>
<ol type="a">
<li><p>Read in the data and verify that you have a column called <code>context</code> that is text and a column called <code>words</code> that is a (whole) number.</p></li>
<li><p>Turn <code>context</code> into a <code>factor</code>, within the data frame. (We are going to be doing contrasts). Display how the data frame now looks.</p></li>
<li><p>What are the names of the five contexts in the data set (just display them), and what order are they in?</p></li>
<li><p>Write each of the four research hypotheses (in the null-hypothesis versions) as R vectors that can be used to make contrasts. (This will mean getting the contexts in the right order. If you get stuck, do the last two first, since they’re easiest. The first one is actually the hardest.)</p></li>
<li><p>Pick two of your contrasts (doesn’t matter which two) and demonstrate that they are orthogonal.</p></li>
<li><p>Collect your contrasts together into a matrix, and tell <code>lm</code> that these are the contrasts for <code>context</code>.</p></li>
<li><p>Fit a model with <code>lm</code>, and display the results.</p></li>
<li><p>For each of the original research hypotheses, what do you infer about them?</p></li>
</ol>
</section>
<section id="trying-on-shirts" class="level2" data-number="31.6">
<h2 data-number="31.6" class="anchored" data-anchor-id="trying-on-shirts"><span class="header-section-number">31.6</span> Trying on shirts</h2>
<p>Does it make a difference if you see somebody else trying on a shirt before you do, and if so, does it matter what kind of person it is?</p>
<p>An experiment was carried out in a university bookstore, with students who wanted to try on a shirt serving as (unsuspecting) experimental subjects. When a student wanted to try on a shirt, the sales associate told them that there was only one shirt left, and it was being tried on by an “other customer”. This “other customer” was actually a “confederate” of the experimenter (that means, they were pretending to be a real customer but were actually part of the experiment). The “other customer” was always female: either an attractive well-dressed model, or an average-looking student wearing jeans. The “other customer” would come out of the dressing room and hand the shirt to the sales associate, who would give it to the student who wanted to try it on. When the student had tried on the shirt, they were asked to rate it on a 7-point scale (on five different dimensions, and those five scores were then averaged). Does a student’s evaluation depend on whether the student was male or female, and whether the “other customer” was a model or a student? There was also a control group, where the student was handed the shirt directly by the sales associate, without the “other customer” being involved at all.</p>
<p>There were thus five treatments: male students who saw a model, male students who saw a student, female students who saw a model, female students who saw a student, and the control group. There were 25 students in each treatment group.</p>
<p>The data from this experiment can be found at <a href="http://ritsokiguess.site/datafiles/shirts.csv">link</a>.</p>
<ol type="a">
<li><p>Read in and display the data. How many observations do you have, and is that what you should have?</p></li>
<li><p>Turn <code>treatment</code> into a <code>factor</code> in your data frame. (You can use the same name as the text <code>treatment</code> that you read in from the file.)</p></li>
<li><p>List the treatments in the order that they are in within your <code>factor</code>. (There are lots of ways to do this; any one of them except for <code>distinct</code> is good.)</p></li>
<li><p><a name="part:mean-eval">*</a> Obtain a table of mean evaluation scores for each treatment group.</p></li>
<li><p>The experimenters wanted to compare four specific things in their analysis:</p></li>
</ol>
<ul>
<li><p>evaluation scores between male students who saw a (female) model and male students who saw a (female) student</p></li>
<li><p>evaluation scores between female students who saw a (female) model and female students who saw a (female) student</p></li>
<li><p>evaluation scores for male and for female students (overall)</p></li>
<li><p>evaluation scores for the (average of the) four genuine treatments and for the control group</p></li>
</ul>
<p>Create contrasts, with suitable names, using vectors with appropriate values.</p>
<ol start="6" type="a">
<li><p>Pick two of your contrasts (doesn’t matter which two) and demonstrate that they are orthogonal.</p></li>
<li><p>Collect all your contrasts together into a matrix and declare that they are contrasts for <code>treatment</code> within your data frame (whatever you called it).</p></li>
<li><p>Predict evaluation score from treatment <em>as a regression</em>, and display the results.</p></li>
<li><p>For each of your contrasts, assess whether or not it is significant, and explain briefly what that means in the context of the data. If a contrast is significant, use your answer to part (<a href="#part:mean-eval">here</a>) to help in your interpretation.</p></li>
</ol>
<p>My solutions follow:</p>
</section>
<section id="acid-rain-1" class="level2" data-number="31.7">
<h2 data-number="31.7" class="anchored" data-anchor-id="acid-rain-1"><span class="header-section-number">31.7</span> Acid rain</h2>
<p>One of the first noticeable effects of climate change was “acid rain”. This is formed by the water vapour in clouds combining with nitrous oxide and sulfur dioxide, which come from coal and oil production. How does the acidity of rain affect the acidity of the soil on which it falls? (This will have an effect on the kind of plants that can be grown in that soil.) Acidity is measured using the pH scale, where a pH of 7 is chemically neutral, a number less than 7 is acidic, and a number greater than 7 is alkaline.</p>
<p>An experiment was conducted at the Florida Institute of Food and Agricultural Sciences, to determine how acidity of rain affects soil acidity. Experimental plots were irrigated with rainwater that was prepared to have one of two different pH levels, 3.7 and 4.5. The acidity of the soil was then measured at three different depths, 0–15, 15–30, and 30–46 centimetres. This was done on three different dates, in April and June 1991. The data are in <a href="http://ritsokiguess.site/datafiles/acidrain.csv">link</a>.</p>
<ol type="a">
<li>Read in and display the data.</li>
</ol>
<p>Solution</p>
<p>This time, it’s a <code>.csv</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/acidrain.csv"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>acidrain <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 18 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (1): soil_depth
dbl  (2): rain_pH, soil_acidity
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>acidrain</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["soil_depth"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date"],"name":[2],"type":["date"],"align":["right"]},{"label":["rain_pH"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["soil_acidity"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0-15","2":"1991-04-03","3":"3.7","4":"5.33"},{"1":"0-15","2":"1991-04-03","3":"4.5","4":"5.33"},{"1":"0-15","2":"1991-06-16","3":"3.7","4":"5.47"},{"1":"0-15","2":"1991-06-16","3":"4.5","4":"5.47"},{"1":"0-15","2":"1991-06-30","3":"3.7","4":"5.20"},{"1":"0-15","2":"1991-06-30","3":"4.5","4":"5.13"},{"1":"15-30","2":"1991-04-03","3":"3.7","4":"5.27"},{"1":"15-30","2":"1991-04-03","3":"4.5","4":"5.03"},{"1":"15-30","2":"1991-06-16","3":"3.7","4":"5.50"},{"1":"15-30","2":"1991-06-16","3":"4.5","4":"5.53"},{"1":"15-30","2":"1991-06-30","3":"3.7","4":"5.33"},{"1":"15-30","2":"1991-06-30","3":"4.5","4":"5.20"},{"1":"30-46","2":"1991-04-03","3":"3.7","4":"5.37"},{"1":"30-46","2":"1991-04-03","3":"4.5","4":"5.40"},{"1":"30-46","2":"1991-06-16","3":"3.7","4":"5.80"},{"1":"30-46","2":"1991-06-16","3":"4.5","4":"5.60"},{"1":"30-46","2":"1991-06-30","3":"3.7","4":"5.33"},{"1":"30-46","2":"1991-06-30","3":"4.5","4":"5.17"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>There are 4 columns, soil depth, date, pH of the rain that was applied (all explanatory) and soil acidity, the response. You’ll note that we have one soil acidity value per combination of the other things (it was a designed experiment).</p>
<p>We’re going to ignore the date for now, treating the observations on different dates as replicates.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Draw a grouped boxplot to show how soil acidity depends on the pH of the rain and the soil depth. (The first time you do this you might not get the boxplot you want. How can you fix that?)</li>
</ol>
<p>Solution</p>
<p>The problem is likely to be that either your <code>x</code> or your <code>fill</code> for your boxplot is numerical (<code>rain_pH</code> is <code>dbl</code>) rather than the categorical variable you need. Try to use one of the explanatory variables as <code>x</code> and the other one as <code>fill</code> (or <code>colour</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(acidrain, <span class="fu">aes</span>(<span class="at">x =</span> rain_pH, <span class="at">y =</span> soil_acidity, <span class="at">fill =</span> soil_depth)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="anova-revisited_files/figure-html/acidrain-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>That looks as if it worked, but it didn’t. See the boxplot below for how it’s supposed to be. I need <code>x</code> for the boxplot needs to be categorical. The easiest way to make it such is to wrap it in <code>factor</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(acidrain, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(rain_pH), <span class="at">y =</span> soil_acidity, <span class="at">fill =</span> soil_depth)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="anova-revisited_files/figure-html/acidrain-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Even though <code>soil_depth</code> looks like numbers, the printout of the data frame reveals that it is text, so that is OK.</p>
<p>If you prefer, exchange <code>x</code> and <code>fill</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(acidrain, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(rain_pH), <span class="at">y =</span> soil_acidity, <span class="at">x =</span> soil_depth)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="anova-revisited_files/figure-html/acidrain-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>What does your grouped boxplot say about likely interactions? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>Think about the effect of one of your explanatory variables, for each level of the other. For example, in the last plot, the effect of the rain pH pm on the soil acidity is very small at the largest and smallest depths, but at the middle soil depth 15–30, the average (median) soil acidity is a lot less when the rain pH is <em>higher</em> (which seems odd to me). The effect of rain pH being different according to soil pH is what suggests an interaction effect. Another way of thinking about this is imagining what an interaction plot would look like. This would be a trace going through the middle (strictly, mean rather than median) of each set of boxplots of one colour. In the last boxplot, the red trace would go close to straight across, while the blue one would dip in the middle. Not parallel, so suggesting an interaction. Either approach is good.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Fit an ANOVA with interaction. What do you conclude from it? You may want to create a column that is the factor version of <code>rain_pH</code> first.</li>
</ol>
<p>Solution</p>
<p>Following my own hint:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>acidrain <span class="ot">&lt;-</span> acidrain <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">frph =</span> <span class="fu">factor</span>(rain_pH))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>soil<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">aov</span>(soil_acidity <span class="sc">~</span> frph <span class="sc">*</span> soil_depth, <span class="at">data =</span> acidrain)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(soil<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Df Sum Sq Mean Sq F value Pr(&gt;F)
frph             1 0.0304 0.03042   0.759  0.401
soil_depth       2 0.0671 0.03357   0.838  0.457
frph:soil_depth  2 0.0078 0.00391   0.097  0.908
Residuals       12 0.4810 0.04008               </code></pre>
</div>
</div>
<p>The interaction is nowhere near significant, perhaps surprisingly. But bear in mind that there are only 18 observations in total, so each box on the boxplot is based on <em>three</em> observations only. So the interaction would have to be a lot bigger to be significant.</p>
<p>The usual procedure after finding a non-significant interaction is to take it out:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>soil<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(soil<span class="fl">.1</span>, . <span class="sc">~</span> . <span class="sc">-</span> frph<span class="sc">:</span>soil_depth)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(soil<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
frph         1 0.0304 0.03042   0.871  0.366
soil_depth   2 0.0671 0.03357   0.962  0.406
Residuals   14 0.4888 0.03492               </code></pre>
</div>
</div>
<p>The P-values have come down a bit (the result of gaining two df for error while the error SS only got a tiny bit bigger), but not nearly enough to be significant.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="treating-hay-fever-1" class="level2" data-number="31.8">
<h2 data-number="31.8" class="anchored" data-anchor-id="treating-hay-fever-1"><span class="header-section-number">31.8</span> Treating hay fever</h2>
<p>Hay fever is an allergic reaction to things like grasses or pollen which can make it unpleasant to go outside when the weather is at its best. A research lab is developing a new compound to relieve severe cases of hay fever. There were two active ingredients, labelled A and B, with each one having three levels, low, medium and high. There were thus <span class="math inline">\(3\times 3=9\)</span> treatment combinations. 36 subjects were available, and these were randomly assigned to combinations of levels of factor A and factor B, so that each combination was tested on 4 people. The response variable was the number of hours of relief from symptoms (so a higher value is better). The data are in <a href="http://ritsokiguess.site/datafiles/hayfever.txt">link</a>.</p>
<ol type="a">
<li>Read the data and display its structure. Verify that you have what you were expecting.</li>
</ol>
<p>Solution</p>
<p>Aligned columns separated by spaces, so <code>read_table</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/hayfever.txt"</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>hayfever <span class="ot">&lt;-</span> <span class="fu">read_table</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
── Column specification ────────────────────────────────────────────────────────
cols(
  relief = col_double(),
  a = col_character(),
  b = col_character(),
  replicate = col_double()
)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>hayfever</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["relief"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["a"],"name":[2],"type":["chr"],"align":["left"]},{"label":["b"],"name":[3],"type":["chr"],"align":["left"]},{"label":["replicate"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.4","2":"low","3":"low","4":"1"},{"1":"2.7","2":"low","3":"low","4":"2"},{"1":"2.3","2":"low","3":"low","4":"3"},{"1":"2.5","2":"low","3":"low","4":"4"},{"1":"4.6","2":"low","3":"medium","4":"1"},{"1":"4.2","2":"low","3":"medium","4":"2"},{"1":"4.9","2":"low","3":"medium","4":"3"},{"1":"4.7","2":"low","3":"medium","4":"4"},{"1":"4.8","2":"low","3":"high","4":"1"},{"1":"4.5","2":"low","3":"high","4":"2"},{"1":"4.4","2":"low","3":"high","4":"3"},{"1":"4.6","2":"low","3":"high","4":"4"},{"1":"5.8","2":"medium","3":"low","4":"1"},{"1":"5.2","2":"medium","3":"low","4":"2"},{"1":"5.5","2":"medium","3":"low","4":"3"},{"1":"5.3","2":"medium","3":"low","4":"4"},{"1":"8.9","2":"medium","3":"medium","4":"1"},{"1":"9.1","2":"medium","3":"medium","4":"2"},{"1":"8.7","2":"medium","3":"medium","4":"3"},{"1":"9.0","2":"medium","3":"medium","4":"4"},{"1":"9.1","2":"medium","3":"high","4":"1"},{"1":"9.3","2":"medium","3":"high","4":"2"},{"1":"8.7","2":"medium","3":"high","4":"3"},{"1":"9.4","2":"medium","3":"high","4":"4"},{"1":"6.1","2":"high","3":"low","4":"1"},{"1":"5.7","2":"high","3":"low","4":"2"},{"1":"5.9","2":"high","3":"low","4":"3"},{"1":"6.2","2":"high","3":"low","4":"4"},{"1":"9.9","2":"high","3":"medium","4":"1"},{"1":"10.5","2":"high","3":"medium","4":"2"},{"1":"10.6","2":"high","3":"medium","4":"3"},{"1":"10.1","2":"high","3":"medium","4":"4"},{"1":"13.5","2":"high","3":"high","4":"1"},{"1":"13.0","2":"high","3":"high","4":"2"},{"1":"13.3","2":"high","3":"high","4":"3"},{"1":"13.2","2":"high","3":"high","4":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>I have 36 observations (patients). There are two categorical columns <code>a</code> and <code>b</code> corresponding to the two active ingredients, and they each seem to have levels low, medium and high.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>The <code>replicate</code> column labels each observation <em>within</em> its A-B combination, so that each treatment combination was indeed replicated four times. We won’t be using this column in our analysis; I think it’s a refugee from the original untidy format the data was in before it came to you.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Calculate the mean hours of relief for each combination of levels of the two active ingredients. Save your results in a data frame and display that.</li>
</ol>
<p>Solution</p>
<p>This is a group-by and summarize, but there are two active ingredients and they <em>both</em> have to go in the group-by:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>hayfever <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(a, b) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">m =</span> <span class="fu">mean</span>(relief)) <span class="ot">-&gt;</span> d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'a'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["a"],"name":[1],"type":["chr"],"align":["left"]},{"label":["b"],"name":[2],"type":["chr"],"align":["left"]},{"label":["m"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"high","2":"high","3":"13.250"},{"1":"high","2":"low","3":"5.975"},{"1":"high","2":"medium","3":"10.275"},{"1":"low","2":"high","3":"4.575"},{"1":"low","2":"low","3":"2.475"},{"1":"low","2":"medium","3":"4.600"},{"1":"medium","2":"high","3":"9.125"},{"1":"medium","2":"low","3":"5.450"},{"1":"medium","2":"medium","3":"8.925"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>I’m using my usual name <code>d</code> for a temporary data frame. I could have put brackets around my whole pipeline to display its result, but I still need to save the data frame <code>d</code> to use in a moment.</p>
<p>These levels are in the wrong logical order, but they are in the right order in the original data frame, so we can use <code>fct_inorder</code> first, thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>hayfever <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a =</span> <span class="fu">fct_inorder</span>(a), <span class="at">b =</span> <span class="fu">fct_inorder</span>(b)) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(a, b) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">m =</span> <span class="fu">mean</span>(relief)) <span class="ot">-&gt;</span> d2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'a'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>d2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["a"],"name":[1],"type":["fct"],"align":["left"]},{"label":["b"],"name":[2],"type":["fct"],"align":["left"]},{"label":["m"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"low","2":"low","3":"2.475"},{"1":"low","2":"medium","3":"4.600"},{"1":"low","2":"high","3":"4.575"},{"1":"medium","2":"low","3":"5.450"},{"1":"medium","2":"medium","3":"8.925"},{"1":"medium","2":"high","3":"9.125"},{"1":"high","2":"low","3":"5.975"},{"1":"high","2":"medium","3":"10.275"},{"1":"high","2":"high","3":"13.250"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>Make an interaction plot, showing how the mean pain relief depends on the combination of levels of A and B. It is probably easiest to use the data frame you obtained in the previous part.</li>
</ol>
<p>Solution</p>
<p>My column of mean relief values is called <code>m</code>. Use whatever name you gave it. I’m going to use my proper-order data frame for this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(<span class="at">x =</span> a, <span class="at">y =</span> m, <span class="at">colour =</span> b, <span class="at">group =</span> b)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="anova-revisited_files/figure-html/zellerin-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Or, you probably had this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x =</span> a, <span class="at">y =</span> m, <span class="at">colour =</span> b, <span class="at">group =</span> b)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="anova-revisited_files/figure-html/bapplin-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Since <code>a</code> and <code>b</code> both have three levels, you could just as well use them the other way around:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(<span class="at">x =</span> b, <span class="at">y =</span> m, <span class="at">colour =</span> a, <span class="at">group =</span> a)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="anova-revisited_files/figure-html/vonmengen-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plot looks different depending on how you draw it, but the conclusion from it (below) will be the same.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>What do you conclude from your interaction plot? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>The three lines are not particularly close to being parallel, so I would expect to see an interaction between the two active ingredients (that is, the number of hours of pain relief depends on the combination of the two of them).</p>
<p>Extra: It is always a judgment call to decide whether the lines are “approximately parallel” or not. It depends on how much variability there is in the data, which the interaction plot doesn’t show. Another idea is to add the data to the interaction plot, colour-coded in the same way. I would do this by taking out the <code>geom_point</code> for the means and add one instead for the data, taken from the original data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d2, <span class="fu">aes</span>(<span class="at">x =</span> a, <span class="at">y =</span> m, <span class="at">colour =</span> b, <span class="at">group =</span> b)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> hayfever, <span class="fu">aes</span>(<span class="at">y =</span> relief))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="anova-revisited_files/figure-html/swaub-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Technique: for that last <code>geom_point</code>, put in anything that changes: a new data frame, and a new <code>y</code> for the plot, but the <code>x</code> and <code>colour</code> and <code>group</code> are the same as they were before, so I don’t need to specify them.</p>
<p>The points are <em>very</em> close to the lines, so there is almost no residual variability. This makes it more convincing that the interaction is real and will be significant.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Run an analysis of variance with interaction. What do you conclude?</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>hayfever<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">aov</span>(relief <span class="sc">~</span> a <span class="sc">*</span> b, <span class="at">data =</span> hayfever)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hayfever<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)    
a            2 220.02  110.01  1827.9 &lt;2e-16 ***
b            2 123.66   61.83  1027.3 &lt;2e-16 ***
a:b          4  29.42    7.36   122.2 &lt;2e-16 ***
Residuals   27   1.63    0.06                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The interaction is (strongly) significant. The hours of relief depend on the combination of levels of the active ingredients A and B.</p>
<p>Don’t try to interpret the main effects of A and B from here. That’s what simple effects are for, coming up.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Analyze the simple effects of B when A is <code>medium</code>. (This means doing an appropriate <code>aov</code> and an appropriate Tukey, if warranted.)</li>
</ol>
<p>Solution</p>
<p>First, we pull out only the data where A is <code>medium</code>, and then we do a one-way analysis of B on that data. This is the slick way, though you can certainly save the result of <code>filter</code> first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>hayfever <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(a <span class="sc">==</span> <span class="st">"medium"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov</span>(relief <span class="sc">~</span> b, <span class="at">data =</span> .) <span class="ot">-&gt;</span> simple_medium</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simple_medium)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
b            2  34.16  17.081   262.8 1.04e-08 ***
Residuals    9   0.59   0.065                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>There is definitely some effect of ingredient B when A is medium. What is it? Tukey will tell us:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(simple_medium)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = relief ~ b, data = .)

$b
              diff       lwr       upr     p adj
low-high    -3.675 -4.178336 -3.171664 0.0000000
medium-high -0.200 -0.703336  0.303336 0.5323662
medium-low   3.475  2.971664  3.978336 0.0000000</code></pre>
</div>
</div>
<p>There is no difference between medium and high (levels of B), but both of these are better in terms of relief than low is.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Analyze the simple effects of B when A is <code>high</code>.</li>
</ol>
<p>Solution</p>
<p>Same idea: pull out only the data where A is <code>high</code>, do a one-way analysis of B, and do Tukey if needed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>hayfever <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(a <span class="sc">==</span> <span class="st">"high"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov</span>(relief <span class="sc">~</span> b, <span class="at">data =</span> .) <span class="ot">-&gt;</span> simple_high</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simple_high)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
b            2 107.02   53.51     796 7.49e-11 ***
Residuals    9   0.61    0.07                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(simple_high)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = relief ~ b, data = .)

$b
              diff       lwr       upr p adj
low-high    -7.275 -7.786868 -6.763132 0e+00
medium-high -2.975 -3.486868 -2.463132 2e-07
medium-low   4.300  3.788132  4.811868 0e+00</code></pre>
</div>
</div>
<p>When A is high, there is definitely an effect of B again, but this time high (for B) is better than medium is better than low. (All the P-values in Tukey are very small.)</p>
<p>You could guess this from the interaction plot as well (whichever one you came up with): when A is high, it is better for B to be high as well, but when A is medium or low, there is not much difference between B being medium or high.</p>
<p>Extra: here, the effect of B is different, depending on what A is. This is what a significant interaction <em>means</em>. If there were no significant interaction, the effect of B would always be the same, no matter what A was.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="focused-comparisons-of-the-effect-of-caffeine-1" class="level2" data-number="31.9">
<h2 data-number="31.9" class="anchored" data-anchor-id="focused-comparisons-of-the-effect-of-caffeine-1"><span class="header-section-number">31.9</span> Focused comparisons of the effect of caffeine</h2>
<p>Does caffeine help students do better on a certain test? To find out, 36 students were randomly allocated to three groups (12 in each group). Each student received a fixed number of cups of coffee while they were studying, but the students didn’t know whether they were receiving all full-strength coffee (“high”), all decaf coffee (“low”) or a 50-50 mixture of the two (“moderate”). For each subject, their group was recorded as well as their score on the test. The data are in <a href="http://ritsokiguess.site/datafiles/caffeine.csv">link</a>, as a <code>.csv</code> file.</p>
<p>This time we look at contrasts. Suppose I knew ahead of time that I wanted to compare moderate caffeine with high, and any caffeine with none. (In the latter case, we’re comparing “no caffeine” against the average of the other two groups.)</p>
<p>In the previous go-through of the caffeine data, we discovered that <code>amount</code> was actually text rather than a factor, but we also discovered that it <em>didn’t matter</em>. Here it does matter, so the first thing we have to do is to re-do the <code>pivot_longer</code>, creating a factor version of <code>amount</code>.</p>
<ol type="a">
<li>Read in the data again, from <a href="http://ritsokiguess.site/datafiles/caffeine.csv">link</a>, and display it. This is the untidy format, so name it appropriately:</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://individual.utoronto.ca/kbutler/stad29/caffeine.csv"</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>caffeine.untidy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 12 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (4): Sub, High, Moderate, None

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>caffeine.untidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Sub"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["High"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Moderate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["None"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"72","3":"68","4":"68"},{"1":"2","2":"65","3":"80","4":"74"},{"1":"3","2":"68","3":"64","4":"59"},{"1":"4","2":"83","3":"65","4":"61"},{"1":"5","2":"79","3":"69","4":"65"},{"1":"6","2":"92","3":"79","4":"72"},{"1":"7","2":"69","3":"80","4":"80"},{"1":"8","2":"74","3":"63","4":"58"},{"1":"9","2":"78","3":"69","4":"65"},{"1":"10","2":"83","3":"70","4":"60"},{"1":"11","2":"88","3":"83","4":"78"},{"1":"12","2":"71","3":"75","4":"75"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>One caffeine level per column, rather than a column of caffeine levels, so untidy.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Copy your <code>pivot_longer</code> from before, only this time add <code>names_ptypes = list(amount=factor())</code> to the end of it. Take a look at the results. What has changed from before?</li>
</ol>
<p>Solution</p>
<p>We’ll save into <code>caffeine</code> again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>caffeine.untidy <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>Sub, <span class="at">names_to=</span><span class="st">"amount"</span>, <span class="at">values_to=</span><span class="st">"score"</span>, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_ptypes =</span> <span class="fu">list</span>(<span class="at">amount=</span><span class="fu">factor</span>())) <span class="ot">-&gt;</span> caffeine</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>caffeine</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Sub"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["amount"],"name":[2],"type":["fct"],"align":["left"]},{"label":["score"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"High","3":"72"},{"1":"1","2":"Moderate","3":"68"},{"1":"1","2":"None","3":"68"},{"1":"2","2":"High","3":"65"},{"1":"2","2":"Moderate","3":"80"},{"1":"2","2":"None","3":"74"},{"1":"3","2":"High","3":"68"},{"1":"3","2":"Moderate","3":"64"},{"1":"3","2":"None","3":"59"},{"1":"4","2":"High","3":"83"},{"1":"4","2":"Moderate","3":"65"},{"1":"4","2":"None","3":"61"},{"1":"5","2":"High","3":"79"},{"1":"5","2":"Moderate","3":"69"},{"1":"5","2":"None","3":"65"},{"1":"6","2":"High","3":"92"},{"1":"6","2":"Moderate","3":"79"},{"1":"6","2":"None","3":"72"},{"1":"7","2":"High","3":"69"},{"1":"7","2":"Moderate","3":"80"},{"1":"7","2":"None","3":"80"},{"1":"8","2":"High","3":"74"},{"1":"8","2":"Moderate","3":"63"},{"1":"8","2":"None","3":"58"},{"1":"9","2":"High","3":"78"},{"1":"9","2":"Moderate","3":"69"},{"1":"9","2":"None","3":"65"},{"1":"10","2":"High","3":"83"},{"1":"10","2":"Moderate","3":"70"},{"1":"10","2":"None","3":"60"},{"1":"11","2":"High","3":"88"},{"1":"11","2":"Moderate","3":"83"},{"1":"11","2":"None","3":"78"},{"1":"12","2":"High","3":"71"},{"1":"12","2":"Moderate","3":"75"},{"1":"12","2":"None","3":"75"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The variable created for the “names” is now a <code>factor</code>: it was text before. Maybe we should have made it a factor before (it wouldn’t have done any harm), but we got away with not doing so.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>Using the newly tidied caffeine data, run the ANOVA <em>as a regression</em> (that is, using <code>lm</code>). Look at the <code>summary</code> of the output. What do you see?</li>
</ol>
<p>Solution</p>
<p>Extra: I’m going to run the ANOVA the “old way” first, so that we can compare results. You don’t need to do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>caffeine.old <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> amount, <span class="at">data =</span> caffeine)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(caffeine.old)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
amount       2  477.7  238.86   3.986 0.0281 *
Residuals   33 1977.5   59.92                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(caffeine.old)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = score ~ amount, data = caffeine)

$amount
                   diff       lwr       upr     p adj
Moderate-High -4.750000 -12.50468  3.004679 0.3025693
None-High     -8.916667 -16.67135 -1.161987 0.0213422
None-Moderate -4.166667 -11.92135  3.588013 0.3952176</code></pre>
</div>
</div>
<p>End of digression.</p>
<p>Now we’ll do it using <code>lm</code>, with contrasts later, and see how things change:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>caffeine<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> amount, <span class="at">data =</span> caffeine)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(caffeine<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ amount, data = caffeine)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.833  -6.958  -2.458   6.354  15.167 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      76.833      2.235  34.383  &lt; 2e-16 ***
amountModerate   -4.750      3.160  -1.503  0.14234    
amountNone       -8.917      3.160  -2.821  0.00803 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.741 on 33 degrees of freedom
Multiple R-squared:  0.1946,    Adjusted R-squared:  0.1458 
F-statistic: 3.986 on 2 and 33 DF,  p-value: 0.02815</code></pre>
</div>
</div>
<p>Look at the slopes. They are <code>amount</code> followed by one of the amounts of caffeine. R is using “high” as a baseline (that’s the first level alphabetically), so the <code>amountModerate</code> line is testing high vs.&nbsp;moderate: high is <em>not</em> significantly higher, in terms of test scores, than moderate. That’s one of the things I wanted to test. What about the coefficient for <code>amountNone</code>? That’s none vs.&nbsp;<em>high</em>, since high was the baseline. This is, as we saw from Tukey, significant. But it is not what I said we wanted to test.</p>
<p>Extra: in case you’re curious, you can also get the regular analysis of variance table as below. <code>anova</code> is multi-talented:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(caffeine<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"477.7222","3":"238.86111","4":"3.986051","5":"0.02814646","_rn_":"amount"},{"1":"33","2":"1977.5000","3":"59.92424","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The problem is that you can’t naturally do Tukey this way, which is often what you want to do next. That’s why we used <code>aov</code> before.</p>
<p>Since we have a regression model (albeit a peculiar one), we can test whether we should remove <code>amount</code> (that is, whether it has any impact on test scores) this way too:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(caffeine<span class="fl">.2</span>, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"1977.500","4":"150.2185","5":"NA","6":"NA","_rn_":"<none>"},{"1":"2","2":"477.7222","3":"2455.222","4":"154.0083","5":"3.986051","6":"0.02814646","_rn_":"amount"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Same conclusion: there is some effect of caffeine level on test score.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Obtain the different values of <code>amount</code>, in the order that R has them.</li>
</ol>
<p>Solution</p>
<p>Count them, or find the distinct ones:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>caffeine <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(amount) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["amount"],"name":[1],"type":["fct"],"align":["left"]},{"label":["count"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"High","2":"12"},{"1":"Moderate","2":"12"},{"1":"None","2":"12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>or there is this shortcut to the above:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>caffeine <span class="sc">%&gt;%</span> <span class="fu">count</span>(amount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["amount"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"High","2":"12"},{"1":"Moderate","2":"12"},{"1":"None","2":"12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>caffeine <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(amount)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["amount"],"name":[1],"type":["fct"],"align":["left"]}],"data":[{"1":"High"},{"1":"Moderate"},{"1":"None"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>since we didn’t really need to know how many of each there were.</p>
<p>These would all have worked if <code>amount</code> had been text rather a factor. If you have a genuine <code>factor</code>, you can also ask for its <code>levels</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(caffeine, <span class="fu">levels</span>(amount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "High"     "Moderate" "None"    </code></pre>
</div>
</div>
<p>or <code>summary</code> will count them up and list them:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>caffeine <span class="sc">%&gt;%</span> <span class="fu">select</span>(amount) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      amount  
 High    :12  
 Moderate:12  
 None    :12  </code></pre>
</div>
</div>
<p>This last won’t work if you have a categorical-variable-as-text. It has to be a genuine factor for it to work.</p>
<p>The categories are High, Moderate and None in that order. For working with contrasts, we need to have the thing we’re making contrasts for (see below) as a <code>factor</code>, otherwise it won’t work.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Create a contrast that compares High with Moderate, ignoring None. That is, create a vector whose length is the same as the number of levels of <code>amount</code>, and which has a 1 to represent High and a <span class="math inline">\(-1\)</span> to represent Moderate.</li>
</ol>
<p>Solution</p>
<p>Put a 0 in for None:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>c.hm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Having the 1 and the <span class="math inline">\(-1\)</span> the other way around would also have been fine.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Create a contrast that compares “any caffeine” against “none” by comparing None against the average of Moderate and High.</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>c.any <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that both our contrasts have coefficients that add up to zero, as they must:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(c.hm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(c.any)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Verify that your two contrasts are orthogonal.</li>
</ol>
<p>Solution</p>
<p>Multiply them together and check that what you get adds up to zero:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(c.hm <span class="sc">*</span> c.any)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Zero, so orthogonal. You can check that writing <code>c.any</code> as <code>c(-1,-1,2)</code> would also work (and still be orthogonal with <code>c.hm</code>), and so would writing it as <code>c(1,1,-2)</code>.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" type="a">
<li>Arrange your contrasts as columns of a matrix (using <code>cbind</code>), and say that you want to use these as contrasts for <code>amount</code> (in data frame <code>caffeine</code> or whatever you called it).</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(c.hm, c.any)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(caffeine<span class="sc">$</span>amount) <span class="ot">&lt;-</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol type="i">
<li>Fit the ANOVA as an <code>lm</code>, and look at the <code>summary</code>. What do you conclude about your contrasts?</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>caff<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> amount, <span class="at">data =</span> caffeine)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(caff<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ amount, data = caffeine)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.833  -6.958  -2.458   6.354  15.167 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   72.278      1.290  56.022   &lt;2e-16 ***
amountc.hm     2.375      1.580   1.503   0.1423    
amountc.any   -4.361      1.825  -2.390   0.0227 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.741 on 33 degrees of freedom
Multiple R-squared:  0.1946,    Adjusted R-squared:  0.1458 
F-statistic: 3.986 on 2 and 33 DF,  p-value: 0.02815</code></pre>
</div>
</div>
<p><code>c.hm</code> was the contrast between high and moderate caffeine. This is not significant (P-value 0.142), which is the same conclusion as Tukey, but the P-value here is quite a bit lower (and thus closer to being significant). There’s a reason for that: here we are focusing in on the two contrasts that we really wanted to test, and ignoring the <span class="math inline">\(F\)</span>-test and the Tukey that tell us stuff that we don’t care about. By focusing our comparison, we get a better (smaller) P-value.</p>
<p><code>c.any</code> was none vs.&nbsp;average of any caffeine. This one is significant, with a P-value of 0.023. So this contrast tells us that having any caffeine is better than having none.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="10" type="a">
<li>What happens if you try to use high caffeine vs.&nbsp;moderate caffeine and moderate vs.&nbsp;none as your two contrasts?</li>
</ol>
<p>Solution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>c.hm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>c.mn <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So far so good: the coefficients add up to zero and they reflect the right comparisons. But now:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(c.hm <span class="sc">*</span> c.mn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
<p>This does <em>not</em> add up to zero, so these two contrasts are not orthogonal, and we can’t do what we just did. R will give us an answer if we try it, but it’ll be the <em>wrong</em> answer.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p>The best description I have seen of what to do here is by David Howell,<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> at <a href="https://www.uvm.edu/~dhowell/StatPages/More_Stuff/R/AnovaOneway.html">link</a> (at the bottom). Let me try to follow his method.</p>
<p>First we need a vector that is all 1’s, which I have called <code>c0</code> below. Since each of our contrasts <code>c.hm</code> and <code>c.mn</code> have 3 things in them (3 groups), we need to add a “dummy” 3rd contrast to give us a <span class="math inline">\(3\times 3\)</span> array of numbers:<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>c0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(c0, c.hm, c.mn)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     c0 c.hm c.mn
[1,]  1    1    0
[2,]  1   -1    1
[3,]  1    0   -1</code></pre>
</div>
</div>
<p>This is what Howell calls an “augmented” matrix of contrasts, since it has our two contrasts as the second and third columns, plus the extra dummy one. Next we invert this matrix of contrasts, which we can do because it’s square. <code>t(m)</code> means “take the matrix transpose of <code>m</code>”, if you’re trying to keep up at the back, and <code>solve</code> finds a matrix inverse:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>minv <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(m))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and then we remove the first column, which represents the contrast that we didn’t want anyway (what Howell calls “deaugmenting”):<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>m.contr <span class="ot">&lt;-</span> minv[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>m.contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           c.hm       c.mn
[1,]  0.6666667  0.3333333
[2,] -0.3333333  0.3333333
[3,] -0.3333333 -0.6666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(caffeine<span class="sc">$</span>amount) <span class="ot">&lt;-</span> m.contr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The columns of <code>m.contr</code> are our new contrasts. Note that they appear to be something else: high vs.&nbsp;the average of moderate and none, and none vs.&nbsp;the average of moderate and high. They are actually <em>not</em> orthogonal, but if Howell is to be trusted,<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> they can be used to test what we want. Now fit the model again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>caff<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> amount, <span class="at">data =</span> caffeine)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(caff<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ amount, data = caffeine)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.833  -6.958  -2.458   6.354  15.167 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   72.278      1.290  56.022   &lt;2e-16 ***
amountc.hm     4.750      3.160   1.503    0.142    
amountc.mn     4.167      3.160   1.318    0.196    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.741 on 33 degrees of freedom
Multiple R-squared:  0.1946,    Adjusted R-squared:  0.1458 
F-statistic: 3.986 on 2 and 33 DF,  p-value: 0.02815</code></pre>
</div>
</div>
<p>The rows <code>amountc.hm</code> and <code>amountc.mn</code> are the proper tests for our contrasts <code>c.hm</code> and <code>c.mn</code>. <code>c.hm</code> is not significant (P-value 0.14) and <code>c.mn</code> is not significant either (P-value 0.20). This is the same significance as from Tukey, but note that the P-values for the non-significant tests are much lower than the corresponding ones from Tukey, once again because we have focused on just these comparisons, and not on any others. We decided ahead of time to test just these, and gave ourselves the best chance of finding significance that we could.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="who-studies-the-most-outside-class-1" class="level2" data-number="31.10">
<h2 data-number="31.10" class="anchored" data-anchor-id="who-studies-the-most-outside-class-1"><span class="header-section-number">31.10</span> Who studies the most outside class?</h2>
<p>A social scientist wanted to see how many hours students studied outside of class. She took a random sample of 75 students from three different majors: math, social science and English, and recorded the number of weekly outside-class study hours for each student. The data can be found at <a href="http://ritsokiguess.site/datafiles/studyhours.txt">link</a>. The social scientist had two research questions: whether math students study more outside of class than the other students, and whether English and social science students study different amounts of time outside class.</p>
<ol type="a">
<li>Explain briefly why contrasts would be a better idea here than ANOVA with Tukey.</li>
</ol>
<p>Solution</p>
<p>The researcher is not interested in all the comparisons between the groups, but rather in two specific ones (as detailed in the question). So we should focus our attention on those comparisons. This is what contrasts are for.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Read in the data and make side-by-side boxplots of study hours by major. What do the boxplots suggest about the comparisons that the researcher wants to make?</li>
</ol>
<p>Solution</p>
<p>Separated by one space. There appear to be some strange quotes in there, but we’ll ignore those and see whether they cause any trouble:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/studyhours.txt"</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>studyhours <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 75 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: " "
chr (1): major
dbl (2): id, hours

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>studyhours</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["major"],"name":[2],"type":["chr"],"align":["left"]},{"label":["hours"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"math","3":"15"},{"1":"2","2":"math","3":"20"},{"1":"3","2":"math","3":"14"},{"1":"4","2":"math","3":"15"},{"1":"5","2":"math","3":"14"},{"1":"6","2":"math","3":"10"},{"1":"7","2":"math","3":"12"},{"1":"8","2":"math","3":"9"},{"1":"9","2":"math","3":"10"},{"1":"10","2":"math","3":"11"},{"1":"11","2":"math","3":"9"},{"1":"12","2":"math","3":"8"},{"1":"13","2":"math","3":"8"},{"1":"14","2":"math","3":"10"},{"1":"15","2":"math","3":"8"},{"1":"16","2":"math","3":"7"},{"1":"17","2":"math","3":"7"},{"1":"18","2":"math","3":"5"},{"1":"19","2":"math","3":"5"},{"1":"20","2":"math","3":"5"},{"1":"21","2":"math","3":"15"},{"1":"22","2":"math","3":"6"},{"1":"23","2":"math","3":"5"},{"1":"24","2":"math","3":"3"},{"1":"25","2":"math","3":"5"},{"1":"26","2":"socsci","3":"10"},{"1":"27","2":"socsci","3":"12"},{"1":"28","2":"socsci","3":"8"},{"1":"29","2":"socsci","3":"7"},{"1":"30","2":"socsci","3":"7"},{"1":"31","2":"socsci","3":"10"},{"1":"32","2":"socsci","3":"6"},{"1":"33","2":"socsci","3":"8"},{"1":"34","2":"socsci","3":"5"},{"1":"35","2":"socsci","3":"4"},{"1":"36","2":"socsci","3":"4"},{"1":"37","2":"socsci","3":"4"},{"1":"38","2":"socsci","3":"8"},{"1":"39","2":"socsci","3":"3"},{"1":"40","2":"socsci","3":"5"},{"1":"41","2":"socsci","3":"7"},{"1":"42","2":"socsci","3":"6"},{"1":"43","2":"socsci","3":"3"},{"1":"44","2":"socsci","3":"3"},{"1":"45","2":"socsci","3":"3"},{"1":"46","2":"socsci","3":"2"},{"1":"47","2":"socsci","3":"2"},{"1":"48","2":"socsci","3":"1"},{"1":"49","2":"socsci","3":"5"},{"1":"50","2":"socsci","3":"4"},{"1":"51","2":"english","3":"14"},{"1":"52","2":"english","3":"12"},{"1":"53","2":"english","3":"12"},{"1":"54","2":"english","3":"10"},{"1":"55","2":"english","3":"10"},{"1":"56","2":"english","3":"10"},{"1":"57","2":"english","3":"8"},{"1":"58","2":"english","3":"8"},{"1":"59","2":"english","3":"5"},{"1":"60","2":"english","3":"7"},{"1":"61","2":"english","3":"6"},{"1":"62","2":"english","3":"4"},{"1":"63","2":"english","3":"6"},{"1":"64","2":"english","3":"5"},{"1":"65","2":"english","3":"5"},{"1":"66","2":"english","3":"4"},{"1":"67","2":"english","3":"8"},{"1":"68","2":"english","3":"9"},{"1":"69","2":"english","3":"10"},{"1":"70","2":"english","3":"4"},{"1":"71","2":"english","3":"3"},{"1":"72","2":"english","3":"3"},{"1":"73","2":"english","3":"3"},{"1":"74","2":"english","3":"6"},{"1":"75","2":"english","3":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>So far so good. 75 students, in tidy format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(studyhours, <span class="fu">aes</span>(<span class="at">x =</span> major, <span class="at">y =</span> hours)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="anova-revisited_files/figure-html/studyhours-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This suggests that the math students study more than the others, but the English and social science students study about the same amount.</p>
<p>I see some rather consistent right-skewness here (but no outliers). We have 25 observations in each group, a decent amount of data, so I’m not too worried, but a transformation could be a good idea, something like square root, perhaps. The spreads are not that unequal, but it <em>is</em> true that the Math students have both the largest median <em>and</em> the largest spread, and the social science students are the lowest on both.</p>
<p>Extra: Box-Cox also works on ANOVA-type data, since that is an <code>lm</code> kind of model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxcox</span>(hours <span class="sc">~</span> major, <span class="at">data =</span> studyhours)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="anova-revisited_files/figure-html/studyhours-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This suggests that some kind of transformation would be a good idea (no transformation, power 1, is not supported by the data). My guess of 0.5 is not bad; that, or something a bit less like 0.25 (fourth root) would be good. Even log is supportable. But we’ll proceed without transformation in this question to give you some practice with contrasts. Despite appearances, I do (sometimes) like to make things not so complicated!</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>Set up contrasts for each of the researcher’s research questions, bearing in mind the levels of <code>major</code> and the order in which they come. (For the <code>Math</code> contrast, you want Math against the average of the other two.)</li>
</ol>
<p>Solution</p>
<p>We need to know what the categories of <code>major</code> are, so that we can set up the contrasts correctly, so let’s start with that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>studyhours <span class="sc">%&gt;%</span> <span class="fu">select</span>(major) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    major          
 Length:75         
 Class :character  
 Mode  :character  </code></pre>
</div>
</div>
<p>Oh. Yeah. We never turned <code>major</code> into a factor. We’d better do that, and then try again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>studyhours <span class="ot">&lt;-</span> studyhours <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">major =</span> <span class="fu">factor</span>(major))</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>studyhours <span class="sc">%&gt;%</span> <span class="fu">select</span>(major) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     major   
 english:25  
 math   :25  
 socsci :25  </code></pre>
</div>
</div>
<p>In alphabetical order.</p>
<p>All right, contrasts. The English vs.&nbsp;social science one is easier, so we’ll do that first. Just set it up with a 1 for one of them and a <span class="math inline">\(-1\)</span> for the other and 0 for math, in the right order according to what the levels are, viz:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>c.eng.socsci <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or <code>c(-1,0,1)</code> would be just as good.</p>
<p>The other one is a bit trickier, because you want math against the average of the others, like <span class="math display">\[\mbox{math}-(\mbox{English}+\mbox{socsci})/2.\]</span> This translates into contrast-ese like this, making sure to get Math in the middle where it belongs:<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>c.math.others <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The coefficients have to add up to zero, so I have to have two halves to balance my one 1. Or I can use two <span class="math inline">\(-1\)</span>s and a 2.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Verify that your two contrasts are orthogonal.</li>
</ol>
<p>Solution</p>
<p>Multiply them together (elementwise, which is how R does it) and show that what you get adds up to zero:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(c.eng.socsci <span class="sc">*</span> c.math.others)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Zero. Orthogonal.</p>
<p>So we are safely in “familiar” territory, not in the here-be-dragons<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> land of non-orthogonal contrasts.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Create a matrix of contrasts (using <code>cbind</code>) and let <code>lm</code> know that these are contrasts for <code>major</code>, in data frame <code>studyhours</code> (or whatever you called it).</li>
</ol>
<p>Solution</p>
<p>So, like the example in lecture (where the <code>contrasts(model)</code> was admittedly rather confusing):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(c.math.others, c.eng.socsci)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     c.math.others c.eng.socsci
[1,]          -0.5            1
[2,]           1.0            0
[3,]          -0.5           -1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(studyhours<span class="sc">$</span>major) <span class="ot">&lt;-</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Fit the model using <code>lm</code>. What do you conclude about your contrasts?</li>
</ol>
<p>Solution</p>
<p>Pretend the ANOVA is a regression (though you can fit ANOVAs either way: we just used <code>aov</code> before because we were going to follow up with Tukey):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>studyhours<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(hours <span class="sc">~</span> major, <span class="at">data =</span> studyhours)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(studyhours<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hours ~ major, data = studyhours)

Residuals:
   Min     1Q Median     3Q    Max 
 -6.44  -2.48  -0.48   2.52  10.56 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          7.3200     0.3980  18.392  &lt; 2e-16 ***
majorc.math.others   2.1200     0.5628   3.767 0.000335 ***
majorc.eng.socsci    0.7800     0.4874   1.600 0.113936    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.447 on 72 degrees of freedom
Multiple R-squared:  0.1887,    Adjusted R-squared:  0.1662 
F-statistic: 8.374 on 2 and 72 DF,  p-value: 0.0005375</code></pre>
</div>
</div>
<p>There is a seriously significant difference between the math students and the others. There is not, however, any kind of difference between the mean study hours of the English and social science students.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Are you surprised by the significance or non-significance you found in the previous part? Explain briefly.</li>
</ol>
<p>Solution</p>
<p>Go back and compare with the boxplots. The math students studied noticeably more than the others, so it is not surprising that this difference came out significant. The median study times for the English and social science students were similar, so it is not at all surprising that this difference failed to be significant.</p>
<p>When you set up contrasts, <em>these</em> are the tests you are interested in, so there is no reason for following up with Tukey or anything else. But you have to be able to say ahead of time which contrasts you want to test. This is in contrast<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> to Tukey, where you don’t have to decide which comparisons interest you until right at the end.</p>
<p>Another question you might have had is “how many contrasts can I do”? To answer this, go back and look at the ANOVA table. If you run an ANOVA using <code>lm</code>, you get the ANOVA table by passing the fitted model object into <code>anova</code> rather than <code>summary</code>:<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(studyhours<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"198.96","3":"99.48","4":"8.373737","5":"0.0005374694","_rn_":"major"},{"1":"72","2":"855.36","3":"11.88","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Two degrees of freedom for <code>major</code>, so we can do 2 contrasts. (The example in class had four models of chainsaw, so 3 df for model, so 3 contrasts possible.) What if we don’t use all those contrasts up? Try it and see:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(c.math.others)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     c.math.others
[1,]          -0.5
[2,]           1.0
[3,]          -0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(studyhours<span class="sc">$</span>major) <span class="ot">&lt;-</span> m</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>studyhours<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(hours <span class="sc">~</span> major, <span class="at">data =</span> studyhours)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(studyhours<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hours ~ major, data = studyhours)

Residuals:
   Min     1Q Median     3Q    Max 
 -6.44  -2.48  -0.48   2.52  10.56 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          7.3200     0.3980  18.392  &lt; 2e-16 ***
majorc.math.others   2.1200     0.5628   3.767 0.000335 ***
major               -1.1031     0.6893  -1.600 0.113936    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.447 on 72 degrees of freedom
Multiple R-squared:  0.1887,    Adjusted R-squared:  0.1662 
F-statistic: 8.374 on 2 and 72 DF,  p-value: 0.0005375</code></pre>
</div>
</div>
<p>The two P-values are identical, but the second one is not now identified with any contrast (so we just ignore it). If we were only interested in how math students compared with the rest, we could test it this way.</p>
<p>Or, we could relabel the students as “math” and “other” and just do a two-sample <span class="math inline">\(t\)</span>-test. To do this, we need to delve into <code>forcats</code> (which is a part of the <code>tidyverse</code>). It deals with categorical variables which are genuine factors, which we haven’t had much cause to do so far. But now we do. What we want to do is to <em>recode</em> the levels of <code>major</code>, which is done by <code>fct_recode</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>studyhoursx <span class="ot">&lt;-</span> studyhours <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mathrest =</span> <span class="fu">fct_recode</span>(major,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rest"</span> <span class="ot">=</span> <span class="st">"english"</span>,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rest"</span> <span class="ot">=</span> <span class="st">"socsci"</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>studyhoursx <span class="sc">%&gt;%</span> <span class="fu">count</span>(mathrest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["mathrest"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"rest","2":"50"},{"1":"math","2":"25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The way <code>fct_recode</code> works is that you first give a factor, here <code>major</code>, then you define a list of new levels in terms of the old ones. We want a student whose major is either English or Social Science to end up in the new not-math group that we’ll call <code>rest</code>, so we need two lines inside <code>fct_recode</code>, one that says that the new <code>rest</code> group includes the old <code>english</code> majors, and another that says that <code>rest</code> also includes the old <code>socsci</code> majors. Any levels not mentioned (here <code>math</code>) are left unchanged.</p>
<p>I did this wrong the first time: I got the things before and after the <code>=</code> in <code>fct_recode</code> the wrong way around.</p>
<p>The last line is to check that the result makes sense. I previously had 25 students in each major. Now I have 25 students for whom <code>mathrest</code> is <code>math</code> (the math majors) and <span class="math inline">\(50=25+25\)</span> students for whom <code>mathrest</code> is <code>rest</code> (everyone else).</p>
<p>Now, the <span class="math inline">\(t\)</span>-test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(hours <span class="sc">~</span> mathrest, <span class="at">data =</span> studyhoursx, <span class="at">var.equal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  hours by mathrest
t = -3.7269, df = 73, p-value = 0.0003796
alternative hypothesis: true difference in means between group rest and group math is not equal to 0
95 percent confidence interval:
 -4.880528 -1.479472
sample estimates:
mean in group rest mean in group math 
              6.26               9.44 </code></pre>
</div>
</div>
<p>This is very close to, but not the same as, the test with the contrasts, because we are not quite testing the same thing. Here, we are comparing the mean of the math students to the mean of everyone else, thrown together into one big bag, but with the contrasts, we are comparing the mean of the math students with the <em>average of the means</em> of the other two groups, treating them as different. (Not clear? Well, it’s not that clear to me either.)</p>
<p>That business with the <code>var.equal=T</code>? This is doing a pooled <span class="math inline">\(t\)</span>-test. I did that here because the ANOVA is assuming equal spreads within the groups (which is what a pooled <span class="math inline">\(t\)</span>-test does) and I thought I should do my best to be consistent. A pooled <span class="math inline">\(t\)</span>-test is really a two-group one-way ANOVA, or at least it is if it is done two-sided.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="mental-context-1" class="level2" data-number="31.11">
<h2 data-number="31.11" class="anchored" data-anchor-id="mental-context-1"><span class="header-section-number">31.11</span> Mental context</h2>
<p>It is believed that being in the same mental context for learning and for testing leads to better test scores. An experiment was carried out to test this. During the learning phase, subjects learned a list of 80 words in a room painted orange and decorated with posters, paintings and other paraphernalia.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> A memory test was given to all subjects immediately after they had learned the words, to give the impression that the experiment was over. (The results of this test were discarded.) One day later, subjects were unexpectedly re-tested under different experimental conditions and asked to write down all the words of the original list that they could remember. The re-test took place in five different conditions, which subjects were randomly allocated to one of:</p>
<ul>
<li><p>Same context: in the original orange-painted room.</p></li>
<li><p>Different context: in a very different room, painted grey and located in a different part of campus.</p></li>
<li><p>Imaginary context: in the grey room, but subjects are asked to remember the orange room in which they took the original test. To help them with this, the experimenter begins by asking them several questions about the orange room and the objects in it.</p></li>
<li><p>Photographed context: in the grey room, but subjects are shown photographs of the orange room.</p></li>
<li><p>Placebo context: in the grey room, with subjects first being asked to recall their living room.</p></li>
</ul>
<p>In each case, the response variable was the number of words on the original list successfully recalled by each subject.</p>
<p>50 subjects in total completed the experiment, 10 under each of the 5 conditions.</p>
<p>The researchers had four research hypotheses to test with the data:</p>
<ul>
<li><p>Groups where the context matches (is the same, or is simulated by imagining or photograph) will perform better than groups with different or placebo contexts.</p></li>
<li><p>The group with the same context will differ from the group with imaginary or photographed contexts.</p></li>
<li><p>The imaginary-context group will differ from the photographed-context group.</p></li>
<li><p>The different-context group will differ from the placebo-context group.</p></li>
</ul>
<p>The research hypotheses are (as is usual) written as <em>alternative</em> hypotheses. We can rewrite them as null hypotheses, with some extra wording to facilitate converting them into contrasts, like this:</p>
<ul>
<li><p>The mean of the <code>same</code>, <code>imaginary</code> and <code>photograph</code> groups (group means) is equal to the mean of the <code>different</code> and <code>placebo</code> groups (group means).</p></li>
<li><p>The mean of the <code>imaginary</code> and <code>photograph</code> groups is equal to the (mean of the) <code>same</code> group.</p></li>
<li><p>The <code>imaginary</code> and the <code>photograph</code> groups will have the same mean.</p></li>
<li><p>The <code>different</code> and the <code>placebo</code> groups will have the same mean.</p></li>
</ul>
<p>The data are in <a href="http://ritsokiguess.site/datafiles/smith.txt">link</a> (the original researcher’s name was Smith).</p>
<ol type="a">
<li>Read in the data and verify that you have a column called <code>context</code> that is text and a column called <code>words</code> that is a (whole) number.</li>
</ol>
<p>Solution</p>
<p>The usual thing — read in the data appropriately and look at the data frame you got:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/smith.txt"</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>smith <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 50 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: " "
chr (1): context
dbl (2): id, words

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>smith</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["context"],"name":[2],"type":["chr"],"align":["left"]},{"label":["words"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"same","3":"25"},{"1":"2","2":"same","3":"26"},{"1":"3","2":"same","3":"17"},{"1":"4","2":"same","3":"15"},{"1":"5","2":"same","3":"14"},{"1":"6","2":"same","3":"17"},{"1":"7","2":"same","3":"14"},{"1":"8","2":"same","3":"20"},{"1":"9","2":"same","3":"11"},{"1":"10","2":"same","3":"21"},{"1":"11","2":"different","3":"11"},{"1":"12","2":"different","3":"21"},{"1":"13","2":"different","3":"9"},{"1":"14","2":"different","3":"6"},{"1":"15","2":"different","3":"7"},{"1":"16","2":"different","3":"14"},{"1":"17","2":"different","3":"12"},{"1":"18","2":"different","3":"4"},{"1":"19","2":"different","3":"7"},{"1":"20","2":"different","3":"19"},{"1":"21","2":"imaginary","3":"14"},{"1":"22","2":"imaginary","3":"15"},{"1":"23","2":"imaginary","3":"29"},{"1":"24","2":"imaginary","3":"10"},{"1":"25","2":"imaginary","3":"12"},{"1":"26","2":"imaginary","3":"22"},{"1":"27","2":"imaginary","3":"14"},{"1":"28","2":"imaginary","3":"24"},{"1":"29","2":"imaginary","3":"22"},{"1":"30","2":"imaginary","3":"12"},{"1":"31","2":"photograph","3":"11"},{"1":"32","2":"photograph","3":"15"},{"1":"33","2":"photograph","3":"23"},{"1":"34","2":"photograph","3":"21"},{"1":"35","2":"photograph","3":"18"},{"1":"36","2":"photograph","3":"24"},{"1":"37","2":"photograph","3":"14"},{"1":"38","2":"photograph","3":"27"},{"1":"39","2":"photograph","3":"12"},{"1":"40","2":"photograph","3":"11"},{"1":"41","2":"placebo","3":"8"},{"1":"42","2":"placebo","3":"20"},{"1":"43","2":"placebo","3":"10"},{"1":"44","2":"placebo","3":"7"},{"1":"45","2":"placebo","3":"15"},{"1":"46","2":"placebo","3":"7"},{"1":"47","2":"placebo","3":"1"},{"1":"48","2":"placebo","3":"17"},{"1":"49","2":"placebo","3":"11"},{"1":"50","2":"placebo","3":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>dbl</code> actually means “decimal number”, but these look like whole numbers, so I think we are good.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Turn <code>context</code> into a <code>factor</code>, within the data frame. (We are going to be doing contrasts). Display how the data frame now looks.</li>
</ol>
<p>Solution</p>
<p>Use <code>mutate</code> and assign everything back to what it was before:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>smith <span class="ot">&lt;-</span> smith <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">context =</span> <span class="fu">factor</span>(context))</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>smith</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["context"],"name":[2],"type":["fct"],"align":["left"]},{"label":["words"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"same","3":"25"},{"1":"2","2":"same","3":"26"},{"1":"3","2":"same","3":"17"},{"1":"4","2":"same","3":"15"},{"1":"5","2":"same","3":"14"},{"1":"6","2":"same","3":"17"},{"1":"7","2":"same","3":"14"},{"1":"8","2":"same","3":"20"},{"1":"9","2":"same","3":"11"},{"1":"10","2":"same","3":"21"},{"1":"11","2":"different","3":"11"},{"1":"12","2":"different","3":"21"},{"1":"13","2":"different","3":"9"},{"1":"14","2":"different","3":"6"},{"1":"15","2":"different","3":"7"},{"1":"16","2":"different","3":"14"},{"1":"17","2":"different","3":"12"},{"1":"18","2":"different","3":"4"},{"1":"19","2":"different","3":"7"},{"1":"20","2":"different","3":"19"},{"1":"21","2":"imaginary","3":"14"},{"1":"22","2":"imaginary","3":"15"},{"1":"23","2":"imaginary","3":"29"},{"1":"24","2":"imaginary","3":"10"},{"1":"25","2":"imaginary","3":"12"},{"1":"26","2":"imaginary","3":"22"},{"1":"27","2":"imaginary","3":"14"},{"1":"28","2":"imaginary","3":"24"},{"1":"29","2":"imaginary","3":"22"},{"1":"30","2":"imaginary","3":"12"},{"1":"31","2":"photograph","3":"11"},{"1":"32","2":"photograph","3":"15"},{"1":"33","2":"photograph","3":"23"},{"1":"34","2":"photograph","3":"21"},{"1":"35","2":"photograph","3":"18"},{"1":"36","2":"photograph","3":"24"},{"1":"37","2":"photograph","3":"14"},{"1":"38","2":"photograph","3":"27"},{"1":"39","2":"photograph","3":"12"},{"1":"40","2":"photograph","3":"11"},{"1":"41","2":"placebo","3":"8"},{"1":"42","2":"placebo","3":"20"},{"1":"43","2":"placebo","3":"10"},{"1":"44","2":"placebo","3":"7"},{"1":"45","2":"placebo","3":"15"},{"1":"46","2":"placebo","3":"7"},{"1":"47","2":"placebo","3":"1"},{"1":"48","2":"placebo","3":"17"},{"1":"49","2":"placebo","3":"11"},{"1":"50","2":"placebo","3":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Note that <code>context</code> is now labelled as the factor that we made.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>What are the names of the five contexts in the data set (just display them), and what order are they in?</li>
</ol>
<p>Solution</p>
<p>You have lots of choices now, since <code>context</code> is a factor (and can also be treated as text). The most obvious factor-based way is this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(smith<span class="sc">$</span>context)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "different"  "imaginary"  "photograph" "placebo"    "same"      </code></pre>
</div>
</div>
<p>or use <code>summary</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>smith <span class="sc">%&gt;%</span> <span class="fu">select</span>(context) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       context  
 different :10  
 imaginary :10  
 photograph:10  
 placebo   :10  
 same      :10  </code></pre>
</div>
</div>
<p>Or treat <code>context</code> as text, such as this way:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>smith <span class="sc">%&gt;%</span> <span class="fu">count</span>(context)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["context"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"different","2":"10"},{"1":"imaginary","2":"10"},{"1":"photograph","2":"10"},{"1":"placebo","2":"10"},{"1":"same","2":"10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>These all display the contexts in alphabetical order.</p>
<p>Or display the distinct values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>smith <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(context)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["context"],"name":[1],"type":["fct"],"align":["left"]}],"data":[{"1":"same"},{"1":"different"},{"1":"imaginary"},{"1":"photograph"},{"1":"placebo"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>or, without using the <code>tidyverse</code>,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(smith<span class="sc">$</span>context)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] same       different  imaginary  photograph placebo   
Levels: different imaginary photograph placebo same</code></pre>
</div>
</div>
<p>These two <em>don’t</em> display things in alphabetical order, because they display things as they appear in the file. This is not the order we want, though the second way <em>does</em> display the <code>Levels</code> in the right order.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li>Write each of the four research hypotheses (in the null-hypothesis versions) as R vectors that can be used to make contrasts. (This will mean getting the contexts in the right order. If you get stuck, do the last two first, since they’re easiest. The first one is actually the hardest.)</li>
</ol>
<p>Solution</p>
<p>All right, let’s go from the bottom:</p>
<ul>
<li>Different and placebo have same means. These are 1st and 4th.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>c4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Imaginary and photograph have same means. 2nd and 3rd:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>c3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Imaginary and photograph together same as <code>same</code>. This time we have two means being compared with one, so we need to give the two means half weight. 2nd and 3rd against 5th:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>(Same and imaginary and photograph) vs.&nbsp;(different or placebo): 2nd, 3rd and 5th with weight <span class="math inline">\(1/3\)</span> (three of them) against 1st and 4th with weight <span class="math inline">\(1/2\)</span> (2 of them):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">1</span> <span class="sc">/</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Variations: you can switch the sign on everything within a contrast (since it doesn’t matter which is plus and which is minus). You can also multiply through by anything to get rid of the fractions, for example these:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All that matters is that the coefficients add up to zero, and that they are the right size and sign relative to each other.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>Pick two of your contrasts (doesn’t matter which two) and demonstrate that they are orthogonal.</li>
</ol>
<p>Solution</p>
<p>Multiply your chosen contrasts together elementwise, and show that the results add to zero, eg. by showing the whole thing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>c1 <span class="sc">*</span> c2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.0000000  0.1666667  0.1666667  0.0000000 -0.3333333</code></pre>
</div>
</div>
<p>which adds to zero because it is <span class="math inline">\(2/6\)</span> minus <span class="math inline">\(1/3\)</span>, or by explicitly summing the elementwise product:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(c1 <span class="sc">*</span> c3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Any pair is good.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Collect your contrasts together into a matrix, and tell <code>lm</code> that these are the contrasts for <code>context</code>.</li>
</ol>
<p>Solution</p>
<p>This:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(c1, c2, c3, c4)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(smith<span class="sc">$</span>context) <span class="ot">&lt;-</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Slipping off into another aside, you might have been wondering whether there was a way to test <em>all</em> the contrasts for orthogonality at once. There is, and it depends on the rules for matrix multiplication. We want to test all the <em>columns</em> of <code>m</code> for orthogonality, but matrix multiplication works by combining a <em>row</em> with a column. No matter, <em>transposing</em> a matrix interchanges rows and columns, so that in math, we want to look at the matrix <span class="math inline">\(M^T M\)</span>. In R, <code>%*%</code> means “matrix multiply”.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> Thus,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(m) <span class="sc">%*%</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          c1  c2 c3 c4
c1 0.8333333 0.0  0  0
c2 0.0000000 1.5  0  0
c3 0.0000000 0.0  2  0
c4 0.0000000 0.0  0  2</code></pre>
</div>
</div>
<p>This matrix-multiplies the transpose of <code>m</code> by <code>m</code> itself. There are numbers down the top-left to bottom-right diagonal, but don’t worry about these, since a contrast doesn’t have to be orthogonal with itself. The thing to note is that <em>all the other elements</em> of this matrix are <em>zero</em>: that means that each of the four contrasts is orthogonal to each of the other three.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Fit a model with <code>lm</code>, and display the results.</li>
</ol>
<p>Solution</p>
<p>We’re past the hard part:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>smith<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(words <span class="sc">~</span> context, <span class="at">data =</span> smith)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(smith<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = words ~ context, data = smith)

Residuals:
   Min     1Q Median     3Q    Max 
  -9.0   -4.0   -1.5    4.6   11.6 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  14.8000     0.8129  18.207  &lt; 2e-16 ***
contextc1     8.6000     1.9912   4.319 8.52e-05 ***
contextc2    -0.3333     1.4841  -0.225    0.823    
contextc3    -0.1000     1.2853  -0.078    0.938    
contextc4     0.5000     1.2853   0.389    0.699    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.748 on 45 degrees of freedom
Multiple R-squared:  0.2954,    Adjusted R-squared:  0.2327 
F-statistic: 4.715 on 4 and 45 DF,  p-value: 0.002902</code></pre>
</div>
</div>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" type="a">
<li>For each of the original research hypotheses, what do you infer about them?</li>
</ol>
<p>Solution</p>
<p>Even though I generated the contrasts backwards, I maintained the numbering so that they refer to the original numbered hypotheses. You might have named them something more mnemonic; that works too, and is quite possibly better. Anyway:</p>
<ul>
<li><p>Matching context better than non-matching context: strongly significant (P-value 0.000085). (Strictly, this is a two-sided test, but the way I constructed the contrast, this should be significantly <em>positive</em> if the research hypothesis is true, and it is.)</p></li>
<li><p>Same context <em>not</em> different from imaginary/photographed context (P-value 0.823)</p></li>
<li><p>Imaginary context <em>not</em> different from photographed context (P-value 0.938).</p></li>
<li><p>Different context <em>not</em> different from placebo context (P-value 0.699).</p></li>
</ul>
<p>I wanted you to match up the research hypotheses with the P-values, as above, and state a conclusion about each one. If you do that, I am happy.</p>
<p>Taking this back to the original research, I think the first hypothesis was the most immediately important of the four: we were able to show that having (or faking up) the original room helped with recall. After that, it didn’t matter how it was done: being in the original room was not different from imagining the original room (by thinking about it or seeing a photo of it). Failing to recall the original room was equally bad, whether the subjects were in a different room and not asked to think about the original orange room, or whether they were literally asked to think about another room entirely.</p>
<p>Contrasts enabled us to tackle this problem and gain a very clear conclusion: recalling the original orange room is helpful, but it doesn’t matter how you do it.</p>
<p>How big of a difference does thinking about the orange room make? You can use the 2 SE thing to get a 95% confidence interval: the difference in the (mean of the) recall-orange-room means and the (mean of the) don’t-recall means is between about 4.6 and 12.6 words (out of 80). I leave it for you to decide whether that is practically important as well as being statistically significant.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
</section>
<section id="trying-on-shirts-1" class="level2" data-number="31.12">
<h2 data-number="31.12" class="anchored" data-anchor-id="trying-on-shirts-1"><span class="header-section-number">31.12</span> Trying on shirts</h2>
<p>Does it make a difference if you see somebody else trying on a shirt before you do, and if so, does it matter what kind of person it is?</p>
<p>An experiment was carried out in a university bookstore, with students who wanted to try on a shirt serving as (unsuspecting) experimental subjects. When a student wanted to try on a shirt, the sales associate told them that there was only one shirt left, and it was being tried on by an “other customer”. This “other customer” was actually a “confederate” of the experimenter (that means, they were pretending to be a real customer but were actually part of the experiment). The “other customer” was always female: either an attractive well-dressed model, or an average-looking student wearing jeans. The “other customer” would come out of the dressing room and hand the shirt to the sales associate, who would give it to the student who wanted to try it on. When the student had tried on the shirt, they were asked to rate it on a 7-point scale (on five different dimensions, and those five scores were then averaged). Does a student’s evaluation depend on whether the student was male or female, and whether the “other customer” was a model or a student? There was also a control group, where the student was handed the shirt directly by the sales associate, without the “other customer” being involved at all.</p>
<p>There were thus five treatments: male students who saw a model, male students who saw a student, female students who saw a model, female students who saw a student, and the control group. There were 25 students in each treatment group.</p>
<p>The data from this experiment can be found at <a href="http://ritsokiguess.site/datafiles/shirts.csv">link</a>.</p>
<ol type="a">
<li>Read in and display the data. How many observations do you have, and is that what you should have?</li>
</ol>
<p>Solution</p>
<p><code>read_csv</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/shirts.csv"</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>shirts <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 125 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): treatment
dbl (1): score

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>shirts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["treatment"],"name":[1],"type":["chr"],"align":["left"]},{"label":["score"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"male_seeing_model","2":"6.8"},{"1":"male_seeing_model","2":"4.7"},{"1":"male_seeing_model","2":"5.1"},{"1":"male_seeing_model","2":"4.7"},{"1":"male_seeing_model","2":"5.5"},{"1":"male_seeing_model","2":"6.0"},{"1":"male_seeing_model","2":"4.4"},{"1":"male_seeing_model","2":"6.0"},{"1":"male_seeing_model","2":"5.3"},{"1":"male_seeing_model","2":"6.3"},{"1":"male_seeing_model","2":"3.9"},{"1":"male_seeing_model","2":"4.3"},{"1":"male_seeing_model","2":"6.4"},{"1":"male_seeing_model","2":"6.1"},{"1":"male_seeing_model","2":"4.7"},{"1":"male_seeing_model","2":"5.4"},{"1":"male_seeing_model","2":"6.7"},{"1":"male_seeing_model","2":"5.2"},{"1":"male_seeing_model","2":"5.6"},{"1":"male_seeing_model","2":"3.8"},{"1":"male_seeing_model","2":"6.3"},{"1":"male_seeing_model","2":"5.8"},{"1":"male_seeing_model","2":"6.2"},{"1":"male_seeing_model","2":"4.6"},{"1":"male_seeing_model","2":"5.6"},{"1":"male_seeing_student","2":"4.2"},{"1":"male_seeing_student","2":"4.1"},{"1":"male_seeing_student","2":"3.4"},{"1":"male_seeing_student","2":"3.1"},{"1":"male_seeing_student","2":"1.9"},{"1":"male_seeing_student","2":"3.3"},{"1":"male_seeing_student","2":"2.5"},{"1":"male_seeing_student","2":"5.0"},{"1":"male_seeing_student","2":"2.3"},{"1":"male_seeing_student","2":"4.9"},{"1":"male_seeing_student","2":"5.1"},{"1":"male_seeing_student","2":"4.8"},{"1":"male_seeing_student","2":"5.1"},{"1":"male_seeing_student","2":"2.6"},{"1":"male_seeing_student","2":"3.8"},{"1":"male_seeing_student","2":"3.1"},{"1":"male_seeing_student","2":"2.5"},{"1":"male_seeing_student","2":"0.7"},{"1":"male_seeing_student","2":"1.9"},{"1":"male_seeing_student","2":"3.9"},{"1":"male_seeing_student","2":"2.1"},{"1":"male_seeing_student","2":"3.2"},{"1":"male_seeing_student","2":"3.6"},{"1":"male_seeing_student","2":"0.8"},{"1":"male_seeing_student","2":"3.4"},{"1":"female_seeing_model","2":"4.9"},{"1":"female_seeing_model","2":"3.0"},{"1":"female_seeing_model","2":"3.7"},{"1":"female_seeing_model","2":"3.7"},{"1":"female_seeing_model","2":"4.1"},{"1":"female_seeing_model","2":"3.3"},{"1":"female_seeing_model","2":"4.0"},{"1":"female_seeing_model","2":"4.4"},{"1":"female_seeing_model","2":"4.2"},{"1":"female_seeing_model","2":"0.9"},{"1":"female_seeing_model","2":"3.7"},{"1":"female_seeing_model","2":"4.2"},{"1":"female_seeing_model","2":"5.1"},{"1":"female_seeing_model","2":"4.1"},{"1":"female_seeing_model","2":"3.8"},{"1":"female_seeing_model","2":"1.9"},{"1":"female_seeing_model","2":"7.6"},{"1":"female_seeing_model","2":"4.8"},{"1":"female_seeing_model","2":"3.3"},{"1":"female_seeing_model","2":"5.7"},{"1":"female_seeing_model","2":"3.5"},{"1":"female_seeing_model","2":"4.6"},{"1":"female_seeing_model","2":"4.6"},{"1":"female_seeing_model","2":"4.9"},{"1":"female_seeing_model","2":"3.7"},{"1":"female_seeing_student","2":"5.7"},{"1":"female_seeing_student","2":"1.4"},{"1":"female_seeing_student","2":"3.2"},{"1":"female_seeing_student","2":"3.3"},{"1":"female_seeing_student","2":"4.2"},{"1":"female_seeing_student","2":"6.5"},{"1":"female_seeing_student","2":"2.3"},{"1":"female_seeing_student","2":"6.6"},{"1":"female_seeing_student","2":"4.2"},{"1":"female_seeing_student","2":"2.6"},{"1":"female_seeing_student","2":"4.7"},{"1":"female_seeing_student","2":"2.6"},{"1":"female_seeing_student","2":"1.8"},{"1":"female_seeing_student","2":"2.6"},{"1":"female_seeing_student","2":"4.4"},{"1":"female_seeing_student","2":"0.9"},{"1":"female_seeing_student","2":"-0.5"},{"1":"female_seeing_student","2":"2.4"},{"1":"female_seeing_student","2":"4.3"},{"1":"female_seeing_student","2":"7.0"},{"1":"female_seeing_student","2":"4.2"},{"1":"female_seeing_student","2":"1.1"},{"1":"female_seeing_student","2":"2.9"},{"1":"female_seeing_student","2":"3.9"},{"1":"female_seeing_student","2":"1.7"},{"1":"control","2":"1.1"},{"1":"control","2":"3.3"},{"1":"control","2":"5.1"},{"1":"control","2":"4.3"},{"1":"control","2":"4.3"},{"1":"control","2":"5.7"},{"1":"control","2":"4.9"},{"1":"control","2":"5.0"},{"1":"control","2":"3.8"},{"1":"control","2":"5.9"},{"1":"control","2":"3.5"},{"1":"control","2":"6.5"},{"1":"control","2":"3.6"},{"1":"control","2":"3.6"},{"1":"control","2":"1.0"},{"1":"control","2":"5.1"},{"1":"control","2":"3.7"},{"1":"control","2":"4.6"},{"1":"control","2":"5.1"},{"1":"control","2":"4.3"},{"1":"control","2":"3.0"},{"1":"control","2":"3.1"},{"1":"control","2":"2.3"},{"1":"control","2":"1.9"},{"1":"control","2":"6.1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>There were 5 treatment groups with 25 students in each, so there should be, and are, <span class="math inline">\(5 \times 25=125\)</span> observations.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="2" type="a">
<li>Turn <code>treatment</code> into a <code>factor</code> in your data frame. (You can use the same name as the text <code>treatment</code> that you read in from the file.)</li>
</ol>
<p>Solution</p>
<p>Thus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>shirts <span class="ot">&lt;-</span> shirts <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">factor</span>(treatment))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and for checking:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>shirts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["treatment"],"name":[1],"type":["fct"],"align":["left"]},{"label":["score"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"male_seeing_model","2":"6.8"},{"1":"male_seeing_model","2":"4.7"},{"1":"male_seeing_model","2":"5.1"},{"1":"male_seeing_model","2":"4.7"},{"1":"male_seeing_model","2":"5.5"},{"1":"male_seeing_model","2":"6.0"},{"1":"male_seeing_model","2":"4.4"},{"1":"male_seeing_model","2":"6.0"},{"1":"male_seeing_model","2":"5.3"},{"1":"male_seeing_model","2":"6.3"},{"1":"male_seeing_model","2":"3.9"},{"1":"male_seeing_model","2":"4.3"},{"1":"male_seeing_model","2":"6.4"},{"1":"male_seeing_model","2":"6.1"},{"1":"male_seeing_model","2":"4.7"},{"1":"male_seeing_model","2":"5.4"},{"1":"male_seeing_model","2":"6.7"},{"1":"male_seeing_model","2":"5.2"},{"1":"male_seeing_model","2":"5.6"},{"1":"male_seeing_model","2":"3.8"},{"1":"male_seeing_model","2":"6.3"},{"1":"male_seeing_model","2":"5.8"},{"1":"male_seeing_model","2":"6.2"},{"1":"male_seeing_model","2":"4.6"},{"1":"male_seeing_model","2":"5.6"},{"1":"male_seeing_student","2":"4.2"},{"1":"male_seeing_student","2":"4.1"},{"1":"male_seeing_student","2":"3.4"},{"1":"male_seeing_student","2":"3.1"},{"1":"male_seeing_student","2":"1.9"},{"1":"male_seeing_student","2":"3.3"},{"1":"male_seeing_student","2":"2.5"},{"1":"male_seeing_student","2":"5.0"},{"1":"male_seeing_student","2":"2.3"},{"1":"male_seeing_student","2":"4.9"},{"1":"male_seeing_student","2":"5.1"},{"1":"male_seeing_student","2":"4.8"},{"1":"male_seeing_student","2":"5.1"},{"1":"male_seeing_student","2":"2.6"},{"1":"male_seeing_student","2":"3.8"},{"1":"male_seeing_student","2":"3.1"},{"1":"male_seeing_student","2":"2.5"},{"1":"male_seeing_student","2":"0.7"},{"1":"male_seeing_student","2":"1.9"},{"1":"male_seeing_student","2":"3.9"},{"1":"male_seeing_student","2":"2.1"},{"1":"male_seeing_student","2":"3.2"},{"1":"male_seeing_student","2":"3.6"},{"1":"male_seeing_student","2":"0.8"},{"1":"male_seeing_student","2":"3.4"},{"1":"female_seeing_model","2":"4.9"},{"1":"female_seeing_model","2":"3.0"},{"1":"female_seeing_model","2":"3.7"},{"1":"female_seeing_model","2":"3.7"},{"1":"female_seeing_model","2":"4.1"},{"1":"female_seeing_model","2":"3.3"},{"1":"female_seeing_model","2":"4.0"},{"1":"female_seeing_model","2":"4.4"},{"1":"female_seeing_model","2":"4.2"},{"1":"female_seeing_model","2":"0.9"},{"1":"female_seeing_model","2":"3.7"},{"1":"female_seeing_model","2":"4.2"},{"1":"female_seeing_model","2":"5.1"},{"1":"female_seeing_model","2":"4.1"},{"1":"female_seeing_model","2":"3.8"},{"1":"female_seeing_model","2":"1.9"},{"1":"female_seeing_model","2":"7.6"},{"1":"female_seeing_model","2":"4.8"},{"1":"female_seeing_model","2":"3.3"},{"1":"female_seeing_model","2":"5.7"},{"1":"female_seeing_model","2":"3.5"},{"1":"female_seeing_model","2":"4.6"},{"1":"female_seeing_model","2":"4.6"},{"1":"female_seeing_model","2":"4.9"},{"1":"female_seeing_model","2":"3.7"},{"1":"female_seeing_student","2":"5.7"},{"1":"female_seeing_student","2":"1.4"},{"1":"female_seeing_student","2":"3.2"},{"1":"female_seeing_student","2":"3.3"},{"1":"female_seeing_student","2":"4.2"},{"1":"female_seeing_student","2":"6.5"},{"1":"female_seeing_student","2":"2.3"},{"1":"female_seeing_student","2":"6.6"},{"1":"female_seeing_student","2":"4.2"},{"1":"female_seeing_student","2":"2.6"},{"1":"female_seeing_student","2":"4.7"},{"1":"female_seeing_student","2":"2.6"},{"1":"female_seeing_student","2":"1.8"},{"1":"female_seeing_student","2":"2.6"},{"1":"female_seeing_student","2":"4.4"},{"1":"female_seeing_student","2":"0.9"},{"1":"female_seeing_student","2":"-0.5"},{"1":"female_seeing_student","2":"2.4"},{"1":"female_seeing_student","2":"4.3"},{"1":"female_seeing_student","2":"7.0"},{"1":"female_seeing_student","2":"4.2"},{"1":"female_seeing_student","2":"1.1"},{"1":"female_seeing_student","2":"2.9"},{"1":"female_seeing_student","2":"3.9"},{"1":"female_seeing_student","2":"1.7"},{"1":"control","2":"1.1"},{"1":"control","2":"3.3"},{"1":"control","2":"5.1"},{"1":"control","2":"4.3"},{"1":"control","2":"4.3"},{"1":"control","2":"5.7"},{"1":"control","2":"4.9"},{"1":"control","2":"5.0"},{"1":"control","2":"3.8"},{"1":"control","2":"5.9"},{"1":"control","2":"3.5"},{"1":"control","2":"6.5"},{"1":"control","2":"3.6"},{"1":"control","2":"3.6"},{"1":"control","2":"1.0"},{"1":"control","2":"5.1"},{"1":"control","2":"3.7"},{"1":"control","2":"4.6"},{"1":"control","2":"5.1"},{"1":"control","2":"4.3"},{"1":"control","2":"3.0"},{"1":"control","2":"3.1"},{"1":"control","2":"2.3"},{"1":"control","2":"1.9"},{"1":"control","2":"6.1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>see that <code>treatment</code> is now definitely a factor rather than a categorical variable represented as a piece of text.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="3" type="a">
<li>List the treatments in the order that they are in within your <code>factor</code>. (There are lots of ways to do this; any one of them except for <code>distinct</code> is good.)</li>
</ol>
<p>Solution</p>
<p>This is the most direct:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(shirts<span class="sc">$</span>treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "control"               "female_seeing_model"   "female_seeing_student"
[4] "male_seeing_model"     "male_seeing_student"  </code></pre>
</div>
</div>
<p>or you can do one of the <code>tidyverse</code>-style ways, such as</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>shirts <span class="sc">%&gt;%</span> <span class="fu">count</span>(treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["treatment"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"control","2":"25"},{"1":"female_seeing_model","2":"25"},{"1":"female_seeing_student","2":"25"},{"1":"male_seeing_model","2":"25"},{"1":"male_seeing_student","2":"25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>shirts <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["treatment"],"name":[1],"type":["fct"],"align":["left"]}],"data":[{"1":"male_seeing_model"},{"1":"male_seeing_student"},{"1":"female_seeing_model"},{"1":"female_seeing_student"},{"1":"control"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>except that <code>distinct</code> shows you the values in the order that they appear in the data file, which is <em>not</em> the order that they appear in the factor. So that’s why I asked you not to do it that way.</p>
<p>Alphabetical order, is the moral of the story.</p>
<p>Extra: you can make them appear in the order they appear in the data, if you want to (and if you know what you are doing):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>shirts <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">trt2 =</span> <span class="fu">fct_inorder</span>(treatment)) <span class="ot">-&gt;</span> d</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(d<span class="sc">$</span>trt2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "male_seeing_model"     "male_seeing_student"   "female_seeing_model"  
[4] "female_seeing_student" "control"              </code></pre>
</div>
</div>
<p><code>fct_inorder</code> <em>creates</em> a factor whose levels are in the order that they appeared in the data. If this is what you want, you can go ahead and do this, and use this order when you create your contrasts. It will work, and it will be good even though your contrasts will look different from mine.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="4" type="a">
<li><a name="part:mean-eval">*</a> Obtain a table of mean evaluation scores for each treatment group.</li>
</ol>
<p>Solution</p>
<p>We will use this later when assessing the significance of the contrasts. It’s the usual group-by and summarize:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>shirts <span class="sc">%&gt;%</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">m =</span> <span class="fu">mean</span>(score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["treatment"],"name":[1],"type":["fct"],"align":["left"]},{"label":["m"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"control","2":"4.032"},{"1":"female_seeing_model","2":"4.068"},{"1":"female_seeing_student","2":"3.360"},{"1":"male_seeing_model","2":"5.416"},{"1":"male_seeing_student","2":"3.252"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Extra: how does this come out if you have your factor levels in a non-alphabetical order?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(trt2) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">m =</span> <span class="fu">mean</span>(score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["trt2"],"name":[1],"type":["fct"],"align":["left"]},{"label":["m"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"male_seeing_model","2":"5.416"},{"1":"male_seeing_student","2":"3.252"},{"1":"female_seeing_model","2":"4.068"},{"1":"female_seeing_student","2":"3.360"},{"1":"control","2":"4.032"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Ah, it respects the order of the levels of the factor: that is to say, the treatment groups appear here in the order that they were in the data, because the factor <code>trt2</code> was created to make that happen.</p>
<p><code>forcats</code> has other tools to re-order the levels of a factor, lump factor levels together to make a category “other”, and so on. These also work if you start with a categorical variable as text: it <em>creates</em> a factor with those properties.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="5" type="a">
<li>The experimenters wanted to compare four specific things in their analysis:</li>
</ol>
<ul>
<li><p>evaluation scores between male students who saw a (female) model and male students who saw a (female) student</p></li>
<li><p>evaluation scores between female students who saw a (female) model and female students who saw a (female) student</p></li>
<li><p>evaluation scores for male and for female students (overall)</p></li>
<li><p>evaluation scores for the (average of the) four genuine treatments and for the control group</p></li>
</ul>
<p>Create contrasts, with suitable names, using vectors with appropriate values.</p>
<p>Solution</p>
<p>These, in that order, are comparisons of treatments 4 and 5:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>c_mms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>treatments 2 and 3:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>c_fms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(in these two the 1 and <span class="math inline">\(-1\)</span> can also be the other way around)</p>
<p>the average of 2 and 3 vs.&nbsp;the average of 4 and 5:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>c_mf <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or you can use 1 and <span class="math inline">\(-1\)</span> instead of the 0.5s, or you can switch the signs around. I like the 0.5 values to remind me it’s an average of two means.</p>
<p>Finally</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>c_tc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.25</span>, <span class="sc">-</span><span class="fl">0.25</span>, <span class="sc">-</span><span class="fl">0.25</span>, <span class="sc">-</span><span class="fl">0.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or multiply through by 4 to get rid of the fractions, or have the negative sign on the first one and positive signs on the others.</p>
<p>I tried to give the contrasts mnemonic but short names, so that I would remember which was which.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="6" type="a">
<li>Pick two of your contrasts (doesn’t matter which two) and demonstrate that they are orthogonal.</li>
</ol>
<p>Solution</p>
<p>Multiply them together (elementwise, which is what <code>*</code> does) and add them up, showing that you get zero, for example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(c_mf <span class="sc">*</span> c_tc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Check (mops brow).</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="7" type="a">
<li>Collect all your contrasts together into a matrix and declare that they are contrasts for <code>treatment</code> within your data frame (whatever you called it).</li>
</ol>
<p>Solution</p>
<p>I called my data frame <code>shirts</code>, so I need to do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(c_mms, c_fms, c_mf, c_tc)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(shirts<span class="sc">$</span>treatment) <span class="ot">&lt;-</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There’s no output here; we’ll see in a moment whether it worked.</p>
<p>Extra: once you’ve created the matrix <code>m</code>, it gives you a second way to test the contrasts for orthogonality, all at once:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(m) <span class="sc">%*%</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      c_mms c_fms c_mf c_tc
c_mms     2     0    0 0.00
c_fms     0     2    0 0.00
c_mf      0     0    1 0.00
c_tc      0     0    0 1.25</code></pre>
</div>
</div>
<p>This matrix-multiplies the transpose of <code>m</code> by <code>m</code>, so it’s testing each column of <code>m</code> to see whether it’s orthogonal to each other column. The columns don’t have to be orthogonal to themselves, hence the non-zeros down the diagonal, but all the off-diagonal entries are zero. Hence each contrast is orthogonal to each other contrast.</p>
<p>Or even:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">t</span>(m) <span class="sc">%*%</span> m</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(z[<span class="fu">row</span>(z) <span class="sc">!=</span> <span class="fu">col</span>(z)] <span class="sc">==</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>That says (a little breathlessly) that it is true that all the elements of <span class="math inline">\(M^TM\)</span> that are off the diagonal are zero.<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a></p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol start="8" type="a">
<li>Predict evaluation score from treatment <em>as a regression</em>, and display the results.</li>
</ol>
<p>Solution</p>
<p>Once you have everything set up, it’s just a matter of going through the process:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>score<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(score <span class="sc">~</span> treatment, <span class="at">data =</span> shirts)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(score<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = score ~ treatment, data = shirts)

Residuals:
   Min     1Q Median     3Q    Max 
-3.860 -0.760  0.032  0.840  3.640 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      4.0256     0.1231  32.705  &lt; 2e-16 ***
treatmentc_mms   1.0820     0.1946   5.560 1.66e-07 ***
treatmentc_fms   0.3540     0.1946   1.819   0.0714 .  
treatmentc_mf   -0.6200     0.2752  -2.253   0.0261 *  
treatmentc_tc    0.0064     0.2462   0.026   0.9793    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.376 on 120 degrees of freedom
Multiple R-squared:  0.2467,    Adjusted R-squared:  0.2216 
F-statistic: 9.823 on 4 and 120 DF,  p-value: 6.576e-07</code></pre>
</div>
</div>
<p>Note how the contrasts have appeared as “slopes” in our regression. (If this didn’t happen for you, go back and check what you did. Probably something gave you an error before, in that case.)</p>
<p>Your slopes can differ in terms of sign and possibly value from mine, but the <span class="math inline">\(t\)</span>-statistics and P-values should be the same as mine.</p>
<p><span class="math inline">\(\blacksquare\)</span></p>
<ol type="i">
<li>For each of your contrasts, assess whether or not it is significant, and explain briefly what that means in the context of the data. If a contrast is significant, use your answer to part (<a href="#part:mean-eval">here</a>) to help in your interpretation.</li>
</ol>
<p>Solution</p>
<p>I’ll take my four contrasts as they appear in the output from <code>lm</code>:</p>
<ul>
<li><p>Comparing the male students who saw the model with those who saw the student: this is strongly significant, and the table of means shows that the males who saw the model rated the shirt significantly <em>higher</em> than those who saw the “average-looking” female student.</p></li>
<li><p>Comparing the female students who saw the model with those who saw the student: this difference is not quite significant, so we conclude that it didn’t matter who the female students saw coming out of the dressing room.</p></li>
<li><p>There is a significant difference between the average evaluation score that males gave to the shirt and that females did. The table of means reveals that the male average was higher, mostly because males <em>really</em> liked the shirt when they thought the model had been wearing it!</p></li>
<li><p>There is no significant difference overall between treatment and control groups in terms of average score. (This is mostly because the treatment groups differ among themselves, with the scores for students who saw the model being higher and those for students who saw the female student being lower than for the control group.)</p></li>
</ul>
<p>It is enough, on the non-significant ones, to say what it is that the contrast is testing, and then to note that it is not significant. On the significant ones, I want you to say what is higher than what. You can also get these conclusions from the <code>lm</code> output, but it requires a bit more care:</p>
<ul>
<li><p>I set up <code>c_mms</code> with the score for the students who had seen the model as plus and those who saw the student as minus. My slope here is positive, so the score for male students who saw the model is higher.</p></li>
<li><p>My slope for <code>c_fms</code> is also positive, and I set this one up the same way with model as positive and student as negative, so the female students rated the shirt higher (but not significantly higher) when they saw the model.</p></li>
<li><p>My <code>c_mf</code> slope is significantly negative. I set up this contrast with females as plus and males as minus, so this means males gave a significantly <em>higher</em> score on average (for reasons discussed above).</p></li>
<li><p>The last slope is very close to 0, consistent with there being no difference (on average) between treatment and control.</p></li>
</ul>
<p>Perhaps the story to get from this analysis is that male students are <em>such</em> suckers!</p>
<p><span class="math inline">\(\blacksquare\)</span></p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>This is a fancy word for <em>stuff</em>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>It’s important to be clear about the distinction between a categorical variable, that lives in a data frame column, and its levels, the values that appear in the column. This is especially important if you’re trying to decide whether a data frame is tidy, since typically an untidy data frame will have factor levels as column names rather than the factor itself, and you need to be able to tell the difference.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Software like SAS, for example, has a way of making non-orthogonal contrasts orthogonal in a way that the user doesn’t have to worry about, but in R, you are closer to the ground, so to speak, and you have to make it happen yourself.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Howell is the author of a famous text on Statistics in Psychology.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Which we are going to invert, as a matrix. But I get ahead of myself.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>We are working with R matrices here rather than data frames, so we access elements, rows and columns using the square bracket notation: inside the square brackets, we put first the numbers of the rows we want, then a comma, then the numbers of the columns. There are two special pieces of notation, both of which I use here: leaving the row or column slot blank means all the rows or all the columns, and using a negative row or column number means all the rows or columns except the one(s) named. Thus my notation here is all the rows, and all the columns except for the first one. You can access data frames this way too, but the Tidyverse makes it much easier.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>I think Howell is famous enough to be trusted.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>As I failed to do the first time.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>On ancient maps, people didn’t know what was in certain parts of the world, because no-one had ever explored them, so they wrote on the map “here be dragons”.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>In contrast. Get it? No? Well, never mind then.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p><code>anova</code> is one of R’s multi-purpose tools; what it does depends on what you feed it.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>This is a fancy word for <em>stuff</em>.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>In R, percents around something mean that it is a special version of that something. Hence the notation for matrix-multiply and the pipe symbol. A regular * when used for multiplying matrices in R will multiply them element by element.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>The thing inside the square brackets says only to look at the elements of <span class="math inline">\(M^TM\)</span> whose row number and whose column number are different; it is perhaps easier to reason that elements of a matrix whose row number and column number are the <em>same</em> are <em>on</em> the diagonal, for example the element in row 2, column 2.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./survival-analysis.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Survival analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ancova.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Analysis of covariance</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>